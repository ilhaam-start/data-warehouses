[0m12:26:14.235820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108164410>]}


============================== 12:26:14.239466 | 2a429d10-1037-4619-a0bf-134dcf1ba90b ==============================
[0m12:26:14.239466 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:26:14.239858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:26:14.240190 [info ] [MainThread]: dbt version: 1.5.3
[0m12:26:14.240416 [info ] [MainThread]: python version: 3.11.2
[0m12:26:14.240630 [info ] [MainThread]: python path: /Users/ilhaam.ahmed/.pyenv/versions/3.11.2/bin/python3.11
[0m12:26:14.240817 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m12:26:14.240997 [info ] [MainThread]: Using profiles.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/profiles.yml
[0m12:26:14.241194 [info ] [MainThread]: Using dbt_project.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/dbt_project.yml
[0m12:26:14.241365 [info ] [MainThread]: Configuration:
[0m12:26:14.275994 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:26:14.285577 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:26:14.285953 [info ] [MainThread]: Required dependencies:
[0m12:26:14.286274 [debug] [MainThread]: Executing "git --help"
[0m12:26:14.300230 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:26:14.300834 [debug] [MainThread]: STDERR: "b''"
[0m12:26:14.301006 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:26:14.301211 [info ] [MainThread]: Connection:
[0m12:26:14.301519 [info ] [MainThread]:   host: localhost
[0m12:26:14.301726 [info ] [MainThread]:   port: 5433
[0m12:26:14.301910 [info ] [MainThread]:   user: postgres
[0m12:26:14.302078 [info ] [MainThread]:   database: mydb
[0m12:26:14.302250 [info ] [MainThread]:   schema: dbt_warehouse
[0m12:26:14.302413 [info ] [MainThread]:   search_path: None
[0m12:26:14.302571 [info ] [MainThread]:   keepalives_idle: 0
[0m12:26:14.302737 [info ] [MainThread]:   sslmode: None
[0m12:26:14.303365 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:26:14.351980 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:26:14.352585 [debug] [MainThread]: Using postgres connection "debug"
[0m12:26:14.352774 [debug] [MainThread]: On debug: select 1 as id
[0m12:26:14.352969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:14.456247 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:26:14.457461 [debug] [MainThread]: On debug: Close
[0m12:26:14.457745 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:26:14.458061 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:26:14.458678 [debug] [MainThread]: Command `dbt debug` succeeded at 12:26:14.458569 after 0.24 seconds
[0m12:26:14.458958 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:26:14.459245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e40bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104839dd0>]}
[0m12:26:14.459606 [debug] [MainThread]: Flushing usage events
[0m13:52:26.676660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b65290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7e610>]}


============================== 13:52:26.680294 | aa10f4ec-db41-42b5-8e28-5fbdffcca489 ==============================
[0m13:52:26.680294 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:52:26.680676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:52:26.723630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b90790>]}
[0m13:52:26.730558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c332d0>]}
[0m13:52:26.730924 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:52:26.741617 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:52:26.742080 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:26.742345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43550>]}
[0m13:52:27.020742 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m13:52:27.049121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34490>]}
[0m13:52:27.051893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b99290>]}
[0m13:52:27.052107 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m13:52:27.052313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102929090>]}
[0m13:52:27.053054 [info ] [MainThread]: 
[0m13:52:27.053519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:27.054069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:52:27.059627 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:52:27.059917 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:52:27.060063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:27.192877 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:52:27.194282 [debug] [ThreadPool]: On list_mydb: Close
[0m13:52:27.195472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now create_mydb_dbt_warehouse)
[0m13:52:27.196229 [debug] [ThreadPool]: Creating schema "database: "mydb"
schema: "dbt_warehouse"
"
[0m13:52:27.201149 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.201473 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: BEGIN
[0m13:52:27.201706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.219554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.219933 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.220190 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "create_mydb_dbt_warehouse"} */
create schema if not exists "dbt_warehouse"
[0m13:52:27.226989 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:52:27.227971 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.228253 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.228499 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.229854 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.230129 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: Close
[0m13:52:27.231578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydb_dbt_warehouse, now list_mydb_dbt_warehouse)
[0m13:52:27.237782 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.238131 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:52:27.238365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.253413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.253849 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.254132 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:52:27.270032 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:52:27.271259 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:52:27.272522 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:52:27.276904 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.277267 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.277523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:27.293826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.294162 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.294475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:27.332359 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m13:52:27.333327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c41a10>]}
[0m13:52:27.333567 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:27.334183 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.334332 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.335181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.335369 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.335518 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.335656 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.336177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.336353 [debug] [MainThread]: On master: Close
[0m13:52:27.336735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:27.336971 [info ] [MainThread]: 
[0m13:52:27.342289 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m13:52:27.342573 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m13:52:27.342971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m13:52:27.343142 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m13:52:27.344539 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:52:27.345042 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 13:52:27.343256 => 13:52:27.344947
[0m13:52:27.345214 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m13:52:27.363406 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:52:27.364036 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.364210 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m13:52:27.364370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:27.374858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.375151 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.375328 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m13:52:27.392308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:27.395547 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.395725 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:52:27.396965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:27.404734 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.404974 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.405132 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.406809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.409217 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.409404 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:52:27.410450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:27.411861 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 13:52:27.345325 => 13:52:27.411776
[0m13:52:27.412033 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m13:52:27.412399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537fb90>]}
[0m13:52:27.412688 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:52:27.413044 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m13:52:27.413818 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.413989 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.414127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:27.423508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.423783 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.423965 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.424111 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.424657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.424836 [debug] [MainThread]: On master: Close
[0m13:52:27.425187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:27.425331 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m13:52:27.425482 [info ] [MainThread]: 
[0m13:52:27.425672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:52:27.426058 [debug] [MainThread]: Command end result
[0m13:52:27.429100 [info ] [MainThread]: 
[0m13:52:27.429354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:27.429546 [info ] [MainThread]: 
[0m13:52:27.429743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:27.430082 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:27.430028 after 0.77 seconds
[0m13:52:27.430280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241dd0>]}
[0m13:52:27.430462 [debug] [MainThread]: Flushing usage events
[0m14:00:06.923103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06f50>]}


============================== 14:00:06.926738 | 9ef958ac-c326-40b4-aeb2-e691566c55a1 ==============================
[0m14:00:06.926738 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:06.927095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:06.968739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835c10>]}
[0m14:00:06.975720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f389d0>]}
[0m14:00:06.976095 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:00:06.986906 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:07.004326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:07.004564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:07.007813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879abd0>]}
[0m14:00:07.010917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087186d0>]}
[0m14:00:07.011147 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:00:07.011362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b15090>]}
[0m14:00:07.012241 [info ] [MainThread]: 
[0m14:00:07.012713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:07.013273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:00:07.018825 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:00:07.019123 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:00:07.019284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:07.081850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:00:07.082887 [debug] [ThreadPool]: On list_mydb: Close
[0m14:00:07.083791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:00:07.087471 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.087686 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:00:07.087858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:07.101379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.101689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.101906 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:00:07.111581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:00:07.112618 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:00:07.113505 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:00:07.116574 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.116823 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.117012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:07.130234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.130590 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.130913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:07.152393 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:00:07.154090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f3e50>]}
[0m14:00:07.154442 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:07.155396 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.155681 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.157019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.157250 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.157457 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.157656 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.158421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.158664 [debug] [MainThread]: On master: Close
[0m14:00:07.159170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:07.159473 [info ] [MainThread]: 
[0m14:00:07.162648 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:00:07.163068 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m14:00:07.163866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:00:07.164161 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:00:07.166170 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:00:07.166906 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:00:07.164342 => 14:00:07.166727
[0m14:00:07.167163 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:00:07.213938 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:00:07.214718 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.214912 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:00:07.215082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:07.224154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.224456 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.224645 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m14:00:07.234328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:00:07.237904 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.238119 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:00:07.239115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.240752 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.240951 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:00:07.242173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.251829 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.252040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.252224 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.254883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.257590 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.257790 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:00:07.261120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:00:07.261889 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:00:07.167313 => 14:00:07.261792
[0m14:00:07.262080 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:00:07.262477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1110>]}
[0m14:00:07.262812 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:00:07.263155 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:00:07.263995 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.264218 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.264381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:07.272218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.272527 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.272703 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.272855 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.273311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.273499 [debug] [MainThread]: On master: Close
[0m14:00:07.273853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:07.273997 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:00:07.274157 [info ] [MainThread]: 
[0m14:00:07.274364 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:00:07.274728 [debug] [MainThread]: Command end result
[0m14:00:07.278074 [info ] [MainThread]: 
[0m14:00:07.278355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:07.278571 [info ] [MainThread]: 
[0m14:00:07.278798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:07.279199 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:07.279142 after 0.37 seconds
[0m14:00:07.279416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442ddd0>]}
[0m14:00:07.279607 [debug] [MainThread]: Flushing usage events
[0m14:05:35.767644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006f50>]}


============================== 14:05:35.771199 | 034175d4-7d67-41d6-aae2-e41f66afff51 ==============================
[0m14:05:35.771199 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:05:35.771552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.812857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701d910>]}
[0m14:05:35.819827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702f0d0>]}
[0m14:05:35.820183 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:05:35.831018 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:05:35.848775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:35.849146 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:05:35.860302 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:05:35.870818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c3110>]}
[0m14:05:35.892339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ab4d0>]}
[0m14:05:35.892633 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:05:35.892848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5090>]}
[0m14:05:35.893574 [info ] [MainThread]: 
[0m14:05:35.894006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:35.894587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:05:35.900040 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:05:35.900283 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:05:35.900433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.983261 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:05:35.984470 [debug] [ThreadPool]: On list_mydb: Close
[0m14:05:35.985571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:05:35.989689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:35.989929 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:05:35.990119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.002024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.002289 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:36.002496 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:05:36.011510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:05:36.012684 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:05:36.013614 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:05:36.017116 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.017383 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.017581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:36.028720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.028992 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.029270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:36.050451 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:05:36.051943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16090>]}
[0m14:05:36.052305 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:36.053311 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.053537 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.054868 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.055101 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.055303 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.055497 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.056245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:36.056523 [debug] [MainThread]: On master: Close
[0m14:05:36.057046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:36.057372 [info ] [MainThread]: 
[0m14:05:36.060775 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:05:36.061188 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:05:36.061790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:05:36.062057 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:05:36.064206 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:05:36.065124 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:05:36.062232 => 14:05:36.064996
[0m14:05:36.065356 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:05:36.090105 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:05:36.091354 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.091560 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:05:36.091737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.101771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.102071 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.102278 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:05:37.468669 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:05:37.476258 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.476531 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:05:37.478081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.479736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.479929 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:05:37.480699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.492065 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.492271 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.492436 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.496382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.498965 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.499154 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:05:37.502157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:05:37.502968 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:05:36.065506 => 14:05:37.502872
[0m14:05:37.503146 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:05:37.503521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7cd0>]}
[0m14:05:37.503834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.44s]
[0m14:05:37.504157 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:05:37.505025 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.505211 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.505350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:37.517818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:37.518103 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.518258 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.518397 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.519061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.519265 [debug] [MainThread]: On master: Close
[0m14:05:37.519619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:37.519760 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:05:37.519916 [info ] [MainThread]: 
[0m14:05:37.520122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m14:05:37.520481 [debug] [MainThread]: Command end result
[0m14:05:37.523497 [info ] [MainThread]: 
[0m14:05:37.523766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:37.523948 [info ] [MainThread]: 
[0m14:05:37.524146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:37.524464 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:37.524416 after 1.77 seconds
[0m14:05:37.524657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde90>]}
[0m14:05:37.524846 [debug] [MainThread]: Flushing usage events
[0m14:06:18.492016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106737710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759e50>]}


============================== 14:06:18.495662 | 93c3510f-4610-440d-aa6a-e9d1619a3ed2 ==============================
[0m14:06:18.495662 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:18.496016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:18.537571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544909 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:18.554628 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:18.575371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:18.575827 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:18.587360 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:18.598080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839790>]}
[0m14:06:18.618526 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:18.621044 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:18.621662 [debug] [MainThread]: Command `dbt run` failed at 14:06:18.621588 after 0.14 seconds
[0m14:06:18.621879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681b110>]}
[0m14:06:18.622078 [debug] [MainThread]: Flushing usage events
[0m14:06:26.143579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c20d0>]}


============================== 14:06:26.146997 | 7ce145a1-6c34-45d2-8d05-9e2befcfa206 ==============================
[0m14:06:26.146997 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:26.147385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:26.180293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187683 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:26.197576 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:26.213972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:26.214222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:26.217566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7ce90>]}
[0m14:06:26.220323 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:26.222396 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:26.222992 [debug] [MainThread]: Command `dbt run` failed at 14:06:26.222914 after 0.09 seconds
[0m14:06:26.223201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102885dd0>]}
[0m14:06:26.223391 [debug] [MainThread]: Flushing usage events
[0m14:06:32.487972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108287750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829de50>]}


============================== 14:06:32.491425 | 5c947364-d1d9-4d4d-a03b-bb59702be088 ==============================
[0m14:06:32.491425 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:32.491763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:32.524418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b0510>]}
[0m14:06:32.531494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108286150>]}
[0m14:06:32.531888 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:32.541254 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:32.556488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:32.556822 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:32.567551 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:32.578062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108916850>]}
[0m14:06:32.599183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834ef50>]}
[0m14:06:32.599483 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:06:32.599697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106049090>]}
[0m14:06:32.600406 [info ] [MainThread]: 
[0m14:06:32.600869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:32.601427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:06:32.606715 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:06:32.607005 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:06:32.607162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:32.680926 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:06:32.682031 [debug] [ThreadPool]: On list_mydb: Close
[0m14:06:32.683155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:06:32.687270 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.687533 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:06:32.687728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:32.700071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.700385 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.700613 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:06:32.711235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:32.712315 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:06:32.713178 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:06:32.716355 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.716611 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.716801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:32.726431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.726701 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.726985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:32.744351 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:06:32.745617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad250>]}
[0m14:06:32.745932 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:32.746718 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.746913 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.748164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.748393 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.748595 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.748787 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.749581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:32.749877 [debug] [MainThread]: On master: Close
[0m14:06:32.750421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:32.750742 [info ] [MainThread]: 
[0m14:06:32.753796 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:06:32.754145 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:06:32.754661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:06:32.754893 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:06:32.756814 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:06:32.757627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:06:32.755047 => 14:06:32.757476
[0m14:06:32.757886 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:06:32.783213 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:06:32.784010 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.784238 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:06:32.784426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:32.793492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.793813 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.794016 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:06:33.143275 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:06:33.154582 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.154865 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:06:33.156060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.157736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.157926 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:06:33.158715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.169624 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.169830 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.169991 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.173486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.176107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.176309 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:06:33.182264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:33.183109 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:06:32.758050 => 14:06:33.183019
[0m14:06:33.183290 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:06:33.183665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894ee50>]}
[0m14:06:33.183990 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m14:06:33.184326 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:06:33.185204 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.185402 [debug] [MainThread]: On master: BEGIN
[0m14:06:33.185543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:33.194950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:33.195236 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.195392 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.195528 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.196087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.196262 [debug] [MainThread]: On master: Close
[0m14:06:33.196595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:33.196736 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:06:33.196890 [info ] [MainThread]: 
[0m14:06:33.197104 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m14:06:33.197477 [debug] [MainThread]: Command end result
[0m14:06:33.200808 [info ] [MainThread]: 
[0m14:06:33.201082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:33.201287 [info ] [MainThread]: 
[0m14:06:33.201500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:33.201879 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:33.201830 after 0.73 seconds
[0m14:06:33.202061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961e90>]}
[0m14:06:33.202228 [debug] [MainThread]: Flushing usage events
[0m14:52:53.002139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5f10>]}


============================== 14:52:53.005787 | bd12cd35-77a0-4cfa-af96-d914f5056086 ==============================
[0m14:52:53.005787 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:52:53.006139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:53.049813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5d50>]}
[0m14:52:53.056779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c49d0>]}
[0m14:52:53.057166 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:52:53.067561 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:52:53.087471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m14:52:53.087798 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:52:53.087966 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:52:53.088171 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:52:53.088350 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:52:53.099750 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:52:53.107037 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:52:53.108926 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:52:53.110745 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:52:53.134489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e68b90>]}
[0m14:52:53.138287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3efd0>]}
[0m14:52:53.138507 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:52:53.138720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104481090>]}
[0m14:52:53.139512 [info ] [MainThread]: 
[0m14:52:53.139913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:53.140469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:52:53.145835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:52:53.146114 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:52:53.146259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:53.281367 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:52:53.282930 [debug] [ThreadPool]: On list_mydb: Close
[0m14:52:53.284509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:52:53.290006 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.290300 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:52:53.290559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:53.309561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.310028 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.310372 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:52:53.322942 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:53.324404 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:52:53.325775 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:52:53.330527 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.330909 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.331189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:53.348320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.348797 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.349238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:53.375876 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:52:53.377138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb2d0>]}
[0m14:52:53.377453 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:53.378228 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.378414 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.379532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.379718 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.379885 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.380051 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.380818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.381020 [debug] [MainThread]: On master: Close
[0m14:52:53.381468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:53.381727 [info ] [MainThread]: 
[0m14:52:53.384870 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:52:53.385143 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:52:53.385462 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:52:53.385828 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:52:53.386368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:52:53.386821 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:52:53.387074 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:52:53.387339 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:52:53.389449 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.391133 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:52:53.391811 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:52:53.387541 => 14:52:53.391683
[0m14:52:53.392033 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:52:53.392263 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:52:53.389655 => 14:52:53.392154
[0m14:52:53.416685 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:52:53.416396 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.420514 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:52:53.421045 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.421280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:52:53.421531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:53.421786 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.422117 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:52:53.422318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:53.432698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433330 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.433549 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.433803 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.434068 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    movie_id,
    user_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.435161 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435378 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435644 [debug] [Thread-2 (]: On model.maker_warehouse.movies: ROLLBACK
[0m14:52:53.435936 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: ROLLBACK
[0m14:52:53.436854 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:52:53.417010 => 14:52:53.436726
[0m14:52:53.437199 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:52:53.392410 => 14:52:53.437078
[0m14:52:53.437428 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:52:53.437644 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:52:53.444341 [debug] [Thread-1 (]: Database Error in model movie_viewings (models/facts/movie_viewings.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.445198 [debug] [Thread-2 (]: Database Error in model movies (models/facts/movies.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.445496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679bcd0>]}
[0m14:52:53.445747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4edd0>]}
[0m14:52:53.446187 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_warehouse.movie_viewings ............. [[31mERROR[0m in 0.06s]
[0m14:52:53.446641 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model dbt_warehouse.movies ..................... [[31mERROR[0m in 0.06s]
[0m14:52:53.447008 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:52:53.447264 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:52:53.447653 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.447842 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:52:53.448133 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_warehouse.sum_movie_viewing_time ...................... [[33mSKIP[0m]
[0m14:52:53.448460 [info ] [Thread-3 (]: 4 of 4 SKIP relation dbt_warehouse.sum_movie_views ............................. [[33mSKIP[0m]
[0m14:52:53.448789 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.449018 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:52:53.449902 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.450073 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.450219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:53.459117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.459411 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.459575 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.459728 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.460243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.460415 [debug] [MainThread]: On master: Close
[0m14:52:53.460787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:53.460933 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:52:53.461080 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:52:53.461262 [info ] [MainThread]: 
[0m14:52:53.461484 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:52:53.461879 [debug] [MainThread]: Command end result
[0m14:52:53.465106 [info ] [MainThread]: 
[0m14:52:53.465388 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:53.465586 [info ] [MainThread]: 
[0m14:52:53.465782 [error] [MainThread]: [33mDatabase Error in model movie_viewings (models/facts/movie_viewings.sql)[0m
[0m14:52:53.465973 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.466222 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.466460 [error] [MainThread]:                                        ^
[0m14:52:53.466663 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.466968 [info ] [MainThread]: 
[0m14:52:53.467177 [error] [MainThread]: [33mDatabase Error in model movies (models/facts/movies.sql)[0m
[0m14:52:53.467368 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.467551 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.467772 [error] [MainThread]:                                        ^
[0m14:52:53.467963 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.468157 [info ] [MainThread]: 
[0m14:52:53.468426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m14:52:53.468822 [debug] [MainThread]: Command `dbt run` failed at 14:52:53.468759 after 0.48 seconds
[0m14:52:53.469060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1d10>]}
[0m14:52:53.469269 [debug] [MainThread]: Flushing usage events
[0m14:54:10.235881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062092d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106210410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062221d0>]}


============================== 14:54:10.239721 | bde4c731-7a74-49fc-bc0d-80cc781a44ec ==============================
[0m14:54:10.239721 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:10.240117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:10.289824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223050>]}
[0m14:54:10.296825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d7690>]}
[0m14:54:10.297197 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:10.307554 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:10.326864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:10.327221 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:54:10.327406 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:54:10.339126 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:54:10.346324 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:54:10.351777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bf90>]}
[0m14:54:10.372977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9ed0>]}
[0m14:54:10.373240 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:10.373450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcd090>]}
[0m14:54:10.374271 [info ] [MainThread]: 
[0m14:54:10.374714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:10.375373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:10.380773 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:10.381017 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:10.381166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:10.455292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:10.456374 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:10.457515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:10.461554 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.461778 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:10.461966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:10.481646 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.481877 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.482084 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:10.493755 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:10.494815 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:10.495753 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:10.499251 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.499726 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.499936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:10.513050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.513437 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.513800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:10.537336 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:10.538746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539fb50>]}
[0m14:54:10.539109 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:10.540132 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.540382 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.541924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.542181 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.542408 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.542628 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.543446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:10.543693 [debug] [MainThread]: On master: Close
[0m14:54:10.544239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:10.544579 [info ] [MainThread]: 
[0m14:54:10.548600 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:10.548930 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:10.549354 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:10.549805 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:10.550447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:10.550981 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:10.551317 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:10.551632 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:10.554260 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.556361 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:10.557001 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:10.551865 => 14:54:10.556844
[0m14:54:10.557302 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:10.554555 => 14:54:10.557164
[0m14:54:10.557571 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:10.557829 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:10.586680 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:10.587977 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.588448 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.588666 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.588840 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:10.589031 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:10.589202 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:10.589366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:10.598245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598765 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.598966 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.599164 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:10.599368 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:11.055653 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:11.065278 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.065566 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:11.067142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.068677 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.068859 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:11.069777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.080556 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.080824 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.080988 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.097353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.100284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.100493 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:11.109203 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.110135 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:10.581973 => 14:54:11.110042
[0m14:54:11.110333 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:11.110727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e3410>]}
[0m14:54:11.111061 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m14:54:11.111490 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:11.212220 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:11.219196 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.219775 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:11.220995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.223407 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.223639 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.223805 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.234985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.237749 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.238001 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:11.239181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.239946 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:10.558009 => 14:54:11.239854
[0m14:54:11.240125 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:11.240491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062df2d0>]}
[0m14:54:11.240777 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.69s]
[0m14:54:11.241112 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:11.241645 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.241826 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:11.242070 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:11.242345 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:11.242793 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:11.243133 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:11.243319 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.243483 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:11.244970 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.246797 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.247421 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:11.243602 => 14:54:11.247308
[0m14:54:11.247609 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.247802 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:11.245227 => 14:54:11.247713
[0m14:54:11.249993 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.250237 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:11.252545 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.252903 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.253077 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:11.253236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:11.253524 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.253689 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:11.253839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:11.262196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262660 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.262846 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.263049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.263257 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.264133 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264319 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264548 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m14:54:11.264757 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m14:54:11.265630 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:11.250427 => 14:54:11.265517
[0m14:54:11.265932 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:11.247920 => 14:54:11.265824
[0m14:54:11.266156 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:11.266337 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:11.272114 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.272812 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.273060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b9810>]}
[0m14:54:11.273263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a990>]}
[0m14:54:11.273558 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.03s]
[0m14:54:11.273823 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.03s]
[0m14:54:11.274168 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:11.274369 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.275151 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.275299 [debug] [MainThread]: On master: BEGIN
[0m14:54:11.275428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:11.283190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.283464 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.283619 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.283761 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.284359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.284535 [debug] [MainThread]: On master: Close
[0m14:54:11.284875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:11.285016 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:11.285138 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:11.285257 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:11.285376 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:11.285546 [info ] [MainThread]: 
[0m14:54:11.285749 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:54:11.286254 [debug] [MainThread]: Command end result
[0m14:54:11.289367 [info ] [MainThread]: 
[0m14:54:11.289616 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:54:11.289799 [info ] [MainThread]: 
[0m14:54:11.289974 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m14:54:11.290144 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.290309 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.290469 [error] [MainThread]:                             ^
[0m14:54:11.290630 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.290793 [info ] [MainThread]: 
[0m14:54:11.290958 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m14:54:11.291124 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.291283 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.291440 [error] [MainThread]:                             ^
[0m14:54:11.291597 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.291764 [info ] [MainThread]: 
[0m14:54:11.291997 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m14:54:11.292352 [debug] [MainThread]: Command `dbt run` failed at 14:54:11.292300 after 1.07 seconds
[0m14:54:11.292550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02510>]}
[0m14:54:11.292724 [debug] [MainThread]: Flushing usage events
[0m14:54:29.143599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b53f90>]}


============================== 14:54:29.147195 | 55b68981-3ebb-438a-b2ce-8f3f1ba487ee ==============================
[0m14:54:29.147195 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:29.147546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:29.188375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75d90>]}
[0m14:54:29.195353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a28850>]}
[0m14:54:29.195712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:29.206355 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:29.223147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:29.223487 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:54:29.223676 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:54:29.235466 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:54:29.242626 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:54:29.247946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fffd0>]}
[0m14:54:29.269107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2ecd0>]}
[0m14:54:29.269458 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:29.269710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921090>]}
[0m14:54:29.270575 [info ] [MainThread]: 
[0m14:54:29.271017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:29.271664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:29.277074 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:29.277404 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:29.277576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:29.339125 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:29.340106 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:29.341125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:29.344793 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.345004 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:29.345175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.359652 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.359841 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.360027 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:29.368130 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:54:29.369058 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:29.369798 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:29.373168 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.373403 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.373578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:29.383454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.383752 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.384030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:29.399334 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:29.400553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b64610>]}
[0m14:54:29.400857 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:29.401804 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.402000 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.404550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.404764 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.404946 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.405119 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.405823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.406053 [debug] [MainThread]: On master: Close
[0m14:54:29.406518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:29.406796 [info ] [MainThread]: 
[0m14:54:29.409712 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:29.409991 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:29.410341 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:29.410739 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:29.411284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:29.411769 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:29.412016 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:29.412242 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:29.414254 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.415887 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:29.416405 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:29.414443 => 14:54:29.416273
[0m14:54:29.416660 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:29.412407 => 14:54:29.416547
[0m14:54:29.416875 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:29.417080 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:29.440117 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:29.442376 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.443148 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.443342 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.443513 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:29.443672 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:29.443829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.443977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:29.453635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.453955 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.454150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.454415 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.454625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.454869 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.793754 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:29.803496 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.803778 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:29.805129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.806796 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.806985 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:29.808008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.818890 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.819156 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.819320 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.829033 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.831949 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.832174 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:29.881596 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:29.884282 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:29.417218 => 14:54:29.883855
[0m14:54:29.884905 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:29.886101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c222d0>]}
[0m14:54:29.887003 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.47s]
[0m14:54:29.887732 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:30.100449 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:30.107266 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.107845 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:54:30.109386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.112239 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.112535 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:30.113606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.115088 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.115273 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.115433 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.123069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.125886 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.126136 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:30.186535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.190228 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:29.440347 => 14:54:30.189853
[0m14:54:30.190921 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:30.192019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104456490>]}
[0m14:54:30.192838 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.78s]
[0m14:54:30.193747 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:30.194780 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.195420 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:30.195173 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:30.195815 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:30.196312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:30.196656 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:30.196837 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.197000 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:30.199061 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.200597 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.201266 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:30.199297 => 14:54:30.201132
[0m14:54:30.201492 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:30.197117 => 14:54:30.201396
[0m14:54:30.201677 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:30.201852 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.203945 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.205873 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206210 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.206396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:30.206572 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:30.206929 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:30.207166 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:30.215877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216385 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.216585 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.216777 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.216966 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.339307 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.340389 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.346198 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.348780 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.349080 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:54:30.349264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:54:30.350207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.350397 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.351484 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.352494 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.352672 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.352836 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.352994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.353149 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.355073 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.356334 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.356509 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:54:30.356674 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.358595 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.358756 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.358928 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:54:30.359621 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:30.204070 => 14:54:30.359534
[0m14:54:30.359824 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:30.360199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9dd0>]}
[0m14:54:30.360372 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.360674 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.16s]
[0m14:54:30.361459 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:30.201960 => 14:54:30.361366
[0m14:54:30.361756 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.361959 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:30.362466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ca890>]}
[0m14:54:30.362771 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m14:54:30.363100 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:30.364864 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.365148 [debug] [MainThread]: On master: BEGIN
[0m14:54:30.365301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:30.374589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.374882 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375033 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.375173 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.375958 [debug] [MainThread]: On master: Close
[0m14:54:30.376315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:30.376446 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:30.376566 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:30.376683 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:30.376795 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:30.376961 [info ] [MainThread]: 
[0m14:54:30.377158 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:54:30.377689 [debug] [MainThread]: Command end result
[0m14:54:30.380747 [info ] [MainThread]: 
[0m14:54:30.381045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:30.381302 [info ] [MainThread]: 
[0m14:54:30.381519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:54:30.381865 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:30.381811 after 1.25 seconds
[0m14:54:30.382075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f0690>]}
[0m14:54:30.382266 [debug] [MainThread]: Flushing usage events
[0m15:05:23.550862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106189290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106058bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a25d0>]}


============================== 15:05:23.554403 | a888bcc0-2d9e-49e3-9319-7b7a18507126 ==============================
[0m15:05:23.554403 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:23.554814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:23.597999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106243f50>]}
[0m15:05:23.604967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b6190>]}
[0m15:05:23.605333 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:23.616128 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:23.637158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:23.637533 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:23.637726 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:23.649569 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:23.656893 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:23.662653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062611d0>]}
[0m15:05:23.683492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068174d0>]}
[0m15:05:23.683765 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:23.683979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4d090>]}
[0m15:05:23.684843 [info ] [MainThread]: 
[0m15:05:23.685295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:23.685983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:23.691529 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:23.691781 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:23.691933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:23.780791 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:23.781911 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:23.783139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:23.787204 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.787430 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:23.787617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:23.800457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.800749 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.800970 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:23.812628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:23.813805 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:23.814669 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:23.818681 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.818975 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.819177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:23.832048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.832380 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.832699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:23.858134 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:23.859694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7f850>]}
[0m15:05:23.860082 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:23.861064 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.861386 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.863163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.863490 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.863774 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.864021 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.864880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:23.865138 [debug] [MainThread]: On master: Close
[0m15:05:23.865651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:23.865966 [info ] [MainThread]: 
[0m15:05:23.869314 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:23.869617 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:23.869998 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:23.870461 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:23.871096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:23.871613 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:23.871887 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:23.872163 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:23.874464 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.876373 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:23.877688 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:23.874675 => 15:05:23.877539
[0m15:05:23.878010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:23.872363 => 15:05:23.877875
[0m15:05:23.878238 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:23.878484 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:23.908778 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.910005 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:23.911094 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.911299 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.911488 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:23.911665 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:23.911836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:23.912015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:23.921744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922096 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.922323 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:23.922533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922841 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.923065 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:24.379349 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:24.391913 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.392224 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:24.394945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.396607 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.396798 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:24.397790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.409066 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.409344 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.409524 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.450606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.457087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.457377 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:24.466823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.468939 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:23.878655 => 15:05:24.468694
[0m15:05:24.469420 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:24.470087 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106194f90>]}
[0m15:05:24.470519 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.60s]
[0m15:05:24.470888 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:24.632375 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:05:24.638694 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.639280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:24.640878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.644454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.644733 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:24.645546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.646964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.647144 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.647295 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.658659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.662245 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.662624 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:24.714906 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.717136 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:23.904081 => 15:05:24.716887
[0m15:05:24.717680 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:24.718687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106842150>]}
[0m15:05:24.719462 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.85s]
[0m15:05:24.720394 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:24.721675 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.722218 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:24.722915 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:24.723935 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:24.724545 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:24.724880 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:24.725062 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.725234 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:24.727161 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.728766 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.729456 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:24.727404 => 15:05:24.729337
[0m15:05:24.729702 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:24.725359 => 15:05:24.729589
[0m15:05:24.729882 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:24.730070 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.732514 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735120 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.735725 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735945 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.736104 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:24.736280 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:24.736447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:24.736602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:24.746945 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747256 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747606 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.747817 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.748073 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.748299 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.750473 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.750749 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.751020 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m15:05:24.751346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m15:05:24.752328 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:24.730190 => 15:05:24.752193
[0m15:05:24.752775 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:24.732781 => 15:05:24.752523
[0m15:05:24.753005 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:24.753195 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:24.759428 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.760162 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.760472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b7490>]}
[0m15:05:24.760684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256a50>]}
[0m15:05:24.761016 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.04s]
[0m15:05:24.761356 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.04s]
[0m15:05:24.761687 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:24.761910 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.762829 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.762997 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.763130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:24.771512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.771811 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.771952 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.772082 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.772611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.772771 [debug] [MainThread]: On master: Close
[0m15:05:24.773094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:24.773227 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:24.773345 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:24.773462 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:24.773576 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:24.773728 [info ] [MainThread]: 
[0m15:05:24.773922 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m15:05:24.774370 [debug] [MainThread]: Command end result
[0m15:05:24.777861 [info ] [MainThread]: 
[0m15:05:24.778087 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:24.778266 [info ] [MainThread]: 
[0m15:05:24.778446 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m15:05:24.778618 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.778782 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.778940 [error] [MainThread]:                ^
[0m15:05:24.779102 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.779265 [info ] [MainThread]: 
[0m15:05:24.779429 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m15:05:24.779595 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.779753 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.779912 [error] [MainThread]:                ^
[0m15:05:24.780071 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.780237 [info ] [MainThread]: 
[0m15:05:24.780422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:05:24.780722 [debug] [MainThread]: Command `dbt run` failed at 15:05:24.780677 after 1.24 seconds
[0m15:05:24.780908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102865e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102867b90>]}
[0m15:05:24.781083 [debug] [MainThread]: Flushing usage events
[0m15:05:44.547398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee2d0>]}


============================== 15:05:44.550929 | 29bb855e-8014-4fd0-8a8f-6fe8847b33c2 ==============================
[0m15:05:44.550929 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:44.551295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:44.592211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106800450>]}
[0m15:05:44.599237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6d90>]}
[0m15:05:44.599621 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:44.609662 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:44.626547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:44.626918 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:44.627110 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:44.638341 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:44.645756 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:44.651395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69790>]}
[0m15:05:44.672703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e62c50>]}
[0m15:05:44.672980 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:44.673203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104599090>]}
[0m15:05:44.674048 [info ] [MainThread]: 
[0m15:05:44.674530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:44.675201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:44.680835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:44.681091 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:44.681237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:44.736435 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:44.737402 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:44.738386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:44.741985 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.742201 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:44.742358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:44.757850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.758039 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.758231 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:44.767820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:44.768761 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:44.769571 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:44.773034 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.773289 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.773473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:44.783986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.784326 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.784644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:44.799812 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:44.801059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fe350>]}
[0m15:05:44.801373 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:44.802213 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.802453 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.803581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.803801 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.803997 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.804181 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.804877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:44.805131 [debug] [MainThread]: On master: Close
[0m15:05:44.805594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:44.805891 [info ] [MainThread]: 
[0m15:05:44.808914 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:44.809200 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:44.809513 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:44.809878 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:44.810400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:44.810876 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:44.811132 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:44.811360 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:44.813393 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.815164 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:44.815868 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:44.811536 => 15:05:44.815744
[0m15:05:44.816133 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:44.813589 => 15:05:44.816010
[0m15:05:44.816365 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:44.816581 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:44.840960 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.843140 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:44.843583 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.843790 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.843964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:44.844137 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:44.844303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:44.844458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:44.866180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866794 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.867018 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.867238 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:44.867460 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:45.184059 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.193965 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.194249 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:45.195482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.196950 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.197126 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:45.198123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.208961 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.209261 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.209432 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.226309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.229158 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.229372 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:45.236660 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.237559 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:44.841129 => 15:05:45.237471
[0m15:05:45.237742 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:45.238134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf290>]}
[0m15:05:45.238455 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m15:05:45.238789 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:45.278875 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 0.0 seconds
[0m15:05:45.283717 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.284017 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:45.285416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.287186 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.287375 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:45.288633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.289961 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.290136 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.290289 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.294822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.296159 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.296346 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:45.316539 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.319009 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:44.816732 => 15:05:45.318718
[0m15:05:45.319496 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:45.320465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecd0d0>]}
[0m15:05:45.321106 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.51s]
[0m15:05:45.321558 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:45.322085 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.322310 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:45.322588 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:45.322911 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:45.323404 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:45.323758 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:45.323939 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.324104 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:45.326036 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.327486 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.327914 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:45.326248 => 15:05:45.327818
[0m15:05:45.328111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:45.324243 => 15:05:45.328017
[0m15:05:45.328283 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:45.328471 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.330585 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.332600 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333013 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.333190 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:45.333588 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:45.333756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:45.333948 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:45.342314 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342568 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342785 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.342971 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.343157 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.343346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.463310 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.463875 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.468579 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.472496 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.472923 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:05:45.473125 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:05:45.474195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.475792 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.475998 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:05:45.476170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.477706 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.477890 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.478067 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:05:45.480159 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480389 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.480560 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480972 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.482183 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.482368 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.482526 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.483282 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.484444 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.484612 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:05:45.484881 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.485953 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.486122 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:05:45.487376 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488222 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:45.330717 => 15:05:45.488122
[0m15:05:45.488423 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:45.488583 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008c90>]}
[0m15:05:45.489688 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:45.328604 => 15:05:45.489597
[0m15:05:45.489997 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.490242 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:45.490517 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.490958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e9ad0>]}
[0m15:05:45.491391 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.491724 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:45.492582 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.492746 [debug] [MainThread]: On master: BEGIN
[0m15:05:45.492879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:45.501284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.501614 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.501776 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.501913 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.502490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.502631 [debug] [MainThread]: On master: Close
[0m15:05:45.502960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:45.503089 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:45.503208 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:45.503323 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:45.503435 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:45.503588 [info ] [MainThread]: 
[0m15:05:45.503790 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:05:45.504372 [debug] [MainThread]: Command end result
[0m15:05:45.507387 [info ] [MainThread]: 
[0m15:05:45.507622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:45.507808 [info ] [MainThread]: 
[0m15:05:45.508004 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:05:45.508314 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:45.508269 after 0.97 seconds
[0m15:05:45.508502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d68690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1dd0>]}
[0m15:05:45.508680 [debug] [MainThread]: Flushing usage events
[0m15:11:44.338699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e15290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2db90>]}


============================== 15:11:44.342392 | 7133d1bd-0fc7-416e-a64f-a43d75e67829 ==============================
[0m15:11:44.342392 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:11:44.342792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:11:44.387477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e56bd0>]}
[0m15:11:44.394554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0b3d0>]}
[0m15:11:44.394973 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:11:44.405875 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:11:44.424575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:44.424920 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:11:44.436593 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:11:44.447206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3450>]}
[0m15:11:44.468300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1d10>]}
[0m15:11:44.468583 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:11:44.468796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd9090>]}
[0m15:11:44.469608 [info ] [MainThread]: 
[0m15:11:44.470035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:44.470697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:11:44.476212 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:11:44.476459 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:11:44.476598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:44.544969 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:11:44.545958 [debug] [ThreadPool]: On list_mydb: Close
[0m15:11:44.546950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:11:44.550626 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.550838 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:11:44.551008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:44.560618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.560941 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.561171 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:11:44.571133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:11:44.572133 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:11:44.572948 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:11:44.576404 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.576660 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.576838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:44.587471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.587738 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.588047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:44.633361 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:11:44.634919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585f610>]}
[0m15:11:44.635338 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:44.636569 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.636823 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.638544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.638836 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.639105 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.639335 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.640239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:44.640491 [debug] [MainThread]: On master: Close
[0m15:11:44.641044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:44.641425 [info ] [MainThread]: 
[0m15:11:44.645649 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:11:44.645964 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:11:44.646336 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:11:44.646751 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:11:44.647371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:11:44.647874 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:11:44.648135 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:11:44.648378 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:11:44.650693 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.652721 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:11:44.653966 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:11:44.650943 => 15:11:44.653784
[0m15:11:44.654286 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:11:44.648552 => 15:11:44.654131
[0m15:11:44.654559 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:11:44.654819 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:11:44.679834 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:11:44.682190 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.682620 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.682835 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.683020 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:11:44.683212 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:11:44.683404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:11:44.683575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:44.693015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693310 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.693525 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693744 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:44.693972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.694237 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:45.142368 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.154736 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.155061 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:11:45.156671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.158362 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.158562 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:11:45.159337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.170519 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.170866 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.171059 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.180733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.183561 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.183759 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:11:45.197473 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.198500 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:11:44.654991 => 15:11:45.198401
[0m15:11:45.198708 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:11:45.199129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3950>]}
[0m15:11:45.199465 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:11:45.199818 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:11:45.200862 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:11:45.202643 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.202874 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:11:45.204270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.206062 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.206293 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:11:45.207144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.208554 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.208746 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.208908 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.213696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.215126 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.215342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:11:45.247272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.248148 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:11:44.680010 => 15:11:45.248056
[0m15:11:45.248342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:11:45.248720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2da50>]}
[0m15:11:45.249014 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.60s]
[0m15:11:45.249384 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:11:45.249856 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.250050 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:11:45.250370 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:11:45.250654 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:11:45.251102 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:11:45.251431 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:11:45.251605 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.251766 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:11:45.253849 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.255735 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.256511 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:11:45.254104 => 15:11:45.256357
[0m15:11:45.256714 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:11:45.256947 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:11:45.251887 => 15:11:45.256859
[0m15:11:45.259629 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.259896 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.262369 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.262907 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.263114 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:11:45.263300 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.263486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:45.263666 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:11:45.263933 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:45.274638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.274921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.275170 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.275378 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.275599 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:11:45.275794 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:11:45.396146 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.402086 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.402545 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.403097 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:11:45.405253 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.405515 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:11:45.406374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.406565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.407927 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.409283 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.409462 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:11:45.409633 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:11:45.410411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.412358 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412531 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.412682 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.414060 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.414260 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.414420 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.416532 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.417650 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.417821 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:11:45.418084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.419150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.419323 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:11:45.420863 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.421689 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:11:45.260118 => 15:11:45.421592
[0m15:11:45.421891 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:11:45.422049 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.422442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0df50>]}
[0m15:11:45.423087 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:11:45.257216 => 15:11:45.423002
[0m15:11:45.423386 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.423640 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:11:45.423901 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.424272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667fc50>]}
[0m15:11:45.424791 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.425125 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:11:45.425962 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.426152 [debug] [MainThread]: On master: BEGIN
[0m15:11:45.426291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:45.435303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.435601 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.435754 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.435894 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.436512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.436700 [debug] [MainThread]: On master: Close
[0m15:11:45.437069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:45.437208 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:11:45.437332 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:11:45.437460 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:11:45.437579 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:11:45.437736 [info ] [MainThread]: 
[0m15:11:45.438071 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m15:11:45.438605 [debug] [MainThread]: Command end result
[0m15:11:45.441590 [info ] [MainThread]: 
[0m15:11:45.441817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:45.442007 [info ] [MainThread]: 
[0m15:11:45.442207 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:11:45.442512 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:45.442469 after 1.12 seconds
[0m15:11:45.442697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023a8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1dd0>]}
[0m15:11:45.442865 [debug] [MainThread]: Flushing usage events
[0m15:16:58.197577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104321450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043221d0>]}


============================== 15:16:58.201298 | 49886db4-9e37-44bf-9f96-6adee53d1d5e ==============================
[0m15:16:58.201298 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:16:58.201672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:58.244712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434b5d0>]}
[0m15:16:58.251791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432ec50>]}
[0m15:16:58.252220 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:16:58.262490 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:16:58.285491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:58.285874 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:16:58.297532 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:16:58.308333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334790>]}
[0m15:16:58.329730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498aa50>]}
[0m15:16:58.330009 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:16:58.330226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020cd090>]}
[0m15:16:58.331054 [info ] [MainThread]: 
[0m15:16:58.331513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:58.332135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:16:58.337638 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:16:58.337900 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:16:58.338053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:58.411393 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:16:58.412432 [debug] [ThreadPool]: On list_mydb: Close
[0m15:16:58.413513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:16:58.417191 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.417405 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:16:58.417577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:58.432067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.432285 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.432485 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:16:58.444648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:16:58.445722 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:16:58.446526 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:16:58.450356 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.450634 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.450827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:58.463666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.463921 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.464249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:58.483367 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:16:58.484764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104390a10>]}
[0m15:16:58.485105 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:58.486023 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.486304 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.487543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.487775 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.487981 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.488243 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.489085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:58.489376 [debug] [MainThread]: On master: Close
[0m15:16:58.489896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:58.490213 [info ] [MainThread]: 
[0m15:16:58.494094 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:16:58.494413 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:16:58.494780 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:16:58.495254 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:16:58.495846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:16:58.496321 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:16:58.496562 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:16:58.496782 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:16:58.498804 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.500561 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:16:58.501595 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:16:58.499007 => 15:16:58.501431
[0m15:16:58.501926 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:16:58.496937 => 15:16:58.501792
[0m15:16:58.502160 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:16:58.502414 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:16:58.526004 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:16:58.528325 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.528763 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.528962 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.529153 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:16:58.529330 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:16:58.529498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:58.529656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:58.538614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.538905 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.539117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.539383 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.539599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.539847 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.980884 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:58.991087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.991386 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:16:58.993037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:58.994683 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.994871 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:16:58.995782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.006469 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.006738 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.006899 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.026166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.029078 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.029282 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:16:59.036447 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.037371 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:16:58.502610 => 15:16:59.037275
[0m15:16:59.037561 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:16:59.037948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e59d0>]}
[0m15:16:59.038280 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.54s]
[0m15:16:59.038628 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:16:59.086158 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:16:59.089836 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.090075 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:16:59.093136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.094457 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.094625 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:16:59.095424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.096783 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.096961 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.097114 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.112291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.113571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.113740 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:16:59.143245 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.146777 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:16:58.526171 => 15:16:59.146379
[0m15:16:59.147395 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:16:59.148511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399e250>]}
[0m15:16:59.149186 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:16:59.149597 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:16:59.150096 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.150314 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:16:59.150558 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:16:59.150867 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:16:59.151422 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:16:59.151761 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:16:59.151935 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.152097 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:16:59.154078 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.155588 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.156012 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:16:59.152209 => 15:16:59.155917
[0m15:16:59.156230 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:16:59.154309 => 15:16:59.156116
[0m15:16:59.156423 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.156588 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:16:59.158689 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.160745 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161224 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.161393 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161568 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:16:59.161729 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:16:59.161882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:16:59.162031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:16:59.177054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177644 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.177845 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.178035 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.178231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.307497 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.308067 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.314005 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.317054 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.317308 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:16:59.317490 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:16:59.318507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.318679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.320106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.321429 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.321598 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:16:59.321764 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:16:59.322592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.322766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.324788 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.325893 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.326068 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.326229 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.326384 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.326528 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.331612 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.332761 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.332947 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:16:59.333214 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.334375 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.334560 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:16:59.335917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.336648 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:16:59.156703 => 15:16:59.336559
[0m15:16:59.336839 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:16:59.337220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73a90>]}
[0m15:16:59.337531 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.337861 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.338453 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.339238 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:16:59.158820 => 15:16:59.339144
[0m15:16:59.339436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:16:59.339810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b0cd0>]}
[0m15:16:59.340097 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.340435 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:16:59.341935 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.342260 [debug] [MainThread]: On master: BEGIN
[0m15:16:59.342402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:59.349615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.349906 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.350120 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.350290 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.351034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.351252 [debug] [MainThread]: On master: Close
[0m15:16:59.351606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:59.351739 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:16:59.351855 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:16:59.351965 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:16:59.352072 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:16:59.352232 [info ] [MainThread]: 
[0m15:16:59.352420 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:16:59.352944 [debug] [MainThread]: Command end result
[0m15:16:59.356019 [info ] [MainThread]: 
[0m15:16:59.356330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:59.356527 [info ] [MainThread]: 
[0m15:16:59.356751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:16:59.357111 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:59.357058 after 1.17 seconds
[0m15:16:59.357305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10089c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009e5e90>]}
[0m15:16:59.357481 [debug] [MainThread]: Flushing usage events
[0m15:31:28.885297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487f90>]}


============================== 15:31:28.889159 | 291e5c32-c9e2-4124-ad98-c2f68608ce73 ==============================
[0m15:31:28.889159 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:31:28.889562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:31:28.932880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aab50>]}
[0m15:31:28.939923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655f690>]}
[0m15:31:28.940297 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:31:28.950590 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:31:28.972544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:31:28.972908 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m15:31:28.973127 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m15:31:28.984980 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:31:28.992257 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:31:28.997745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106492c10>]}
[0m15:31:29.018676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d850>]}
[0m15:31:29.018954 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:31:29.019168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104255090>]}
[0m15:31:29.020063 [info ] [MainThread]: 
[0m15:31:29.020487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:29.021119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:31:29.026482 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:31:29.026723 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:31:29.026874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:29.106698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:31:29.107802 [debug] [ThreadPool]: On list_mydb: Close
[0m15:31:29.108949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:31:29.113008 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.113228 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:31:29.113404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:29.126561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.126845 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.127070 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:31:29.136612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:31:29.137659 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:31:29.138466 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:31:29.142146 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.142401 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.142588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:29.154724 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.155052 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.155357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:29.179557 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:31:29.180830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b108d0>]}
[0m15:31:29.181151 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:29.181992 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.182193 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.183478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.183744 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.183956 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.184141 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.184889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.185112 [debug] [MainThread]: On master: Close
[0m15:31:29.185574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:29.185859 [info ] [MainThread]: 
[0m15:31:29.189024 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:31:29.189313 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:31:29.189553 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:31:29.189776 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:31:29.190088 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:31:29.190494 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:31:29.190890 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:31:29.191257 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:31:29.191859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:31:29.192360 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:31:29.192827 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:31:29.193257 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:31:29.193487 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:31:29.193710 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:31:29.193924 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:31:29.194134 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:31:29.196153 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:31:29.197932 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.199669 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:31:29.201396 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:31:29.202160 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:31:29.194289 => 15:31:29.202039
[0m15:31:29.202518 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:31:29.202780 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:31:29.198119 => 15:31:29.202674
[0m15:31:29.215665 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:31:29.196350 => 15:31:29.215499
[0m15:31:29.215885 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:31:29.199843 => 15:31:29.215801
[0m15:31:29.226601 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:31:29.226925 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:31:29.227100 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:31:29.227263 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:31:29.230198 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:31:29.232432 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.234469 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:31:29.234821 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.235150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.235339 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:31:29.235539 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:31:29.235694 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.235865 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.236041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.236203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:29.236399 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:31:29.236598 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:31:29.236952 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:29.237119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:29.251005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.251518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.251819 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.252186 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.252379 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.252568 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.253696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.253972 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.254275 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.254487 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.254709 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.254952 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.256366 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.256958 [debug] [Thread-4 (]: On model.maker_warehouse.users: ROLLBACK
[0m15:31:29.258565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.259111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:31:29.232586 => 15:31:29.258990
[0m15:31:29.259353 [debug] [Thread-1 (]: On model.maker_warehouse.genres: ROLLBACK
[0m15:31:29.259597 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:31:29.262911 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:31:29.202957 => 15:31:29.262742
[0m15:31:29.263207 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:31:29.267741 [debug] [Thread-1 (]: Database Error in model genres (models/facts/genres.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:29.269372 [debug] [Thread-4 (]: Database Error in model users (models/facts/users.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:29.269757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be090>]}
[0m15:31:29.270046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a290>]}
[0m15:31:29.270465 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model dbt_warehouse.genres ..................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271291 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model dbt_warehouse.users ...................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271703 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:31:29.271923 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:31:29.721352 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.731687 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.732037 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:31:29.733853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.736048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.736292 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:31:29.737543 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.748687 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.748981 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.749146 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.761118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.764048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.764255 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:31:29.771492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.772478 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:31:29.227461 => 15:31:29.772385
[0m15:31:29.772676 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:31:29.773077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32510>]}
[0m15:31:29.773382 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.58s]
[0m15:31:29.773720 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:31:29.788430 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:31:29.790356 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.790586 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:31:29.792618 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.794479 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.794686 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:31:29.795750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.797056 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.797246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.797408 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.804207 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.805740 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.805931 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:31:29.840859 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.843773 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:31:29.230361 => 15:31:29.843473
[0m15:31:29.844356 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:31:29.845384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c44290>]}
[0m15:31:29.845875 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:31:29.846263 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:31:29.846867 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.847092 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:31:29.847407 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:31:29.847692 [info ] [Thread-4 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:31:29.848294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:31:29.848698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:31:29.848969 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.849191 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:31:29.851346 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.853243 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.854028 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:31:29.849329 => 15:31:29.853872
[0m15:31:29.854276 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:31:29.851674 => 15:31:29.854155
[0m15:31:29.854540 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.854721 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:31:29.857271 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860061 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.860670 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860864 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:31:29.861031 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.861197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.861355 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:31:29.861593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:29.870657 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.870921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.871171 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.871385 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.871583 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.871803 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.998844 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.999902 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:30.006224 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.008976 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.009228 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:31:30.009421 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:31:30.011869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.012060 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.013740 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.015142 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.015330 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:31:30.015518 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:31:30.016387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.016577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.017818 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019007 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.019200 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.019373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.019538 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019701 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.024619 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.025921 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.026093 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:31:30.026271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.027466 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.027648 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:31:30.029642 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.030399 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:31:29.857447 => 15:31:30.030303
[0m15:31:30.030599 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:31:30.030978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e750>]}
[0m15:31:30.031149 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.031433 [info ] [Thread-4 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.18s]
[0m15:31:30.032181 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:31:29.854854 => 15:31:30.032094
[0m15:31:30.032479 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:31:30.032679 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:31:30.033147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9bdd0>]}
[0m15:31:30.033452 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:31:30.033827 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:30.034748 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.034942 [debug] [MainThread]: On master: BEGIN
[0m15:31:30.035081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:30.042904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:30.043163 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043305 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.043428 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.044142 [debug] [MainThread]: On master: Close
[0m15:31:30.044484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:30.044628 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:31:30.044751 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:31:30.044867 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:31:30.044978 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:31:30.045135 [info ] [MainThread]: 
[0m15:31:30.045328 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:31:30.045906 [debug] [MainThread]: Command end result
[0m15:31:30.048886 [info ] [MainThread]: 
[0m15:31:30.049126 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:31:30.049309 [info ] [MainThread]: 
[0m15:31:30.049564 [error] [MainThread]: [33mDatabase Error in model genres (models/facts/genres.sql)[0m
[0m15:31:30.049815 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.050006 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.050181 [error] [MainThread]:            ^
[0m15:31:30.050349 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:30.050521 [info ] [MainThread]: 
[0m15:31:30.050699 [error] [MainThread]: [33mDatabase Error in model users (models/facts/users.sql)[0m
[0m15:31:30.050865 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.051025 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.051184 [error] [MainThread]:            ^
[0m15:31:30.051343 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:30.051513 [info ] [MainThread]: 
[0m15:31:30.051706 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m15:31:30.052085 [debug] [MainThread]: Command `dbt run` failed at 15:31:30.052027 after 1.18 seconds
[0m15:31:30.052303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106360550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bb210>]}
[0m15:31:30.052492 [debug] [MainThread]: Flushing usage events
[0m15:32:34.691504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fbf90>]}


============================== 15:32:34.695471 | 7fc677d9-cb84-4527-89a1-a072a9ebb691 ==============================
[0m15:32:34.695471 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:32:34.695844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:32:34.738832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.745770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.746147 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:32:34.756388 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:32:34.776472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:32:34.776892 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/users.sql
[0m15:32:34.777081 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/genres.sql
[0m15:32:34.788833 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:32:34.796071 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:32:34.801672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f76150>]}
[0m15:32:34.822815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b890>]}
[0m15:32:34.823093 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:32:34.823307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cecfd0>]}
[0m15:32:34.824144 [info ] [MainThread]: 
[0m15:32:34.824585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:34.825242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:32:34.830168 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:32:34.830341 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:32:34.830487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:34.913057 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:32:34.914152 [debug] [ThreadPool]: On list_mydb: Close
[0m15:32:34.915369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:32:34.919467 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.919709 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:32:34.919901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:34.932980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.933283 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.933512 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:32:34.944612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:32:34.945802 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:32:34.946797 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:32:34.951199 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.951527 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.951750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:34.963587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.963938 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.964264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:34.988580 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:32:34.990177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c58dd0>]}
[0m15:32:34.990583 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:34.991752 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.992070 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.993851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.994151 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.994392 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.994625 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.995552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:34.995828 [debug] [MainThread]: On master: Close
[0m15:32:34.996430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:34.996750 [info ] [MainThread]: 
[0m15:32:35.000411 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:32:35.000780 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:32:35.001069 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:32:35.001318 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:32:35.001706 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:32:35.002145 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:32:35.002670 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:32:35.003089 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:32:35.003840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:32:35.004391 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:32:35.004909 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:32:35.005428 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:32:35.005824 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:32:35.006143 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:32:35.006424 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:32:35.006714 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:32:35.009401 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:32:35.011474 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.013349 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:32:35.015246 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:32:35.016037 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:32:35.006919 => 15:32:35.015894
[0m15:32:35.016433 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:32:35.016710 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:32:35.009722 => 15:32:35.016597
[0m15:32:35.016948 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:32:35.011694 => 15:32:35.016847
[0m15:32:35.024378 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:32:35.013570 => 15:32:35.024119
[0m15:32:35.041517 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:32:35.041793 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:32:35.041984 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:32:35.042161 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:32:35.045276 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.047498 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:32:35.047695 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.049711 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:32:35.050010 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:32:35.050206 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.050453 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.050628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.050828 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:32:35.050983 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.051141 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:32:35.051382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:32:35.051549 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:32:35.051710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:32:35.051934 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:32:35.068826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.069210 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.069439 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.069830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.070027 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.070270 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.071609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.071838 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.072186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.072404 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.072633 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.072880 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.333866 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:32:35.345117 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.345742 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:32:35.347263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.357407 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.357696 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.357872 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.368739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.371720 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.371964 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:32:35.373098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.373909 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:32:35.017100 => 15:32:35.373816
[0m15:32:35.374100 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:32:35.374494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b950>]}
[0m15:32:35.374810 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:32:35.375135 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:32:35.526460 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:35.529011 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.529261 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:32:35.532983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.534850 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.535076 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:32:35.536234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.539052 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.539356 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.539563 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.557658 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.559241 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.559495 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:32:35.565851 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.566840 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:32:35.045461 => 15:32:35.566741
[0m15:32:35.567044 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:32:35.567481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e3ed0>]}
[0m15:32:35.567913 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m15:32:35.568316 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:32:35.698965 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:32:35.705632 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.706303 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:32:35.712590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.715794 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.716045 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.716215 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.729353 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.733486 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.733775 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:32:35.734731 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.735609 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:32:35.047830 => 15:32:35.735513
[0m15:32:35.735808 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:32:35.736207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702c490>]}
[0m15:32:35.736579 [info ] [Thread-4 (]: 4 of 6 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.73s]
[0m15:32:35.737237 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:32:35.858880 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:32:35.865380 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.865703 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:32:35.866868 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.868577 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.868769 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:32:35.869721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.870946 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.871122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.871278 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.879637 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.883400 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.884735 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:32:35.928267 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.930685 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:32:35.042366 => 15:32:35.930424
[0m15:32:35.931238 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:32:35.932295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8f90>]}
[0m15:32:35.933270 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.93s]
[0m15:32:35.934456 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:32:35.935762 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.936324 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:32:35.936859 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:32:35.937188 [info ] [Thread-3 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:32:35.937714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:32:35.938073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_views)
[0m15:32:35.938285 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.938462 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:32:35.940271 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.942574 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.943359 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:32:35.938585 => 15:32:35.943212
[0m15:32:35.943599 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.946189 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.946677 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:32:35.940619 => 15:32:35.946516
[0m15:32:35.946875 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:32:35.947077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.949222 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.949404 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:32:35.949642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.949966 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.950144 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:32:35.950298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:35.961350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961862 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.962077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.962404 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:35.962675 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:36.115793 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.116955 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.122016 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.123517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.123705 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:32:36.123877 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:32:36.124962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.125134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.126486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.127714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.127898 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:32:36.128068 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:32:36.128916 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.130158 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130328 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.130486 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.132064 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.132332 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.132506 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.134387 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.134678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.136512 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.137793 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.137994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:32:36.138184 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:32:36.143103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.143336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.144195 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:32:35.943730 => 15:32:36.144082
[0m15:32:36.144850 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:32:35.947219 => 15:32:36.144767
[0m15:32:36.145048 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:32:36.145234 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:32:36.145685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033bd0>]}
[0m15:32:36.146588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033d10>]}
[0m15:32:36.146079 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.147545 [info ] [Thread-3 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.148548 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:36.148901 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:32:36.150278 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.150511 [debug] [MainThread]: On master: BEGIN
[0m15:32:36.150660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:36.162057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:36.162385 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.162602 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.162772 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.163505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.163667 [debug] [MainThread]: On master: Close
[0m15:32:36.164016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:36.164155 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:32:36.164278 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:32:36.164396 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:32:36.164509 [debug] [MainThread]: Connection 'model.maker_warehouse.users' was properly closed.
[0m15:32:36.164692 [info ] [MainThread]: 
[0m15:32:36.164907 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m15:32:36.165681 [debug] [MainThread]: Command end result
[0m15:32:36.169456 [info ] [MainThread]: 
[0m15:32:36.169808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:36.170325 [info ] [MainThread]: 
[0m15:32:36.170696 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:32:36.171677 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:36.171595 after 1.50 seconds
[0m15:32:36.172136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023b8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501dd0>]}
[0m15:32:36.172431 [debug] [MainThread]: Flushing usage events
[0m15:41:17.578055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ddf10>]}


============================== 15:41:17.581613 | 9754a8f3-b6d6-4cd2-83e6-8de2f248630b ==============================
[0m15:41:17.581613 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:41:17.581996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:17.628243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f6010>]}
[0m15:41:17.635425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904390>]}
[0m15:41:17.635876 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:41:17.647037 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:41:17.668300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:41:17.668712 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:41:17.668875 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m15:41:17.680602 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:41:17.687944 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m15:41:17.693683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108986150>]}
[0m15:41:17.715010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089903d0>]}
[0m15:41:17.715300 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:41:17.715514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106689090>]}
[0m15:41:17.716460 [info ] [MainThread]: 
[0m15:41:17.716897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:17.717580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:41:17.723196 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:41:17.723439 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:41:17.723582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:17.798573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:41:17.799547 [debug] [ThreadPool]: On list_mydb: Close
[0m15:41:17.800627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:41:17.804256 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.804461 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:41:17.804633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:17.820288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.820574 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.820806 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:41:17.831777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:41:17.832834 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:41:17.833664 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:41:17.837620 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.837881 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.838068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:17.849850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.850181 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.850485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:17.873235 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:41:17.874648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089910d0>]}
[0m15:41:17.875006 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:17.876005 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.876282 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.877685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.877914 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.878120 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.878319 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.879091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:17.879329 [debug] [MainThread]: On master: Close
[0m15:41:17.879835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:17.880143 [info ] [MainThread]: 
[0m15:41:17.883573 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:41:17.883874 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:41:17.884160 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:41:17.884391 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:41:17.884705 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:41:17.885128 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:41:17.885571 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:41:17.885949 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:41:17.886475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:41:17.886939 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:41:17.887377 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:41:17.887800 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:41:17.888025 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:41:17.888237 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:41:17.888440 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:41:17.888641 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:41:17.890629 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:41:17.892384 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.893989 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:41:17.895551 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:41:17.896877 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:41:17.888787 => 15:41:17.896748
[0m15:41:17.897134 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:41:17.892568 => 15:41:17.897018
[0m15:41:17.897361 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:41:17.894152 => 15:41:17.897262
[0m15:41:17.897600 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:41:17.890822 => 15:41:17.897496
[0m15:41:17.897790 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:41:17.897989 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:41:17.898183 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:41:17.898381 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:41:17.921312 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:41:17.924284 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:41:17.926346 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:41:17.928401 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.929019 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.929252 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.929426 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:41:17.929588 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.929743 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.929910 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:41:17.930074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:17.930234 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:41:17.930387 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:41:17.930616 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:17.930920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:17.931100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:17.940823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.941164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.941388 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.942399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.942600 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.942783 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.943147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.943375 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.943581 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.944507 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.944702 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.944888 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:18.210875 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:41:18.219412 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.219761 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:41:18.221410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.223033 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.223239 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:41:18.224515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.236892 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.237272 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.237464 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.251345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.255030 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.255296 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:41:18.264730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.266145 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:41:17.898542 => 15:41:18.266026
[0m15:41:18.266403 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:41:18.266846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb4750>]}
[0m15:41:18.267396 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.38s]
[0m15:41:18.267788 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:41:18.393092 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.398671 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.399381 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:41:18.403938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.408115 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.408559 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:41:18.409669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.411322 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.411550 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.411729 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.425671 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.429319 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.429813 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:41:18.438811 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.440702 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:41:17.921482 => 15:41:18.440453
[0m15:41:18.441189 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:41:18.442101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c1850>]}
[0m15:41:18.442637 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:41:18.443002 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:41:18.477989 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:18.482535 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.482878 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:41:18.484737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.486543 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.486779 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:41:18.488313 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.489740 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.489955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.490119 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.500473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.502099 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.502293 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:41:18.514291 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.516786 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:41:17.924463 => 15:41:18.516496
[0m15:41:18.517288 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:41:18.518194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089919d0>]}
[0m15:41:18.518861 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.63s]
[0m15:41:18.519348 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:41:18.571529 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:41:18.573197 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.573412 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:41:18.574916 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.577556 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.577805 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:41:18.579079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.580463 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.580666 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.580829 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.591038 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.592458 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.592633 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:41:18.636115 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.638353 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:41:17.926495 => 15:41:18.638097
[0m15:41:18.638843 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:41:18.639865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830f550>]}
[0m15:41:18.640593 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.75s]
[0m15:41:18.641454 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:41:18.642631 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:41:18.643144 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.643694 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:41:18.644142 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:41:18.644815 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:41:18.645441 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:41:18.645787 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:41:18.646076 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:41:18.646541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:41:18.646854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:41:18.647144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:41:18.647439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:41:18.647768 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:41:18.647985 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.648153 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:41:18.648322 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:41:18.650939 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.652427 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.653912 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.655222 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.655833 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:41:18.648448 => 15:41:18.655722
[0m15:41:18.656032 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:41:18.658241 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.658551 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:41:18.652590 => 15:41:18.658464
[0m15:41:18.658717 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:41:18.660709 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.660961 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:41:18.651166 => 15:41:18.660857
[0m15:41:18.661201 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:41:18.654074 => 15:41:18.661120
[0m15:41:18.661383 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.661602 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.661799 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.661962 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:41:18.664146 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.664422 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:41:18.664614 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:41:18.667086 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.667420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:18.667634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:18.667824 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.668249 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.668421 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:41:18.668615 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:41:18.668795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:18.669003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:18.678334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.678667 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.678864 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.681734 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682541 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.682754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.683182 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.683373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.683547 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:41:18.683774 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    genres,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:41:18.686839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "movie_id" is ambiguous
LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                            ^

[0m15:41:18.687100 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: ROLLBACK
[0m15:41:18.688362 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:41:18.656159 => 15:41:18.688224
[0m15:41:18.688594 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:41:18.693992 [debug] [Thread-1 (]: Database Error in model sum_genre_views (models/facts/sum_genre_views.sql)
  column reference "movie_id" is ambiguous
  LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                              ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:18.694320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911a850>]}
[0m15:41:18.694634 [error] [Thread-1 (]: 5 of 8 ERROR creating sql table model dbt_warehouse.sum_genre_views ............ [[31mERROR[0m in 0.05s]
[0m15:41:18.694928 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:41:18.901672 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903358 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.903572 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903773 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:41:18.905275 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.905563 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:41:18.906639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908167 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.908356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908570 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:41:18.910832 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.911078 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:41:18.911898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.913100 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913279 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.913436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913616 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.914855 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.915057 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.915224 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.917447 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.918875 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.919061 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.919223 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:41:18.920329 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.920549 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:41:18.926917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.927811 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:41:18.658826 => 15:41:18.927718
[0m15:41:18.927977 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.928177 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:41:18.928875 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:41:18.662083 => 15:41:18.928787
[0m15:41:18.929091 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:41:18.929437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d57d0>]}
[0m15:41:18.929794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108794390>]}
[0m15:41:18.930174 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.930930 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.931741 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:41:18.932183 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:19.326668 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:19.331472 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.332128 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:41:19.333873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:19.336836 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.337351 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.337793 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.348878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.352246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.352517 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:41:19.353314 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:19.354097 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:41:18.664745 => 15:41:19.354003
[0m15:41:19.354287 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:41:19.354672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd5350>]}
[0m15:41:19.354984 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 0.71s]
[0m15:41:19.355310 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:41:19.356323 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.356552 [debug] [MainThread]: On master: BEGIN
[0m15:41:19.356700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:19.366218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:19.366513 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.366673 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.366815 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.367395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.367581 [debug] [MainThread]: On master: Close
[0m15:41:19.367924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:19.368071 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:41:19.368195 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:41:19.368311 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:41:19.368434 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:41:19.368604 [info ] [MainThread]: 
[0m15:41:19.368805 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m15:41:19.369523 [debug] [MainThread]: Command end result
[0m15:41:19.372544 [info ] [MainThread]: 
[0m15:41:19.372791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:19.373021 [info ] [MainThread]: 
[0m15:41:19.373218 [error] [MainThread]: [33mDatabase Error in model sum_genre_views (models/facts/sum_genre_views.sql)[0m
[0m15:41:19.373405 [error] [MainThread]:   column reference "movie_id" is ambiguous
[0m15:41:19.373578 [error] [MainThread]:   LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
[0m15:41:19.373743 [error] [MainThread]:                               ^
[0m15:41:19.373907 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:19.374082 [info ] [MainThread]: 
[0m15:41:19.374274 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:41:19.374589 [debug] [MainThread]: Command `dbt run` failed at 15:41:19.374542 after 1.81 seconds
[0m15:41:19.374780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa1e90>]}
[0m15:41:19.374951 [debug] [MainThread]: Flushing usage events
[0m15:43:10.788336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d05290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfbf90>]}


============================== 15:43:10.791988 | ce23b147-5871-4b2e-a756-99fa3ff46ded ==============================
[0m15:43:10.791988 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:43:10.792396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:10.837996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd3490>]}
[0m15:43:10.845245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfad10>]}
[0m15:43:10.845663 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:43:10.857439 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:43:10.878886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:10.879389 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:43:10.891283 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:43:10.920541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa950>]}
[0m15:43:10.923934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950b190>]}
[0m15:43:10.924164 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:43:10.924380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9090>]}
[0m15:43:10.925263 [info ] [MainThread]: 
[0m15:43:10.925666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:10.926303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:43:10.931954 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:43:10.932384 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:43:10.932539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:11.011753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:43:11.012909 [debug] [ThreadPool]: On list_mydb: Close
[0m15:43:11.014128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:43:11.018129 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.018363 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:43:11.018547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:11.037011 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.037260 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.037504 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:43:11.048099 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:43:11.049284 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:43:11.050253 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:43:11.054707 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.054976 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.055180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:11.067926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.068285 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.068654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:11.091964 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:43:11.093371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821bf90>]}
[0m15:43:11.093723 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:11.094717 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.094933 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.096467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.096711 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.096927 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.097128 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.097957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.098216 [debug] [MainThread]: On master: Close
[0m15:43:11.098745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:11.099040 [info ] [MainThread]: 
[0m15:43:11.102675 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:43:11.102948 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:43:11.103201 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:43:11.103438 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:43:11.103726 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:43:11.104120 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:43:11.104535 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:43:11.104925 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:43:11.105461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:43:11.105899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:43:11.106323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:43:11.106725 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:43:11.106984 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:43:11.107221 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:43:11.107451 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:43:11.107674 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:43:11.109953 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:43:11.111930 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.113700 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:43:11.115523 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:43:11.116496 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:43:11.107851 => 15:43:11.116318
[0m15:43:11.116856 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:43:11.117212 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:43:11.113903 => 15:43:11.117089
[0m15:43:11.117527 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:43:11.112147 => 15:43:11.117372
[0m15:43:11.123475 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:43:11.110168 => 15:43:11.123363
[0m15:43:11.142198 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:43:11.142532 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:43:11.142748 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:43:11.142935 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:43:11.145280 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:43:11.147960 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:43:11.150286 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.150739 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.150975 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.151137 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:43:11.151294 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.151442 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.151597 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:43:11.151750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.151905 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:43:11.152055 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:43:11.152195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:43:11.152446 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:43:11.152613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:43:11.161878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.162182 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.162379 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.164107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.164386 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.164589 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.166335 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.166650 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.166869 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.167165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.167383 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.167580 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.414405 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:43:11.423139 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.423721 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:43:11.425558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.429391 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.429685 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:43:11.430785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.448126 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.448454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.448639 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.465476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.469487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.469753 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:43:11.476117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.477086 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:43:11.117711 => 15:43:11.476990
[0m15:43:11.477341 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:43:11.477771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c2d10>]}
[0m15:43:11.478179 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:43:11.478534 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:43:11.607414 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:11.611676 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.612198 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:43:11.613772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.617721 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.618210 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:43:11.619463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.620837 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.621106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.621327 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.632869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.636409 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.636702 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:43:11.654578 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.656826 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:43:11.145602 => 15:43:11.656576
[0m15:43:11.657308 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:43:11.658264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dde150>]}
[0m15:43:11.659011 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:43:11.660019 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:43:11.689946 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:11.691695 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.691892 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:43:11.724689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.729637 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.730220 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:43:11.731404 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.733828 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.734052 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.734230 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.740414 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.741833 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.742016 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:43:11.753152 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.755153 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:43:11.143061 => 15:43:11.754916
[0m15:43:11.755623 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:43:11.756208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.756541 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.65s]
[0m15:43:11.756865 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:43:11.804099 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:43:11.808757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.809288 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:43:11.810623 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.813529 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.813822 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:43:11.814661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.815954 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.816139 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.816292 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.855367 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.861314 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.861927 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:43:11.894270 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.896364 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:43:11.148182 => 15:43:11.896105
[0m15:43:11.896832 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:43:11.897752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.898791 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.79s]
[0m15:43:11.900003 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:43:11.901390 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:43:11.901936 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.902348 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:43:11.902776 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:43:11.903383 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:43:11.904083 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:43:11.904446 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:43:11.904736 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:43:11.905223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:43:11.905576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:43:11.905885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:43:11.906168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:43:11.906369 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:43:11.906560 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.906721 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:43:11.906882 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:43:11.908874 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.910292 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.911904 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.913327 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.914672 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:43:11.909039 => 15:43:11.914531
[0m15:43:11.914954 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:43:11.912083 => 15:43:11.914824
[0m15:43:11.915187 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:43:11.906996 => 15:43:11.915096
[0m15:43:11.915355 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.915534 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:43:11.910465 => 15:43:11.915455
[0m15:43:11.915725 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:43:11.915889 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:43:11.918572 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.918778 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:43:11.920911 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.922943 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.925141 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.925499 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.925664 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.925912 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:43:11.926112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.926274 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:43:11.926465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:43:11.926646 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.926812 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:43:11.926984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:43:11.927241 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:43:11.927404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.927632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:43:11.938388 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.938705 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.938901 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.939819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940118 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.940310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940491 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940699 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:43:11.940894 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.941057 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.941284 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.941510 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:43:12.294264 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.298883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.299459 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:43:12.301447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.301947 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.306627 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.308427 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.308678 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:43:12.308945 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:43:12.310281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.311958 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.312159 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.312397 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:43:12.314039 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.314461 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.314657 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.316543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.317966 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.318227 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.318408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.318581 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.319882 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.320272 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:43:12.321519 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.322785 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.323034 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:43:12.326708 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.327633 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:43:11.916136 => 15:43:12.327540
[0m15:43:12.327813 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.328021 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:43:12.328764 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:43:11.923130 => 15:43:12.328671
[0m15:43:12.329298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c0990>]}
[0m15:43:12.329501 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:43:12.329907 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.330731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109590b10>]}
[0m15:43:12.331064 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:12.331390 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.332181 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:43:12.671796 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m15:43:12.677674 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.678323 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m15:43:12.679996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.682909 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.683393 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.683833 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.690378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.693001 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.693296 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m15:43:12.694154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.695010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:43:11.921049 => 15:43:12.694898
[0m15:43:12.695214 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:43:12.695667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109631850>]}
[0m15:43:12.696045 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.79s]
[0m15:43:12.696662 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:43:12.898803 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:12.904599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.905125 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m15:43:12.906687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.910477 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.910796 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:43:12.911806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.913217 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.913418 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.913593 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.949968 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.955393 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.955937 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:43:12.966609 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.968893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:43:11.918911 => 15:43:12.968574
[0m15:43:12.969464 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:43:12.970407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096726d0>]}
[0m15:43:12.971159 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.06s]
[0m15:43:12.971757 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:43:12.972884 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.973137 [debug] [MainThread]: On master: BEGIN
[0m15:43:12.973305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:12.983438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:12.983738 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.983892 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.984032 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.984668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.984859 [debug] [MainThread]: On master: Close
[0m15:43:12.985220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:12.985365 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:43:12.985493 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:43:12.985616 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:43:12.985732 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:43:12.985909 [info ] [MainThread]: 
[0m15:43:12.986117 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m15:43:12.987325 [debug] [MainThread]: Command end result
[0m15:43:12.991959 [info ] [MainThread]: 
[0m15:43:12.992239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:12.992435 [info ] [MainThread]: 
[0m15:43:12.992701 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:43:12.993141 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:12.993088 after 2.22 seconds
[0m15:43:12.993373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bca7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d11e90>]}
[0m15:43:12.993567 [debug] [MainThread]: Flushing usage events
[0m17:03:01.478122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f05b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bfed0>]}


============================== 17:03:01.481723 | 13e8596e-82f1-42fb-8131-07224a8663c1 ==============================
[0m17:03:01.481723 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:03:01.482072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:03:01.664394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc38d0>]}
[0m17:03:01.672704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f061d0>]}
[0m17:03:01.673185 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:03:01.699859 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:03:01.720972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:03:01.721310 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m17:03:01.732228 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m17:03:01.739850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m17:03:01.763619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8d010>]}
[0m17:03:01.767318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ee350>]}
[0m17:03:01.767538 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:03:01.767757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103934e90>]}
[0m17:03:01.768772 [info ] [MainThread]: 
[0m17:03:01.769306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:01.770006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:03:01.775748 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:03:01.775981 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:03:01.776116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:01.871311 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:03:01.872393 [debug] [ThreadPool]: On list_mydb: Close
[0m17:03:01.873628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m17:03:01.877686 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.877920 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m17:03:01.878109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:01.888930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.889206 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.889417 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m17:03:01.910508 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:03:01.911747 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m17:03:01.912612 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m17:03:01.917152 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.917429 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.917634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:01.933229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.933778 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.934180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:01.968822 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m17:03:01.969839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0d750>]}
[0m17:03:01.970080 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:01.970689 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.970831 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.971717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.971919 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972079 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.972210 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:01.972838 [debug] [MainThread]: On master: Close
[0m17:03:01.973174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:01.973372 [info ] [MainThread]: 
[0m17:03:01.975970 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m17:03:01.976170 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m17:03:01.976354 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m17:03:01.976503 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m17:03:01.976739 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m17:03:01.977047 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m17:03:01.977350 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m17:03:01.977616 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m17:03:01.978007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m17:03:01.978340 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m17:03:01.978662 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m17:03:01.978976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m17:03:01.979138 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m17:03:01.979301 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m17:03:01.979454 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m17:03:01.979604 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m17:03:01.981129 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m17:03:01.982543 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m17:03:01.983855 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m17:03:01.985705 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m17:03:01.986392 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 17:03:01.979721 => 17:03:01.986284
[0m17:03:01.986607 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m17:03:02.004956 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 17:03:01.982701 => 17:03:02.004754
[0m17:03:02.005267 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 17:03:01.981265 => 17:03:02.005132
[0m17:03:02.010021 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m17:03:02.010307 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m17:03:02.010568 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 17:03:01.983993 => 17:03:02.010438
[0m17:03:02.010788 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m17:03:02.013416 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m17:03:02.013658 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m17:03:02.013861 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.024463 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m17:03:02.027021 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m17:03:02.027233 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m17:03:02.027486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.027728 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.027917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.028113 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m17:03:02.028297 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.028483 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m17:03:02.028735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:03:02.028921 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m17:03:02.029099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:02.029383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:03:02.041223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041798 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.042013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042420 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.042652 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.042880 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.043087 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.043289 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m17:03:02.043535 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.043752 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.057810 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:02.061609 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.061840 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m17:03:02.067326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.075994 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.076293 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.076528 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.089439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.092295 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.092538 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m17:03:02.093695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:02.094575 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 17:03:02.013999 => 17:03:02.094476
[0m17:03:02.094802 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m17:03:02.095293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2f250>]}
[0m17:03:02.095991 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m17:03:02.096610 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m17:03:02.096996 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m17:03:02.097335 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m17:03:02.098197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m17:03:02.098506 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m17:03:02.100681 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m17:03:02.101230 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 17:03:02.098712 => 17:03:02.101078
[0m17:03:02.101499 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m17:03:02.104747 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m17:03:02.105897 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.106376 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m17:03:02.106597 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:02.122935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.124049 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.125059 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.826083 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:02.830693 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.831265 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m17:03:02.833555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.838671 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.839014 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m17:03:02.841394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.846268 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.846571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.846744 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.883051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.887114 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.887743 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m17:03:02.912283 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.913378 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 17:03:01.986861 => 17:03:02.913274
[0m17:03:02.913776 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m17:03:02.914440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf950>]}
[0m17:03:02.914865 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.94s]
[0m17:03:02.915274 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m17:03:02.927918 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m17:03:02.929989 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.930224 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m17:03:02.932043 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.933955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.934222 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m17:03:02.935710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.937592 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.938151 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.938389 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.959197 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.960947 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.961189 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m17:03:02.981206 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.982128 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 17:03:02.024781 => 17:03:02.982028
[0m17:03:02.982323 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m17:03:02.982706 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d710>]}
[0m17:03:02.983002 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.00s]
[0m17:03:02.983329 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m17:03:03.087916 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m17:03:03.094457 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.094980 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m17:03:03.096726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.100076 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.100504 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m17:03:03.101588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.102975 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.103174 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.103341 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.125793 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.129852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.130214 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m17:03:03.141344 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:03.143190 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.143423 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m17:03:03.145170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.146882 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.147083 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m17:03:03.148218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.149563 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.149758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.149914 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.151713 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.153164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.153350 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m17:03:03.184032 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.187306 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 17:03:02.101633 => 17:03:03.186944
[0m17:03:03.187991 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m17:03:03.189286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b350>]}
[0m17:03:03.190177 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 1.09s]
[0m17:03:03.190886 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m17:03:03.263265 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.267258 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 17:03:02.011005 => 17:03:03.266880
[0m17:03:03.267903 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m17:03:03.269051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554dfd0>]}
[0m17:03:03.269845 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 1.29s]
[0m17:03:03.270920 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m17:03:03.271956 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m17:03:03.272190 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.272419 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m17:03:03.272587 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m17:03:03.272860 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m17:03:03.273178 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m17:03:03.273485 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m17:03:03.274264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m17:03:03.273831 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m17:03:03.274763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m17:03:03.275113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m17:03:03.275328 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m17:03:03.275632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m17:03:03.275803 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.275959 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m17:03:03.277967 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.278154 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m17:03:03.279460 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.280802 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.282167 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.282523 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 17:03:03.276075 => 17:03:03.282428
[0m17:03:03.282781 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 17:03:03.278274 => 17:03:03.282688
[0m17:03:03.283033 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 17:03:03.279587 => 17:03:03.282938
[0m17:03:03.283190 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m17:03:03.283369 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 17:03:03.280989 => 17:03:03.283292
[0m17:03:03.283540 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.283718 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m17:03:03.286716 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.286924 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m17:03:03.289076 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.291504 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.294127 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.294553 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.294982 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.295267 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.295547 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m17:03:03.295768 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.295980 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m17:03:03.296193 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m17:03:03.296396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:03.296585 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m17:03:03.296754 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:03.296926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:03.297202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:03.312596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.312915 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.313116 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m17:03:03.315621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316077 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316303 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.316526 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.316791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316972 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m17:03:03.317203 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.317411 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.317688 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.649511 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.650091 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.654408 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.658668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.659264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m17:03:03.659740 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m17:03:03.661417 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.661867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.665798 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.669538 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.670231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m17:03:03.670729 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m17:03:03.672339 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.672806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.676603 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.679951 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.680506 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.680961 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.681406 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.681838 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.693538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.694070 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.697370 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.700480 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.700964 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m17:03:03.701436 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m17:03:03.707257 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.708170 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 17:03:03.287052 => 17:03:03.708075
[0m17:03:03.708513 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.709049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m17:03:03.710787 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 17:03:03.289286 => 17:03:03.710558
[0m17:03:03.711720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3c410>]}
[0m17:03:03.712137 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m17:03:03.712855 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.714068 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.714991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc2450>]}
[0m17:03:03.716002 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.716608 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m17:03:03.943691 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:03.949599 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.950106 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m17:03:03.951353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.954596 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.954844 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m17:03:03.955739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.957157 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.957350 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.957517 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.981833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.985327 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.986066 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m17:03:03.990747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.991703 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 17:03:03.283838 => 17:03:03.991607
[0m17:03:03.991903 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m17:03:03.992309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe90d0>]}
[0m17:03:03.992617 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.72s]
[0m17:03:03.992938 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m17:03:04.201642 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:04.205922 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.206523 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m17:03:04.208134 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.213669 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.213896 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m17:03:04.214620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.215798 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.215968 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.216119 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.234836 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.238823 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.239084 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m17:03:04.273614 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:04.277030 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 17:03:03.291763 => 17:03:04.276722
[0m17:03:04.277674 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m17:03:04.278776 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0c450>]}
[0m17:03:04.279636 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.00s]
[0m17:03:04.280502 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m17:03:04.282126 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.282387 [debug] [MainThread]: On master: BEGIN
[0m17:03:04.282534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:04.291381 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:04.291686 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.291849 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.291981 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.292501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.292649 [debug] [MainThread]: On master: Close
[0m17:03:04.292977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:04.293112 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m17:03:04.293232 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m17:03:04.293347 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m17:03:04.293455 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m17:03:04.293640 [info ] [MainThread]: 
[0m17:03:04.293852 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m17:03:04.294693 [debug] [MainThread]: Command end result
[0m17:03:04.297885 [info ] [MainThread]: 
[0m17:03:04.298117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:04.298314 [info ] [MainThread]: 
[0m17:03:04.298520 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:03:04.298949 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:04.298905 after 2.84 seconds
[0m17:03:04.299159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123fb90>]}
[0m17:03:04.299340 [debug] [MainThread]: Flushing usage events
[0m11:15:03.471248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad22d0>]}


============================== 11:15:03.475071 | 926b2733-f81c-47df-a15b-2830e6ac4788 ==============================
[0m11:15:03.475071 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:15:03.475419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:03.674734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1cd0>]}
[0m11:15:03.683076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac0a90>]}
[0m11:15:03.683505 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m11:15:03.714107 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:15:03.736295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:15:03.736651 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/schema.yml
[0m11:15:03.795597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7a6d0>]}
[0m11:15:03.799663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abaad0>]}
[0m11:15:03.799899 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:15:03.800122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687d090>]}
[0m11:15:03.801098 [info ] [MainThread]: 
[0m11:15:03.801496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:03.802161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m11:15:03.807060 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m11:15:03.807242 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m11:15:03.807387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:03.928371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:15:03.929705 [debug] [ThreadPool]: On list_mydb: Close
[0m11:15:03.931369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m11:15:03.936582 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m11:15:03.936870 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m11:15:03.937080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:03.955607 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:15:03.956060 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m11:15:03.956358 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m11:15:03.974442 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:15:03.975783 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m11:15:03.976763 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m11:15:03.981955 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:03.982269 [debug] [MainThread]: On master: BEGIN
[0m11:15:03.982491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:03.995644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:03.995951 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:03.996249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:04.025900 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m11:15:04.026841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae4bd0>]}
[0m11:15:04.027074 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:04.028519 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:04.028664 [debug] [MainThread]: On master: BEGIN
[0m11:15:04.030641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.030783 [debug] [MainThread]: On master: COMMIT
[0m11:15:04.030913 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:04.031039 [debug] [MainThread]: On master: COMMIT
[0m11:15:04.032077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:04.032259 [debug] [MainThread]: On master: Close
[0m11:15:04.032620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:04.032836 [info ] [MainThread]: 
[0m11:15:04.035791 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m11:15:04.036025 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m11:15:04.036199 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m11:15:04.036364 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m11:15:04.036620 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m11:15:04.036886 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m11:15:04.037478 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m11:15:04.037826 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m11:15:04.038327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m11:15:04.038707 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m11:15:04.039057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m11:15:04.039377 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m11:15:04.039561 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m11:15:04.039720 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m11:15:04.039874 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m11:15:04.040020 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m11:15:04.041679 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m11:15:04.043027 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m11:15:04.044231 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m11:15:04.045512 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m11:15:04.046746 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 11:15:04.043156 => 11:15:04.046606
[0m11:15:04.046999 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 11:15:04.044363 => 11:15:04.046895
[0m11:15:04.047192 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 11:15:04.040131 => 11:15:04.047108
[0m11:15:04.047411 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m11:15:04.047591 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 11:15:04.041816 => 11:15:04.047512
[0m11:15:04.047775 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m11:15:04.047976 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m11:15:04.065664 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m11:15:04.072495 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m11:15:04.075304 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m11:15:04.077841 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m11:15:04.089009 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m11:15:04.089743 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.090018 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m11:15:04.090208 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:04.090379 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:15:04.090545 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:04.090734 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:04.090938 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m11:15:04.091220 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m11:15:04.091389 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m11:15:04.091552 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:15:04.091710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:04.091909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:15:04.101573 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.101983 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.102223 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m11:15:04.103490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.103833 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:04.104047 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.104957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.105201 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:04.105399 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.106100 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.106393 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:04.106640 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.118687 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:15:04.122373 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.122635 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m11:15:04.124757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:04.127276 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.127533 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m11:15:04.128899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:04.138683 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m11:15:04.138960 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.139135 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m11:15:04.158577 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:04.163948 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.164379 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m11:15:04.182223 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:15:04.183281 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 11:15:04.078019 => 11:15:04.183137
[0m11:15:04.183496 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m11:15:04.183914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333790>]}
[0m11:15:04.184346 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:15:04.185190 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m11:15:04.185932 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m11:15:04.186537 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m11:15:04.187964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m11:15:04.188795 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m11:15:04.191861 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m11:15:04.193130 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 11:15:04.189115 => 11:15:04.192792
[0m11:15:04.193653 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m11:15:04.202544 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m11:15:04.206393 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:04.207096 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m11:15:04.207757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:15:04.230868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.231370 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:04.231599 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:05.074475 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m11:15:05.079568 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.080148 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m11:15:05.082084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.084112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.084425 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m11:15:05.086112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.089706 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m11:15:05.089961 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.090167 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m11:15:05.175135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.180645 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.181210 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m11:15:05.212205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.214586 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 11:15:04.075508 => 11:15:05.214308
[0m11:15:05.215178 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m11:15:05.216442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108571590>]}
[0m11:15:05.217251 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 1.18s]
[0m11:15:05.218136 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m11:15:05.224641 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m11:15:05.227967 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.228914 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m11:15:05.238347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.240419 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.240810 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m11:15:05.244214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.246370 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m11:15:05.246865 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.247135 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m11:15:05.308738 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.313429 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.313925 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m11:15:05.349674 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.351819 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 11:15:04.072783 => 11:15:05.351561
[0m11:15:05.352390 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m11:15:05.353857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7a8d0>]}
[0m11:15:05.354780 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.31s]
[0m11:15:05.355706 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m11:15:05.702205 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m11:15:05.708400 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.709058 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m11:15:05.715075 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.716784 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.716996 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m11:15:05.719696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.720990 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m11:15:05.721186 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.721348 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m11:15:05.801099 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.805560 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.806228 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m11:15:05.868754 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 2.0 seconds
[0m11:15:05.874394 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.874926 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m11:15:05.876609 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.881057 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.881305 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m11:15:05.882364 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.883669 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m11:15:05.883856 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.884017 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m11:15:05.902589 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.906911 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.907521 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m11:15:05.909074 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.909986 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 11:15:04.194221 => 11:15:05.909865
[0m11:15:05.910199 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m11:15:05.910706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093840d0>]}
[0m11:15:05.911129 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 1.72s]
[0m11:15:05.911492 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m11:15:06.210017 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.212643 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 11:15:04.048110 => 11:15:06.212379
[0m11:15:06.213251 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m11:15:06.214389 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109398850>]}
[0m11:15:06.215191 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 2.18s]
[0m11:15:06.216084 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m11:15:06.217902 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m11:15:06.218602 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.219208 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m11:15:06.219539 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m11:15:06.220038 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m11:15:06.220633 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m11:15:06.221036 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m11:15:06.221364 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m11:15:06.221893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m11:15:06.222332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m11:15:06.223058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m11:15:06.223521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m11:15:06.223789 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m11:15:06.223977 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.224178 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m11:15:06.224381 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m11:15:06.226706 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m11:15:06.228317 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.230222 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m11:15:06.231875 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m11:15:06.233002 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 11:15:06.228521 => 11:15:06.232841
[0m11:15:06.233338 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m11:15:06.233556 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 11:15:06.226901 => 11:15:06.233469
[0m11:15:06.236582 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m11:15:06.236986 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 11:15:06.230459 => 11:15:06.236860
[0m11:15:06.237213 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 11:15:06.224531 => 11:15:06.237100
[0m11:15:06.237440 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.237674 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m11:15:06.237850 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m11:15:06.240160 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.242485 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m11:15:06.242715 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.245131 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m11:15:06.245622 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m11:15:06.245906 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.246171 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:06.246530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:15:06.246809 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.246989 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m11:15:06.247184 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m11:15:06.247488 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m11:15:06.247744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:15:06.247922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:15:06.248149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:06.260859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.261198 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.261478 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.261679 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.261918 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m11:15:06.262222 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m11:15:06.264324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.264680 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.264894 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m11:15:06.265571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.265796 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:06.265985 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m11:15:06.565537 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m11:15:06.569810 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.570477 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m11:15:06.572653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.577062 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.577611 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m11:15:06.579174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.581345 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m11:15:06.581603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.581788 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m11:15:06.595752 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m11:15:06.599865 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.600126 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:06.600400 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m11:15:06.602703 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.603199 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m11:15:06.604140 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.606154 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.606385 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m11:15:06.608412 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.611022 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m11:15:06.611533 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.611800 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m11:15:06.616846 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:06.619058 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.619563 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m11:15:06.632244 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.633262 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 11:15:06.233689 => 11:15:06.633149
[0m11:15:06.633551 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m11:15:06.634003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c6590>]}
[0m11:15:06.634362 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.41s]
[0m11:15:06.634705 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m11:15:06.645239 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.646265 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 11:15:06.238006 => 11:15:06.646162
[0m11:15:06.646615 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m11:15:06.647258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae3dd0>]}
[0m11:15:06.647703 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.43s]
[0m11:15:06.648143 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.969264 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m11:15:06.971617 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.971883 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m11:15:06.975403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.977225 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.977467 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m11:15:06.979044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.980573 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m11:15:06.980758 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.980913 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m11:15:07.019929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.021336 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:07.021633 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m11:15:07.029323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:07.030188 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 11:15:06.242859 => 11:15:07.030096
[0m11:15:07.030382 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m11:15:07.030760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913af50>]}
[0m11:15:07.031069 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.81s]
[0m11:15:07.031503 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m11:15:07.276485 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m11:15:07.282118 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.282771 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m11:15:07.284313 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:07.288062 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.288336 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m11:15:07.289136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:07.290367 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m11:15:07.290535 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.290691 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m11:15:07.315075 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.320240 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.320989 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m11:15:07.380066 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:07.383876 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 11:15:06.240354 => 11:15:07.383442
[0m11:15:07.384693 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m11:15:07.385857 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c0b10>]}
[0m11:15:07.386676 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.16s]
[0m11:15:07.387600 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m11:15:07.389098 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:07.389338 [debug] [MainThread]: On master: BEGIN
[0m11:15:07.389485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:07.403157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:07.403651 [debug] [MainThread]: On master: COMMIT
[0m11:15:07.403864 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:07.404020 [debug] [MainThread]: On master: COMMIT
[0m11:15:07.404978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.405199 [debug] [MainThread]: On master: Close
[0m11:15:07.405638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:07.405822 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m11:15:07.405986 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m11:15:07.406128 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m11:15:07.406255 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m11:15:07.406450 [info ] [MainThread]: 
[0m11:15:07.406671 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m11:15:07.407588 [debug] [MainThread]: Command end result
[0m11:15:07.412159 [info ] [MainThread]: 
[0m11:15:07.412457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:07.412707 [info ] [MainThread]: 
[0m11:15:07.412968 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:15:07.413536 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:07.413467 after 3.96 seconds
[0m11:15:07.413799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195e90>]}
[0m11:15:07.413990 [debug] [MainThread]: Flushing usage events
[0m09:36:28.850075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d06f50>]}


============================== 09:36:28.853805 | c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6 ==============================
[0m09:36:28.853805 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:36:28.854151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:36:28.949678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d358d0>]}
[0m09:36:28.956772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d36610>]}
[0m09:36:28.957169 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:36:28.994325 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:36:29.021269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:29.021535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:29.025454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181a7e50>]}
[0m09:36:29.031256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118104ad0>]}
[0m09:36:29.031543 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:36:29.031763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a5350>]}
[0m09:36:29.032951 [info ] [MainThread]: 
[0m09:36:29.033470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:29.034313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:36:29.040469 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:36:29.040725 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:36:29.040868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:29.136237 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.136639 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:36:29.136893 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:36:29.163116 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:36:29.164704 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:36:29.166505 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:36:29.196880 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.197156 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.197319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:29.209657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.209972 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.210242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:29.254171 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:36:29.255591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00910>]}
[0m09:36:29.255939 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:29.256759 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.256972 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.258273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.258517 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.258800 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.259058 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.259790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:36:29.260013 [debug] [MainThread]: On master: Close
[0m09:36:29.260477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:36:29.260749 [info ] [MainThread]: 
[0m09:36:29.264040 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.264316 [debug] [Thread-2 (]: Began running node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.264550 [debug] [Thread-3 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.264767 [debug] [Thread-4 (]: Began running node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.265025 [info ] [Thread-1 (]: 1 of 7 START test has_rows_sum_genre_views_ .................................... [RUN]
[0m09:36:29.265362 [info ] [Thread-2 (]: 2 of 7 START test has_rows_sum_movie_viewing_time_ ............................. [RUN]
[0m09:36:29.265709 [info ] [Thread-3 (]: 3 of 7 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:36:29.266059 [info ] [Thread-4 (]: 4 of 7 START test has_rows_sum_user_activity_ .................................. [RUN]
[0m09:36:29.266662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90)
[0m09:36:29.267140 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0'
[0m09:36:29.267592 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe'
[0m09:36:29.268040 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c'
[0m09:36:29.268293 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.268530 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.268750 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.268971 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.281159 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90 (compile): 09:36:29.269137 => 09:36:29.280995
[0m09:36:29.281546 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0 (compile): 09:36:29.274438 => 09:36:29.281411
[0m09:36:29.281871 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:36:29.276686 => 09:36:29.281772
[0m09:36:29.282175 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c (compile): 09:36:29.278711 => 09:36:29.282082
[0m09:36:29.288136 [debug] [Thread-2 (]: Compilation Error in test has_rows_sum_movie_viewing_time_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.288830 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_genre_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.289449 [debug] [Thread-4 (]: Compilation Error in test has_rows_sum_user_activity_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.290031 [debug] [Thread-3 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.290299 [error] [Thread-2 (]: 2 of 7 ERROR has_rows_sum_movie_viewing_time_ .................................. [[31mERROR[0m in 0.02s]
[0m09:36:29.290649 [error] [Thread-1 (]: 1 of 7 ERROR has_rows_sum_genre_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.290965 [error] [Thread-4 (]: 4 of 7 ERROR has_rows_sum_user_activity_ ....................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.291312 [error] [Thread-3 (]: 3 of 7 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.291628 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.291863 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.292097 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.292318 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.292547 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.292811 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.293039 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.293319 [info ] [Thread-2 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:36:29.293577 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:36:29.293823 [info ] [Thread-4 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:36:29.294235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:36:29.294545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:36:29.294873 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:36:29.295072 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.295254 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.295426 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.300325 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.302606 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.304880 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.305723 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:36:29.295552 => 09:36:29.305555
[0m09:36:29.305949 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:36:29.300520 => 09:36:29.305866
[0m09:36:29.306195 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.306404 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:36:29.302808 => 09:36:29.306324
[0m09:36:29.306598 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.313724 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.313943 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.315029 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.316078 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.316486 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.316657 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.317858 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.318097 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:36:29.318285 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:36:29.318457 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:36:29.318648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:29.318812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:36:29.318974 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:36:29.329218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.329537 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.329788 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:36:29.330498 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.330709 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.330894 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:36:29.331134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.331358 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.331548 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:36:29.337599 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.340925 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:36:29.306778 => 09:36:29.340494
[0m09:36:29.341210 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:36:29.343940 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:36:29.344528 [info ] [Thread-2 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:36:29.345212 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.532511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.533538 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:36:29.315209 => 09:36:29.533424
[0m09:36:29.533762 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:36:29.535367 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:36:29.535873 [info ] [Thread-4 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.24s]
[0m09:36:29.536477 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.665212 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.668921 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:36:29.314071 => 09:36:29.668200
[0m09:36:29.669916 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:36:29.671334 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:36:29.672559 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.38s]
[0m09:36:29.673643 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.675590 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.676077 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.676552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:29.686131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.686464 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.686633 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.686778 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.687347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:36:29.687545 [debug] [MainThread]: On master: Close
[0m09:36:29.687920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:29.688063 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:36:29.688188 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:36:29.688304 [debug] [MainThread]: Connection 'test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe' was properly closed.
[0m09:36:29.688417 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:36:29.688570 [info ] [MainThread]: 
[0m09:36:29.688771 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m09:36:29.689501 [debug] [MainThread]: Command end result
[0m09:36:29.693362 [info ] [MainThread]: 
[0m09:36:29.693648 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:36:29.693863 [info ] [MainThread]: 
[0m09:36:29.694125 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:36:29.694368 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.694547 [info ] [MainThread]: 
[0m09:36:29.694740 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_genre_views_ (models/schema.yml)[0m
[0m09:36:29.694954 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.695172 [info ] [MainThread]: 
[0m09:36:29.695407 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_user_activity_ (models/schema.yml)[0m
[0m09:36:29.695617 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.695807 [info ] [MainThread]: 
[0m09:36:29.695987 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:36:29.696157 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.696359 [info ] [MainThread]: 
[0m09:36:29.696574 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:36:29.696943 [debug] [MainThread]: Command `dbt test` failed at 09:36:29.696887 after 0.86 seconds
[0m09:36:29.697163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b20690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c1e90>]}
[0m09:36:29.697377 [debug] [MainThread]: Flushing usage events
[0m09:39:03.061500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bd710>]}


============================== 09:39:03.065092 | 13241d13-0787-4d9e-bcc1-4cf5ee52ec0a ==============================
[0m09:39:03.065092 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:39:03.065462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:39:03.076721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13241d13-0787-4d9e-bcc1-4cf5ee52ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc550>]}
[0m09:39:03.077204 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:39:03.077599 [debug] [MainThread]: Command `dbt deps` succeeded at 09:39:03.077523 after 0.03 seconds
[0m09:39:03.077814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10293a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a81dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a81e90>]}
[0m09:39:03.078008 [debug] [MainThread]: Flushing usage events
[0m09:41:13.011299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106546ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655dc50>]}


============================== 09:41:13.015398 | 07d81e2c-1aaa-42da-893d-4469ee2e2d80 ==============================
[0m09:41:13.015398 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:41:13.015778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:41:13.059126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654ca10>]}
[0m09:41:13.066282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065708d0>]}
[0m09:41:13.066758 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:41:13.079205 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:41:13.100615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:13.101188 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:41:13.113230 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:41:13.120560 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:41:13.122576 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:41:13.124457 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:41:13.172785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbcd0>]}
[0m09:41:13.176853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c71b50>]}
[0m09:41:13.177071 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:41:13.177290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104309090>]}
[0m09:41:13.178325 [info ] [MainThread]: 
[0m09:41:13.178813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:41:13.179619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:41:13.185239 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:41:13.185481 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:41:13.185613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:13.244518 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.244837 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:41:13.245047 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:41:13.265886 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:41:13.267132 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:41:13.268322 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:41:13.272640 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.272918 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.273096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:13.285478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.285756 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.286024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:41:13.309207 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:41:13.310596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c113d0>]}
[0m09:41:13.310937 [debug] [MainThread]: On master: ROLLBACK
[0m09:41:13.311757 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.311971 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.313314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.313564 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.313778 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.313979 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.314749 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:13.314982 [debug] [MainThread]: On master: Close
[0m09:41:13.315473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:41:13.315764 [info ] [MainThread]: 
[0m09:41:13.318929 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.319224 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.319500 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.319790 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.320039 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:41:13.320390 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:41:13.320737 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:41:13.321048 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:41:13.321610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:41:13.322099 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:41:13.322555 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:41:13.323010 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:41:13.323259 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.323484 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.323740 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.324035 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.333870 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:41:13.324245 => 09:41:13.333703
[0m09:41:13.334263 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:41:13.327333 => 09:41:13.334130
[0m09:41:13.334625 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:41:13.329497 => 09:41:13.334512
[0m09:41:13.335325 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:41:13.331510 => 09:41:13.335218
[0m09:41:13.341111 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.341846 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.342276 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:41:13.342972 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.343534 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.343788 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:41:13.344127 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.344394 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:41:13.344696 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:41:13.344970 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.345254 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.345571 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.345783 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.345998 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.346214 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:41:13.346474 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.346730 [info ] [Thread-3 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:41:13.347140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:41:13.347337 [info ] [Thread-1 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:41:13.347725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:41:13.347921 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.348238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:41:13.348413 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.353305 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.353517 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.355591 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.358278 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.358838 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:41:13.348538 => 09:41:13.358716
[0m09:41:13.359091 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.359293 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:41:13.353646 => 09:41:13.359202
[0m09:41:13.359474 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:41:13.355866 => 09:41:13.359397
[0m09:41:13.366094 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.366289 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.366467 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.368566 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.369617 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.369805 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.370121 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:41:13.370291 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.370487 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:41:13.370657 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.370830 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:41:13.371075 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:41:13.371236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:41:13.371413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:13.382187 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.382548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.382826 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.383039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.383243 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.383462 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:41:13.383666 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.383865 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:41:13.384099 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:41:13.386822 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.388551 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:41:13.359599 => 09:41:13.388333
[0m09:41:13.388894 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:41:13.390927 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:41:13.391969 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:41:13.392434 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.428285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.430825 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:41:13.368729 => 09:41:13.430338
[0m09:41:13.431407 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:41:13.433271 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:41:13.434573 [info ] [Thread-1 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.09s]
[0m09:41:13.435286 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.468108 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.469095 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:41:13.366637 => 09:41:13.468981
[0m09:41:13.469298 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:41:13.470166 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:41:13.470652 [info ] [Thread-3 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.12s]
[0m09:41:13.470998 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.472899 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.473245 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.473404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:13.481876 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.482198 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.482351 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.482482 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.483031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:13.483179 [debug] [MainThread]: On master: Close
[0m09:41:13.483499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:13.483631 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:41:13.483751 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d' was properly closed.
[0m09:41:13.483866 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:41:13.483976 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:41:13.484126 [info ] [MainThread]: 
[0m09:41:13.484336 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m09:41:13.484913 [debug] [MainThread]: Command end result
[0m09:41:13.488957 [info ] [MainThread]: 
[0m09:41:13.489256 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:41:13.489457 [info ] [MainThread]: 
[0m09:41:13.489690 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:41:13.489882 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.490061 [info ] [MainThread]: 
[0m09:41:13.490232 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:41:13.490409 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.490579 [info ] [MainThread]: 
[0m09:41:13.490745 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:41:13.491015 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.491253 [info ] [MainThread]: 
[0m09:41:13.491502 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:41:13.491700 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.491890 [info ] [MainThread]: 
[0m09:41:13.492106 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:41:13.492506 [debug] [MainThread]: Command `dbt test` failed at 09:41:13.492451 after 0.50 seconds
[0m09:41:13.492731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106540d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c21e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104308f50>]}
[0m09:41:13.492982 [debug] [MainThread]: Flushing usage events
[0m09:42:57.934907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fcbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106446250>]}


============================== 09:42:57.938546 | 140b73f0-ea2d-4932-8b73-a9b342f131d3 ==============================
[0m09:42:57.938546 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:42:57.938917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:42:57.981920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbdc90>]}
[0m09:42:57.988908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106428650>]}
[0m09:42:57.989336 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:42:58.000665 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:42:58.022733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:58.023312 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:42:58.035076 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:42:58.042425 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:42:58.044456 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:42:58.046315 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:42:58.093968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106463a10>]}
[0m09:42:58.098876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40210>]}
[0m09:42:58.099102 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:42:58.099319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f1090>]}
[0m09:42:58.100341 [info ] [MainThread]: 
[0m09:42:58.100768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:58.101526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:42:58.107510 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:42:58.107750 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:42:58.107881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:58.177142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.177502 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:42:58.177751 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:42:58.190865 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:42:58.192052 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:42:58.192921 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:42:58.196760 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.197012 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.197196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:58.209818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.210085 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.210352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:58.231892 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:42:58.233185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40950>]}
[0m09:42:58.233498 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:58.234347 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.234546 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.236027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.236227 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.236444 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.236632 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.237355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:58.237559 [debug] [MainThread]: On master: Close
[0m09:42:58.238001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:58.238291 [info ] [MainThread]: 
[0m09:42:58.242782 [debug] [Thread-1 (]: Began running node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.243069 [debug] [Thread-2 (]: Began running node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.243337 [debug] [Thread-3 (]: Began running node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.243560 [info ] [Thread-1 (]: 1 of 7 START test count_sum_genre_views_ ....................................... [RUN]
[0m09:42:58.243871 [debug] [Thread-4 (]: Began running node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.244129 [info ] [Thread-2 (]: 2 of 7 START test count_sum_movie_viewing_time_ ................................ [RUN]
[0m09:42:58.244446 [info ] [Thread-3 (]: 3 of 7 START test count_sum_movie_views_ ....................................... [RUN]
[0m09:42:58.245045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.count_sum_genre_views_.1fe3815a3d)
[0m09:42:58.245350 [info ] [Thread-4 (]: 4 of 7 START test count_sum_user_activity_ ..................................... [RUN]
[0m09:42:58.245931 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0'
[0m09:42:58.246385 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_movie_views_.3629ba83dc'
[0m09:42:58.246616 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.247035 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_user_activity_.ee4feb4835'
[0m09:42:58.247257 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.247466 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.250092 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.252567 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.count_sum_genre_views_.1fe3815a3d (compile): 09:42:58.247617 => 09:42:58.252445
[0m09:42:58.255067 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.count_sum_movie_views_.3629ba83dc (compile): 09:42:58.252701 => 09:42:58.254928
[0m09:42:58.255467 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0 (compile): 09:42:58.250272 => 09:42:58.255322
[0m09:42:58.258340 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.count_sum_user_activity_.ee4feb4835 (compile): 09:42:58.255689 => 09:42:58.258183
[0m09:42:58.264598 [debug] [Thread-2 (]: Compilation Error in test count_sum_movie_viewing_time_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.265191 [debug] [Thread-1 (]: Compilation Error in test count_sum_genre_views_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.265457 [error] [Thread-2 (]: 2 of 7 ERROR count_sum_movie_viewing_time_ ..................................... [[31mERROR[0m in 0.02s]
[0m09:42:58.266151 [debug] [Thread-3 (]: Compilation Error in test count_sum_movie_views_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.266722 [debug] [Thread-4 (]: Compilation Error in test count_sum_user_activity_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.266948 [error] [Thread-1 (]: 1 of 7 ERROR count_sum_genre_views_ ............................................ [[31mERROR[0m in 0.02s]
[0m09:42:58.267235 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.267464 [error] [Thread-3 (]: 3 of 7 ERROR count_sum_movie_views_ ............................................ [[31mERROR[0m in 0.02s]
[0m09:42:58.267779 [error] [Thread-4 (]: 4 of 7 ERROR count_sum_user_activity_ .......................................... [[31mERROR[0m in 0.02s]
[0m09:42:58.268070 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.268298 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.268559 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.268766 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.268974 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.269182 [info ] [Thread-2 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:42:58.269449 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.269700 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:42:58.270120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:42:58.270326 [info ] [Thread-3 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:42:58.270726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_genre_views_.1fe3815a3d, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:42:58.270916 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.271251 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_movie_views_.3629ba83dc, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:42:58.271447 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.276663 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.277092 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.279448 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.281561 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.281896 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:42:58.271584 => 09:42:58.281801
[0m09:42:58.282152 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:42:58.277244 => 09:42:58.282071
[0m09:42:58.282306 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.282493 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.282716 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:42:58.279681 => 09:42:58.282629
[0m09:42:58.290039 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.292952 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.293201 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.294369 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.294692 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.294961 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:42:58.295133 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:42:58.295407 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.295646 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.295809 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:42:58.296073 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:42:58.296291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:58.296602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:42:58.308325 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.308956 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.309225 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:42:58.310589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.310829 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.311020 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:42:58.311411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.311600 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.311774 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:42:58.312783 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.314187 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:42:58.282818 => 09:42:58.314037
[0m09:42:58.314454 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:42:58.315794 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:42:58.316930 [info ] [Thread-2 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:42:58.317872 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.339848 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.341149 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:42:58.293466 => 09:42:58.340981
[0m09:42:58.341438 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:42:58.343086 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:42:58.343680 [info ] [Thread-3 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:42:58.344063 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.378424 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.379319 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:42:58.290327 => 09:42:58.379217
[0m09:42:58.379507 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:42:58.380192 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:42:58.380609 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:42:58.380931 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.381752 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.381932 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.382072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:58.390238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.390576 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.390727 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.390858 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.391634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:58.391811 [debug] [MainThread]: On master: Close
[0m09:42:58.392245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:58.392383 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:42:58.392508 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:42:58.392640 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:42:58.392752 [debug] [MainThread]: Connection 'test.maker_warehouse.count_sum_user_activity_.ee4feb4835' was properly closed.
[0m09:42:58.392963 [info ] [MainThread]: 
[0m09:42:58.393173 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:42:58.393784 [debug] [MainThread]: Command end result
[0m09:42:58.397801 [info ] [MainThread]: 
[0m09:42:58.398026 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:42:58.398202 [info ] [MainThread]: 
[0m09:42:58.398424 [error] [MainThread]: [33mCompilation Error in test count_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:42:58.398616 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.398797 [info ] [MainThread]: 
[0m09:42:58.398982 [error] [MainThread]: [33mCompilation Error in test count_sum_genre_views_ (models/schema.yml)[0m
[0m09:42:58.399225 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.399428 [info ] [MainThread]: 
[0m09:42:58.399624 [error] [MainThread]: [33mCompilation Error in test count_sum_movie_views_ (models/schema.yml)[0m
[0m09:42:58.399807 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.399980 [info ] [MainThread]: 
[0m09:42:58.400149 [error] [MainThread]: [33mCompilation Error in test count_sum_user_activity_ (models/schema.yml)[0m
[0m09:42:58.400316 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.400490 [info ] [MainThread]: 
[0m09:42:58.400682 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:42:58.401044 [debug] [MainThread]: Command `dbt test` failed at 09:42:58.400979 after 0.48 seconds
[0m09:42:58.401260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b09e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b09dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fc950>]}
[0m09:42:58.401462 [debug] [MainThread]: Flushing usage events
[0m09:44:01.133799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077069d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771da10>]}


============================== 09:44:01.137435 | bc0f94dd-78e6-4f8a-8095-e382052565f4 ==============================
[0m09:44:01.137435 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:44:01.137837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:44:01.184621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771d890>]}
[0m09:44:01.191630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e710>]}
[0m09:44:01.192051 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:44:01.203520 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:44:01.225079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:01.225617 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:44:01.237147 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:44:01.244432 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:44:01.246350 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:44:01.248187 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:44:01.296271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e31ed0>]}
[0m09:44:01.300026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb1f90>]}
[0m09:44:01.300242 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:44:01.300460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eced0>]}
[0m09:44:01.301495 [info ] [MainThread]: 
[0m09:44:01.301934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:01.302699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m09:44:01.308358 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m09:44:01.308614 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m09:44:01.308760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:01.388292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:44:01.389353 [debug] [ThreadPool]: On list_mydb: Close
[0m09:44:01.390610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m09:44:01.394583 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:01.394796 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:44:01.394972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:01.407551 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.407860 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:01.408099 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:44:01.417705 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:44:01.418841 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:44:01.419617 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:44:01.423813 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.424077 [debug] [MainThread]: On master: BEGIN
[0m09:44:01.424271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:01.434859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.435196 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.435501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:01.455841 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:44:01.457221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80950>]}
[0m09:44:01.457573 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:01.458445 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.458682 [debug] [MainThread]: On master: BEGIN
[0m09:44:01.460119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.460382 [debug] [MainThread]: On master: COMMIT
[0m09:44:01.460599 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.460797 [debug] [MainThread]: On master: COMMIT
[0m09:44:01.461526 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:01.461755 [debug] [MainThread]: On master: Close
[0m09:44:01.462272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:01.462573 [info ] [MainThread]: 
[0m09:44:01.467154 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m09:44:01.467477 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m09:44:01.467781 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m09:44:01.468065 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m09:44:01.468385 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m09:44:01.468796 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m09:44:01.469293 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m09:44:01.469729 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m09:44:01.470345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m09:44:01.470820 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m09:44:01.471257 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m09:44:01.471671 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m09:44:01.471906 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m09:44:01.472115 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m09:44:01.472325 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m09:44:01.472533 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m09:44:01.474971 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m09:44:01.476932 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m09:44:01.478702 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m09:44:01.480286 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m09:44:01.481647 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 09:44:01.472685 => 09:44:01.481502
[0m09:44:01.481953 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 09:44:01.477121 => 09:44:01.481819
[0m09:44:01.482195 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 09:44:01.478874 => 09:44:01.482091
[0m09:44:01.482421 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m09:44:01.482659 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 09:44:01.475309 => 09:44:01.482558
[0m09:44:01.482871 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m09:44:01.483080 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m09:44:01.505908 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m09:44:01.506160 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m09:44:01.508509 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m09:44:01.510633 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m09:44:01.520718 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m09:44:01.521346 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:01.521683 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m09:44:01.521890 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:01.522086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:01.522274 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.522462 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:01.522621 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m09:44:01.522892 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m09:44:01.523061 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m09:44:01.523231 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:01.523401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:01.523574 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:01.532782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533125 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533734 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:01.533956 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:01.534164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.534375 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.534593 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.534795 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m09:44:01.535998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.536207 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:01.536383 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.552314 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:01.556561 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.556829 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m09:44:01.559958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:01.561905 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.562138 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m09:44:01.564025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:01.574869 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m09:44:01.575168 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.575358 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m09:44:01.605564 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:01.608868 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.609208 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m09:44:01.630765 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:01.631755 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 09:44:01.510839 => 09:44:01.631659
[0m09:44:01.631954 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m09:44:01.632354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f9bd0>]}
[0m09:44:01.632790 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m09:44:01.633330 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m09:44:01.633564 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m09:44:01.633873 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m09:44:01.634472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m09:44:01.634694 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m09:44:01.636555 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m09:44:01.637293 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 09:44:01.634810 => 09:44:01.637106
[0m09:44:01.637527 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m09:44:01.641424 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m09:44:01.642255 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:01.642477 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m09:44:01.642646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:01.650709 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.651004 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:01.651290 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:02.943190 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m09:44:02.945229 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.945519 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m09:44:02.948802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:02.950682 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.950916 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m09:44:02.953884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:02.957832 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m09:44:02.958114 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.958283 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m09:44:03.022292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.027690 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:03.028321 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m09:44:03.074538 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 2.0 seconds
[0m09:44:03.075130 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.079803 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.082774 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 09:44:01.483224 => 09:44:03.081987
[0m09:44:03.083124 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m09:44:03.083582 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m09:44:03.084389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110053ed0>]}
[0m09:44:03.085006 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 1.61s]
[0m09:44:03.085504 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m09:44:03.093559 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.095893 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.096171 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m09:44:03.155335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.156774 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m09:44:03.156969 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.157133 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m09:44:03.185724 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.190297 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.190662 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m09:44:03.323154 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.327237 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 09:44:01.508664 => 09:44:03.326724
[0m09:44:03.328199 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m09:44:03.329333 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5b10>]}
[0m09:44:03.330233 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.86s]
[0m09:44:03.331210 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m09:44:03.666446 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 2.0 seconds
[0m09:44:03.674530 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.674836 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 2.0 seconds
[0m09:44:03.675068 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m09:44:03.676602 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.676843 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m09:44:03.679028 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.679193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.680634 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.681992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.682179 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m09:44:03.682372 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m09:44:03.683740 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.683891 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.685063 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m09:44:03.686188 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m09:44:03.686368 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.686579 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.686772 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m09:44:03.686936 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m09:44:03.713992 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.714771 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.717468 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.718667 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.718847 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m09:44:03.719033 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m09:44:03.803815 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.807642 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 09:44:01.637678 => 09:44:03.807200
[0m09:44:03.808490 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m09:44:03.809795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5bad0>]}
[0m09:44:03.810752 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 2.18s]
[0m09:44:03.811780 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m09:44:03.900277 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.904173 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 09:44:01.506343 => 09:44:03.903789
[0m09:44:03.904996 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m09:44:03.906197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f59690>]}
[0m09:44:03.907198 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 2.43s]
[0m09:44:03.908216 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m09:44:03.909387 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m09:44:03.909655 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.909830 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m09:44:03.910023 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m09:44:03.910307 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m09:44:03.910627 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m09:44:03.910964 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m09:44:03.911237 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m09:44:03.911701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m09:44:03.912067 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m09:44:03.912407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m09:44:03.912758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m09:44:03.912991 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m09:44:03.913183 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.913399 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m09:44:03.913600 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m09:44:03.915586 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m09:44:03.916915 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.918265 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m09:44:03.919531 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m09:44:03.920147 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 09:44:03.917051 => 09:44:03.920042
[0m09:44:03.920380 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 09:44:03.913726 => 09:44:03.920295
[0m09:44:03.920536 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m09:44:03.920743 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 09:44:03.918396 => 09:44:03.920664
[0m09:44:03.920921 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 09:44:03.915727 => 09:44:03.920843
[0m09:44:03.921083 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m09:44:03.923580 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m09:44:03.923884 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m09:44:03.924099 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.926440 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m09:44:03.928727 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m09:44:03.930803 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.931091 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:03.931367 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m09:44:03.931531 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:03.931721 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:03.931890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:03.932073 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.932230 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m09:44:03.932408 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m09:44:03.932670 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m09:44:03.932839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:03.933003 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:03.933185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:03.944071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.944485 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:03.944694 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m09:44:03.946355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.946739 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:03.946949 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m09:44:03.953549 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.954207 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:03.954536 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m09:44:03.967953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.968318 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.968546 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m09:44:04.288845 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m09:44:04.301964 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.302964 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m09:44:04.305486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.311603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.312468 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m09:44:04.313252 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m09:44:04.313796 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.324578 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.326515 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m09:44:04.327541 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m09:44:04.328145 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.328824 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m09:44:04.330026 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.332661 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.332929 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m09:44:04.334177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.335672 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m09:44:04.335876 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.336064 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m09:44:04.338273 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.339673 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.339872 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.340066 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m09:44:04.341559 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.342006 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m09:44:04.357777 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.358114 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.358983 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 09:44:03.921219 => 09:44:04.358886
[0m09:44:04.359768 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 09:44:03.928875 => 09:44:04.359677
[0m09:44:04.360029 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m09:44:04.360229 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m09:44:04.360706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec5c10>]}
[0m09:44:04.361183 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8f810>]}
[0m09:44:04.361526 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.45s]
[0m09:44:04.361950 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.45s]
[0m09:44:04.362527 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m09:44:04.362814 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:04.634106 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m09:44:04.639786 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.640500 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m09:44:04.649002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.653215 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.653502 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m09:44:04.654804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.656392 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m09:44:04.656632 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.656805 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m09:44:04.667764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.669215 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.669404 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m09:44:04.674388 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.676574 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 09:44:03.924245 => 09:44:04.676304
[0m09:44:04.676845 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m09:44:04.677321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110091190>]}
[0m09:44:04.677663 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.77s]
[0m09:44:04.678017 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m09:44:04.864331 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m09:44:04.868852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.869181 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m09:44:04.889740 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.894084 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.894312 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m09:44:04.895226 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.896475 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m09:44:04.896657 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.896818 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m09:44:04.902917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.905905 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.906103 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m09:44:05.019981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:05.023799 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 09:44:03.926661 => 09:44:05.023280
[0m09:44:05.024594 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m09:44:05.025939 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000d490>]}
[0m09:44:05.027036 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.11s]
[0m09:44:05.027957 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m09:44:05.029051 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:05.029279 [debug] [MainThread]: On master: BEGIN
[0m09:44:05.029422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:05.038604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:05.038901 [debug] [MainThread]: On master: COMMIT
[0m09:44:05.039054 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:05.039184 [debug] [MainThread]: On master: COMMIT
[0m09:44:05.039795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:05.039983 [debug] [MainThread]: On master: Close
[0m09:44:05.040331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:05.040474 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m09:44:05.040591 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m09:44:05.040702 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m09:44:05.040814 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m09:44:05.041008 [info ] [MainThread]: 
[0m09:44:05.041221 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:44:05.042100 [debug] [MainThread]: Command end result
[0m09:44:05.046649 [info ] [MainThread]: 
[0m09:44:05.046900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:05.047099 [info ] [MainThread]: 
[0m09:44:05.047356 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:44:05.047853 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:05.047800 after 3.93 seconds
[0m09:44:05.048099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab1bd0>]}
[0m09:44:05.048284 [debug] [MainThread]: Flushing usage events
[0m09:44:08.090139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab05290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1e090>]}


============================== 09:44:08.093534 | 4991a506-105b-4789-a744-e468df30fc6f ==============================
[0m09:44:08.093534 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:44:08.093878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:44:08.127733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd3790>]}
[0m09:44:08.134800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2eb10>]}
[0m09:44:08.135238 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:44:08.145198 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:44:08.165765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:08.166014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:08.169742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b138790>]}
[0m09:44:08.173922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b1ad0>]}
[0m09:44:08.174227 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:44:08.174447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672ced0>]}
[0m09:44:08.175612 [info ] [MainThread]: 
[0m09:44:08.176051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:08.176795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:44:08.182117 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:08.182279 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:44:08.182444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:08.214383 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.214700 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:08.214898 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:44:08.223103 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:44:08.224368 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:44:08.225214 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:44:08.251767 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.252042 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.252203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:08.268099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.268422 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.268737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:08.284232 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:44:08.285437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e28090>]}
[0m09:44:08.285735 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:08.286531 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.286717 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.287923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.288127 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.288301 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.288460 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.289140 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:08.289342 [debug] [MainThread]: On master: Close
[0m09:44:08.289769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:08.290027 [info ] [MainThread]: 
[0m09:44:08.293001 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.293257 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.293481 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.293682 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.293915 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:44:08.294255 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:44:08.294616 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:44:08.294914 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:44:08.295404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:44:08.295845 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:44:08.296254 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:44:08.296662 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:44:08.296875 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.297084 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.297288 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.297511 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.306329 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:44:08.297676 => 09:44:08.306124
[0m09:44:08.306768 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:44:08.301866 => 09:44:08.306654
[0m09:44:08.307130 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:44:08.303941 => 09:44:08.307018
[0m09:44:08.309462 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:44:08.307260 => 09:44:08.309340
[0m09:44:08.315497 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.316054 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.316377 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:44:08.317027 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.317490 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.317729 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:44:08.317997 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.318220 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:44:08.318499 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:44:08.318783 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.319011 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.319272 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.319473 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.319672 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.319852 [info ] [Thread-3 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:44:08.320139 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.320401 [info ] [Thread-4 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:44:08.320803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:44:08.321008 [info ] [Thread-2 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:44:08.321396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:44:08.321641 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.321993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:44:08.322194 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.327074 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.327324 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.329286 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.331310 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.331924 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:44:08.327456 => 09:44:08.331823
[0m09:44:08.332111 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:44:08.322330 => 09:44:08.332031
[0m09:44:08.332279 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:44:08.329488 => 09:44:08.332205
[0m09:44:08.332434 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.332587 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.332735 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.339510 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.340935 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.341924 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.342356 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.342550 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.342717 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:44:08.342915 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:44:08.344201 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.344392 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:08.344582 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:08.344762 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:44:08.345128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:08.358904 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.359350 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.359576 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:44:08.359775 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.360037 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.360256 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:44:08.360504 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.360731 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.360932 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:44:08.363263 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.364640 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:44:08.339819 => 09:44:08.364508
[0m09:44:08.364874 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:44:08.365595 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:44:08.366098 [info ] [Thread-3 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:44:08.366469 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.389198 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.390288 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:44:08.341091 => 09:44:08.390155
[0m09:44:08.390525 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:44:08.391338 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:44:08.391846 [info ] [Thread-2 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:44:08.392228 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.425904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.426824 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:44:08.332847 => 09:44:08.426715
[0m09:44:08.427023 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:44:08.427706 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:44:08.428124 [info ] [Thread-4 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:44:08.428446 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.429379 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.429561 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.429701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:08.442774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.443080 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.443232 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.443372 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.444107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:08.444282 [debug] [MainThread]: On master: Close
[0m09:44:08.444628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:08.444769 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6' was properly closed.
[0m09:44:08.444897 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:44:08.445018 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:44:08.445134 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:44:08.445284 [info ] [MainThread]: 
[0m09:44:08.445504 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m09:44:08.446061 [debug] [MainThread]: Command end result
[0m09:44:08.450518 [info ] [MainThread]: 
[0m09:44:08.450848 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:44:08.451093 [info ] [MainThread]: 
[0m09:44:08.451321 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:44:08.451515 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.451744 [info ] [MainThread]: 
[0m09:44:08.451979 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:44:08.452186 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.452377 [info ] [MainThread]: 
[0m09:44:08.452570 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:44:08.452747 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.452920 [info ] [MainThread]: 
[0m09:44:08.453091 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:44:08.453343 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.453565 [info ] [MainThread]: 
[0m09:44:08.453766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:44:08.454118 [debug] [MainThread]: Command `dbt test` failed at 09:44:08.454063 after 0.38 seconds
[0m09:44:08.454329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104409e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104409dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c3810>]}
[0m09:44:08.454540 [debug] [MainThread]: Flushing usage events
[0m09:45:16.128757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251d310>]}


============================== 09:45:16.132357 | 12bce1c3-bcf2-4efb-80b0-92e7c6380244 ==============================
[0m09:45:16.132357 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:45:16.132745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:16.143751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12bce1c3-bcf2-4efb-80b0-92e7c6380244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11208ec10>]}
[0m09:45:16.147798 [debug] [MainThread]: Command `dbt clean` succeeded at 09:45:16.147707 after 0.03 seconds
[0m09:45:16.148022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5dd0>]}
[0m09:45:16.148210 [debug] [MainThread]: Flushing usage events
[0m09:45:26.623789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104885e50>]}


============================== 09:45:26.627268 | 04138c2f-0799-4664-a69f-7ab836124a16 ==============================
[0m09:45:26.627268 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:45:26.627612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:26.670147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104935290>]}
[0m09:45:26.677280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104885c90>]}
[0m09:45:26.677910 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:45:26.699389 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:45:26.699951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:45:26.700293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048950d0>]}
[0m09:45:26.982440 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m09:45:26.989170 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:45:26.991066 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:45:26.992970 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m09:45:26.994765 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m09:45:26.996927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m09:45:26.997876 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m09:45:26.999690 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m09:45:27.001658 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:45:27.003575 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:45:27.058031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437ec10>]}
[0m09:45:27.061879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fac650>]}
[0m09:45:27.062095 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:45:27.062305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102631090>]}
[0m09:45:27.063293 [info ] [MainThread]: 
[0m09:45:27.063702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:45:27.064441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:45:27.070164 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:45:27.070460 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:45:27.070612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:27.151681 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.152033 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:45:27.152265 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:45:27.170201 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:45:27.171663 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:45:27.172724 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:45:27.177496 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.177814 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.178006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:27.189183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.189550 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.189894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:45:27.217062 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:45:27.218543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432d550>]}
[0m09:45:27.218920 [debug] [MainThread]: On master: ROLLBACK
[0m09:45:27.220805 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.221024 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.223898 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.224151 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.224401 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.224617 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.225353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:45:27.225564 [debug] [MainThread]: On master: Close
[0m09:45:27.226026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:27.226301 [info ] [MainThread]: 
[0m09:45:27.229474 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.229748 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.230001 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.230263 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.230494 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:45:27.230893 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:45:27.231280 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:45:27.231611 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:45:27.232130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:45:27.232615 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:45:27.233130 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:45:27.233629 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:45:27.233897 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.234150 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.234391 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.234628 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.243506 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:45:27.234801 => 09:45:27.243314
[0m09:45:27.243939 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:45:27.237666 => 09:45:27.243792
[0m09:45:27.244333 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:45:27.240651 => 09:45:27.244210
[0m09:45:27.246979 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:45:27.244474 => 09:45:27.246840
[0m09:45:27.253856 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.254577 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.255253 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.255866 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.256208 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:45:27.256593 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:45:27.256939 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:45:27.257275 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:45:27.257610 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.257872 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.258135 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.258365 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.258616 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.258898 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.259137 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.259434 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:45:27.259719 [info ] [Thread-2 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:45:27.260014 [info ] [Thread-1 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:45:27.260463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:45:27.260815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:45:27.261150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:45:27.261344 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.261535 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.261716 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.266745 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.268899 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.271262 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.272214 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:45:27.269069 => 09:45:27.272032
[0m09:45:27.272514 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.272769 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:45:27.261848 => 09:45:27.272660
[0m09:45:27.278174 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:45:27.266906 => 09:45:27.278073
[0m09:45:27.280309 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.280521 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.280712 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.282950 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.283978 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.284428 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.284620 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.284797 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:45:27.284955 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.285123 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:45:27.285285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:27.285473 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:45:27.285657 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:45:27.285920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:45:27.295882 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.296218 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.296474 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:45:27.296901 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.297128 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.297334 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:45:27.297804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.297998 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.298194 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:45:27.299653 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.301006 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:45:27.280921 => 09:45:27.300874
[0m09:45:27.301248 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:45:27.302097 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:45:27.302709 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:45:27.303186 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.329897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.330923 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:45:27.272894 => 09:45:27.330806
[0m09:45:27.331145 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:45:27.332066 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:45:27.332531 [info ] [Thread-1 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:45:27.332888 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.366078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.367003 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:45:27.283106 => 09:45:27.366897
[0m09:45:27.367194 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:45:27.367954 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:45:27.368390 [info ] [Thread-2 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:45:27.368868 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.370152 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.370511 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.370655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:27.379456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.379778 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.379933 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.380064 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.380577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:45:27.380745 [debug] [MainThread]: On master: Close
[0m09:45:27.381085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:27.381230 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:45:27.381352 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:45:27.381468 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5' was properly closed.
[0m09:45:27.381584 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:45:27.381735 [info ] [MainThread]: 
[0m09:45:27.381932 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m09:45:27.382455 [debug] [MainThread]: Command end result
[0m09:45:27.385942 [info ] [MainThread]: 
[0m09:45:27.386233 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:45:27.386418 [info ] [MainThread]: 
[0m09:45:27.386596 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:45:27.386883 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.387089 [info ] [MainThread]: 
[0m09:45:27.387340 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:45:27.387531 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.387743 [info ] [MainThread]: 
[0m09:45:27.388038 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:45:27.388229 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.388403 [info ] [MainThread]: 
[0m09:45:27.388575 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:45:27.388744 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.388918 [info ] [MainThread]: 
[0m09:45:27.389109 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:45:27.389430 [debug] [MainThread]: Command `dbt test` failed at 09:45:27.389380 after 0.78 seconds
[0m09:45:27.389632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f49e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f49dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486a1d0>]}
[0m09:45:27.389824 [debug] [MainThread]: Flushing usage events
[0m09:53:49.142928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109306f50>]}


============================== 09:53:49.146520 | 57d2e47c-fac5-4e85-b817-f971401b740e ==============================
[0m09:53:49.146520 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:53:49.146889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:53:49.200292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932e650>]}
[0m09:53:49.207356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3810>]}
[0m09:53:49.207728 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:53:49.219396 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:53:49.241088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:49.241549 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:53:49.253104 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:53:49.302591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d1d0>]}
[0m09:53:49.306167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109339dd0>]}
[0m09:53:49.306387 [info ] [MainThread]: Found 9 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:53:49.306605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fcf50>]}
[0m09:53:49.307688 [info ] [MainThread]: 
[0m09:53:49.308110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:49.308884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:53:49.314907 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:53:49.315202 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:53:49.315357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:49.376142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.376449 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:53:49.376662 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:53:49.400373 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:53:49.401584 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:53:49.402662 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:53:49.407005 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.407276 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.407465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:49.417006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.417292 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.417592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:49.457130 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:53:49.458565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721aad0>]}
[0m09:53:49.458910 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:49.459807 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.460063 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.461467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.461755 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.462054 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.462273 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.462996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:49.463234 [debug] [MainThread]: On master: Close
[0m09:53:49.463757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:49.464065 [info ] [MainThread]: 
[0m09:53:49.467522 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.467829 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.468103 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.468356 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.468648 [info ] [Thread-1 (]: 1 of 9 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:53:49.469023 [info ] [Thread-2 (]: 2 of 9 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:53:49.469449 [info ] [Thread-3 (]: 3 of 9 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:53:49.469832 [info ] [Thread-4 (]: 4 of 9 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:53:49.470420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe)
[0m09:53:49.470955 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6'
[0m09:53:49.471496 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:53:49.471994 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:53:49.472253 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.472508 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.472746 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.472998 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.481407 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:53:49.473177 => 09:53:49.481239
[0m09:53:49.481788 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:53:49.476053 => 09:53:49.481668
[0m09:53:49.482146 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:53:49.478688 => 09:53:49.482036
[0m09:53:49.484858 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:53:49.482287 => 09:53:49.484677
[0m09:53:49.491901 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.492330 [error] [Thread-3 (]: 3 of 9 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:53:49.493137 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.493741 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.494360 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.494636 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.494912 [error] [Thread-4 (]: 4 of 9 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:53:49.495244 [error] [Thread-2 (]: 2 of 9 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:53:49.495611 [error] [Thread-1 (]: 1 of 9 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.03s]
[0m09:53:49.495937 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.496227 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.496461 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.496679 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.496885 [info ] [Thread-3 (]: 5 of 9 START test not_null_genres_genres ....................................... [RUN]
[0m09:53:49.497198 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.497481 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.497758 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.498154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:53:49.498391 [info ] [Thread-4 (]: 6 of 9 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:53:49.498689 [info ] [Thread-2 (]: 7 of 9 START test not_null_sum_movie_views_total_views ......................... [RUN]
[0m09:53:49.498996 [info ] [Thread-1 (]: 8 of 9 START test not_null_users_user_id ....................................... [RUN]
[0m09:53:49.499265 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.499691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:53:49.500070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842)
[0m09:53:49.500397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:53:49.505741 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.505988 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.506168 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.506343 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.508657 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.511046 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842 (compile): 09:53:49.508821 => 09:53:49.510930
[0m09:53:49.513237 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.513464 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:53:49.500545 => 09:53:49.513372
[0m09:53:49.514310 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:53:49.506549 => 09:53:49.514199
[0m09:53:49.514499 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.514712 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:53:49.511213 => 09:53:49.514622
[0m09:53:49.514903 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.522164 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.522568 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.523165 [debug] [Thread-2 (]: Compilation Error in test not_null_sum_movie_views_total_views (models/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m09:53:49.525308 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.526368 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.526633 [error] [Thread-2 (]: 7 of 9 ERROR not_null_sum_movie_views_total_views .............................. [[31mERROR[0m in 0.03s]
[0m09:53:49.526929 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.527282 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.527494 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.527672 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:53:49.527840 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.528035 [debug] [Thread-2 (]: Began running node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.528238 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:53:49.528397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:49.528554 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:53:49.528718 [info ] [Thread-2 (]: 9 of 9 START test unique_key_sum_movie_views_movie_id .......................... [RUN]
[0m09:53:49.528944 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:49.529176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:49.529476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842, now test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263)
[0m09:53:49.529889 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.532710 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263 (compile): 09:53:49.530038 => 09:53:49.532525
[0m09:53:49.533748 [debug] [Thread-2 (]: Compilation Error in test unique_key_sum_movie_views_movie_id (models/schema.yml)
  'test_unique_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.534068 [error] [Thread-2 (]: 9 of 9 ERROR unique_key_sum_movie_views_movie_id ............................... [[31mERROR[0m in 0.00s]
[0m09:53:49.534357 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.540490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.540836 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.541041 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:53:49.541249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.541456 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.541641 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:53:49.541823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.542086 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.542281 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:53:49.544708 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.546047 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:53:49.515072 => 09:53:49.545934
[0m09:53:49.546265 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:53:49.547327 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:53:49.547958 [info ] [Thread-3 (]: 5 of 9 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:53:49.548351 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.598006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.600300 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:53:49.525500 => 09:53:49.599764
[0m09:53:49.600789 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:53:49.602282 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:53:49.603242 [info ] [Thread-1 (]: 8 of 9 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.10s]
[0m09:53:49.603750 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.641867 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.642904 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:53:49.523288 => 09:53:49.642788
[0m09:53:49.643112 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:53:49.643851 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:53:49.644298 [info ] [Thread-4 (]: 6 of 9 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.14s]
[0m09:53:49.644637 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.645623 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.645853 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.646004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:49.656272 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.656589 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.656777 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.656961 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.657751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:49.657907 [debug] [MainThread]: On master: Close
[0m09:53:49.658250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:49.658387 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:53:49.658511 [debug] [MainThread]: Connection 'test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263' was properly closed.
[0m09:53:49.658634 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:53:49.658748 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:53:49.658913 [info ] [MainThread]: 
[0m09:53:49.659119 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:53:49.659725 [debug] [MainThread]: Command end result
[0m09:53:49.663133 [info ] [MainThread]: 
[0m09:53:49.663381 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m09:53:49.663603 [info ] [MainThread]: 
[0m09:53:49.663807 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:53:49.663996 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.664180 [info ] [MainThread]: 
[0m09:53:49.664375 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:53:49.664578 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.664814 [info ] [MainThread]: 
[0m09:53:49.665035 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:53:49.665267 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.665479 [info ] [MainThread]: 
[0m09:53:49.665684 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:53:49.665874 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.666046 [info ] [MainThread]: 
[0m09:53:49.666217 [error] [MainThread]: [33mCompilation Error in test not_null_sum_movie_views_total_views (models/schema.yml)[0m
[0m09:53:49.666390 [error] [MainThread]:   macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m09:53:49.666569 [info ] [MainThread]: 
[0m09:53:49.666790 [error] [MainThread]: [33mCompilation Error in test unique_key_sum_movie_views_movie_id (models/schema.yml)[0m
[0m09:53:49.666980 [error] [MainThread]:   'test_unique_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.667192 [info ] [MainThread]: 
[0m09:53:49.667411 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=6 SKIP=0 TOTAL=9
[0m09:53:49.667779 [debug] [MainThread]: Command `dbt test` failed at 09:53:49.667719 after 0.54 seconds
[0m09:53:49.668015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c15dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c15e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b8a10>]}
[0m09:53:49.668231 [debug] [MainThread]: Flushing usage events
[0m09:54:06.094811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032d9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480dd10>]}


============================== 09:54:06.098407 | d776184d-e2e2-4f79-a67f-ccf70cfcfb67 ==============================
[0m09:54:06.098407 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:54:06.098798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:54:06.139458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480db50>]}
[0m09:54:06.146382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c4890>]}
[0m09:54:06.146776 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:54:06.157525 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:54:06.180255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:06.180755 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:54:06.193631 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:54:06.238744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f810d0>]}
[0m09:54:06.242243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea1bd0>]}
[0m09:54:06.242456 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:54:06.242671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b9090>]}
[0m09:54:06.243650 [info ] [MainThread]: 
[0m09:54:06.244072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:06.244763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:54:06.249895 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:54:06.250200 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:54:06.250348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:06.313547 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.313850 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:54:06.314061 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:54:06.331460 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:54:06.332687 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:54:06.333659 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:54:06.338281 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.338540 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.338724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:06.349707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.350010 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.350351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:06.375833 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:54:06.377284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ad4d0>]}
[0m09:54:06.377632 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:06.378606 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.378848 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.380136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.380359 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.380596 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.380807 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.381601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:06.381832 [debug] [MainThread]: On master: Close
[0m09:54:06.382326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:06.382631 [info ] [MainThread]: 
[0m09:54:06.386647 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.386964 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.387248 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.387528 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.387789 [info ] [Thread-1 (]: 1 of 7 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:54:06.388182 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:54:06.388598 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:54:06.389000 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:54:06.389602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe)
[0m09:54:06.390130 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6'
[0m09:54:06.390576 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:54:06.391008 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:54:06.391252 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.391484 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.391710 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.391929 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.399543 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:54:06.392090 => 09:54:06.399383
[0m09:54:06.399948 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:54:06.394646 => 09:54:06.399818
[0m09:54:06.400352 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:54:06.396935 => 09:54:06.400206
[0m09:54:06.403149 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:54:06.400504 => 09:54:06.403007
[0m09:54:06.409301 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.409919 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.410507 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.411354 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.410759 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:54:06.411716 [error] [Thread-1 (]: 1 of 7 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:54:06.412018 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:54:06.412301 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:54:06.412643 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.412881 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.413115 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.413337 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.413555 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.413824 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.414052 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.414312 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:54:06.414569 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:54:06.414847 [info ] [Thread-3 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:54:06.415296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:54:06.415654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:54:06.415988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:54:06.416207 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.416420 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.416627 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.422020 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.424250 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.426272 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.426939 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:54:06.424401 => 09:54:06.426827
[0m09:54:06.427174 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:54:06.422213 => 09:54:06.427073
[0m09:54:06.427366 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:54:06.416765 => 09:54:06.427281
[0m09:54:06.427522 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.427698 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.427873 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.434813 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.436194 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.437214 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.437831 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.438012 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.438183 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.438347 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:54:06.438530 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:54:06.438715 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:54:06.438896 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:54:06.439059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:06.439215 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:54:06.451071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451473 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451947 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.452168 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.452366 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.452570 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:54:06.452777 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:54:06.452986 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:54:06.456024 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.457473 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:54:06.436342 => 09:54:06.457332
[0m09:54:06.457715 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:54:06.458488 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:54:06.459023 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:54:06.459417 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.491993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.494667 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:54:06.427990 => 09:54:06.494347
[0m09:54:06.495225 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:54:06.496994 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:54:06.497725 [info ] [Thread-3 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.08s]
[0m09:54:06.498526 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.518899 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.519898 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:54:06.435056 => 09:54:06.519780
[0m09:54:06.520110 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:54:06.520791 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:54:06.521273 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:54:06.521633 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.522581 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.522793 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.522949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:06.530529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.530823 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.530971 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.531106 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.531718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:06.531875 [debug] [MainThread]: On master: Close
[0m09:54:06.532220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:06.532365 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:54:06.532489 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6' was properly closed.
[0m09:54:06.532606 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:54:06.532718 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:54:06.532880 [info ] [MainThread]: 
[0m09:54:06.533090 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:54:06.533713 [debug] [MainThread]: Command end result
[0m09:54:06.538274 [info ] [MainThread]: 
[0m09:54:06.538541 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:54:06.538750 [info ] [MainThread]: 
[0m09:54:06.538985 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:54:06.539180 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.539361 [info ] [MainThread]: 
[0m09:54:06.539531 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:54:06.539700 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.539869 [info ] [MainThread]: 
[0m09:54:06.540034 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:54:06.540202 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.540367 [info ] [MainThread]: 
[0m09:54:06.540532 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:54:06.540699 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.540871 [info ] [MainThread]: 
[0m09:54:06.541061 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:54:06.541374 [debug] [MainThread]: Command `dbt test` failed at 09:54:06.541326 after 0.46 seconds
[0m09:54:06.541570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed3b90>]}
[0m09:54:06.541762 [debug] [MainThread]: Flushing usage events
[0m12:35:17.061610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f81290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77f90>]}


============================== 12:35:17.065174 | b2600c37-badd-448c-bad9-c6cf59a73369 ==============================
[0m12:35:17.065174 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:35:17.065519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:17.170901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2600c37-badd-448c-bad9-c6cf59a73369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99d90>]}
[0m12:35:17.178303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2600c37-badd-448c-bad9-c6cf59a73369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa9bd0>]}
[0m12:35:17.178712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:35:17.201268 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:35:17.223870 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:35:17.224207 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:35:17.224373 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:35:17.224518 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:35:17.224655 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test.sql
[0m12:35:17.224791 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:35:17.224922 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:35:17.225055 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:35:17.225186 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:35:17.225316 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:35:17.225445 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:35:17.225638 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:35:17.225781 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:35:17.225913 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:35:17.226040 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:35:17.226160 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:35:17.226270 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:35:17.226387 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:35:17.226506 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:35:17.226628 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:35:17.226744 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:35:17.237842 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:35:17.245515 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:35:17.246903 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:35:17.248883 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:35:17.250711 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test.sql
[0m12:35:17.270135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test.sql
[0m12:35:17.270462 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "mac_test".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("mac_test").
  
  To fix this, change the name of one of these resources:
  - model.maker_warehouse.mac_test (models/raw_banking/mac_test.sql)
  - model.maker_warehouse.mac_test (models/raw_netflix/mac_test.sql)
[0m12:35:17.270823 [debug] [MainThread]: Command `dbt run` failed at 12:35:17.270762 after 0.23 seconds
[0m12:35:17.271022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10065de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104055f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104054a50>]}
[0m12:35:17.271230 [debug] [MainThread]: Flushing usage events
[0m12:35:51.273470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997f90>]}


============================== 12:35:51.277105 | 87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd ==============================
[0m12:35:51.277105 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:35:51.277501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:51.320196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ca4d0>]}
[0m12:35:51.327352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cde10>]}
[0m12:35:51.327742 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:35:51.337613 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:35:51.361413 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:35:51.361774 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test_banking.sql
[0m12:35:51.361940 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:35:51.362088 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:35:51.362228 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:35:51.362378 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:35:51.362511 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:35:51.362661 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:35:51.362801 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:35:51.362935 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:35:51.363074 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:35:51.363270 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:35:51.363416 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:35:51.363556 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:35:51.363701 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:35:51.363831 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:35:51.363956 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:35:51.364092 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:35:51.364215 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:35:51.364341 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:35:51.364468 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:35:51.374946 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test_banking.sql
[0m12:35:51.382782 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test_banking.sql
[0m12:35:51.384107 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m12:35:51.386103 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:35:51.408275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:35:51.409474 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m12:35:51.411345 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m12:35:51.413248 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:35:51.415102 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m12:35:51.417015 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m12:35:51.418890 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:35:51.420667 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m12:35:51.462466 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/raw_netflix/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m12:35:51.462948 [debug] [MainThread]: Command `dbt run` failed at 12:35:51.462881 after 0.21 seconds
[0m12:35:51.463157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d7d10>]}
[0m12:35:51.463370 [debug] [MainThread]: Flushing usage events
[0m12:36:37.896610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491df10>]}


============================== 12:36:37.900277 | 500c9baf-2d41-4ba9-b213-24e310da627e ==============================
[0m12:36:37.900277 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:36:37.900639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:37.942225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '500c9baf-2d41-4ba9-b213-24e310da627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d39d0>]}
[0m12:36:37.949264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '500c9baf-2d41-4ba9-b213-24e310da627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906150>]}
[0m12:36:37.949629 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:36:37.960599 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:36:37.982143 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:36:37.982469 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:36:37.982633 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:36:37.982777 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test_banking.sql
[0m12:36:37.982915 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:36:37.983048 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:36:37.983180 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:36:37.983310 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:36:37.983444 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:36:37.983571 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:36:37.983701 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:36:37.983900 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:36:37.984044 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:36:37.984171 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:36:37.984299 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:36:37.984429 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:36:37.984561 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:36:37.984675 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:36:37.984797 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:36:37.984922 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:36:37.985045 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:36:37.996450 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:36:38.004246 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:36:38.005597 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m12:36:38.007463 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test_banking.sql
[0m12:36:38.027746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test_banking.sql
[0m12:36:38.028919 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m12:36:38.030815 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m12:36:38.032606 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m12:36:38.034399 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m12:36:38.036253 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m12:36:38.038009 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:36:38.039757 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:36:38.078061 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/raw_netflix/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m12:36:38.078473 [debug] [MainThread]: Command `dbt run` failed at 12:36:38.078407 after 0.20 seconds
[0m12:36:38.078682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104900ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490cbd0>]}
[0m12:36:38.078891 [debug] [MainThread]: Flushing usage events
[0m13:56:59.564644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c9c50>]}


============================== 13:56:59.569260 | 21df9884-d5dc-4d63-a93e-008dee4fe9ee ==============================
[0m13:56:59.569260 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:56:59.569650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:56:59.622220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21df9884-d5dc-4d63-a93e-008dee4fe9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c9a10>]}
[0m13:56:59.629713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21df9884-d5dc-4d63-a93e-008dee4fe9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057229d0>]}
[0m13:56:59.630433 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:56:59.647606 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:56:59.678218 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 9 files added, 1 files changed.
[0m13:56:59.678647 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m13:56:59.678827 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m13:56:59.678988 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m13:56:59.679138 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m13:56:59.679288 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m13:56:59.679434 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m13:56:59.679576 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m13:56:59.679717 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m13:56:59.679858 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m13:56:59.680085 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:56:59.680219 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m13:56:59.680382 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m13:56:59.680523 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m13:56:59.680660 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m13:56:59.680798 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m13:56:59.680933 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m13:56:59.681063 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m13:56:59.681193 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m13:56:59.681323 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m13:56:59.692982 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:56:59.700562 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:56:59.703007 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:56:59.705100 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:56:59.707193 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m13:56:59.710813 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m13:56:59.712142 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:56:59.741834 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:56:59.744304 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:56:59.748408 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:56:59.789536 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/raw_netflix/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m13:56:59.790025 [debug] [MainThread]: Command `dbt run` failed at 13:56:59.789958 after 0.25 seconds
[0m13:56:59.790278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ca010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067acf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b3810>]}
[0m13:56:59.790522 [debug] [MainThread]: Flushing usage events
[0m13:57:11.779131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d79290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d92010>]}


============================== 13:57:11.782761 | a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564 ==============================
[0m13:57:11.782761 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:57:11.783114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.824102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d805d0>]}
[0m13:57:11.831088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e47ad0>]}
[0m13:57:11.831526 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:57:11.842646 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:57:11.862698 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 9 files added, 1 files changed.
[0m13:57:11.863087 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m13:57:11.863254 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m13:57:11.863402 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m13:57:11.863542 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m13:57:11.863677 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m13:57:11.863807 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m13:57:11.863946 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m13:57:11.864083 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m13:57:11.864219 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m13:57:11.864395 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:57:11.864559 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m13:57:11.864706 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m13:57:11.864847 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m13:57:11.864972 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m13:57:11.865098 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m13:57:11.865218 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m13:57:11.865332 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m13:57:11.865448 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m13:57:11.865565 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m13:57:11.877472 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:57:11.884668 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:57:11.886637 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:57:11.888549 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m13:57:11.891192 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m13:57:11.892184 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:57:11.894027 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:57:11.913939 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:57:11.915946 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:57:11.917768 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:57:11.954768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d906d0>]}
[0m13:57:11.959815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407410>]}
[0m13:57:11.960025 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m13:57:11.960238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3d090>]}
[0m13:57:11.961291 [info ] [MainThread]: 
[0m13:57:11.961816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:11.962581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:57:11.968088 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:57:11.968346 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:57:11.968487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:12.071567 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:57:12.072774 [debug] [ThreadPool]: On list_mydb: Close
[0m13:57:12.074168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m13:57:12.078759 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:12.079022 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:57:12.079233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:12.093477 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.093817 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:12.094080 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:57:12.114484 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m13:57:12.115806 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:57:12.116991 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:57:12.121964 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.122279 [debug] [MainThread]: On master: BEGIN
[0m13:57:12.122485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:12.136579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.137000 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.137446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:12.182748 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m13:57:12.184131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d807d0>]}
[0m13:57:12.184418 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:12.185145 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.185312 [debug] [MainThread]: On master: BEGIN
[0m13:57:12.186296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.186504 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.186665 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.186813 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.187856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:12.188054 [debug] [MainThread]: On master: Close
[0m13:57:12.188483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:12.188718 [info ] [MainThread]: 
[0m13:57:12.193387 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m13:57:12.193619 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m13:57:12.193804 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m13:57:12.194001 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m13:57:12.194240 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m13:57:12.194532 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m13:57:12.194820 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m13:57:12.195131 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m13:57:12.195579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m13:57:12.195937 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m13:57:12.196268 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m13:57:12.196621 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m13:57:12.196812 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m13:57:12.196986 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m13:57:12.197151 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m13:57:12.197301 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m13:57:12.198988 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m13:57:12.200494 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m13:57:12.201911 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m13:57:12.203464 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:57:12.204164 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 13:57:12.197426 => 13:57:12.204055
[0m13:57:12.204701 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m13:57:12.204911 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 13:57:12.199158 => 13:57:12.204825
[0m13:57:12.211323 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 13:57:12.200668 => 13:57:12.211020
[0m13:57:12.223751 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 13:57:12.202117 => 13:57:12.223563
[0m13:57:12.229846 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m13:57:12.230122 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m13:57:12.230346 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m13:57:12.230552 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m13:57:12.241675 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m13:57:12.244067 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m13:57:12.246418 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:57:12.246625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:12.247029 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.247253 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:12.247427 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m13:57:12.247639 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m13:57:12.247823 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:12.248001 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m13:57:12.248178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.248350 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:57:12.248521 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m13:57:12.248686 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:12.249001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:57:12.263870 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.264266 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:12.264496 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.269034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.269476 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:12.269965 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.270191 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.270553 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.270889 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m13:57:12.273828 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.274248 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:12.274467 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.283377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:57:12.287408 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.287764 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m13:57:12.289407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:12.291361 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.291616 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m13:57:12.292788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:12.303414 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:12.303726 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.303912 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:12.310183 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:12.313517 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.313832 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m13:57:12.323076 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:57:12.324603 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 13:57:12.230783 => 13:57:12.324448
[0m13:57:12.324842 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m13:57:12.325332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065db490>]}
[0m13:57:12.325728 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m13:57:12.327011 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m13:57:12.327317 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m13:57:12.327874 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m13:57:12.328923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m13:57:12.329244 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m13:57:12.331261 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m13:57:12.331734 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 13:57:12.329375 => 13:57:12.331628
[0m13:57:12.331956 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m13:57:12.334562 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m13:57:12.334992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:12.335200 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m13:57:12.335369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:12.345939 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.346253 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:12.346478 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:14.435474 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 2.0 seconds
[0m13:57:14.443447 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.443797 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m13:57:14.460471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.465205 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.465467 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m13:57:14.475805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.481700 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:14.482008 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.482183 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:14.593525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.600537 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.601214 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 2.0 seconds
[0m13:57:14.601870 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m13:57:14.604684 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.605062 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m13:57:14.615723 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.618810 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.619089 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:57:14.681689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.687192 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:14.687767 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:14.688430 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.690532 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 13:57:12.205029 => 13:57:14.690144
[0m13:57:14.690960 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:14.691210 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m13:57:14.691990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661b1d0>]}
[0m13:57:14.692643 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 2.50s]
[0m13:57:14.693070 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m13:57:14.732155 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.734197 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.734486 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:57:14.789192 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:14.790334 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 13:57:12.244258 => 13:57:14.790210
[0m13:57:14.790720 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m13:57:14.790915 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 3.0 seconds
[0m13:57:14.791450 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106564a10>]}
[0m13:57:14.793288 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.793655 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 2.59s]
[0m13:57:14.793940 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m13:57:14.794370 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m13:57:14.796952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.799302 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.799686 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m13:57:14.807952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.813917 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:14.814471 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.814973 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:14.863077 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.864634 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.864823 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m13:57:15.086116 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 3.0 seconds
[0m13:57:15.092667 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.093327 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m13:57:15.101559 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:15.103272 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.103494 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m13:57:15.104411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:15.105772 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:15.105951 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.106108 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:15.164469 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:15.169026 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.169582 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m13:57:15.393625 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:15.396014 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 13:57:12.332094 => 13:57:15.395852
[0m13:57:15.396290 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m13:57:15.396881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bb990>]}
[0m13:57:15.397265 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 3.07s]
[0m13:57:15.397635 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m13:57:15.513907 [debug] [Thread-3 (]: SQL status: DROP TABLE in 1.0 seconds
[0m13:57:15.517548 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 13:57:12.241861 => 13:57:15.517157
[0m13:57:15.518319 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m13:57:15.519501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bc1d0>]}
[0m13:57:15.520404 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 3.32s]
[0m13:57:15.521371 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m13:57:15.522523 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m13:57:15.522805 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.523040 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m13:57:15.523330 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m13:57:15.523643 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m13:57:15.523966 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m13:57:15.524295 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m13:57:15.524630 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m13:57:15.525135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m13:57:15.525507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m13:57:15.525828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m13:57:15.526516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m13:57:15.526817 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m13:57:15.527015 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.527195 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m13:57:15.527370 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m13:57:15.529163 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m13:57:15.530655 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.531994 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m13:57:15.533311 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m13:57:15.533801 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 13:57:15.527515 => 13:57:15.533701
[0m13:57:15.534000 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 13:57:15.529321 => 13:57:15.533907
[0m13:57:15.534209 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m13:57:15.534388 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 13:57:15.530801 => 13:57:15.534309
[0m13:57:15.534565 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 13:57:15.532137 => 13:57:15.534486
[0m13:57:15.534737 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.536954 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m13:57:15.537133 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m13:57:15.537306 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m13:57:15.540388 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.543245 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m13:57:15.545712 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m13:57:15.545940 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:15.546363 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.546563 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:15.546753 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m13:57:15.546915 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:15.547085 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m13:57:15.547272 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m13:57:15.547467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:15.547634 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m13:57:15.547797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:57:15.547951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:15.548206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:57:15.560616 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561252 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561523 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.561745 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:15.561940 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:15.562156 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:15.562398 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m13:57:15.562598 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:15.562817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.563355 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:15.563562 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m13:57:16.001970 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:16.007470 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.008022 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m13:57:16.010601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.014310 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.014810 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m13:57:16.015276 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:16.016876 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.017089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.017294 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m13:57:16.018732 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:16.019067 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.019236 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:16.024185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.026125 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.026386 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m13:57:16.027510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.028899 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:16.029091 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.029257 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:16.043401 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.045013 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.045225 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m13:57:16.045820 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.047196 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.047398 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m13:57:16.071792 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.074326 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 13:57:15.537432 => 13:57:16.073974
[0m13:57:16.074691 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m13:57:16.075301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dccd0>]}
[0m13:57:16.075787 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.55s]
[0m13:57:16.076497 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:16.080093 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.081542 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 13:57:15.540899 => 13:57:16.081430
[0m13:57:16.081828 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m13:57:16.082304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106477550>]}
[0m13:57:16.083027 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.56s]
[0m13:57:16.083721 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m13:57:16.330901 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m13:57:16.334472 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.334703 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m13:57:16.336479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.338632 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.338882 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m13:57:16.340077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.342091 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:16.342388 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.342571 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:16.353333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.355145 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.355400 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m13:57:16.363011 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.363957 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 13:57:15.534857 => 13:57:16.363863
[0m13:57:16.364167 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m13:57:16.364597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106559790>]}
[0m13:57:16.364921 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.84s]
[0m13:57:16.365382 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m13:57:16.632337 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:16.638586 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.639536 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m13:57:16.641072 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.644189 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.644505 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m13:57:16.645401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.646881 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:16.647076 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.647239 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:16.679912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.683959 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.684578 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m13:57:16.843728 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.847420 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 13:57:15.543495 => 13:57:16.847021
[0m13:57:16.848169 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m13:57:16.849398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648d8d0>]}
[0m13:57:16.850304 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.32s]
[0m13:57:16.851207 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m13:57:16.852875 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:16.853129 [debug] [MainThread]: On master: BEGIN
[0m13:57:16.853281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:16.862457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:16.862761 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.862961 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:16.863145 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.863758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.863928 [debug] [MainThread]: On master: Close
[0m13:57:16.864289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:16.864435 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m13:57:16.864560 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m13:57:16.864677 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m13:57:16.864791 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m13:57:16.864979 [info ] [MainThread]: 
[0m13:57:16.865204 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m13:57:16.866098 [debug] [MainThread]: Command end result
[0m13:57:16.871273 [info ] [MainThread]: 
[0m13:57:16.871656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:16.871900 [info ] [MainThread]: 
[0m13:57:16.872117 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:57:16.872589 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:16.872539 after 5.11 seconds
[0m13:57:16.872819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ad6d0>]}
[0m13:57:16.873011 [debug] [MainThread]: Flushing usage events
[0m13:57:53.177704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410e010>]}


============================== 13:57:53.181295 | 85e14ded-19c4-4242-837f-2e1a69adfe02 ==============================
[0m13:57:53.181295 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:57:53.181652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:53.224288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f1f90>]}
[0m13:57:53.231642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c3690>]}
[0m13:57:53.232022 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:57:53.243372 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:57:53.264633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:53.265311 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:57:53.276722 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:57:53.283954 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:57:53.285900 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:57:53.287804 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:57:53.289693 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:57:53.291929 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:57:53.293723 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:57:53.295515 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:57:53.356610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104849210>]}
[0m13:57:53.360489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ceb10>]}
[0m13:57:53.360699 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:53.360909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101eb9090>]}
[0m13:57:53.361888 [info ] [MainThread]: 
[0m13:57:53.362289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:53.362956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:57:53.368287 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:57:53.368543 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:57:53.368682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:53.442508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:57:53.443580 [debug] [ThreadPool]: On list_mydb: Close
[0m13:57:53.444804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m13:57:53.448922 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:53.449169 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:57:53.449358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:53.464925 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.465233 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:53.465469 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:57:53.475341 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m13:57:53.476506 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:57:53.477486 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:57:53.481986 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.482244 [debug] [MainThread]: On master: BEGIN
[0m13:57:53.482442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:53.492672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.493010 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.493313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:53.521105 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m13:57:53.522908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041eec10>]}
[0m13:57:53.523263 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:53.524187 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.524439 [debug] [MainThread]: On master: BEGIN
[0m13:57:53.526294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.526562 [debug] [MainThread]: On master: COMMIT
[0m13:57:53.526793 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.527015 [debug] [MainThread]: On master: COMMIT
[0m13:57:53.528159 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.528383 [debug] [MainThread]: On master: Close
[0m13:57:53.528881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:53.529181 [info ] [MainThread]: 
[0m13:57:53.532342 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m13:57:53.532605 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m13:57:53.532852 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m13:57:53.533061 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m13:57:53.533373 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m13:57:53.533784 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m13:57:53.534172 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m13:57:53.534567 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m13:57:53.535150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m13:57:53.535636 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m13:57:53.536113 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m13:57:53.536571 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m13:57:53.536829 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m13:57:53.537064 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m13:57:53.537291 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m13:57:53.537513 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m13:57:53.539791 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m13:57:53.542056 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m13:57:53.544072 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m13:57:53.545775 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:57:53.546599 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 13:57:53.540042 => 13:57:53.546457
[0m13:57:53.546908 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 13:57:53.537683 => 13:57:53.546792
[0m13:57:53.547183 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 13:57:53.542297 => 13:57:53.547058
[0m13:57:53.547408 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m13:57:53.547658 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 13:57:53.544260 => 13:57:53.547552
[0m13:57:53.547881 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m13:57:53.548115 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m13:57:53.570605 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m13:57:53.570879 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m13:57:53.583184 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m13:57:53.585586 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m13:57:53.587887 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:57:53.588376 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:53.588565 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.588757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.588926 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:53.589101 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m13:57:53.589294 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m13:57:53.589472 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m13:57:53.589648 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m13:57:53.589819 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:53.589995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:53.590166 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:57:53.590326 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:57:53.604653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.605004 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:53.605233 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.608815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.609445 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.609686 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.610234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.610552 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:53.610769 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.612489 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.612811 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.613061 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m13:57:53.630983 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:57:53.635508 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.635788 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m13:57:53.637770 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.639758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.639975 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m13:57:53.641430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.651891 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:53.652179 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.652363 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:53.658234 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.662351 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.662680 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m13:57:53.672629 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:57:53.673893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 13:57:53.548273 => 13:57:53.673728
[0m13:57:53.674281 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m13:57:53.674736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8110>]}
[0m13:57:53.675089 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m13:57:53.675983 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m13:57:53.676276 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m13:57:53.676861 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m13:57:53.678389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m13:57:53.678822 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m13:57:53.681601 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m13:57:53.682576 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 13:57:53.678975 => 13:57:53.682440
[0m13:57:53.682796 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m13:57:53.686945 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m13:57:53.687538 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:53.688377 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m13:57:53.688807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:53.751645 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.752018 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:53.752264 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.888812 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m13:57:53.890548 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.890884 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m13:57:53.892330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.893913 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.894156 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m13:57:53.895401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.899571 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:53.899852 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.900023 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:53.952751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.956346 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.956910 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m13:57:53.962512 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:53.964641 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 13:57:53.571042 => 13:57:53.964382
[0m13:57:53.965139 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m13:57:53.966105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a3eb10>]}
[0m13:57:53.966830 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.43s]
[0m13:57:53.967646 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m13:57:54.097750 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:54.103900 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.104443 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m13:57:54.106462 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.110039 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.110346 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:57:54.112148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.113509 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:54.113696 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.113859 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:54.189554 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.195025 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.195585 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:57:54.217202 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.219720 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 13:57:53.585819 => 13:57:54.219429
[0m13:57:54.220392 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m13:57:54.221550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483ae10>]}
[0m13:57:54.222614 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.69s]
[0m13:57:54.223821 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m13:57:54.481122 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:54.484878 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.485154 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m13:57:54.486723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.488501 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.488702 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m13:57:54.489734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.491041 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:54.491221 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.491383 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:54.531813 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.533241 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.533421 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m13:57:54.556818 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.559050 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 13:57:53.683330 => 13:57:54.558800
[0m13:57:54.559586 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m13:57:54.560160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049691d0>]}
[0m13:57:54.560515 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.88s]
[0m13:57:54.560848 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m13:57:54.753201 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m13:57:54.757139 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.757388 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m13:57:54.758485 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.760097 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.760274 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m13:57:54.761123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.762374 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:54.762564 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.762727 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:54.782357 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.785036 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.785302 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m13:57:54.851009 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.851956 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 13:57:53.583399 => 13:57:54.851862
[0m13:57:54.852162 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m13:57:54.852579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049934d0>]}
[0m13:57:54.852904 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 1.32s]
[0m13:57:54.853229 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m13:57:54.853772 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m13:57:54.853996 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.854193 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m13:57:54.854568 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m13:57:54.854402 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m13:57:54.854831 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m13:57:54.855282 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m13:57:54.855608 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m13:57:54.856088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m13:57:54.856402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m13:57:54.856716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m13:57:54.857017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m13:57:54.857214 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m13:57:54.857395 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.857566 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m13:57:54.857727 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m13:57:54.859744 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m13:57:54.861342 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.862933 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m13:57:54.864396 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m13:57:54.865043 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 13:57:54.859917 => 13:57:54.864932
[0m13:57:54.865306 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 13:57:54.857865 => 13:57:54.865193
[0m13:57:54.865598 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 13:57:54.861517 => 13:57:54.865494
[0m13:57:54.865780 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.866161 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m13:57:54.866412 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 13:57:54.863097 => 13:57:54.866327
[0m13:57:54.866589 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m13:57:54.869817 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.874380 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m13:57:54.874749 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m13:57:54.877399 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m13:57:54.880385 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m13:57:54.880757 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.881014 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:54.881232 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:54.881415 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m13:57:54.881605 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m13:57:54.881770 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:54.881953 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m13:57:54.882132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:57:54.882297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:54.882471 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m13:57:54.882627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:54.882952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:57:54.904998 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.905408 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.905620 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:54.907660 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.908006 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:54.908213 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:54.910337 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.910619 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:54.910830 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m13:57:54.916074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.916505 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:54.916753 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m13:57:55.325947 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:55.334123 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.334473 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m13:57:55.336841 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.339100 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.339390 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m13:57:55.340671 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.342506 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:55.343134 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:55.343711 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.346306 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.346550 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:55.346737 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m13:57:55.348158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.349998 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.350265 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m13:57:55.351365 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.352739 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:55.352933 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.353095 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:55.401799 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.402392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.406147 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.407668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.407907 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m13:57:55.408113 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m13:57:55.413045 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.414308 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 13:57:54.874912 => 13:57:55.414075
[0m13:57:55.414561 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m13:57:55.415266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dbbd0>]}
[0m13:57:55.415861 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.56s]
[0m13:57:55.416279 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m13:57:55.420270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.421686 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 13:57:54.866717 => 13:57:55.421572
[0m13:57:55.421961 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m13:57:55.422776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c0ad0>]}
[0m13:57:55.423123 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.57s]
[0m13:57:55.423457 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:55.733679 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m13:57:55.738714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.739400 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m13:57:55.740871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.745502 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.746025 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m13:57:55.747119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.748732 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:55.748944 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.749127 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:55.750960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.752614 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.752842 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m13:57:55.755805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.756627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 13:57:54.870118 => 13:57:55.756537
[0m13:57:55.756810 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m13:57:55.757271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cdf50>]}
[0m13:57:55.757684 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.90s]
[0m13:57:55.758244 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m13:57:55.964540 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:55.968875 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.969519 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m13:57:55.971149 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.974616 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.974912 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m13:57:55.975714 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.977085 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:55.977272 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.977445 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:55.978308 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.980702 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.980901 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m13:57:55.994404 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.996810 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 13:57:54.877906 => 13:57:55.996473
[0m13:57:55.997435 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m13:57:55.998148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f92d0>]}
[0m13:57:55.998524 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.14s]
[0m13:57:55.998914 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m13:57:56.000304 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:56.000507 [debug] [MainThread]: On master: BEGIN
[0m13:57:56.000723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:56.023803 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:56.024254 [debug] [MainThread]: On master: COMMIT
[0m13:57:56.024641 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:56.024899 [debug] [MainThread]: On master: COMMIT
[0m13:57:56.027064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:56.027359 [debug] [MainThread]: On master: Close
[0m13:57:56.028179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:56.028476 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m13:57:56.028690 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m13:57:56.028986 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m13:57:56.029374 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m13:57:56.029623 [info ] [MainThread]: 
[0m13:57:56.030207 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m13:57:56.033347 [debug] [MainThread]: Command end result
[0m13:57:56.043517 [info ] [MainThread]: 
[0m13:57:56.044180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:56.044827 [info ] [MainThread]: 
[0m13:57:56.045362 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:57:56.046310 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:56.046234 after 2.88 seconds
[0m13:57:56.046674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100688690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007d1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007d1dd0>]}
[0m13:57:56.046950 [debug] [MainThread]: Flushing usage events
[0m14:00:19.215080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d74f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75cd0>]}


============================== 14:00:19.218725 | 5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8 ==============================
[0m14:00:19.218725 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:19.219113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:19.264956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75b50>]}
[0m14:00:19.271930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccef90>]}
[0m14:00:19.272318 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:00:19.281834 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:19.303768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:00:19.304166 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:00:19.315924 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/sum_total_customers_by_gender.sql
[0m14:00:19.345481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e56510>]}
[0m14:00:19.348545 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:00:19.351520 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:00:19.352098 [debug] [MainThread]: Command `dbt run` failed at 14:00:19.352034 after 0.15 seconds
[0m14:00:19.352305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102439dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058155d0>]}
[0m14:00:19.352499 [debug] [MainThread]: Flushing usage events
[0m14:01:02.900985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106905290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691e190>]}


============================== 14:01:02.904842 | d9a3242c-9cbc-4c9e-b9e0-7d5d3befd164 ==============================
[0m14:01:02.904842 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:01:02.905205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:02.945765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a3242c-9cbc-4c9e-b9e0-7d5d3befd164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691db50>]}
[0m14:01:02.952748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9a3242c-9cbc-4c9e-b9e0-7d5d3befd164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb410>]}
[0m14:01:02.953110 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:01:02.962784 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:01:02.985119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:02.985921 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:01:02.997500 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:01:03.004908 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:01:03.006819 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:01:03.008649 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:01:03.010459 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:01:03.012674 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:01:03.014447 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:01:03.016204 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:01:03.070530 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:01:03.070979 [debug] [MainThread]: Command `dbt run` failed at 14:01:03.070915 after 0.19 seconds
[0m14:01:03.071184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106900e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106907b50>]}
[0m14:01:03.071445 [debug] [MainThread]: Flushing usage events
[0m14:04:23.542216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c61290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c78d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c79a90>]}


============================== 14:04:23.545829 | 4da38b03-0074-46cd-a49e-6e8e5825c9d9 ==============================
[0m14:04:23.545829 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:04:23.546201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:04:23.587824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4da38b03-0074-46cd-a49e-6e8e5825c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c881d0>]}
[0m14:04:23.594770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4da38b03-0074-46cd-a49e-6e8e5825c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c575d0>]}
[0m14:04:23.595119 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:04:23.605786 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:04:23.627635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:23.628305 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:04:23.639674 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:04:23.646939 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:04:23.648852 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:04:23.650734 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:04:23.652569 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:04:23.654778 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:04:23.656555 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:04:23.658320 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:04:23.713503 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:04:23.713981 [debug] [MainThread]: Command `dbt run` failed at 14:04:23.713915 after 0.19 seconds
[0m14:04:23.714189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c61190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d57f10>]}
[0m14:04:23.714398 [debug] [MainThread]: Flushing usage events
[0m14:05:52.910690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cff90>]}


============================== 14:05:52.914341 | 7ed463a9-29a6-4153-87a0-c3205013bb60 ==============================
[0m14:05:52.914341 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:05:52.914705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.957691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049043d0>]}
[0m14:05:52.964674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fd990>]}
[0m14:05:52.965115 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:05:52.976206 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:05:52.999088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:52.999746 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:05:53.011245 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:05:53.018537 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:05:53.020486 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:05:53.022331 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:05:53.024142 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:05:53.026353 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:05:53.028120 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:05:53.029873 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:05:53.090273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ffd10>]}
[0m14:05:53.093417 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:05:53.096308 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:05:53.096985 [debug] [MainThread]: Command `dbt run` failed at 14:05:53.096907 after 0.20 seconds
[0m14:05:53.097221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a8850>]}
[0m14:05:53.097427 [debug] [MainThread]: Flushing usage events
[0m14:07:31.660217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f13f90>]}


============================== 14:07:31.663791 | 657c0565-2c0d-40bb-8353-71df4e5dcacc ==============================
[0m14:07:31.663791 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:07:31.664137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:31.710581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '657c0565-2c0d-40bb-8353-71df4e5dcacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19f50>]}
[0m14:07:31.717738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '657c0565-2c0d-40bb-8353-71df4e5dcacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4ae50>]}
[0m14:07:31.718116 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:07:31.727811 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:07:31.750223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:07:31.750641 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/banking.sql
[0m14:07:31.762312 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/banking.sql
[0m14:07:31.768912 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.banking' (models/raw_banking/banking.sql) depends on a source named 'raw.raw_banking' which was not found
[0m14:07:31.769351 [debug] [MainThread]: Command `dbt run` failed at 14:07:31.769280 after 0.12 seconds
[0m14:07:31.769583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f9e90>]}
[0m14:07:31.769812 [debug] [MainThread]: Flushing usage events
[0m14:07:50.496198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0ff90>]}


============================== 14:07:50.499648 | 2ac2ec6a-e240-469d-9199-570fe67e108c ==============================
[0m14:07:50.499648 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:07:50.499998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:50.540646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ac2ec6a-e240-469d-9199-570fe67e108c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0f450>]}
[0m14:07:50.547645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ac2ec6a-e240-469d-9199-570fe67e108c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b01ad0>]}
[0m14:07:50.548023 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:07:50.558350 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:07:50.579198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:07:50.579564 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/banking.sql
[0m14:07:50.580093 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:07:50.591788 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/banking.sql
[0m14:07:50.599124 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:07:50.601171 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:07:50.603036 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:07:50.604867 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:07:50.607114 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:07:50.608876 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:07:50.610650 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:07:50.612430 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:07:50.666938 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:07:50.667416 [debug] [MainThread]: Command `dbt run` failed at 14:07:50.667351 after 0.19 seconds
[0m14:07:50.667641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b00d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213d150>]}
[0m14:07:50.667883 [debug] [MainThread]: Flushing usage events
[0m14:11:48.932799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106205290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f34bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c410>]}


============================== 14:11:48.936357 | 164f11b8-a005-47bf-87b6-f511066656b0 ==============================
[0m14:11:48.936357 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:11:48.936722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:48.981384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '164f11b8-a005-47bf-87b6-f511066656b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621f050>]}
[0m14:11:48.988680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '164f11b8-a005-47bf-87b6-f511066656b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c0d0>]}
[0m14:11:48.989102 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:11:49.000821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:11:49.023245 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:11:49.023585 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:11:49.023761 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:11:49.023905 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:11:49.024042 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:11:49.024179 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:11:49.024311 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:11:49.024443 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:11:49.024577 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:11:49.024706 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:11:49.024837 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:11:49.024965 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:11:49.025163 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:11:49.025307 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:11:49.025437 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:11:49.025561 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:11:49.025672 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:11:49.025795 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:11:49.025915 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:11:49.026037 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:11:49.026158 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:11:49.026274 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:11:49.026386 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:11:49.037116 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:11:49.044392 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:11:49.046351 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:11:49.048173 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:11:49.050654 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:11:49.051602 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:11:49.053404 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:11:49.073783 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:11:49.075823 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:11:49.077665 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:11:49.079441 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:11:49.081278 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:11:49.118916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movie_viewings' (models/facts/movie_viewings.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:11:49.119371 [debug] [MainThread]: Command `dbt run` failed at 14:11:49.119282 after 0.20 seconds
[0m14:11:49.119615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106200f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c47a50>]}
[0m14:11:49.119831 [debug] [MainThread]: Flushing usage events
[0m14:12:17.206661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ba190>]}


============================== 14:12:17.210163 | 95406de0-ecee-43be-b0c8-ed5a841ba26e ==============================
[0m14:12:17.210163 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:12:17.210548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:17.251172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95406de0-ecee-43be-b0c8-ed5a841ba26e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854bb90>]}
[0m14:12:17.258154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95406de0-ecee-43be-b0c8-ed5a841ba26e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a11f10>]}
[0m14:12:17.258496 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:12:17.269580 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:12:17.290908 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:12:17.291246 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:12:17.291408 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:12:17.291553 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:12:17.291687 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:12:17.291823 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:12:17.291953 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:12:17.292086 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:12:17.292220 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:12:17.292351 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:12:17.292482 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:12:17.292608 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:12:17.292808 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:12:17.292947 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:12:17.293076 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:12:17.293203 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:12:17.293326 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:12:17.293446 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:12:17.293567 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:12:17.293679 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:12:17.293799 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:12:17.293913 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:12:17.294031 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:12:17.305553 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:12:17.312823 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:12:17.314801 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:12:17.316611 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:12:17.319131 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:12:17.320085 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:12:17.321859 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:12:17.341108 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:12:17.343043 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:12:17.344828 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:12:17.346608 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:12:17.348431 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:12:17.385761 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/facts/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:12:17.386185 [debug] [MainThread]: Command `dbt run` failed at 14:12:17.386124 after 0.19 seconds
[0m14:12:17.386399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085350d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a11d0>]}
[0m14:12:17.386590 [debug] [MainThread]: Flushing usage events
[0m14:12:51.905357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109905b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991de50>]}


============================== 14:12:51.908977 | 1029ae14-9ca1-41fe-9ca0-3264d72c9278 ==============================
[0m14:12:51.908977 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:12:51.909358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:51.951208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1029ae14-9ca1-41fe-9ca0-3264d72c9278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992e010>]}
[0m14:12:51.958221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1029ae14-9ca1-41fe-9ca0-3264d72c9278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991dc90>]}
[0m14:12:51.958573 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:12:51.971668 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:12:51.993278 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:12:51.993614 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:12:51.993776 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:12:51.993919 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:12:51.994056 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:12:51.994191 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:12:51.994326 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:12:51.994467 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:12:51.994610 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:12:51.994750 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:12:51.994885 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:12:51.995017 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:12:51.995232 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:12:51.995388 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:12:51.995528 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:12:51.995656 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:12:51.995782 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:12:51.995907 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:12:51.996026 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:12:51.996148 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:12:51.996259 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:12:51.996371 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:12:51.996507 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:12:52.007953 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:12:52.015156 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:12:52.017016 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:12:52.019471 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:12:52.020448 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:12:52.022279 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:12:52.024078 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:12:52.043684 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:12:52.045752 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:12:52.047575 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:12:52.049357 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:12:52.051187 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:12:52.088556 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movie_viewings' (models/facts/movie_viewings.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:12:52.088962 [debug] [MainThread]: Command `dbt run` failed at 14:12:52.088899 after 0.20 seconds
[0m14:12:52.089172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109900d90>]}
[0m14:12:52.089370 [debug] [MainThread]: Flushing usage events
[0m14:13:01.915325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ded290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05fd0>]}


============================== 14:13:01.919089 | 042b1575-f184-427d-89bf-f0cc3c626d1a ==============================
[0m14:13:01.919089 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:13:01.919552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:01.952544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '042b1575-f184-427d-89bf-f0cc3c626d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e165d0>]}
[0m14:13:01.959491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '042b1575-f184-427d-89bf-f0cc3c626d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebb990>]}
[0m14:13:01.959844 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:13:01.971113 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:13:01.993893 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:13:01.994335 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:13:01.994516 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:13:01.994673 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:13:01.994816 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:13:01.994954 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:13:01.995091 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:13:01.995223 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:13:01.995360 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:13:01.995494 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:13:01.995626 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:13:01.995758 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:13:01.995986 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:13:01.996139 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:13:01.996272 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:13:01.996393 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:13:01.996527 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:13:01.996656 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:13:01.996782 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:13:01.996910 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:13:01.997032 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:13:01.997153 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:13:01.997266 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:13:02.007940 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:13:02.015277 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:13:02.017171 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:13:02.018997 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:13:02.020840 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:13:02.023002 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:13:02.042436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:13:02.043575 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:13:02.045475 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:13:02.047265 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:13:02.049000 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:13:02.050830 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:13:02.088187 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/facts/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:13:02.088596 [debug] [MainThread]: Command `dbt run` failed at 14:13:02.088527 after 0.19 seconds
[0m14:13:02.088803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df40d0>]}
[0m14:13:02.089013 [debug] [MainThread]: Flushing usage events
[0m14:13:31.086255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c3f90>]}


============================== 14:13:31.089813 | 5aa46b7b-726e-4ae6-8279-a4ee1c73339e ==============================
[0m14:13:31.089813 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:13:31.090160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:31.130495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aa46b7b-726e-4ae6-8279-a4ee1c73339e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f5d50>]}
[0m14:13:31.137514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aa46b7b-726e-4ae6-8279-a4ee1c73339e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610f010>]}
[0m14:13:31.137879 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:13:31.148979 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:13:31.169652 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:13:31.169992 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:13:31.170160 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:13:31.170306 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:13:31.170443 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:13:31.170577 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:13:31.170710 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:13:31.170841 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:13:31.170975 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:13:31.171104 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:13:31.171233 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:13:31.171359 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:13:31.171557 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:13:31.171704 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:13:31.171830 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:13:31.171946 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:13:31.172074 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:13:31.172197 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:13:31.172317 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:13:31.172426 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:13:31.172546 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:13:31.172665 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:13:31.172779 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:13:31.184478 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:13:31.191715 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:13:31.193621 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:13:31.195503 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:13:31.197439 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:13:31.199633 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:13:31.219016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:13:31.220270 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:13:31.222144 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:13:31.223946 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:13:31.225726 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:13:31.227576 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:13:31.265193 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/facts/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:13:31.265619 [debug] [MainThread]: Command `dbt run` failed at 14:13:31.265525 after 0.20 seconds
[0m14:13:31.265863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cf110>]}
[0m14:13:31.266082 [debug] [MainThread]: Flushing usage events

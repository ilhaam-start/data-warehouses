[0m12:26:14.235820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108164410>]}


============================== 12:26:14.239466 | 2a429d10-1037-4619-a0bf-134dcf1ba90b ==============================
[0m12:26:14.239466 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:26:14.239858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:26:14.240190 [info ] [MainThread]: dbt version: 1.5.3
[0m12:26:14.240416 [info ] [MainThread]: python version: 3.11.2
[0m12:26:14.240630 [info ] [MainThread]: python path: /Users/ilhaam.ahmed/.pyenv/versions/3.11.2/bin/python3.11
[0m12:26:14.240817 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m12:26:14.240997 [info ] [MainThread]: Using profiles.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/profiles.yml
[0m12:26:14.241194 [info ] [MainThread]: Using dbt_project.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/dbt_project.yml
[0m12:26:14.241365 [info ] [MainThread]: Configuration:
[0m12:26:14.275994 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:26:14.285577 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:26:14.285953 [info ] [MainThread]: Required dependencies:
[0m12:26:14.286274 [debug] [MainThread]: Executing "git --help"
[0m12:26:14.300230 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:26:14.300834 [debug] [MainThread]: STDERR: "b''"
[0m12:26:14.301006 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:26:14.301211 [info ] [MainThread]: Connection:
[0m12:26:14.301519 [info ] [MainThread]:   host: localhost
[0m12:26:14.301726 [info ] [MainThread]:   port: 5433
[0m12:26:14.301910 [info ] [MainThread]:   user: postgres
[0m12:26:14.302078 [info ] [MainThread]:   database: mydb
[0m12:26:14.302250 [info ] [MainThread]:   schema: dbt_warehouse
[0m12:26:14.302413 [info ] [MainThread]:   search_path: None
[0m12:26:14.302571 [info ] [MainThread]:   keepalives_idle: 0
[0m12:26:14.302737 [info ] [MainThread]:   sslmode: None
[0m12:26:14.303365 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:26:14.351980 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:26:14.352585 [debug] [MainThread]: Using postgres connection "debug"
[0m12:26:14.352774 [debug] [MainThread]: On debug: select 1 as id
[0m12:26:14.352969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:14.456247 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:26:14.457461 [debug] [MainThread]: On debug: Close
[0m12:26:14.457745 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:26:14.458061 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:26:14.458678 [debug] [MainThread]: Command `dbt debug` succeeded at 12:26:14.458569 after 0.24 seconds
[0m12:26:14.458958 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:26:14.459245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e40bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104839dd0>]}
[0m12:26:14.459606 [debug] [MainThread]: Flushing usage events
[0m13:52:26.676660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b65290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7e610>]}


============================== 13:52:26.680294 | aa10f4ec-db41-42b5-8e28-5fbdffcca489 ==============================
[0m13:52:26.680294 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:52:26.680676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:52:26.723630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b90790>]}
[0m13:52:26.730558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c332d0>]}
[0m13:52:26.730924 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:52:26.741617 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:52:26.742080 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:26.742345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43550>]}
[0m13:52:27.020742 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m13:52:27.049121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34490>]}
[0m13:52:27.051893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b99290>]}
[0m13:52:27.052107 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m13:52:27.052313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102929090>]}
[0m13:52:27.053054 [info ] [MainThread]: 
[0m13:52:27.053519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:27.054069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:52:27.059627 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:52:27.059917 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:52:27.060063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:27.192877 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:52:27.194282 [debug] [ThreadPool]: On list_mydb: Close
[0m13:52:27.195472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now create_mydb_dbt_warehouse)
[0m13:52:27.196229 [debug] [ThreadPool]: Creating schema "database: "mydb"
schema: "dbt_warehouse"
"
[0m13:52:27.201149 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.201473 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: BEGIN
[0m13:52:27.201706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.219554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.219933 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.220190 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "create_mydb_dbt_warehouse"} */
create schema if not exists "dbt_warehouse"
[0m13:52:27.226989 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:52:27.227971 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.228253 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.228499 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.229854 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.230129 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: Close
[0m13:52:27.231578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydb_dbt_warehouse, now list_mydb_dbt_warehouse)
[0m13:52:27.237782 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.238131 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:52:27.238365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.253413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.253849 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.254132 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:52:27.270032 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:52:27.271259 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:52:27.272522 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:52:27.276904 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.277267 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.277523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:27.293826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.294162 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.294475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:27.332359 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m13:52:27.333327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c41a10>]}
[0m13:52:27.333567 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:27.334183 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.334332 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.335181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.335369 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.335518 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.335656 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.336177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.336353 [debug] [MainThread]: On master: Close
[0m13:52:27.336735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:27.336971 [info ] [MainThread]: 
[0m13:52:27.342289 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m13:52:27.342573 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m13:52:27.342971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m13:52:27.343142 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m13:52:27.344539 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:52:27.345042 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 13:52:27.343256 => 13:52:27.344947
[0m13:52:27.345214 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m13:52:27.363406 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:52:27.364036 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.364210 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m13:52:27.364370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:27.374858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.375151 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.375328 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m13:52:27.392308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:27.395547 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.395725 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:52:27.396965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:27.404734 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.404974 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.405132 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.406809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.409217 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.409404 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:52:27.410450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:27.411861 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 13:52:27.345325 => 13:52:27.411776
[0m13:52:27.412033 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m13:52:27.412399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537fb90>]}
[0m13:52:27.412688 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:52:27.413044 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m13:52:27.413818 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.413989 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.414127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:27.423508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.423783 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.423965 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.424111 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.424657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.424836 [debug] [MainThread]: On master: Close
[0m13:52:27.425187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:27.425331 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m13:52:27.425482 [info ] [MainThread]: 
[0m13:52:27.425672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:52:27.426058 [debug] [MainThread]: Command end result
[0m13:52:27.429100 [info ] [MainThread]: 
[0m13:52:27.429354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:27.429546 [info ] [MainThread]: 
[0m13:52:27.429743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:27.430082 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:27.430028 after 0.77 seconds
[0m13:52:27.430280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241dd0>]}
[0m13:52:27.430462 [debug] [MainThread]: Flushing usage events
[0m14:00:06.923103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06f50>]}


============================== 14:00:06.926738 | 9ef958ac-c326-40b4-aeb2-e691566c55a1 ==============================
[0m14:00:06.926738 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:06.927095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:06.968739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835c10>]}
[0m14:00:06.975720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f389d0>]}
[0m14:00:06.976095 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:00:06.986906 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:07.004326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:07.004564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:07.007813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879abd0>]}
[0m14:00:07.010917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087186d0>]}
[0m14:00:07.011147 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:00:07.011362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b15090>]}
[0m14:00:07.012241 [info ] [MainThread]: 
[0m14:00:07.012713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:07.013273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:00:07.018825 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:00:07.019123 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:00:07.019284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:07.081850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:00:07.082887 [debug] [ThreadPool]: On list_mydb: Close
[0m14:00:07.083791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:00:07.087471 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.087686 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:00:07.087858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:07.101379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.101689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.101906 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:00:07.111581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:00:07.112618 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:00:07.113505 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:00:07.116574 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.116823 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.117012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:07.130234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.130590 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.130913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:07.152393 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:00:07.154090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f3e50>]}
[0m14:00:07.154442 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:07.155396 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.155681 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.157019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.157250 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.157457 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.157656 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.158421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.158664 [debug] [MainThread]: On master: Close
[0m14:00:07.159170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:07.159473 [info ] [MainThread]: 
[0m14:00:07.162648 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:00:07.163068 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m14:00:07.163866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:00:07.164161 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:00:07.166170 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:00:07.166906 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:00:07.164342 => 14:00:07.166727
[0m14:00:07.167163 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:00:07.213938 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:00:07.214718 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.214912 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:00:07.215082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:07.224154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.224456 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.224645 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m14:00:07.234328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:00:07.237904 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.238119 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:00:07.239115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.240752 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.240951 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:00:07.242173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.251829 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.252040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.252224 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.254883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.257590 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.257790 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:00:07.261120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:00:07.261889 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:00:07.167313 => 14:00:07.261792
[0m14:00:07.262080 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:00:07.262477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1110>]}
[0m14:00:07.262812 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:00:07.263155 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:00:07.263995 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.264218 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.264381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:07.272218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.272527 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.272703 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.272855 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.273311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.273499 [debug] [MainThread]: On master: Close
[0m14:00:07.273853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:07.273997 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:00:07.274157 [info ] [MainThread]: 
[0m14:00:07.274364 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:00:07.274728 [debug] [MainThread]: Command end result
[0m14:00:07.278074 [info ] [MainThread]: 
[0m14:00:07.278355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:07.278571 [info ] [MainThread]: 
[0m14:00:07.278798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:07.279199 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:07.279142 after 0.37 seconds
[0m14:00:07.279416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442ddd0>]}
[0m14:00:07.279607 [debug] [MainThread]: Flushing usage events
[0m14:05:35.767644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006f50>]}


============================== 14:05:35.771199 | 034175d4-7d67-41d6-aae2-e41f66afff51 ==============================
[0m14:05:35.771199 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:05:35.771552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.812857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701d910>]}
[0m14:05:35.819827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702f0d0>]}
[0m14:05:35.820183 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:05:35.831018 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:05:35.848775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:35.849146 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:05:35.860302 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:05:35.870818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c3110>]}
[0m14:05:35.892339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ab4d0>]}
[0m14:05:35.892633 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:05:35.892848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5090>]}
[0m14:05:35.893574 [info ] [MainThread]: 
[0m14:05:35.894006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:35.894587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:05:35.900040 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:05:35.900283 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:05:35.900433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.983261 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:05:35.984470 [debug] [ThreadPool]: On list_mydb: Close
[0m14:05:35.985571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:05:35.989689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:35.989929 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:05:35.990119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.002024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.002289 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:36.002496 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:05:36.011510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:05:36.012684 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:05:36.013614 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:05:36.017116 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.017383 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.017581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:36.028720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.028992 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.029270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:36.050451 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:05:36.051943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16090>]}
[0m14:05:36.052305 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:36.053311 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.053537 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.054868 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.055101 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.055303 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.055497 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.056245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:36.056523 [debug] [MainThread]: On master: Close
[0m14:05:36.057046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:36.057372 [info ] [MainThread]: 
[0m14:05:36.060775 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:05:36.061188 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:05:36.061790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:05:36.062057 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:05:36.064206 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:05:36.065124 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:05:36.062232 => 14:05:36.064996
[0m14:05:36.065356 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:05:36.090105 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:05:36.091354 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.091560 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:05:36.091737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.101771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.102071 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.102278 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:05:37.468669 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:05:37.476258 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.476531 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:05:37.478081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.479736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.479929 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:05:37.480699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.492065 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.492271 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.492436 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.496382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.498965 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.499154 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:05:37.502157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:05:37.502968 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:05:36.065506 => 14:05:37.502872
[0m14:05:37.503146 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:05:37.503521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7cd0>]}
[0m14:05:37.503834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.44s]
[0m14:05:37.504157 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:05:37.505025 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.505211 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.505350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:37.517818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:37.518103 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.518258 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.518397 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.519061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.519265 [debug] [MainThread]: On master: Close
[0m14:05:37.519619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:37.519760 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:05:37.519916 [info ] [MainThread]: 
[0m14:05:37.520122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m14:05:37.520481 [debug] [MainThread]: Command end result
[0m14:05:37.523497 [info ] [MainThread]: 
[0m14:05:37.523766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:37.523948 [info ] [MainThread]: 
[0m14:05:37.524146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:37.524464 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:37.524416 after 1.77 seconds
[0m14:05:37.524657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde90>]}
[0m14:05:37.524846 [debug] [MainThread]: Flushing usage events
[0m14:06:18.492016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106737710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759e50>]}


============================== 14:06:18.495662 | 93c3510f-4610-440d-aa6a-e9d1619a3ed2 ==============================
[0m14:06:18.495662 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:18.496016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:18.537571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544909 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:18.554628 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:18.575371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:18.575827 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:18.587360 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:18.598080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839790>]}
[0m14:06:18.618526 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:18.621044 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:18.621662 [debug] [MainThread]: Command `dbt run` failed at 14:06:18.621588 after 0.14 seconds
[0m14:06:18.621879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681b110>]}
[0m14:06:18.622078 [debug] [MainThread]: Flushing usage events
[0m14:06:26.143579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c20d0>]}


============================== 14:06:26.146997 | 7ce145a1-6c34-45d2-8d05-9e2befcfa206 ==============================
[0m14:06:26.146997 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:26.147385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:26.180293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187683 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:26.197576 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:26.213972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:26.214222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:26.217566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7ce90>]}
[0m14:06:26.220323 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:26.222396 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:26.222992 [debug] [MainThread]: Command `dbt run` failed at 14:06:26.222914 after 0.09 seconds
[0m14:06:26.223201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102885dd0>]}
[0m14:06:26.223391 [debug] [MainThread]: Flushing usage events
[0m14:06:32.487972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108287750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829de50>]}


============================== 14:06:32.491425 | 5c947364-d1d9-4d4d-a03b-bb59702be088 ==============================
[0m14:06:32.491425 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:32.491763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:32.524418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b0510>]}
[0m14:06:32.531494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108286150>]}
[0m14:06:32.531888 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:32.541254 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:32.556488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:32.556822 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:32.567551 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:32.578062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108916850>]}
[0m14:06:32.599183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834ef50>]}
[0m14:06:32.599483 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:06:32.599697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106049090>]}
[0m14:06:32.600406 [info ] [MainThread]: 
[0m14:06:32.600869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:32.601427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:06:32.606715 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:06:32.607005 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:06:32.607162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:32.680926 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:06:32.682031 [debug] [ThreadPool]: On list_mydb: Close
[0m14:06:32.683155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:06:32.687270 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.687533 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:06:32.687728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:32.700071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.700385 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.700613 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:06:32.711235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:32.712315 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:06:32.713178 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:06:32.716355 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.716611 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.716801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:32.726431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.726701 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.726985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:32.744351 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:06:32.745617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad250>]}
[0m14:06:32.745932 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:32.746718 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.746913 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.748164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.748393 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.748595 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.748787 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.749581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:32.749877 [debug] [MainThread]: On master: Close
[0m14:06:32.750421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:32.750742 [info ] [MainThread]: 
[0m14:06:32.753796 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:06:32.754145 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:06:32.754661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:06:32.754893 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:06:32.756814 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:06:32.757627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:06:32.755047 => 14:06:32.757476
[0m14:06:32.757886 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:06:32.783213 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:06:32.784010 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.784238 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:06:32.784426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:32.793492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.793813 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.794016 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:06:33.143275 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:06:33.154582 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.154865 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:06:33.156060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.157736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.157926 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:06:33.158715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.169624 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.169830 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.169991 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.173486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.176107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.176309 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:06:33.182264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:33.183109 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:06:32.758050 => 14:06:33.183019
[0m14:06:33.183290 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:06:33.183665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894ee50>]}
[0m14:06:33.183990 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m14:06:33.184326 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:06:33.185204 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.185402 [debug] [MainThread]: On master: BEGIN
[0m14:06:33.185543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:33.194950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:33.195236 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.195392 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.195528 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.196087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.196262 [debug] [MainThread]: On master: Close
[0m14:06:33.196595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:33.196736 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:06:33.196890 [info ] [MainThread]: 
[0m14:06:33.197104 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m14:06:33.197477 [debug] [MainThread]: Command end result
[0m14:06:33.200808 [info ] [MainThread]: 
[0m14:06:33.201082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:33.201287 [info ] [MainThread]: 
[0m14:06:33.201500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:33.201879 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:33.201830 after 0.73 seconds
[0m14:06:33.202061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961e90>]}
[0m14:06:33.202228 [debug] [MainThread]: Flushing usage events
[0m14:52:53.002139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5f10>]}


============================== 14:52:53.005787 | bd12cd35-77a0-4cfa-af96-d914f5056086 ==============================
[0m14:52:53.005787 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:52:53.006139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:53.049813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5d50>]}
[0m14:52:53.056779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c49d0>]}
[0m14:52:53.057166 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:52:53.067561 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:52:53.087471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m14:52:53.087798 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:52:53.087966 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:52:53.088171 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:52:53.088350 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:52:53.099750 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:52:53.107037 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:52:53.108926 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:52:53.110745 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:52:53.134489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e68b90>]}
[0m14:52:53.138287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3efd0>]}
[0m14:52:53.138507 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:52:53.138720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104481090>]}
[0m14:52:53.139512 [info ] [MainThread]: 
[0m14:52:53.139913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:53.140469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:52:53.145835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:52:53.146114 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:52:53.146259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:53.281367 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:52:53.282930 [debug] [ThreadPool]: On list_mydb: Close
[0m14:52:53.284509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:52:53.290006 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.290300 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:52:53.290559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:53.309561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.310028 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.310372 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:52:53.322942 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:53.324404 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:52:53.325775 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:52:53.330527 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.330909 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.331189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:53.348320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.348797 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.349238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:53.375876 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:52:53.377138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb2d0>]}
[0m14:52:53.377453 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:53.378228 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.378414 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.379532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.379718 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.379885 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.380051 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.380818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.381020 [debug] [MainThread]: On master: Close
[0m14:52:53.381468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:53.381727 [info ] [MainThread]: 
[0m14:52:53.384870 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:52:53.385143 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:52:53.385462 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:52:53.385828 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:52:53.386368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:52:53.386821 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:52:53.387074 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:52:53.387339 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:52:53.389449 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.391133 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:52:53.391811 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:52:53.387541 => 14:52:53.391683
[0m14:52:53.392033 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:52:53.392263 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:52:53.389655 => 14:52:53.392154
[0m14:52:53.416685 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:52:53.416396 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.420514 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:52:53.421045 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.421280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:52:53.421531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:53.421786 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.422117 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:52:53.422318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:53.432698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433330 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.433549 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.433803 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.434068 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    movie_id,
    user_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.435161 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435378 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435644 [debug] [Thread-2 (]: On model.maker_warehouse.movies: ROLLBACK
[0m14:52:53.435936 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: ROLLBACK
[0m14:52:53.436854 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:52:53.417010 => 14:52:53.436726
[0m14:52:53.437199 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:52:53.392410 => 14:52:53.437078
[0m14:52:53.437428 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:52:53.437644 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:52:53.444341 [debug] [Thread-1 (]: Database Error in model movie_viewings (models/facts/movie_viewings.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.445198 [debug] [Thread-2 (]: Database Error in model movies (models/facts/movies.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.445496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679bcd0>]}
[0m14:52:53.445747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4edd0>]}
[0m14:52:53.446187 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_warehouse.movie_viewings ............. [[31mERROR[0m in 0.06s]
[0m14:52:53.446641 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model dbt_warehouse.movies ..................... [[31mERROR[0m in 0.06s]
[0m14:52:53.447008 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:52:53.447264 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:52:53.447653 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.447842 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:52:53.448133 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_warehouse.sum_movie_viewing_time ...................... [[33mSKIP[0m]
[0m14:52:53.448460 [info ] [Thread-3 (]: 4 of 4 SKIP relation dbt_warehouse.sum_movie_views ............................. [[33mSKIP[0m]
[0m14:52:53.448789 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.449018 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:52:53.449902 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.450073 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.450219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:53.459117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.459411 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.459575 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.459728 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.460243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.460415 [debug] [MainThread]: On master: Close
[0m14:52:53.460787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:53.460933 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:52:53.461080 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:52:53.461262 [info ] [MainThread]: 
[0m14:52:53.461484 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:52:53.461879 [debug] [MainThread]: Command end result
[0m14:52:53.465106 [info ] [MainThread]: 
[0m14:52:53.465388 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:53.465586 [info ] [MainThread]: 
[0m14:52:53.465782 [error] [MainThread]: [33mDatabase Error in model movie_viewings (models/facts/movie_viewings.sql)[0m
[0m14:52:53.465973 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.466222 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.466460 [error] [MainThread]:                                        ^
[0m14:52:53.466663 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.466968 [info ] [MainThread]: 
[0m14:52:53.467177 [error] [MainThread]: [33mDatabase Error in model movies (models/facts/movies.sql)[0m
[0m14:52:53.467368 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.467551 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.467772 [error] [MainThread]:                                        ^
[0m14:52:53.467963 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.468157 [info ] [MainThread]: 
[0m14:52:53.468426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m14:52:53.468822 [debug] [MainThread]: Command `dbt run` failed at 14:52:53.468759 after 0.48 seconds
[0m14:52:53.469060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1d10>]}
[0m14:52:53.469269 [debug] [MainThread]: Flushing usage events
[0m14:54:10.235881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062092d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106210410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062221d0>]}


============================== 14:54:10.239721 | bde4c731-7a74-49fc-bc0d-80cc781a44ec ==============================
[0m14:54:10.239721 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:10.240117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:10.289824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223050>]}
[0m14:54:10.296825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d7690>]}
[0m14:54:10.297197 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:10.307554 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:10.326864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:10.327221 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:54:10.327406 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:54:10.339126 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:54:10.346324 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:54:10.351777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bf90>]}
[0m14:54:10.372977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9ed0>]}
[0m14:54:10.373240 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:10.373450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcd090>]}
[0m14:54:10.374271 [info ] [MainThread]: 
[0m14:54:10.374714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:10.375373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:10.380773 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:10.381017 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:10.381166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:10.455292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:10.456374 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:10.457515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:10.461554 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.461778 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:10.461966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:10.481646 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.481877 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.482084 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:10.493755 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:10.494815 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:10.495753 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:10.499251 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.499726 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.499936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:10.513050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.513437 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.513800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:10.537336 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:10.538746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539fb50>]}
[0m14:54:10.539109 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:10.540132 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.540382 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.541924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.542181 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.542408 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.542628 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.543446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:10.543693 [debug] [MainThread]: On master: Close
[0m14:54:10.544239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:10.544579 [info ] [MainThread]: 
[0m14:54:10.548600 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:10.548930 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:10.549354 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:10.549805 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:10.550447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:10.550981 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:10.551317 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:10.551632 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:10.554260 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.556361 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:10.557001 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:10.551865 => 14:54:10.556844
[0m14:54:10.557302 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:10.554555 => 14:54:10.557164
[0m14:54:10.557571 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:10.557829 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:10.586680 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:10.587977 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.588448 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.588666 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.588840 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:10.589031 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:10.589202 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:10.589366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:10.598245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598765 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.598966 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.599164 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:10.599368 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:11.055653 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:11.065278 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.065566 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:11.067142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.068677 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.068859 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:11.069777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.080556 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.080824 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.080988 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.097353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.100284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.100493 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:11.109203 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.110135 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:10.581973 => 14:54:11.110042
[0m14:54:11.110333 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:11.110727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e3410>]}
[0m14:54:11.111061 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m14:54:11.111490 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:11.212220 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:11.219196 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.219775 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:11.220995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.223407 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.223639 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.223805 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.234985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.237749 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.238001 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:11.239181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.239946 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:10.558009 => 14:54:11.239854
[0m14:54:11.240125 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:11.240491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062df2d0>]}
[0m14:54:11.240777 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.69s]
[0m14:54:11.241112 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:11.241645 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.241826 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:11.242070 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:11.242345 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:11.242793 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:11.243133 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:11.243319 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.243483 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:11.244970 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.246797 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.247421 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:11.243602 => 14:54:11.247308
[0m14:54:11.247609 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.247802 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:11.245227 => 14:54:11.247713
[0m14:54:11.249993 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.250237 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:11.252545 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.252903 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.253077 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:11.253236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:11.253524 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.253689 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:11.253839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:11.262196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262660 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.262846 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.263049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.263257 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.264133 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264319 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264548 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m14:54:11.264757 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m14:54:11.265630 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:11.250427 => 14:54:11.265517
[0m14:54:11.265932 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:11.247920 => 14:54:11.265824
[0m14:54:11.266156 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:11.266337 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:11.272114 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.272812 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.273060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b9810>]}
[0m14:54:11.273263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a990>]}
[0m14:54:11.273558 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.03s]
[0m14:54:11.273823 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.03s]
[0m14:54:11.274168 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:11.274369 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.275151 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.275299 [debug] [MainThread]: On master: BEGIN
[0m14:54:11.275428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:11.283190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.283464 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.283619 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.283761 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.284359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.284535 [debug] [MainThread]: On master: Close
[0m14:54:11.284875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:11.285016 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:11.285138 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:11.285257 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:11.285376 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:11.285546 [info ] [MainThread]: 
[0m14:54:11.285749 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:54:11.286254 [debug] [MainThread]: Command end result
[0m14:54:11.289367 [info ] [MainThread]: 
[0m14:54:11.289616 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:54:11.289799 [info ] [MainThread]: 
[0m14:54:11.289974 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m14:54:11.290144 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.290309 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.290469 [error] [MainThread]:                             ^
[0m14:54:11.290630 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.290793 [info ] [MainThread]: 
[0m14:54:11.290958 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m14:54:11.291124 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.291283 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.291440 [error] [MainThread]:                             ^
[0m14:54:11.291597 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.291764 [info ] [MainThread]: 
[0m14:54:11.291997 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m14:54:11.292352 [debug] [MainThread]: Command `dbt run` failed at 14:54:11.292300 after 1.07 seconds
[0m14:54:11.292550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02510>]}
[0m14:54:11.292724 [debug] [MainThread]: Flushing usage events
[0m14:54:29.143599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b53f90>]}


============================== 14:54:29.147195 | 55b68981-3ebb-438a-b2ce-8f3f1ba487ee ==============================
[0m14:54:29.147195 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:29.147546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:29.188375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75d90>]}
[0m14:54:29.195353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a28850>]}
[0m14:54:29.195712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:29.206355 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:29.223147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:29.223487 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:54:29.223676 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:54:29.235466 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:54:29.242626 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:54:29.247946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fffd0>]}
[0m14:54:29.269107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2ecd0>]}
[0m14:54:29.269458 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:29.269710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921090>]}
[0m14:54:29.270575 [info ] [MainThread]: 
[0m14:54:29.271017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:29.271664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:29.277074 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:29.277404 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:29.277576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:29.339125 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:29.340106 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:29.341125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:29.344793 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.345004 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:29.345175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.359652 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.359841 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.360027 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:29.368130 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:54:29.369058 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:29.369798 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:29.373168 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.373403 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.373578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:29.383454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.383752 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.384030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:29.399334 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:29.400553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b64610>]}
[0m14:54:29.400857 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:29.401804 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.402000 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.404550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.404764 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.404946 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.405119 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.405823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.406053 [debug] [MainThread]: On master: Close
[0m14:54:29.406518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:29.406796 [info ] [MainThread]: 
[0m14:54:29.409712 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:29.409991 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:29.410341 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:29.410739 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:29.411284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:29.411769 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:29.412016 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:29.412242 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:29.414254 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.415887 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:29.416405 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:29.414443 => 14:54:29.416273
[0m14:54:29.416660 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:29.412407 => 14:54:29.416547
[0m14:54:29.416875 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:29.417080 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:29.440117 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:29.442376 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.443148 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.443342 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.443513 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:29.443672 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:29.443829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.443977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:29.453635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.453955 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.454150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.454415 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.454625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.454869 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.793754 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:29.803496 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.803778 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:29.805129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.806796 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.806985 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:29.808008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.818890 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.819156 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.819320 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.829033 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.831949 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.832174 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:29.881596 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:29.884282 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:29.417218 => 14:54:29.883855
[0m14:54:29.884905 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:29.886101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c222d0>]}
[0m14:54:29.887003 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.47s]
[0m14:54:29.887732 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:30.100449 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:30.107266 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.107845 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:54:30.109386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.112239 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.112535 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:30.113606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.115088 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.115273 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.115433 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.123069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.125886 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.126136 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:30.186535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.190228 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:29.440347 => 14:54:30.189853
[0m14:54:30.190921 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:30.192019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104456490>]}
[0m14:54:30.192838 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.78s]
[0m14:54:30.193747 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:30.194780 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.195420 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:30.195173 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:30.195815 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:30.196312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:30.196656 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:30.196837 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.197000 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:30.199061 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.200597 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.201266 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:30.199297 => 14:54:30.201132
[0m14:54:30.201492 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:30.197117 => 14:54:30.201396
[0m14:54:30.201677 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:30.201852 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.203945 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.205873 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206210 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.206396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:30.206572 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:30.206929 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:30.207166 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:30.215877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216385 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.216585 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.216777 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.216966 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.339307 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.340389 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.346198 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.348780 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.349080 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:54:30.349264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:54:30.350207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.350397 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.351484 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.352494 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.352672 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.352836 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.352994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.353149 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.355073 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.356334 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.356509 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:54:30.356674 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.358595 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.358756 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.358928 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:54:30.359621 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:30.204070 => 14:54:30.359534
[0m14:54:30.359824 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:30.360199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9dd0>]}
[0m14:54:30.360372 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.360674 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.16s]
[0m14:54:30.361459 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:30.201960 => 14:54:30.361366
[0m14:54:30.361756 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.361959 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:30.362466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ca890>]}
[0m14:54:30.362771 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m14:54:30.363100 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:30.364864 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.365148 [debug] [MainThread]: On master: BEGIN
[0m14:54:30.365301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:30.374589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.374882 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375033 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.375173 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.375958 [debug] [MainThread]: On master: Close
[0m14:54:30.376315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:30.376446 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:30.376566 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:30.376683 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:30.376795 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:30.376961 [info ] [MainThread]: 
[0m14:54:30.377158 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:54:30.377689 [debug] [MainThread]: Command end result
[0m14:54:30.380747 [info ] [MainThread]: 
[0m14:54:30.381045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:30.381302 [info ] [MainThread]: 
[0m14:54:30.381519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:54:30.381865 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:30.381811 after 1.25 seconds
[0m14:54:30.382075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f0690>]}
[0m14:54:30.382266 [debug] [MainThread]: Flushing usage events
[0m15:05:23.550862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106189290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106058bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a25d0>]}


============================== 15:05:23.554403 | a888bcc0-2d9e-49e3-9319-7b7a18507126 ==============================
[0m15:05:23.554403 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:23.554814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:23.597999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106243f50>]}
[0m15:05:23.604967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b6190>]}
[0m15:05:23.605333 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:23.616128 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:23.637158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:23.637533 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:23.637726 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:23.649569 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:23.656893 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:23.662653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062611d0>]}
[0m15:05:23.683492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068174d0>]}
[0m15:05:23.683765 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:23.683979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4d090>]}
[0m15:05:23.684843 [info ] [MainThread]: 
[0m15:05:23.685295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:23.685983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:23.691529 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:23.691781 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:23.691933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:23.780791 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:23.781911 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:23.783139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:23.787204 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.787430 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:23.787617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:23.800457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.800749 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.800970 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:23.812628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:23.813805 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:23.814669 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:23.818681 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.818975 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.819177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:23.832048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.832380 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.832699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:23.858134 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:23.859694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7f850>]}
[0m15:05:23.860082 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:23.861064 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.861386 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.863163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.863490 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.863774 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.864021 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.864880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:23.865138 [debug] [MainThread]: On master: Close
[0m15:05:23.865651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:23.865966 [info ] [MainThread]: 
[0m15:05:23.869314 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:23.869617 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:23.869998 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:23.870461 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:23.871096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:23.871613 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:23.871887 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:23.872163 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:23.874464 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.876373 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:23.877688 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:23.874675 => 15:05:23.877539
[0m15:05:23.878010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:23.872363 => 15:05:23.877875
[0m15:05:23.878238 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:23.878484 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:23.908778 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.910005 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:23.911094 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.911299 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.911488 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:23.911665 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:23.911836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:23.912015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:23.921744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922096 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.922323 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:23.922533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922841 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.923065 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:24.379349 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:24.391913 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.392224 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:24.394945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.396607 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.396798 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:24.397790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.409066 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.409344 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.409524 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.450606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.457087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.457377 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:24.466823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.468939 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:23.878655 => 15:05:24.468694
[0m15:05:24.469420 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:24.470087 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106194f90>]}
[0m15:05:24.470519 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.60s]
[0m15:05:24.470888 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:24.632375 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:05:24.638694 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.639280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:24.640878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.644454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.644733 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:24.645546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.646964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.647144 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.647295 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.658659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.662245 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.662624 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:24.714906 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.717136 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:23.904081 => 15:05:24.716887
[0m15:05:24.717680 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:24.718687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106842150>]}
[0m15:05:24.719462 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.85s]
[0m15:05:24.720394 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:24.721675 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.722218 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:24.722915 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:24.723935 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:24.724545 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:24.724880 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:24.725062 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.725234 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:24.727161 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.728766 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.729456 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:24.727404 => 15:05:24.729337
[0m15:05:24.729702 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:24.725359 => 15:05:24.729589
[0m15:05:24.729882 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:24.730070 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.732514 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735120 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.735725 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735945 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.736104 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:24.736280 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:24.736447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:24.736602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:24.746945 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747256 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747606 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.747817 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.748073 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.748299 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.750473 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.750749 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.751020 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m15:05:24.751346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m15:05:24.752328 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:24.730190 => 15:05:24.752193
[0m15:05:24.752775 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:24.732781 => 15:05:24.752523
[0m15:05:24.753005 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:24.753195 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:24.759428 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.760162 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.760472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b7490>]}
[0m15:05:24.760684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256a50>]}
[0m15:05:24.761016 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.04s]
[0m15:05:24.761356 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.04s]
[0m15:05:24.761687 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:24.761910 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.762829 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.762997 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.763130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:24.771512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.771811 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.771952 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.772082 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.772611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.772771 [debug] [MainThread]: On master: Close
[0m15:05:24.773094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:24.773227 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:24.773345 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:24.773462 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:24.773576 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:24.773728 [info ] [MainThread]: 
[0m15:05:24.773922 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m15:05:24.774370 [debug] [MainThread]: Command end result
[0m15:05:24.777861 [info ] [MainThread]: 
[0m15:05:24.778087 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:24.778266 [info ] [MainThread]: 
[0m15:05:24.778446 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m15:05:24.778618 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.778782 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.778940 [error] [MainThread]:                ^
[0m15:05:24.779102 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.779265 [info ] [MainThread]: 
[0m15:05:24.779429 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m15:05:24.779595 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.779753 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.779912 [error] [MainThread]:                ^
[0m15:05:24.780071 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.780237 [info ] [MainThread]: 
[0m15:05:24.780422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:05:24.780722 [debug] [MainThread]: Command `dbt run` failed at 15:05:24.780677 after 1.24 seconds
[0m15:05:24.780908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102865e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102867b90>]}
[0m15:05:24.781083 [debug] [MainThread]: Flushing usage events
[0m15:05:44.547398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee2d0>]}


============================== 15:05:44.550929 | 29bb855e-8014-4fd0-8a8f-6fe8847b33c2 ==============================
[0m15:05:44.550929 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:44.551295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:44.592211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106800450>]}
[0m15:05:44.599237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6d90>]}
[0m15:05:44.599621 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:44.609662 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:44.626547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:44.626918 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:44.627110 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:44.638341 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:44.645756 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:44.651395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69790>]}
[0m15:05:44.672703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e62c50>]}
[0m15:05:44.672980 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:44.673203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104599090>]}
[0m15:05:44.674048 [info ] [MainThread]: 
[0m15:05:44.674530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:44.675201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:44.680835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:44.681091 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:44.681237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:44.736435 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:44.737402 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:44.738386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:44.741985 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.742201 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:44.742358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:44.757850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.758039 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.758231 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:44.767820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:44.768761 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:44.769571 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:44.773034 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.773289 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.773473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:44.783986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.784326 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.784644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:44.799812 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:44.801059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fe350>]}
[0m15:05:44.801373 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:44.802213 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.802453 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.803581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.803801 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.803997 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.804181 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.804877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:44.805131 [debug] [MainThread]: On master: Close
[0m15:05:44.805594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:44.805891 [info ] [MainThread]: 
[0m15:05:44.808914 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:44.809200 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:44.809513 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:44.809878 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:44.810400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:44.810876 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:44.811132 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:44.811360 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:44.813393 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.815164 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:44.815868 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:44.811536 => 15:05:44.815744
[0m15:05:44.816133 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:44.813589 => 15:05:44.816010
[0m15:05:44.816365 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:44.816581 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:44.840960 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.843140 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:44.843583 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.843790 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.843964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:44.844137 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:44.844303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:44.844458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:44.866180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866794 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.867018 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.867238 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:44.867460 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:45.184059 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.193965 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.194249 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:45.195482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.196950 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.197126 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:45.198123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.208961 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.209261 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.209432 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.226309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.229158 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.229372 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:45.236660 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.237559 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:44.841129 => 15:05:45.237471
[0m15:05:45.237742 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:45.238134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf290>]}
[0m15:05:45.238455 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m15:05:45.238789 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:45.278875 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 0.0 seconds
[0m15:05:45.283717 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.284017 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:45.285416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.287186 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.287375 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:45.288633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.289961 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.290136 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.290289 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.294822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.296159 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.296346 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:45.316539 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.319009 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:44.816732 => 15:05:45.318718
[0m15:05:45.319496 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:45.320465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecd0d0>]}
[0m15:05:45.321106 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.51s]
[0m15:05:45.321558 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:45.322085 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.322310 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:45.322588 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:45.322911 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:45.323404 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:45.323758 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:45.323939 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.324104 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:45.326036 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.327486 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.327914 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:45.326248 => 15:05:45.327818
[0m15:05:45.328111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:45.324243 => 15:05:45.328017
[0m15:05:45.328283 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:45.328471 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.330585 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.332600 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333013 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.333190 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:45.333588 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:45.333756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:45.333948 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:45.342314 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342568 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342785 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.342971 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.343157 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.343346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.463310 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.463875 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.468579 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.472496 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.472923 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:05:45.473125 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:05:45.474195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.475792 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.475998 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:05:45.476170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.477706 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.477890 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.478067 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:05:45.480159 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480389 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.480560 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480972 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.482183 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.482368 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.482526 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.483282 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.484444 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.484612 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:05:45.484881 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.485953 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.486122 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:05:45.487376 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488222 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:45.330717 => 15:05:45.488122
[0m15:05:45.488423 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:45.488583 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008c90>]}
[0m15:05:45.489688 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:45.328604 => 15:05:45.489597
[0m15:05:45.489997 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.490242 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:45.490517 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.490958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e9ad0>]}
[0m15:05:45.491391 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.491724 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:45.492582 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.492746 [debug] [MainThread]: On master: BEGIN
[0m15:05:45.492879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:45.501284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.501614 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.501776 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.501913 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.502490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.502631 [debug] [MainThread]: On master: Close
[0m15:05:45.502960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:45.503089 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:45.503208 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:45.503323 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:45.503435 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:45.503588 [info ] [MainThread]: 
[0m15:05:45.503790 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:05:45.504372 [debug] [MainThread]: Command end result
[0m15:05:45.507387 [info ] [MainThread]: 
[0m15:05:45.507622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:45.507808 [info ] [MainThread]: 
[0m15:05:45.508004 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:05:45.508314 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:45.508269 after 0.97 seconds
[0m15:05:45.508502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d68690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1dd0>]}
[0m15:05:45.508680 [debug] [MainThread]: Flushing usage events
[0m15:11:44.338699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e15290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2db90>]}


============================== 15:11:44.342392 | 7133d1bd-0fc7-416e-a64f-a43d75e67829 ==============================
[0m15:11:44.342392 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:11:44.342792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:11:44.387477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e56bd0>]}
[0m15:11:44.394554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0b3d0>]}
[0m15:11:44.394973 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:11:44.405875 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:11:44.424575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:44.424920 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:11:44.436593 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:11:44.447206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3450>]}
[0m15:11:44.468300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1d10>]}
[0m15:11:44.468583 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:11:44.468796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd9090>]}
[0m15:11:44.469608 [info ] [MainThread]: 
[0m15:11:44.470035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:44.470697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:11:44.476212 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:11:44.476459 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:11:44.476598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:44.544969 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:11:44.545958 [debug] [ThreadPool]: On list_mydb: Close
[0m15:11:44.546950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:11:44.550626 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.550838 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:11:44.551008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:44.560618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.560941 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.561171 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:11:44.571133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:11:44.572133 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:11:44.572948 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:11:44.576404 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.576660 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.576838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:44.587471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.587738 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.588047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:44.633361 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:11:44.634919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585f610>]}
[0m15:11:44.635338 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:44.636569 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.636823 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.638544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.638836 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.639105 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.639335 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.640239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:44.640491 [debug] [MainThread]: On master: Close
[0m15:11:44.641044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:44.641425 [info ] [MainThread]: 
[0m15:11:44.645649 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:11:44.645964 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:11:44.646336 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:11:44.646751 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:11:44.647371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:11:44.647874 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:11:44.648135 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:11:44.648378 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:11:44.650693 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.652721 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:11:44.653966 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:11:44.650943 => 15:11:44.653784
[0m15:11:44.654286 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:11:44.648552 => 15:11:44.654131
[0m15:11:44.654559 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:11:44.654819 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:11:44.679834 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:11:44.682190 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.682620 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.682835 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.683020 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:11:44.683212 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:11:44.683404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:11:44.683575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:44.693015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693310 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.693525 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693744 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:44.693972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.694237 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:45.142368 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.154736 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.155061 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:11:45.156671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.158362 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.158562 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:11:45.159337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.170519 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.170866 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.171059 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.180733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.183561 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.183759 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:11:45.197473 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.198500 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:11:44.654991 => 15:11:45.198401
[0m15:11:45.198708 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:11:45.199129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3950>]}
[0m15:11:45.199465 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:11:45.199818 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:11:45.200862 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:11:45.202643 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.202874 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:11:45.204270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.206062 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.206293 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:11:45.207144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.208554 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.208746 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.208908 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.213696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.215126 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.215342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:11:45.247272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.248148 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:11:44.680010 => 15:11:45.248056
[0m15:11:45.248342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:11:45.248720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2da50>]}
[0m15:11:45.249014 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.60s]
[0m15:11:45.249384 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:11:45.249856 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.250050 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:11:45.250370 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:11:45.250654 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:11:45.251102 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:11:45.251431 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:11:45.251605 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.251766 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:11:45.253849 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.255735 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.256511 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:11:45.254104 => 15:11:45.256357
[0m15:11:45.256714 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:11:45.256947 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:11:45.251887 => 15:11:45.256859
[0m15:11:45.259629 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.259896 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.262369 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.262907 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.263114 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:11:45.263300 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.263486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:45.263666 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:11:45.263933 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:45.274638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.274921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.275170 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.275378 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.275599 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:11:45.275794 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:11:45.396146 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.402086 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.402545 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.403097 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:11:45.405253 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.405515 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:11:45.406374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.406565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.407927 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.409283 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.409462 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:11:45.409633 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:11:45.410411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.412358 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412531 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.412682 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.414060 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.414260 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.414420 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.416532 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.417650 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.417821 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:11:45.418084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.419150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.419323 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:11:45.420863 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.421689 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:11:45.260118 => 15:11:45.421592
[0m15:11:45.421891 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:11:45.422049 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.422442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0df50>]}
[0m15:11:45.423087 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:11:45.257216 => 15:11:45.423002
[0m15:11:45.423386 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.423640 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:11:45.423901 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.424272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667fc50>]}
[0m15:11:45.424791 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.425125 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:11:45.425962 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.426152 [debug] [MainThread]: On master: BEGIN
[0m15:11:45.426291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:45.435303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.435601 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.435754 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.435894 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.436512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.436700 [debug] [MainThread]: On master: Close
[0m15:11:45.437069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:45.437208 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:11:45.437332 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:11:45.437460 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:11:45.437579 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:11:45.437736 [info ] [MainThread]: 
[0m15:11:45.438071 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m15:11:45.438605 [debug] [MainThread]: Command end result
[0m15:11:45.441590 [info ] [MainThread]: 
[0m15:11:45.441817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:45.442007 [info ] [MainThread]: 
[0m15:11:45.442207 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:11:45.442512 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:45.442469 after 1.12 seconds
[0m15:11:45.442697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023a8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1dd0>]}
[0m15:11:45.442865 [debug] [MainThread]: Flushing usage events
[0m15:16:58.197577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104321450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043221d0>]}


============================== 15:16:58.201298 | 49886db4-9e37-44bf-9f96-6adee53d1d5e ==============================
[0m15:16:58.201298 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:16:58.201672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:58.244712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434b5d0>]}
[0m15:16:58.251791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432ec50>]}
[0m15:16:58.252220 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:16:58.262490 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:16:58.285491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:58.285874 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:16:58.297532 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:16:58.308333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334790>]}
[0m15:16:58.329730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498aa50>]}
[0m15:16:58.330009 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:16:58.330226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020cd090>]}
[0m15:16:58.331054 [info ] [MainThread]: 
[0m15:16:58.331513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:58.332135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:16:58.337638 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:16:58.337900 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:16:58.338053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:58.411393 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:16:58.412432 [debug] [ThreadPool]: On list_mydb: Close
[0m15:16:58.413513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:16:58.417191 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.417405 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:16:58.417577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:58.432067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.432285 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.432485 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:16:58.444648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:16:58.445722 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:16:58.446526 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:16:58.450356 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.450634 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.450827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:58.463666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.463921 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.464249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:58.483367 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:16:58.484764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104390a10>]}
[0m15:16:58.485105 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:58.486023 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.486304 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.487543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.487775 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.487981 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.488243 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.489085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:58.489376 [debug] [MainThread]: On master: Close
[0m15:16:58.489896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:58.490213 [info ] [MainThread]: 
[0m15:16:58.494094 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:16:58.494413 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:16:58.494780 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:16:58.495254 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:16:58.495846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:16:58.496321 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:16:58.496562 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:16:58.496782 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:16:58.498804 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.500561 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:16:58.501595 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:16:58.499007 => 15:16:58.501431
[0m15:16:58.501926 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:16:58.496937 => 15:16:58.501792
[0m15:16:58.502160 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:16:58.502414 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:16:58.526004 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:16:58.528325 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.528763 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.528962 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.529153 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:16:58.529330 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:16:58.529498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:58.529656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:58.538614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.538905 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.539117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.539383 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.539599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.539847 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.980884 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:58.991087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.991386 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:16:58.993037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:58.994683 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.994871 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:16:58.995782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.006469 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.006738 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.006899 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.026166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.029078 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.029282 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:16:59.036447 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.037371 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:16:58.502610 => 15:16:59.037275
[0m15:16:59.037561 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:16:59.037948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e59d0>]}
[0m15:16:59.038280 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.54s]
[0m15:16:59.038628 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:16:59.086158 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:16:59.089836 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.090075 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:16:59.093136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.094457 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.094625 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:16:59.095424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.096783 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.096961 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.097114 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.112291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.113571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.113740 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:16:59.143245 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.146777 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:16:58.526171 => 15:16:59.146379
[0m15:16:59.147395 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:16:59.148511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399e250>]}
[0m15:16:59.149186 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:16:59.149597 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:16:59.150096 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.150314 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:16:59.150558 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:16:59.150867 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:16:59.151422 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:16:59.151761 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:16:59.151935 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.152097 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:16:59.154078 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.155588 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.156012 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:16:59.152209 => 15:16:59.155917
[0m15:16:59.156230 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:16:59.154309 => 15:16:59.156116
[0m15:16:59.156423 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.156588 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:16:59.158689 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.160745 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161224 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.161393 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161568 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:16:59.161729 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:16:59.161882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:16:59.162031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:16:59.177054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177644 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.177845 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.178035 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.178231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.307497 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.308067 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.314005 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.317054 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.317308 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:16:59.317490 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:16:59.318507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.318679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.320106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.321429 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.321598 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:16:59.321764 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:16:59.322592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.322766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.324788 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.325893 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.326068 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.326229 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.326384 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.326528 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.331612 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.332761 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.332947 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:16:59.333214 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.334375 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.334560 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:16:59.335917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.336648 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:16:59.156703 => 15:16:59.336559
[0m15:16:59.336839 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:16:59.337220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73a90>]}
[0m15:16:59.337531 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.337861 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.338453 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.339238 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:16:59.158820 => 15:16:59.339144
[0m15:16:59.339436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:16:59.339810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b0cd0>]}
[0m15:16:59.340097 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.340435 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:16:59.341935 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.342260 [debug] [MainThread]: On master: BEGIN
[0m15:16:59.342402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:59.349615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.349906 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.350120 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.350290 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.351034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.351252 [debug] [MainThread]: On master: Close
[0m15:16:59.351606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:59.351739 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:16:59.351855 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:16:59.351965 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:16:59.352072 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:16:59.352232 [info ] [MainThread]: 
[0m15:16:59.352420 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:16:59.352944 [debug] [MainThread]: Command end result
[0m15:16:59.356019 [info ] [MainThread]: 
[0m15:16:59.356330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:59.356527 [info ] [MainThread]: 
[0m15:16:59.356751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:16:59.357111 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:59.357058 after 1.17 seconds
[0m15:16:59.357305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10089c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009e5e90>]}
[0m15:16:59.357481 [debug] [MainThread]: Flushing usage events
[0m15:31:28.885297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487f90>]}


============================== 15:31:28.889159 | 291e5c32-c9e2-4124-ad98-c2f68608ce73 ==============================
[0m15:31:28.889159 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:31:28.889562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:31:28.932880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aab50>]}
[0m15:31:28.939923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655f690>]}
[0m15:31:28.940297 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:31:28.950590 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:31:28.972544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:31:28.972908 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m15:31:28.973127 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m15:31:28.984980 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:31:28.992257 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:31:28.997745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106492c10>]}
[0m15:31:29.018676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d850>]}
[0m15:31:29.018954 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:31:29.019168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104255090>]}
[0m15:31:29.020063 [info ] [MainThread]: 
[0m15:31:29.020487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:29.021119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:31:29.026482 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:31:29.026723 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:31:29.026874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:29.106698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:31:29.107802 [debug] [ThreadPool]: On list_mydb: Close
[0m15:31:29.108949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:31:29.113008 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.113228 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:31:29.113404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:29.126561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.126845 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.127070 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:31:29.136612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:31:29.137659 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:31:29.138466 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:31:29.142146 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.142401 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.142588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:29.154724 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.155052 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.155357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:29.179557 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:31:29.180830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b108d0>]}
[0m15:31:29.181151 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:29.181992 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.182193 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.183478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.183744 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.183956 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.184141 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.184889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.185112 [debug] [MainThread]: On master: Close
[0m15:31:29.185574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:29.185859 [info ] [MainThread]: 
[0m15:31:29.189024 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:31:29.189313 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:31:29.189553 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:31:29.189776 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:31:29.190088 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:31:29.190494 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:31:29.190890 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:31:29.191257 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:31:29.191859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:31:29.192360 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:31:29.192827 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:31:29.193257 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:31:29.193487 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:31:29.193710 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:31:29.193924 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:31:29.194134 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:31:29.196153 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:31:29.197932 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.199669 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:31:29.201396 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:31:29.202160 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:31:29.194289 => 15:31:29.202039
[0m15:31:29.202518 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:31:29.202780 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:31:29.198119 => 15:31:29.202674
[0m15:31:29.215665 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:31:29.196350 => 15:31:29.215499
[0m15:31:29.215885 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:31:29.199843 => 15:31:29.215801
[0m15:31:29.226601 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:31:29.226925 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:31:29.227100 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:31:29.227263 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:31:29.230198 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:31:29.232432 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.234469 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:31:29.234821 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.235150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.235339 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:31:29.235539 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:31:29.235694 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.235865 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.236041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.236203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:29.236399 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:31:29.236598 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:31:29.236952 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:29.237119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:29.251005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.251518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.251819 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.252186 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.252379 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.252568 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.253696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.253972 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.254275 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.254487 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.254709 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.254952 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.256366 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.256958 [debug] [Thread-4 (]: On model.maker_warehouse.users: ROLLBACK
[0m15:31:29.258565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.259111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:31:29.232586 => 15:31:29.258990
[0m15:31:29.259353 [debug] [Thread-1 (]: On model.maker_warehouse.genres: ROLLBACK
[0m15:31:29.259597 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:31:29.262911 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:31:29.202957 => 15:31:29.262742
[0m15:31:29.263207 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:31:29.267741 [debug] [Thread-1 (]: Database Error in model genres (models/facts/genres.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:29.269372 [debug] [Thread-4 (]: Database Error in model users (models/facts/users.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:29.269757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be090>]}
[0m15:31:29.270046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a290>]}
[0m15:31:29.270465 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model dbt_warehouse.genres ..................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271291 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model dbt_warehouse.users ...................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271703 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:31:29.271923 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:31:29.721352 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.731687 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.732037 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:31:29.733853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.736048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.736292 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:31:29.737543 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.748687 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.748981 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.749146 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.761118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.764048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.764255 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:31:29.771492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.772478 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:31:29.227461 => 15:31:29.772385
[0m15:31:29.772676 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:31:29.773077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32510>]}
[0m15:31:29.773382 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.58s]
[0m15:31:29.773720 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:31:29.788430 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:31:29.790356 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.790586 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:31:29.792618 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.794479 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.794686 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:31:29.795750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.797056 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.797246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.797408 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.804207 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.805740 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.805931 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:31:29.840859 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.843773 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:31:29.230361 => 15:31:29.843473
[0m15:31:29.844356 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:31:29.845384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c44290>]}
[0m15:31:29.845875 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:31:29.846263 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:31:29.846867 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.847092 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:31:29.847407 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:31:29.847692 [info ] [Thread-4 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:31:29.848294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:31:29.848698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:31:29.848969 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.849191 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:31:29.851346 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.853243 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.854028 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:31:29.849329 => 15:31:29.853872
[0m15:31:29.854276 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:31:29.851674 => 15:31:29.854155
[0m15:31:29.854540 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.854721 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:31:29.857271 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860061 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.860670 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860864 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:31:29.861031 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.861197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.861355 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:31:29.861593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:29.870657 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.870921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.871171 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.871385 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.871583 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.871803 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.998844 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.999902 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:30.006224 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.008976 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.009228 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:31:30.009421 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:31:30.011869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.012060 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.013740 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.015142 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.015330 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:31:30.015518 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:31:30.016387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.016577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.017818 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019007 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.019200 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.019373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.019538 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019701 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.024619 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.025921 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.026093 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:31:30.026271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.027466 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.027648 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:31:30.029642 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.030399 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:31:29.857447 => 15:31:30.030303
[0m15:31:30.030599 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:31:30.030978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e750>]}
[0m15:31:30.031149 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.031433 [info ] [Thread-4 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.18s]
[0m15:31:30.032181 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:31:29.854854 => 15:31:30.032094
[0m15:31:30.032479 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:31:30.032679 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:31:30.033147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9bdd0>]}
[0m15:31:30.033452 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:31:30.033827 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:30.034748 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.034942 [debug] [MainThread]: On master: BEGIN
[0m15:31:30.035081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:30.042904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:30.043163 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043305 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.043428 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.044142 [debug] [MainThread]: On master: Close
[0m15:31:30.044484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:30.044628 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:31:30.044751 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:31:30.044867 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:31:30.044978 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:31:30.045135 [info ] [MainThread]: 
[0m15:31:30.045328 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:31:30.045906 [debug] [MainThread]: Command end result
[0m15:31:30.048886 [info ] [MainThread]: 
[0m15:31:30.049126 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:31:30.049309 [info ] [MainThread]: 
[0m15:31:30.049564 [error] [MainThread]: [33mDatabase Error in model genres (models/facts/genres.sql)[0m
[0m15:31:30.049815 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.050006 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.050181 [error] [MainThread]:            ^
[0m15:31:30.050349 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:30.050521 [info ] [MainThread]: 
[0m15:31:30.050699 [error] [MainThread]: [33mDatabase Error in model users (models/facts/users.sql)[0m
[0m15:31:30.050865 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.051025 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.051184 [error] [MainThread]:            ^
[0m15:31:30.051343 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:30.051513 [info ] [MainThread]: 
[0m15:31:30.051706 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m15:31:30.052085 [debug] [MainThread]: Command `dbt run` failed at 15:31:30.052027 after 1.18 seconds
[0m15:31:30.052303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106360550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bb210>]}
[0m15:31:30.052492 [debug] [MainThread]: Flushing usage events
[0m15:32:34.691504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fbf90>]}


============================== 15:32:34.695471 | 7fc677d9-cb84-4527-89a1-a072a9ebb691 ==============================
[0m15:32:34.695471 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:32:34.695844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:32:34.738832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.745770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.746147 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:32:34.756388 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:32:34.776472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:32:34.776892 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/users.sql
[0m15:32:34.777081 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/genres.sql
[0m15:32:34.788833 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:32:34.796071 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:32:34.801672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f76150>]}
[0m15:32:34.822815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b890>]}
[0m15:32:34.823093 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:32:34.823307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cecfd0>]}
[0m15:32:34.824144 [info ] [MainThread]: 
[0m15:32:34.824585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:34.825242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:32:34.830168 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:32:34.830341 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:32:34.830487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:34.913057 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:32:34.914152 [debug] [ThreadPool]: On list_mydb: Close
[0m15:32:34.915369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:32:34.919467 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.919709 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:32:34.919901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:34.932980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.933283 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.933512 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:32:34.944612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:32:34.945802 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:32:34.946797 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:32:34.951199 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.951527 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.951750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:34.963587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.963938 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.964264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:34.988580 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:32:34.990177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c58dd0>]}
[0m15:32:34.990583 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:34.991752 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.992070 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.993851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.994151 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.994392 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.994625 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.995552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:34.995828 [debug] [MainThread]: On master: Close
[0m15:32:34.996430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:34.996750 [info ] [MainThread]: 
[0m15:32:35.000411 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:32:35.000780 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:32:35.001069 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:32:35.001318 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:32:35.001706 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:32:35.002145 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:32:35.002670 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:32:35.003089 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:32:35.003840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:32:35.004391 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:32:35.004909 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:32:35.005428 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:32:35.005824 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:32:35.006143 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:32:35.006424 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:32:35.006714 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:32:35.009401 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:32:35.011474 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.013349 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:32:35.015246 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:32:35.016037 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:32:35.006919 => 15:32:35.015894
[0m15:32:35.016433 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:32:35.016710 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:32:35.009722 => 15:32:35.016597
[0m15:32:35.016948 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:32:35.011694 => 15:32:35.016847
[0m15:32:35.024378 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:32:35.013570 => 15:32:35.024119
[0m15:32:35.041517 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:32:35.041793 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:32:35.041984 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:32:35.042161 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:32:35.045276 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.047498 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:32:35.047695 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.049711 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:32:35.050010 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:32:35.050206 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.050453 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.050628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.050828 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:32:35.050983 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.051141 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:32:35.051382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:32:35.051549 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:32:35.051710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:32:35.051934 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:32:35.068826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.069210 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.069439 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.069830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.070027 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.070270 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.071609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.071838 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.072186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.072404 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.072633 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.072880 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.333866 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:32:35.345117 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.345742 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:32:35.347263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.357407 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.357696 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.357872 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.368739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.371720 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.371964 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:32:35.373098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.373909 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:32:35.017100 => 15:32:35.373816
[0m15:32:35.374100 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:32:35.374494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b950>]}
[0m15:32:35.374810 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:32:35.375135 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:32:35.526460 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:35.529011 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.529261 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:32:35.532983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.534850 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.535076 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:32:35.536234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.539052 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.539356 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.539563 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.557658 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.559241 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.559495 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:32:35.565851 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.566840 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:32:35.045461 => 15:32:35.566741
[0m15:32:35.567044 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:32:35.567481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e3ed0>]}
[0m15:32:35.567913 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m15:32:35.568316 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:32:35.698965 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:32:35.705632 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.706303 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:32:35.712590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.715794 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.716045 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.716215 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.729353 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.733486 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.733775 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:32:35.734731 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.735609 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:32:35.047830 => 15:32:35.735513
[0m15:32:35.735808 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:32:35.736207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702c490>]}
[0m15:32:35.736579 [info ] [Thread-4 (]: 4 of 6 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.73s]
[0m15:32:35.737237 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:32:35.858880 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:32:35.865380 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.865703 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:32:35.866868 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.868577 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.868769 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:32:35.869721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.870946 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.871122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.871278 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.879637 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.883400 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.884735 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:32:35.928267 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.930685 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:32:35.042366 => 15:32:35.930424
[0m15:32:35.931238 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:32:35.932295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8f90>]}
[0m15:32:35.933270 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.93s]
[0m15:32:35.934456 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:32:35.935762 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.936324 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:32:35.936859 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:32:35.937188 [info ] [Thread-3 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:32:35.937714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:32:35.938073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_views)
[0m15:32:35.938285 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.938462 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:32:35.940271 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.942574 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.943359 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:32:35.938585 => 15:32:35.943212
[0m15:32:35.943599 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.946189 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.946677 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:32:35.940619 => 15:32:35.946516
[0m15:32:35.946875 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:32:35.947077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.949222 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.949404 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:32:35.949642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.949966 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.950144 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:32:35.950298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:35.961350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961862 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.962077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.962404 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:35.962675 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:36.115793 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.116955 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.122016 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.123517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.123705 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:32:36.123877 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:32:36.124962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.125134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.126486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.127714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.127898 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:32:36.128068 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:32:36.128916 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.130158 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130328 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.130486 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.132064 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.132332 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.132506 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.134387 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.134678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.136512 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.137793 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.137994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:32:36.138184 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:32:36.143103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.143336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.144195 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:32:35.943730 => 15:32:36.144082
[0m15:32:36.144850 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:32:35.947219 => 15:32:36.144767
[0m15:32:36.145048 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:32:36.145234 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:32:36.145685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033bd0>]}
[0m15:32:36.146588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033d10>]}
[0m15:32:36.146079 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.147545 [info ] [Thread-3 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.148548 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:36.148901 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:32:36.150278 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.150511 [debug] [MainThread]: On master: BEGIN
[0m15:32:36.150660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:36.162057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:36.162385 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.162602 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.162772 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.163505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.163667 [debug] [MainThread]: On master: Close
[0m15:32:36.164016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:36.164155 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:32:36.164278 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:32:36.164396 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:32:36.164509 [debug] [MainThread]: Connection 'model.maker_warehouse.users' was properly closed.
[0m15:32:36.164692 [info ] [MainThread]: 
[0m15:32:36.164907 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m15:32:36.165681 [debug] [MainThread]: Command end result
[0m15:32:36.169456 [info ] [MainThread]: 
[0m15:32:36.169808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:36.170325 [info ] [MainThread]: 
[0m15:32:36.170696 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:32:36.171677 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:36.171595 after 1.50 seconds
[0m15:32:36.172136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023b8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501dd0>]}
[0m15:32:36.172431 [debug] [MainThread]: Flushing usage events
[0m15:41:17.578055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ddf10>]}


============================== 15:41:17.581613 | 9754a8f3-b6d6-4cd2-83e6-8de2f248630b ==============================
[0m15:41:17.581613 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:41:17.581996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:17.628243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f6010>]}
[0m15:41:17.635425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904390>]}
[0m15:41:17.635876 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:41:17.647037 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:41:17.668300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:41:17.668712 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:41:17.668875 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m15:41:17.680602 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:41:17.687944 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m15:41:17.693683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108986150>]}
[0m15:41:17.715010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089903d0>]}
[0m15:41:17.715300 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:41:17.715514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106689090>]}
[0m15:41:17.716460 [info ] [MainThread]: 
[0m15:41:17.716897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:17.717580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:41:17.723196 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:41:17.723439 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:41:17.723582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:17.798573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:41:17.799547 [debug] [ThreadPool]: On list_mydb: Close
[0m15:41:17.800627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:41:17.804256 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.804461 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:41:17.804633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:17.820288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.820574 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.820806 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:41:17.831777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:41:17.832834 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:41:17.833664 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:41:17.837620 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.837881 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.838068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:17.849850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.850181 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.850485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:17.873235 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:41:17.874648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089910d0>]}
[0m15:41:17.875006 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:17.876005 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.876282 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.877685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.877914 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.878120 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.878319 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.879091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:17.879329 [debug] [MainThread]: On master: Close
[0m15:41:17.879835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:17.880143 [info ] [MainThread]: 
[0m15:41:17.883573 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:41:17.883874 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:41:17.884160 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:41:17.884391 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:41:17.884705 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:41:17.885128 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:41:17.885571 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:41:17.885949 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:41:17.886475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:41:17.886939 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:41:17.887377 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:41:17.887800 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:41:17.888025 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:41:17.888237 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:41:17.888440 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:41:17.888641 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:41:17.890629 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:41:17.892384 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.893989 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:41:17.895551 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:41:17.896877 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:41:17.888787 => 15:41:17.896748
[0m15:41:17.897134 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:41:17.892568 => 15:41:17.897018
[0m15:41:17.897361 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:41:17.894152 => 15:41:17.897262
[0m15:41:17.897600 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:41:17.890822 => 15:41:17.897496
[0m15:41:17.897790 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:41:17.897989 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:41:17.898183 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:41:17.898381 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:41:17.921312 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:41:17.924284 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:41:17.926346 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:41:17.928401 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.929019 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.929252 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.929426 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:41:17.929588 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.929743 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.929910 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:41:17.930074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:17.930234 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:41:17.930387 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:41:17.930616 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:17.930920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:17.931100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:17.940823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.941164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.941388 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.942399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.942600 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.942783 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.943147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.943375 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.943581 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.944507 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.944702 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.944888 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:18.210875 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:41:18.219412 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.219761 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:41:18.221410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.223033 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.223239 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:41:18.224515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.236892 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.237272 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.237464 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.251345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.255030 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.255296 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:41:18.264730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.266145 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:41:17.898542 => 15:41:18.266026
[0m15:41:18.266403 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:41:18.266846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb4750>]}
[0m15:41:18.267396 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.38s]
[0m15:41:18.267788 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:41:18.393092 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.398671 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.399381 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:41:18.403938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.408115 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.408559 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:41:18.409669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.411322 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.411550 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.411729 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.425671 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.429319 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.429813 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:41:18.438811 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.440702 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:41:17.921482 => 15:41:18.440453
[0m15:41:18.441189 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:41:18.442101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c1850>]}
[0m15:41:18.442637 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:41:18.443002 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:41:18.477989 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:18.482535 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.482878 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:41:18.484737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.486543 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.486779 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:41:18.488313 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.489740 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.489955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.490119 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.500473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.502099 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.502293 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:41:18.514291 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.516786 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:41:17.924463 => 15:41:18.516496
[0m15:41:18.517288 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:41:18.518194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089919d0>]}
[0m15:41:18.518861 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.63s]
[0m15:41:18.519348 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:41:18.571529 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:41:18.573197 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.573412 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:41:18.574916 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.577556 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.577805 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:41:18.579079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.580463 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.580666 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.580829 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.591038 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.592458 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.592633 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:41:18.636115 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.638353 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:41:17.926495 => 15:41:18.638097
[0m15:41:18.638843 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:41:18.639865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830f550>]}
[0m15:41:18.640593 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.75s]
[0m15:41:18.641454 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:41:18.642631 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:41:18.643144 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.643694 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:41:18.644142 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:41:18.644815 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:41:18.645441 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:41:18.645787 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:41:18.646076 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:41:18.646541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:41:18.646854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:41:18.647144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:41:18.647439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:41:18.647768 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:41:18.647985 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.648153 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:41:18.648322 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:41:18.650939 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.652427 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.653912 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.655222 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.655833 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:41:18.648448 => 15:41:18.655722
[0m15:41:18.656032 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:41:18.658241 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.658551 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:41:18.652590 => 15:41:18.658464
[0m15:41:18.658717 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:41:18.660709 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.660961 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:41:18.651166 => 15:41:18.660857
[0m15:41:18.661201 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:41:18.654074 => 15:41:18.661120
[0m15:41:18.661383 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.661602 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.661799 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.661962 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:41:18.664146 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.664422 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:41:18.664614 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:41:18.667086 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.667420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:18.667634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:18.667824 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.668249 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.668421 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:41:18.668615 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:41:18.668795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:18.669003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:18.678334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.678667 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.678864 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.681734 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682541 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.682754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.683182 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.683373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.683547 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:41:18.683774 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    genres,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:41:18.686839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "movie_id" is ambiguous
LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                            ^

[0m15:41:18.687100 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: ROLLBACK
[0m15:41:18.688362 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:41:18.656159 => 15:41:18.688224
[0m15:41:18.688594 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:41:18.693992 [debug] [Thread-1 (]: Database Error in model sum_genre_views (models/facts/sum_genre_views.sql)
  column reference "movie_id" is ambiguous
  LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                              ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:18.694320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911a850>]}
[0m15:41:18.694634 [error] [Thread-1 (]: 5 of 8 ERROR creating sql table model dbt_warehouse.sum_genre_views ............ [[31mERROR[0m in 0.05s]
[0m15:41:18.694928 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:41:18.901672 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903358 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.903572 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903773 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:41:18.905275 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.905563 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:41:18.906639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908167 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.908356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908570 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:41:18.910832 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.911078 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:41:18.911898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.913100 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913279 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.913436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913616 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.914855 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.915057 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.915224 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.917447 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.918875 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.919061 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.919223 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:41:18.920329 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.920549 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:41:18.926917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.927811 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:41:18.658826 => 15:41:18.927718
[0m15:41:18.927977 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.928177 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:41:18.928875 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:41:18.662083 => 15:41:18.928787
[0m15:41:18.929091 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:41:18.929437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d57d0>]}
[0m15:41:18.929794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108794390>]}
[0m15:41:18.930174 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.930930 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.931741 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:41:18.932183 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:19.326668 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:19.331472 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.332128 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:41:19.333873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:19.336836 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.337351 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.337793 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.348878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.352246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.352517 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:41:19.353314 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:19.354097 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:41:18.664745 => 15:41:19.354003
[0m15:41:19.354287 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:41:19.354672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd5350>]}
[0m15:41:19.354984 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 0.71s]
[0m15:41:19.355310 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:41:19.356323 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.356552 [debug] [MainThread]: On master: BEGIN
[0m15:41:19.356700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:19.366218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:19.366513 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.366673 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.366815 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.367395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.367581 [debug] [MainThread]: On master: Close
[0m15:41:19.367924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:19.368071 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:41:19.368195 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:41:19.368311 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:41:19.368434 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:41:19.368604 [info ] [MainThread]: 
[0m15:41:19.368805 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m15:41:19.369523 [debug] [MainThread]: Command end result
[0m15:41:19.372544 [info ] [MainThread]: 
[0m15:41:19.372791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:19.373021 [info ] [MainThread]: 
[0m15:41:19.373218 [error] [MainThread]: [33mDatabase Error in model sum_genre_views (models/facts/sum_genre_views.sql)[0m
[0m15:41:19.373405 [error] [MainThread]:   column reference "movie_id" is ambiguous
[0m15:41:19.373578 [error] [MainThread]:   LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
[0m15:41:19.373743 [error] [MainThread]:                               ^
[0m15:41:19.373907 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:19.374082 [info ] [MainThread]: 
[0m15:41:19.374274 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:41:19.374589 [debug] [MainThread]: Command `dbt run` failed at 15:41:19.374542 after 1.81 seconds
[0m15:41:19.374780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa1e90>]}
[0m15:41:19.374951 [debug] [MainThread]: Flushing usage events
[0m15:43:10.788336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d05290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfbf90>]}


============================== 15:43:10.791988 | ce23b147-5871-4b2e-a756-99fa3ff46ded ==============================
[0m15:43:10.791988 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:43:10.792396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:10.837996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd3490>]}
[0m15:43:10.845245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfad10>]}
[0m15:43:10.845663 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:43:10.857439 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:43:10.878886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:10.879389 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:43:10.891283 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:43:10.920541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa950>]}
[0m15:43:10.923934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950b190>]}
[0m15:43:10.924164 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:43:10.924380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9090>]}
[0m15:43:10.925263 [info ] [MainThread]: 
[0m15:43:10.925666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:10.926303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:43:10.931954 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:43:10.932384 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:43:10.932539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:11.011753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:43:11.012909 [debug] [ThreadPool]: On list_mydb: Close
[0m15:43:11.014128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:43:11.018129 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.018363 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:43:11.018547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:11.037011 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.037260 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.037504 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:43:11.048099 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:43:11.049284 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:43:11.050253 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:43:11.054707 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.054976 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.055180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:11.067926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.068285 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.068654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:11.091964 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:43:11.093371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821bf90>]}
[0m15:43:11.093723 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:11.094717 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.094933 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.096467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.096711 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.096927 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.097128 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.097957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.098216 [debug] [MainThread]: On master: Close
[0m15:43:11.098745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:11.099040 [info ] [MainThread]: 
[0m15:43:11.102675 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:43:11.102948 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:43:11.103201 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:43:11.103438 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:43:11.103726 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:43:11.104120 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:43:11.104535 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:43:11.104925 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:43:11.105461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:43:11.105899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:43:11.106323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:43:11.106725 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:43:11.106984 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:43:11.107221 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:43:11.107451 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:43:11.107674 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:43:11.109953 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:43:11.111930 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.113700 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:43:11.115523 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:43:11.116496 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:43:11.107851 => 15:43:11.116318
[0m15:43:11.116856 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:43:11.117212 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:43:11.113903 => 15:43:11.117089
[0m15:43:11.117527 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:43:11.112147 => 15:43:11.117372
[0m15:43:11.123475 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:43:11.110168 => 15:43:11.123363
[0m15:43:11.142198 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:43:11.142532 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:43:11.142748 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:43:11.142935 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:43:11.145280 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:43:11.147960 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:43:11.150286 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.150739 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.150975 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.151137 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:43:11.151294 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.151442 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.151597 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:43:11.151750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.151905 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:43:11.152055 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:43:11.152195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:43:11.152446 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:43:11.152613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:43:11.161878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.162182 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.162379 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.164107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.164386 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.164589 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.166335 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.166650 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.166869 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.167165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.167383 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.167580 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.414405 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:43:11.423139 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.423721 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:43:11.425558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.429391 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.429685 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:43:11.430785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.448126 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.448454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.448639 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.465476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.469487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.469753 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:43:11.476117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.477086 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:43:11.117711 => 15:43:11.476990
[0m15:43:11.477341 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:43:11.477771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c2d10>]}
[0m15:43:11.478179 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:43:11.478534 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:43:11.607414 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:11.611676 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.612198 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:43:11.613772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.617721 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.618210 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:43:11.619463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.620837 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.621106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.621327 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.632869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.636409 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.636702 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:43:11.654578 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.656826 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:43:11.145602 => 15:43:11.656576
[0m15:43:11.657308 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:43:11.658264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dde150>]}
[0m15:43:11.659011 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:43:11.660019 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:43:11.689946 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:11.691695 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.691892 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:43:11.724689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.729637 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.730220 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:43:11.731404 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.733828 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.734052 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.734230 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.740414 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.741833 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.742016 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:43:11.753152 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.755153 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:43:11.143061 => 15:43:11.754916
[0m15:43:11.755623 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:43:11.756208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.756541 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.65s]
[0m15:43:11.756865 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:43:11.804099 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:43:11.808757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.809288 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:43:11.810623 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.813529 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.813822 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:43:11.814661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.815954 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.816139 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.816292 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.855367 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.861314 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.861927 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:43:11.894270 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.896364 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:43:11.148182 => 15:43:11.896105
[0m15:43:11.896832 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:43:11.897752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.898791 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.79s]
[0m15:43:11.900003 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:43:11.901390 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:43:11.901936 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.902348 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:43:11.902776 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:43:11.903383 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:43:11.904083 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:43:11.904446 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:43:11.904736 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:43:11.905223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:43:11.905576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:43:11.905885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:43:11.906168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:43:11.906369 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:43:11.906560 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.906721 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:43:11.906882 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:43:11.908874 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.910292 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.911904 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.913327 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.914672 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:43:11.909039 => 15:43:11.914531
[0m15:43:11.914954 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:43:11.912083 => 15:43:11.914824
[0m15:43:11.915187 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:43:11.906996 => 15:43:11.915096
[0m15:43:11.915355 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.915534 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:43:11.910465 => 15:43:11.915455
[0m15:43:11.915725 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:43:11.915889 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:43:11.918572 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.918778 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:43:11.920911 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.922943 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.925141 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.925499 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.925664 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.925912 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:43:11.926112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.926274 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:43:11.926465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:43:11.926646 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.926812 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:43:11.926984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:43:11.927241 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:43:11.927404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.927632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:43:11.938388 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.938705 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.938901 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.939819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940118 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.940310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940491 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940699 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:43:11.940894 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.941057 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.941284 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.941510 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:43:12.294264 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.298883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.299459 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:43:12.301447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.301947 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.306627 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.308427 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.308678 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:43:12.308945 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:43:12.310281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.311958 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.312159 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.312397 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:43:12.314039 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.314461 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.314657 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.316543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.317966 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.318227 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.318408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.318581 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.319882 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.320272 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:43:12.321519 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.322785 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.323034 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:43:12.326708 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.327633 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:43:11.916136 => 15:43:12.327540
[0m15:43:12.327813 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.328021 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:43:12.328764 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:43:11.923130 => 15:43:12.328671
[0m15:43:12.329298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c0990>]}
[0m15:43:12.329501 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:43:12.329907 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.330731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109590b10>]}
[0m15:43:12.331064 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:12.331390 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.332181 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:43:12.671796 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m15:43:12.677674 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.678323 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m15:43:12.679996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.682909 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.683393 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.683833 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.690378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.693001 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.693296 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m15:43:12.694154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.695010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:43:11.921049 => 15:43:12.694898
[0m15:43:12.695214 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:43:12.695667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109631850>]}
[0m15:43:12.696045 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.79s]
[0m15:43:12.696662 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:43:12.898803 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:12.904599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.905125 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m15:43:12.906687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.910477 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.910796 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:43:12.911806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.913217 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.913418 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.913593 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.949968 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.955393 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.955937 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:43:12.966609 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.968893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:43:11.918911 => 15:43:12.968574
[0m15:43:12.969464 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:43:12.970407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096726d0>]}
[0m15:43:12.971159 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.06s]
[0m15:43:12.971757 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:43:12.972884 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.973137 [debug] [MainThread]: On master: BEGIN
[0m15:43:12.973305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:12.983438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:12.983738 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.983892 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.984032 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.984668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.984859 [debug] [MainThread]: On master: Close
[0m15:43:12.985220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:12.985365 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:43:12.985493 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:43:12.985616 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:43:12.985732 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:43:12.985909 [info ] [MainThread]: 
[0m15:43:12.986117 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m15:43:12.987325 [debug] [MainThread]: Command end result
[0m15:43:12.991959 [info ] [MainThread]: 
[0m15:43:12.992239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:12.992435 [info ] [MainThread]: 
[0m15:43:12.992701 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:43:12.993141 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:12.993088 after 2.22 seconds
[0m15:43:12.993373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bca7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d11e90>]}
[0m15:43:12.993567 [debug] [MainThread]: Flushing usage events
[0m17:03:01.478122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f05b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bfed0>]}


============================== 17:03:01.481723 | 13e8596e-82f1-42fb-8131-07224a8663c1 ==============================
[0m17:03:01.481723 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:03:01.482072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:03:01.664394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc38d0>]}
[0m17:03:01.672704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f061d0>]}
[0m17:03:01.673185 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:03:01.699859 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:03:01.720972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:03:01.721310 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m17:03:01.732228 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m17:03:01.739850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m17:03:01.763619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8d010>]}
[0m17:03:01.767318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ee350>]}
[0m17:03:01.767538 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:03:01.767757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103934e90>]}
[0m17:03:01.768772 [info ] [MainThread]: 
[0m17:03:01.769306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:01.770006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:03:01.775748 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:03:01.775981 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:03:01.776116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:01.871311 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:03:01.872393 [debug] [ThreadPool]: On list_mydb: Close
[0m17:03:01.873628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m17:03:01.877686 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.877920 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m17:03:01.878109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:01.888930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.889206 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.889417 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m17:03:01.910508 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:03:01.911747 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m17:03:01.912612 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m17:03:01.917152 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.917429 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.917634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:01.933229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.933778 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.934180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:01.968822 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m17:03:01.969839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0d750>]}
[0m17:03:01.970080 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:01.970689 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.970831 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.971717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.971919 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972079 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.972210 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:01.972838 [debug] [MainThread]: On master: Close
[0m17:03:01.973174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:01.973372 [info ] [MainThread]: 
[0m17:03:01.975970 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m17:03:01.976170 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m17:03:01.976354 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m17:03:01.976503 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m17:03:01.976739 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m17:03:01.977047 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m17:03:01.977350 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m17:03:01.977616 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m17:03:01.978007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m17:03:01.978340 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m17:03:01.978662 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m17:03:01.978976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m17:03:01.979138 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m17:03:01.979301 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m17:03:01.979454 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m17:03:01.979604 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m17:03:01.981129 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m17:03:01.982543 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m17:03:01.983855 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m17:03:01.985705 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m17:03:01.986392 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 17:03:01.979721 => 17:03:01.986284
[0m17:03:01.986607 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m17:03:02.004956 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 17:03:01.982701 => 17:03:02.004754
[0m17:03:02.005267 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 17:03:01.981265 => 17:03:02.005132
[0m17:03:02.010021 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m17:03:02.010307 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m17:03:02.010568 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 17:03:01.983993 => 17:03:02.010438
[0m17:03:02.010788 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m17:03:02.013416 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m17:03:02.013658 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m17:03:02.013861 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.024463 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m17:03:02.027021 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m17:03:02.027233 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m17:03:02.027486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.027728 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.027917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.028113 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m17:03:02.028297 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.028483 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m17:03:02.028735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:03:02.028921 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m17:03:02.029099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:02.029383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:03:02.041223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041798 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.042013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042420 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.042652 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.042880 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.043087 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.043289 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m17:03:02.043535 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.043752 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.057810 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:02.061609 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.061840 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m17:03:02.067326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.075994 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.076293 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.076528 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.089439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.092295 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.092538 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m17:03:02.093695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:02.094575 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 17:03:02.013999 => 17:03:02.094476
[0m17:03:02.094802 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m17:03:02.095293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2f250>]}
[0m17:03:02.095991 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m17:03:02.096610 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m17:03:02.096996 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m17:03:02.097335 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m17:03:02.098197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m17:03:02.098506 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m17:03:02.100681 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m17:03:02.101230 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 17:03:02.098712 => 17:03:02.101078
[0m17:03:02.101499 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m17:03:02.104747 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m17:03:02.105897 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.106376 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m17:03:02.106597 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:02.122935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.124049 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.125059 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.826083 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:02.830693 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.831265 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m17:03:02.833555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.838671 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.839014 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m17:03:02.841394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.846268 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.846571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.846744 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.883051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.887114 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.887743 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m17:03:02.912283 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.913378 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 17:03:01.986861 => 17:03:02.913274
[0m17:03:02.913776 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m17:03:02.914440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf950>]}
[0m17:03:02.914865 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.94s]
[0m17:03:02.915274 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m17:03:02.927918 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m17:03:02.929989 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.930224 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m17:03:02.932043 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.933955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.934222 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m17:03:02.935710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.937592 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.938151 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.938389 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.959197 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.960947 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.961189 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m17:03:02.981206 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.982128 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 17:03:02.024781 => 17:03:02.982028
[0m17:03:02.982323 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m17:03:02.982706 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d710>]}
[0m17:03:02.983002 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.00s]
[0m17:03:02.983329 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m17:03:03.087916 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m17:03:03.094457 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.094980 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m17:03:03.096726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.100076 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.100504 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m17:03:03.101588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.102975 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.103174 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.103341 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.125793 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.129852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.130214 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m17:03:03.141344 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:03.143190 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.143423 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m17:03:03.145170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.146882 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.147083 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m17:03:03.148218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.149563 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.149758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.149914 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.151713 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.153164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.153350 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m17:03:03.184032 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.187306 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 17:03:02.101633 => 17:03:03.186944
[0m17:03:03.187991 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m17:03:03.189286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b350>]}
[0m17:03:03.190177 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 1.09s]
[0m17:03:03.190886 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m17:03:03.263265 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.267258 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 17:03:02.011005 => 17:03:03.266880
[0m17:03:03.267903 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m17:03:03.269051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554dfd0>]}
[0m17:03:03.269845 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 1.29s]
[0m17:03:03.270920 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m17:03:03.271956 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m17:03:03.272190 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.272419 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m17:03:03.272587 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m17:03:03.272860 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m17:03:03.273178 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m17:03:03.273485 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m17:03:03.274264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m17:03:03.273831 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m17:03:03.274763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m17:03:03.275113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m17:03:03.275328 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m17:03:03.275632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m17:03:03.275803 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.275959 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m17:03:03.277967 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.278154 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m17:03:03.279460 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.280802 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.282167 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.282523 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 17:03:03.276075 => 17:03:03.282428
[0m17:03:03.282781 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 17:03:03.278274 => 17:03:03.282688
[0m17:03:03.283033 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 17:03:03.279587 => 17:03:03.282938
[0m17:03:03.283190 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m17:03:03.283369 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 17:03:03.280989 => 17:03:03.283292
[0m17:03:03.283540 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.283718 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m17:03:03.286716 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.286924 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m17:03:03.289076 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.291504 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.294127 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.294553 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.294982 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.295267 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.295547 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m17:03:03.295768 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.295980 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m17:03:03.296193 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m17:03:03.296396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:03.296585 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m17:03:03.296754 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:03.296926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:03.297202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:03.312596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.312915 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.313116 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m17:03:03.315621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316077 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316303 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.316526 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.316791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316972 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m17:03:03.317203 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.317411 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.317688 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.649511 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.650091 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.654408 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.658668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.659264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m17:03:03.659740 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m17:03:03.661417 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.661867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.665798 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.669538 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.670231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m17:03:03.670729 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m17:03:03.672339 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.672806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.676603 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.679951 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.680506 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.680961 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.681406 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.681838 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.693538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.694070 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.697370 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.700480 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.700964 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m17:03:03.701436 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m17:03:03.707257 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.708170 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 17:03:03.287052 => 17:03:03.708075
[0m17:03:03.708513 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.709049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m17:03:03.710787 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 17:03:03.289286 => 17:03:03.710558
[0m17:03:03.711720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3c410>]}
[0m17:03:03.712137 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m17:03:03.712855 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.714068 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.714991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc2450>]}
[0m17:03:03.716002 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.716608 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m17:03:03.943691 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:03.949599 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.950106 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m17:03:03.951353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.954596 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.954844 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m17:03:03.955739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.957157 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.957350 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.957517 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.981833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.985327 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.986066 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m17:03:03.990747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.991703 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 17:03:03.283838 => 17:03:03.991607
[0m17:03:03.991903 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m17:03:03.992309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe90d0>]}
[0m17:03:03.992617 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.72s]
[0m17:03:03.992938 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m17:03:04.201642 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:04.205922 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.206523 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m17:03:04.208134 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.213669 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.213896 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m17:03:04.214620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.215798 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.215968 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.216119 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.234836 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.238823 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.239084 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m17:03:04.273614 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:04.277030 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 17:03:03.291763 => 17:03:04.276722
[0m17:03:04.277674 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m17:03:04.278776 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0c450>]}
[0m17:03:04.279636 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.00s]
[0m17:03:04.280502 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m17:03:04.282126 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.282387 [debug] [MainThread]: On master: BEGIN
[0m17:03:04.282534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:04.291381 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:04.291686 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.291849 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.291981 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.292501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.292649 [debug] [MainThread]: On master: Close
[0m17:03:04.292977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:04.293112 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m17:03:04.293232 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m17:03:04.293347 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m17:03:04.293455 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m17:03:04.293640 [info ] [MainThread]: 
[0m17:03:04.293852 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m17:03:04.294693 [debug] [MainThread]: Command end result
[0m17:03:04.297885 [info ] [MainThread]: 
[0m17:03:04.298117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:04.298314 [info ] [MainThread]: 
[0m17:03:04.298520 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:03:04.298949 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:04.298905 after 2.84 seconds
[0m17:03:04.299159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123fb90>]}
[0m17:03:04.299340 [debug] [MainThread]: Flushing usage events

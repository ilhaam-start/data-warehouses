[0m12:26:14.235820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108164410>]}


============================== 12:26:14.239466 | 2a429d10-1037-4619-a0bf-134dcf1ba90b ==============================
[0m12:26:14.239466 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:26:14.239858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:26:14.240190 [info ] [MainThread]: dbt version: 1.5.3
[0m12:26:14.240416 [info ] [MainThread]: python version: 3.11.2
[0m12:26:14.240630 [info ] [MainThread]: python path: /Users/ilhaam.ahmed/.pyenv/versions/3.11.2/bin/python3.11
[0m12:26:14.240817 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m12:26:14.240997 [info ] [MainThread]: Using profiles.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/profiles.yml
[0m12:26:14.241194 [info ] [MainThread]: Using dbt_project.yml file at /Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/dbt_project.yml
[0m12:26:14.241365 [info ] [MainThread]: Configuration:
[0m12:26:14.275994 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:26:14.285577 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:26:14.285953 [info ] [MainThread]: Required dependencies:
[0m12:26:14.286274 [debug] [MainThread]: Executing "git --help"
[0m12:26:14.300230 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:26:14.300834 [debug] [MainThread]: STDERR: "b''"
[0m12:26:14.301006 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:26:14.301211 [info ] [MainThread]: Connection:
[0m12:26:14.301519 [info ] [MainThread]:   host: localhost
[0m12:26:14.301726 [info ] [MainThread]:   port: 5433
[0m12:26:14.301910 [info ] [MainThread]:   user: postgres
[0m12:26:14.302078 [info ] [MainThread]:   database: mydb
[0m12:26:14.302250 [info ] [MainThread]:   schema: dbt_warehouse
[0m12:26:14.302413 [info ] [MainThread]:   search_path: None
[0m12:26:14.302571 [info ] [MainThread]:   keepalives_idle: 0
[0m12:26:14.302737 [info ] [MainThread]:   sslmode: None
[0m12:26:14.303365 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:26:14.351980 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:26:14.352585 [debug] [MainThread]: Using postgres connection "debug"
[0m12:26:14.352774 [debug] [MainThread]: On debug: select 1 as id
[0m12:26:14.352969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:14.456247 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:26:14.457461 [debug] [MainThread]: On debug: Close
[0m12:26:14.457745 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:26:14.458061 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:26:14.458678 [debug] [MainThread]: Command `dbt debug` succeeded at 12:26:14.458569 after 0.24 seconds
[0m12:26:14.458958 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:26:14.459245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e40bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104839dd0>]}
[0m12:26:14.459606 [debug] [MainThread]: Flushing usage events
[0m13:52:26.676660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b65290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7e610>]}


============================== 13:52:26.680294 | aa10f4ec-db41-42b5-8e28-5fbdffcca489 ==============================
[0m13:52:26.680294 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:52:26.680676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:52:26.723630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b90790>]}
[0m13:52:26.730558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c332d0>]}
[0m13:52:26.730924 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:52:26.741617 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:52:26.742080 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:26.742345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43550>]}
[0m13:52:27.020742 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m13:52:27.049121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34490>]}
[0m13:52:27.051893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b99290>]}
[0m13:52:27.052107 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m13:52:27.052313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102929090>]}
[0m13:52:27.053054 [info ] [MainThread]: 
[0m13:52:27.053519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:27.054069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:52:27.059627 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:52:27.059917 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:52:27.060063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:27.192877 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:52:27.194282 [debug] [ThreadPool]: On list_mydb: Close
[0m13:52:27.195472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now create_mydb_dbt_warehouse)
[0m13:52:27.196229 [debug] [ThreadPool]: Creating schema "database: "mydb"
schema: "dbt_warehouse"
"
[0m13:52:27.201149 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.201473 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: BEGIN
[0m13:52:27.201706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.219554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.219933 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.220190 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "create_mydb_dbt_warehouse"} */
create schema if not exists "dbt_warehouse"
[0m13:52:27.226989 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:52:27.227971 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.228253 [debug] [ThreadPool]: Using postgres connection "create_mydb_dbt_warehouse"
[0m13:52:27.228499 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: COMMIT
[0m13:52:27.229854 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.230129 [debug] [ThreadPool]: On create_mydb_dbt_warehouse: Close
[0m13:52:27.231578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydb_dbt_warehouse, now list_mydb_dbt_warehouse)
[0m13:52:27.237782 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.238131 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:52:27.238365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:27.253413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.253849 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:52:27.254132 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:52:27.270032 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:52:27.271259 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:52:27.272522 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:52:27.276904 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.277267 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.277523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:27.293826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.294162 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.294475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:27.332359 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m13:52:27.333327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c41a10>]}
[0m13:52:27.333567 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:27.334183 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.334332 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.335181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.335369 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.335518 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.335656 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.336177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.336353 [debug] [MainThread]: On master: Close
[0m13:52:27.336735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:27.336971 [info ] [MainThread]: 
[0m13:52:27.342289 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m13:52:27.342573 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m13:52:27.342971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m13:52:27.343142 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m13:52:27.344539 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:52:27.345042 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 13:52:27.343256 => 13:52:27.344947
[0m13:52:27.345214 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m13:52:27.363406 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:52:27.364036 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.364210 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m13:52:27.364370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:27.374858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.375151 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.375328 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m13:52:27.392308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:27.395547 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.395725 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:52:27.396965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:27.404734 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.404974 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.405132 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m13:52:27.406809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.409217 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:52:27.409404 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:52:27.410450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:27.411861 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 13:52:27.345325 => 13:52:27.411776
[0m13:52:27.412033 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m13:52:27.412399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa10f4ec-db41-42b5-8e28-5fbdffcca489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537fb90>]}
[0m13:52:27.412688 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:52:27.413044 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m13:52:27.413818 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.413989 [debug] [MainThread]: On master: BEGIN
[0m13:52:27.414127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:27.423508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:27.423783 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.423965 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:27.424111 [debug] [MainThread]: On master: COMMIT
[0m13:52:27.424657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:27.424836 [debug] [MainThread]: On master: Close
[0m13:52:27.425187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:27.425331 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m13:52:27.425482 [info ] [MainThread]: 
[0m13:52:27.425672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:52:27.426058 [debug] [MainThread]: Command end result
[0m13:52:27.429100 [info ] [MainThread]: 
[0m13:52:27.429354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:27.429546 [info ] [MainThread]: 
[0m13:52:27.429743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:27.430082 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:27.430028 after 0.77 seconds
[0m13:52:27.430280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101241dd0>]}
[0m13:52:27.430462 [debug] [MainThread]: Flushing usage events
[0m14:00:06.923103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06f50>]}


============================== 14:00:06.926738 | 9ef958ac-c326-40b4-aeb2-e691566c55a1 ==============================
[0m14:00:06.926738 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:06.927095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:06.968739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835c10>]}
[0m14:00:06.975720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f389d0>]}
[0m14:00:06.976095 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:00:06.986906 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:07.004326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:07.004564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:07.007813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879abd0>]}
[0m14:00:07.010917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087186d0>]}
[0m14:00:07.011147 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:00:07.011362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b15090>]}
[0m14:00:07.012241 [info ] [MainThread]: 
[0m14:00:07.012713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:07.013273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:00:07.018825 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:00:07.019123 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:00:07.019284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:07.081850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:00:07.082887 [debug] [ThreadPool]: On list_mydb: Close
[0m14:00:07.083791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:00:07.087471 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.087686 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:00:07.087858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:07.101379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.101689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:00:07.101906 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:00:07.111581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:00:07.112618 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:00:07.113505 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:00:07.116574 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.116823 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.117012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:07.130234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.130590 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.130913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:07.152393 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:00:07.154090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f3e50>]}
[0m14:00:07.154442 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:07.155396 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.155681 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.157019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.157250 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.157457 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.157656 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.158421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.158664 [debug] [MainThread]: On master: Close
[0m14:00:07.159170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:07.159473 [info ] [MainThread]: 
[0m14:00:07.162648 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:00:07.163068 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_warehouse.movies ............................... [RUN]
[0m14:00:07.163866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:00:07.164161 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:00:07.166170 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:00:07.166906 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:00:07.164342 => 14:00:07.166727
[0m14:00:07.167163 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:00:07.213938 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:00:07.214718 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.214912 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:00:07.215082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:07.224154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.224456 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.224645 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  create view "mydb"."dbt_warehouse"."movies__dbt_tmp"
    
    
  as (
    SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
[0m14:00:07.234328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:00:07.237904 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.238119 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:00:07.239115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.240752 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.240951 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:00:07.242173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:07.251829 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.252040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.252224 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:00:07.254883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.257590 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:00:07.257790 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:00:07.261120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:00:07.261889 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:00:07.167313 => 14:00:07.261792
[0m14:00:07.262080 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:00:07.262477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef958ac-c326-40b4-aeb2-e691566c55a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1110>]}
[0m14:00:07.262812 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_warehouse.movies .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:00:07.263155 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:00:07.263995 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.264218 [debug] [MainThread]: On master: BEGIN
[0m14:00:07.264381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:07.272218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:07.272527 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.272703 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:07.272855 [debug] [MainThread]: On master: COMMIT
[0m14:00:07.273311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:07.273499 [debug] [MainThread]: On master: Close
[0m14:00:07.273853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:07.273997 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:00:07.274157 [info ] [MainThread]: 
[0m14:00:07.274364 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:00:07.274728 [debug] [MainThread]: Command end result
[0m14:00:07.278074 [info ] [MainThread]: 
[0m14:00:07.278355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:07.278571 [info ] [MainThread]: 
[0m14:00:07.278798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:07.279199 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:07.279142 after 0.37 seconds
[0m14:00:07.279416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442ddd0>]}
[0m14:00:07.279607 [debug] [MainThread]: Flushing usage events
[0m14:05:35.767644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006f50>]}


============================== 14:05:35.771199 | 034175d4-7d67-41d6-aae2-e41f66afff51 ==============================
[0m14:05:35.771199 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:05:35.771552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.812857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701d910>]}
[0m14:05:35.819827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702f0d0>]}
[0m14:05:35.820183 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:05:35.831018 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:05:35.848775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:35.849146 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:05:35.860302 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:05:35.870818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c3110>]}
[0m14:05:35.892339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ab4d0>]}
[0m14:05:35.892633 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:05:35.892848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5090>]}
[0m14:05:35.893574 [info ] [MainThread]: 
[0m14:05:35.894006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:35.894587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:05:35.900040 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:05:35.900283 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:05:35.900433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.983261 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:05:35.984470 [debug] [ThreadPool]: On list_mydb: Close
[0m14:05:35.985571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:05:35.989689 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:35.989929 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:05:35.990119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.002024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.002289 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:05:36.002496 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:05:36.011510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:05:36.012684 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:05:36.013614 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:05:36.017116 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.017383 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.017581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:36.028720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.028992 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.029270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:36.050451 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:05:36.051943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16090>]}
[0m14:05:36.052305 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:36.053311 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.053537 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.054868 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.055101 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.055303 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.055497 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.056245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:36.056523 [debug] [MainThread]: On master: Close
[0m14:05:36.057046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:36.057372 [info ] [MainThread]: 
[0m14:05:36.060775 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:05:36.061188 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:05:36.061790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:05:36.062057 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:05:36.064206 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:05:36.065124 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:05:36.062232 => 14:05:36.064996
[0m14:05:36.065356 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:05:36.090105 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:05:36.091354 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.091560 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:05:36.091737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.101771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:05:36.102071 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:36.102278 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:05:37.468669 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:05:37.476258 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.476531 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:05:37.478081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.479736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.479929 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:05:37.480699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:37.492065 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.492271 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.492436 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:05:37.496382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.498965 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:05:37.499154 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop view if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:05:37.502157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:05:37.502968 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:05:36.065506 => 14:05:37.502872
[0m14:05:37.503146 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:05:37.503521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034175d4-7d67-41d6-aae2-e41f66afff51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7cd0>]}
[0m14:05:37.503834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.44s]
[0m14:05:37.504157 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:05:37.505025 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.505211 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.505350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:37.517818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:37.518103 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.518258 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:37.518397 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.519061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:37.519265 [debug] [MainThread]: On master: Close
[0m14:05:37.519619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:37.519760 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:05:37.519916 [info ] [MainThread]: 
[0m14:05:37.520122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m14:05:37.520481 [debug] [MainThread]: Command end result
[0m14:05:37.523497 [info ] [MainThread]: 
[0m14:05:37.523766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:37.523948 [info ] [MainThread]: 
[0m14:05:37.524146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:37.524464 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:37.524416 after 1.77 seconds
[0m14:05:37.524657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024dde90>]}
[0m14:05:37.524846 [debug] [MainThread]: Flushing usage events
[0m14:06:18.492016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106737710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759e50>]}


============================== 14:06:18.495662 | 93c3510f-4610-440d-aa6a-e9d1619a3ed2 ==============================
[0m14:06:18.495662 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:18.496016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:18.537571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758950>]}
[0m14:06:18.544909 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:18.554628 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:18.575371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:18.575827 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:18.587360 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:18.598080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c3510f-4610-440d-aa6a-e9d1619a3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839790>]}
[0m14:06:18.618526 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:18.621044 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:18.621662 [debug] [MainThread]: Command `dbt run` failed at 14:06:18.621588 after 0.14 seconds
[0m14:06:18.621879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681b110>]}
[0m14:06:18.622078 [debug] [MainThread]: Flushing usage events
[0m14:06:26.143579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c20d0>]}


============================== 14:06:26.146997 | 7ce145a1-6c34-45d2-8d05-9e2befcfa206 ==============================
[0m14:06:26.146997 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:26.147385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:26.180293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f10>]}
[0m14:06:26.187683 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:26.197576 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:26.213972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:26.214222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:26.217566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce145a1-6c34-45d2-8d05-9e2befcfa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7ce90>]}
[0m14:06:26.220323 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.movies
[0m14:06:26.222396 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.movies

[0m14:06:26.222992 [debug] [MainThread]: Command `dbt run` failed at 14:06:26.222914 after 0.09 seconds
[0m14:06:26.223201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102885dd0>]}
[0m14:06:26.223391 [debug] [MainThread]: Flushing usage events
[0m14:06:32.487972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108287750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829de50>]}


============================== 14:06:32.491425 | 5c947364-d1d9-4d4d-a03b-bb59702be088 ==============================
[0m14:06:32.491425 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:06:32.491763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:32.524418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b0510>]}
[0m14:06:32.531494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108286150>]}
[0m14:06:32.531888 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:06:32.541254 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:06:32.556488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:32.556822 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:06:32.567551 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:06:32.578062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108916850>]}
[0m14:06:32.599183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834ef50>]}
[0m14:06:32.599483 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:06:32.599697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106049090>]}
[0m14:06:32.600406 [info ] [MainThread]: 
[0m14:06:32.600869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:32.601427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:06:32.606715 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:06:32.607005 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:06:32.607162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:32.680926 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:06:32.682031 [debug] [ThreadPool]: On list_mydb: Close
[0m14:06:32.683155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:06:32.687270 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.687533 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:06:32.687728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:32.700071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.700385 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:06:32.700613 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:06:32.711235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:32.712315 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:06:32.713178 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:06:32.716355 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.716611 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.716801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:32.726431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.726701 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.726985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:32.744351 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:06:32.745617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad250>]}
[0m14:06:32.745932 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:32.746718 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.746913 [debug] [MainThread]: On master: BEGIN
[0m14:06:32.748164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.748393 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.748595 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:32.748787 [debug] [MainThread]: On master: COMMIT
[0m14:06:32.749581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:32.749877 [debug] [MainThread]: On master: Close
[0m14:06:32.750421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:32.750742 [info ] [MainThread]: 
[0m14:06:32.753796 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:06:32.754145 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:06:32.754661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movies)
[0m14:06:32.754893 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:06:32.756814 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:06:32.757627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:06:32.755047 => 14:06:32.757476
[0m14:06:32.757886 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:06:32.783213 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:06:32.784010 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.784238 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:06:32.784426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:32.793492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:32.793813 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:32.794016 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:06:33.143275 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:06:33.154582 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.154865 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:06:33.156060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.157736 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.157926 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:06:33.158715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:33.169624 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.169830 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.169991 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:06:33.173486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.176107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:06:33.176309 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:06:33.182264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:33.183109 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:06:32.758050 => 14:06:33.183019
[0m14:06:33.183290 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:06:33.183665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c947364-d1d9-4d4d-a03b-bb59702be088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894ee50>]}
[0m14:06:33.183990 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m14:06:33.184326 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:06:33.185204 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.185402 [debug] [MainThread]: On master: BEGIN
[0m14:06:33.185543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:33.194950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:33.195236 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.195392 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:33.195528 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.196087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:33.196262 [debug] [MainThread]: On master: Close
[0m14:06:33.196595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:33.196736 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:06:33.196890 [info ] [MainThread]: 
[0m14:06:33.197104 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m14:06:33.197477 [debug] [MainThread]: Command end result
[0m14:06:33.200808 [info ] [MainThread]: 
[0m14:06:33.201082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:33.201287 [info ] [MainThread]: 
[0m14:06:33.201500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:33.201879 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:33.201830 after 0.73 seconds
[0m14:06:33.202061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961e90>]}
[0m14:06:33.202228 [debug] [MainThread]: Flushing usage events
[0m14:52:53.002139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5f10>]}


============================== 14:52:53.005787 | bd12cd35-77a0-4cfa-af96-d914f5056086 ==============================
[0m14:52:53.005787 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:52:53.006139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:53.049813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d5d50>]}
[0m14:52:53.056779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c49d0>]}
[0m14:52:53.057166 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:52:53.067561 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:52:53.087471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m14:52:53.087798 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:52:53.087966 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:52:53.088171 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:52:53.088350 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:52:53.099750 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:52:53.107037 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:52:53.108926 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:52:53.110745 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:52:53.134489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e68b90>]}
[0m14:52:53.138287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3efd0>]}
[0m14:52:53.138507 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:52:53.138720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104481090>]}
[0m14:52:53.139512 [info ] [MainThread]: 
[0m14:52:53.139913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:53.140469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:52:53.145835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:52:53.146114 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:52:53.146259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:53.281367 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:52:53.282930 [debug] [ThreadPool]: On list_mydb: Close
[0m14:52:53.284509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:52:53.290006 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.290300 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:52:53.290559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:53.309561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.310028 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:53.310372 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:52:53.322942 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:53.324404 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:52:53.325775 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:52:53.330527 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.330909 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.331189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:53.348320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.348797 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.349238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:53.375876 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:52:53.377138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb2d0>]}
[0m14:52:53.377453 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:53.378228 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.378414 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.379532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.379718 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.379885 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.380051 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.380818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.381020 [debug] [MainThread]: On master: Close
[0m14:52:53.381468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:53.381727 [info ] [MainThread]: 
[0m14:52:53.384870 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:52:53.385143 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:52:53.385462 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:52:53.385828 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:52:53.386368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:52:53.386821 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:52:53.387074 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:52:53.387339 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:52:53.389449 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.391133 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:52:53.391811 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:52:53.387541 => 14:52:53.391683
[0m14:52:53.392033 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:52:53.392263 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:52:53.389655 => 14:52:53.392154
[0m14:52:53.416685 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:52:53.416396 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:52:53.420514 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:52:53.421045 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.421280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:52:53.421531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:53.421786 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.422117 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:52:53.422318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:53.432698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.433330 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:53.433549 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:53.433803 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.434068 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    movie_id,
    user_id
FROM mydb.public.raw_netflix;
  );
  
[0m14:52:53.435161 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435378 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM mydb.public.raw_netflix;
                                     ^

[0m14:52:53.435644 [debug] [Thread-2 (]: On model.maker_warehouse.movies: ROLLBACK
[0m14:52:53.435936 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: ROLLBACK
[0m14:52:53.436854 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:52:53.417010 => 14:52:53.436726
[0m14:52:53.437199 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:52:53.392410 => 14:52:53.437078
[0m14:52:53.437428 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:52:53.437644 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:52:53.444341 [debug] [Thread-1 (]: Database Error in model movie_viewings (models/facts/movie_viewings.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.445198 [debug] [Thread-2 (]: Database Error in model movies (models/facts/movies.sql)
  syntax error at or near ";"
  LINE 19: FROM mydb.public.raw_netflix;
                                       ^
  compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.445496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679bcd0>]}
[0m14:52:53.445747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd12cd35-77a0-4cfa-af96-d914f5056086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4edd0>]}
[0m14:52:53.446187 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_warehouse.movie_viewings ............. [[31mERROR[0m in 0.06s]
[0m14:52:53.446641 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model dbt_warehouse.movies ..................... [[31mERROR[0m in 0.06s]
[0m14:52:53.447008 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:52:53.447264 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:52:53.447653 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.447842 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:52:53.448133 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_warehouse.sum_movie_viewing_time ...................... [[33mSKIP[0m]
[0m14:52:53.448460 [info ] [Thread-3 (]: 4 of 4 SKIP relation dbt_warehouse.sum_movie_views ............................. [[33mSKIP[0m]
[0m14:52:53.448789 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:53.449018 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:52:53.449902 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.450073 [debug] [MainThread]: On master: BEGIN
[0m14:52:53.450219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:53.459117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:53.459411 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.459575 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:53.459728 [debug] [MainThread]: On master: COMMIT
[0m14:52:53.460243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:53.460415 [debug] [MainThread]: On master: Close
[0m14:52:53.460787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:53.460933 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:52:53.461080 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:52:53.461262 [info ] [MainThread]: 
[0m14:52:53.461484 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:52:53.461879 [debug] [MainThread]: Command end result
[0m14:52:53.465106 [info ] [MainThread]: 
[0m14:52:53.465388 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:53.465586 [info ] [MainThread]: 
[0m14:52:53.465782 [error] [MainThread]: [33mDatabase Error in model movie_viewings (models/facts/movie_viewings.sql)[0m
[0m14:52:53.465973 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.466222 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.466460 [error] [MainThread]:                                        ^
[0m14:52:53.466663 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movie_viewings.sql
[0m14:52:53.466968 [info ] [MainThread]: 
[0m14:52:53.467177 [error] [MainThread]: [33mDatabase Error in model movies (models/facts/movies.sql)[0m
[0m14:52:53.467368 [error] [MainThread]:   syntax error at or near ";"
[0m14:52:53.467551 [error] [MainThread]:   LINE 19: FROM mydb.public.raw_netflix;
[0m14:52:53.467772 [error] [MainThread]:                                        ^
[0m14:52:53.467963 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/movies.sql
[0m14:52:53.468157 [info ] [MainThread]: 
[0m14:52:53.468426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m14:52:53.468822 [debug] [MainThread]: Command `dbt run` failed at 14:52:53.468759 after 0.48 seconds
[0m14:52:53.469060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d99dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1d10>]}
[0m14:52:53.469269 [debug] [MainThread]: Flushing usage events
[0m14:54:10.235881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062092d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106210410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062221d0>]}


============================== 14:54:10.239721 | bde4c731-7a74-49fc-bc0d-80cc781a44ec ==============================
[0m14:54:10.239721 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:10.240117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:10.289824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223050>]}
[0m14:54:10.296825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d7690>]}
[0m14:54:10.297197 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:10.307554 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:10.326864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:10.327221 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:54:10.327406 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/movies.sql
[0m14:54:10.339126 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:54:10.346324 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:54:10.351777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620bf90>]}
[0m14:54:10.372977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9ed0>]}
[0m14:54:10.373240 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:10.373450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcd090>]}
[0m14:54:10.374271 [info ] [MainThread]: 
[0m14:54:10.374714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:10.375373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:10.380773 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:10.381017 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:10.381166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:10.455292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:10.456374 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:10.457515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:10.461554 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.461778 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:10.461966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:10.481646 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.481877 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:10.482084 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:10.493755 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:10.494815 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:10.495753 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:10.499251 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.499726 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.499936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:10.513050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.513437 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.513800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:10.537336 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:10.538746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539fb50>]}
[0m14:54:10.539109 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:10.540132 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.540382 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.541924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.542181 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.542408 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.542628 [debug] [MainThread]: On master: COMMIT
[0m14:54:10.543446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:10.543693 [debug] [MainThread]: On master: Close
[0m14:54:10.544239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:10.544579 [info ] [MainThread]: 
[0m14:54:10.548600 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:10.548930 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:10.549354 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:10.549805 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:10.550447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:10.550981 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:10.551317 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:10.551632 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:10.554260 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.556361 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:10.557001 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:10.551865 => 14:54:10.556844
[0m14:54:10.557302 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:10.554555 => 14:54:10.557164
[0m14:54:10.557571 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:10.557829 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:10.586680 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:10.587977 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:10.588448 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.588666 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.588840 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:10.589031 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:10.589202 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:10.589366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:10.598245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:10.598765 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:10.598966 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:10.599164 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:10.599368 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:11.055653 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:11.065278 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.065566 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:11.067142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.068677 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.068859 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:11.069777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.080556 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.080824 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.080988 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:11.097353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.100284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:11.100493 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:11.109203 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.110135 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:10.581973 => 14:54:11.110042
[0m14:54:11.110333 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:11.110727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e3410>]}
[0m14:54:11.111061 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m14:54:11.111490 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:11.212220 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:11.219196 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.219775 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:11.220995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:11.223407 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.223639 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.223805 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:11.234985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.237749 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:11.238001 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:11.239181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:11.239946 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:10.558009 => 14:54:11.239854
[0m14:54:11.240125 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:11.240491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062df2d0>]}
[0m14:54:11.240777 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.69s]
[0m14:54:11.241112 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:11.241645 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.241826 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:11.242070 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:11.242345 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:11.242793 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:11.243133 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:11.243319 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.243483 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:11.244970 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.246797 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.247421 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:11.243602 => 14:54:11.247308
[0m14:54:11.247609 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.247802 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:11.245227 => 14:54:11.247713
[0m14:54:11.249993 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.250237 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:11.252545 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:11.252903 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.253077 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:11.253236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:11.253524 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.253689 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:11.253839 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:11.262196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.262660 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:11.262846 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:11.263049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.263257 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id;
  );
  
[0m14:54:11.264133 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264319 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: GROUP BY movie_id;
                          ^

[0m14:54:11.264548 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m14:54:11.264757 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m14:54:11.265630 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:11.250427 => 14:54:11.265517
[0m14:54:11.265932 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:11.247920 => 14:54:11.265824
[0m14:54:11.266156 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:11.266337 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:11.272114 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.272812 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  syntax error at or near ";"
  LINE 18: GROUP BY movie_id;
                            ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.273060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b9810>]}
[0m14:54:11.273263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde4c731-7a74-49fc-bc0d-80cc781a44ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a990>]}
[0m14:54:11.273558 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.03s]
[0m14:54:11.273823 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.03s]
[0m14:54:11.274168 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:11.274369 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:11.275151 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.275299 [debug] [MainThread]: On master: BEGIN
[0m14:54:11.275428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:11.283190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:11.283464 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.283619 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.283761 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.284359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:11.284535 [debug] [MainThread]: On master: Close
[0m14:54:11.284875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:11.285016 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:11.285138 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:11.285257 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:11.285376 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:11.285546 [info ] [MainThread]: 
[0m14:54:11.285749 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:54:11.286254 [debug] [MainThread]: Command end result
[0m14:54:11.289367 [info ] [MainThread]: 
[0m14:54:11.289616 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:54:11.289799 [info ] [MainThread]: 
[0m14:54:11.289974 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m14:54:11.290144 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.290309 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.290469 [error] [MainThread]:                             ^
[0m14:54:11.290630 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m14:54:11.290793 [info ] [MainThread]: 
[0m14:54:11.290958 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m14:54:11.291124 [error] [MainThread]:   syntax error at or near ";"
[0m14:54:11.291283 [error] [MainThread]:   LINE 18: GROUP BY movie_id;
[0m14:54:11.291440 [error] [MainThread]:                             ^
[0m14:54:11.291597 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m14:54:11.291764 [info ] [MainThread]: 
[0m14:54:11.291997 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m14:54:11.292352 [debug] [MainThread]: Command `dbt run` failed at 14:54:11.292300 after 1.07 seconds
[0m14:54:11.292550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02510>]}
[0m14:54:11.292724 [debug] [MainThread]: Flushing usage events
[0m14:54:29.143599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b53f90>]}


============================== 14:54:29.147195 | 55b68981-3ebb-438a-b2ce-8f3f1ba487ee ==============================
[0m14:54:29.147195 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:29.147546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:29.188375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75d90>]}
[0m14:54:29.195353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a28850>]}
[0m14:54:29.195712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:29.206355 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:29.223147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:29.223487 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:54:29.223676 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:54:29.235466 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:54:29.242626 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:54:29.247946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fffd0>]}
[0m14:54:29.269107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2ecd0>]}
[0m14:54:29.269458 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:54:29.269710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921090>]}
[0m14:54:29.270575 [info ] [MainThread]: 
[0m14:54:29.271017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:29.271664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:29.277074 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:29.277404 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:29.277576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:29.339125 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:29.340106 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:29.341125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:29.344793 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.345004 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:29.345175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:29.359652 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.359841 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:29.360027 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:29.368130 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:54:29.369058 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:29.369798 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:29.373168 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.373403 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.373578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:29.383454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.383752 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.384030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:29.399334 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m14:54:29.400553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b64610>]}
[0m14:54:29.400857 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:29.401804 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.402000 [debug] [MainThread]: On master: BEGIN
[0m14:54:29.404550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.404764 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.404946 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:29.405119 [debug] [MainThread]: On master: COMMIT
[0m14:54:29.405823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.406053 [debug] [MainThread]: On master: Close
[0m14:54:29.406518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:29.406796 [info ] [MainThread]: 
[0m14:54:29.409712 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:29.409991 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:29.410341 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m14:54:29.410739 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m14:54:29.411284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m14:54:29.411769 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m14:54:29.412016 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:29.412242 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:29.414254 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.415887 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:29.416405 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:29.414443 => 14:54:29.416273
[0m14:54:29.416660 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:29.412407 => 14:54:29.416547
[0m14:54:29.416875 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:29.417080 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:29.440117 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:29.442376 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:29.443148 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.443342 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.443513 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:29.443672 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:29.443829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.443977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:29.453635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.453955 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.454150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:29.454415 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.454625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:29.454869 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:29.793754 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:29.803496 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.803778 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:29.805129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.806796 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.806985 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:29.808008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:29.818890 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.819156 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.819320 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:29.829033 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:29.831949 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:29.832174 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:29.881596 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:29.884282 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:29.417218 => 14:54:29.883855
[0m14:54:29.884905 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:29.886101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c222d0>]}
[0m14:54:29.887003 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.47s]
[0m14:54:29.887732 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:30.100449 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:30.107266 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.107845 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:54:30.109386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.112239 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.112535 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:30.113606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.115088 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.115273 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.115433 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:30.123069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.125886 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:30.126136 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:30.186535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.190228 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:29.440347 => 14:54:30.189853
[0m14:54:30.190921 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:30.192019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104456490>]}
[0m14:54:30.192838 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.78s]
[0m14:54:30.193747 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:30.194780 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.195420 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:30.195173 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m14:54:30.195815 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m14:54:30.196312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m14:54:30.196656 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m14:54:30.196837 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.197000 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:30.199061 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.200597 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.201266 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:30.199297 => 14:54:30.201132
[0m14:54:30.201492 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:30.197117 => 14:54:30.201396
[0m14:54:30.201677 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:30.201852 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.203945 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:30.205873 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206210 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.206396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:30.206572 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.206754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:30.206929 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:30.207166 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:30.215877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.216385 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.216585 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.216777 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.216966 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m14:54:30.339307 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.340389 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:30.346198 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.348780 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.349080 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:54:30.349264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:54:30.350207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.350397 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:30.351484 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.352494 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.352672 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.352836 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.352994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:30.353149 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:30.355073 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.356334 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:30.356509 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:54:30.356674 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.358595 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:30.358756 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.358928 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:54:30.359621 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:30.204070 => 14:54:30.359534
[0m14:54:30.359824 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:30.360199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9dd0>]}
[0m14:54:30.360372 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:30.360674 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.16s]
[0m14:54:30.361459 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:30.201960 => 14:54:30.361366
[0m14:54:30.361756 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:30.361959 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:30.362466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b68981-3ebb-438a-b2ce-8f3f1ba487ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ca890>]}
[0m14:54:30.362771 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m14:54:30.363100 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:30.364864 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.365148 [debug] [MainThread]: On master: BEGIN
[0m14:54:30.365301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:30.374589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:30.374882 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375033 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:30.375173 [debug] [MainThread]: On master: COMMIT
[0m14:54:30.375807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:30.375958 [debug] [MainThread]: On master: Close
[0m14:54:30.376315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:30.376446 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m14:54:30.376566 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m14:54:30.376683 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:30.376795 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:30.376961 [info ] [MainThread]: 
[0m14:54:30.377158 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:54:30.377689 [debug] [MainThread]: Command end result
[0m14:54:30.380747 [info ] [MainThread]: 
[0m14:54:30.381045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:30.381302 [info ] [MainThread]: 
[0m14:54:30.381519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:54:30.381865 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:30.381811 after 1.25 seconds
[0m14:54:30.382075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f0690>]}
[0m14:54:30.382266 [debug] [MainThread]: Flushing usage events
[0m15:05:23.550862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106189290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106058bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a25d0>]}


============================== 15:05:23.554403 | a888bcc0-2d9e-49e3-9319-7b7a18507126 ==============================
[0m15:05:23.554403 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:23.554814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:23.597999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106243f50>]}
[0m15:05:23.604967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b6190>]}
[0m15:05:23.605333 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:23.616128 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:23.637158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:23.637533 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:23.637726 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:23.649569 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:23.656893 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:23.662653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062611d0>]}
[0m15:05:23.683492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068174d0>]}
[0m15:05:23.683765 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:23.683979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4d090>]}
[0m15:05:23.684843 [info ] [MainThread]: 
[0m15:05:23.685295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:23.685983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:23.691529 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:23.691781 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:23.691933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:23.780791 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:23.781911 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:23.783139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:23.787204 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.787430 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:23.787617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:23.800457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.800749 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:23.800970 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:23.812628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:23.813805 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:23.814669 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:23.818681 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.818975 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.819177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:23.832048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.832380 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.832699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:23.858134 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:23.859694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7f850>]}
[0m15:05:23.860082 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:23.861064 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.861386 [debug] [MainThread]: On master: BEGIN
[0m15:05:23.863163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.863490 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.863774 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:23.864021 [debug] [MainThread]: On master: COMMIT
[0m15:05:23.864880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:23.865138 [debug] [MainThread]: On master: Close
[0m15:05:23.865651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:23.865966 [info ] [MainThread]: 
[0m15:05:23.869314 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:23.869617 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:23.869998 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:23.870461 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:23.871096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:23.871613 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:23.871887 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:23.872163 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:23.874464 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.876373 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:23.877688 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:23.874675 => 15:05:23.877539
[0m15:05:23.878010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:23.872363 => 15:05:23.877875
[0m15:05:23.878238 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:23.878484 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:23.908778 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:23.910005 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:23.911094 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.911299 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.911488 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:23.911665 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:23.911836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:23.912015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:23.921744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922096 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:23.922323 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:23.922533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:23.922841 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:23.923065 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:24.379349 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:24.391913 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.392224 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:24.394945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.396607 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.396798 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:24.397790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.409066 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.409344 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.409524 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:24.450606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.457087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:24.457377 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:24.466823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.468939 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:23.878655 => 15:05:24.468694
[0m15:05:24.469420 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:24.470087 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106194f90>]}
[0m15:05:24.470519 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.60s]
[0m15:05:24.470888 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:24.632375 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:05:24.638694 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.639280 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:24.640878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.644454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.644733 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:24.645546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:24.646964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.647144 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.647295 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:24.658659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.662245 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:24.662624 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:24.714906 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:24.717136 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:23.904081 => 15:05:24.716887
[0m15:05:24.717680 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:24.718687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106842150>]}
[0m15:05:24.719462 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.85s]
[0m15:05:24.720394 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:24.721675 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.722218 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:24.722915 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:24.723935 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:24.724545 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:24.724880 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:24.725062 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.725234 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:24.727161 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.728766 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.729456 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:24.727404 => 15:05:24.729337
[0m15:05:24.729702 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:24.725359 => 15:05:24.729589
[0m15:05:24.729882 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:24.730070 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.732514 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735120 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.735725 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.735945 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.736104 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:24.736280 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:24.736447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:24.736602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:24.746945 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747256 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.747606 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:24.747817 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:24.748073 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.748299 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    title,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:24.750473 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.750749 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "title" does not exist
LINE 16:     title,
             ^

[0m15:05:24.751020 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: ROLLBACK
[0m15:05:24.751346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: ROLLBACK
[0m15:05:24.752328 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:24.730190 => 15:05:24.752193
[0m15:05:24.752775 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:24.732781 => 15:05:24.752523
[0m15:05:24.753005 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:24.753195 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:24.759428 [debug] [Thread-3 (]: Database Error in model sum_movie_views (models/facts/sum_movie_views.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.760162 [debug] [Thread-4 (]: Database Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)
  column "title" does not exist
  LINE 16:     title,
               ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.760472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b7490>]}
[0m15:05:24.760684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a888bcc0-2d9e-49e3-9319-7b7a18507126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256a50>]}
[0m15:05:24.761016 [error] [Thread-3 (]: 4 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_views ............ [[31mERROR[0m in 0.04s]
[0m15:05:24.761356 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_warehouse.sum_movie_viewing_time ..... [[31mERROR[0m in 0.04s]
[0m15:05:24.761687 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:24.761910 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:24.762829 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.762997 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.763130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:24.771512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:24.771811 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.771952 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.772082 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.772611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:24.772771 [debug] [MainThread]: On master: Close
[0m15:05:24.773094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:24.773227 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:24.773345 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:24.773462 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:24.773576 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:24.773728 [info ] [MainThread]: 
[0m15:05:24.773922 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m15:05:24.774370 [debug] [MainThread]: Command end result
[0m15:05:24.777861 [info ] [MainThread]: 
[0m15:05:24.778087 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:24.778266 [info ] [MainThread]: 
[0m15:05:24.778446 [error] [MainThread]: [33mDatabase Error in model sum_movie_views (models/facts/sum_movie_views.sql)[0m
[0m15:05:24.778618 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.778782 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.778940 [error] [MainThread]:                ^
[0m15:05:24.779102 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_views.sql
[0m15:05:24.779265 [info ] [MainThread]: 
[0m15:05:24.779429 [error] [MainThread]: [33mDatabase Error in model sum_movie_viewing_time (models/facts/sum_movie_viewing_time.sql)[0m
[0m15:05:24.779595 [error] [MainThread]:   column "title" does not exist
[0m15:05:24.779753 [error] [MainThread]:   LINE 16:     title,
[0m15:05:24.779912 [error] [MainThread]:                ^
[0m15:05:24.780071 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_movie_viewing_time.sql
[0m15:05:24.780237 [info ] [MainThread]: 
[0m15:05:24.780422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:05:24.780722 [debug] [MainThread]: Command `dbt run` failed at 15:05:24.780677 after 1.24 seconds
[0m15:05:24.780908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102865e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102867b90>]}
[0m15:05:24.781083 [debug] [MainThread]: Flushing usage events
[0m15:05:44.547398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee2d0>]}


============================== 15:05:44.550929 | 29bb855e-8014-4fd0-8a8f-6fe8847b33c2 ==============================
[0m15:05:44.550929 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:44.551295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:44.592211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106800450>]}
[0m15:05:44.599237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6d90>]}
[0m15:05:44.599621 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:44.609662 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:44.626547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:05:44.626918 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:05:44.627110 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:05:44.638341 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:05:44.645756 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:05:44.651395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69790>]}
[0m15:05:44.672703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e62c50>]}
[0m15:05:44.672980 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:44.673203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104599090>]}
[0m15:05:44.674048 [info ] [MainThread]: 
[0m15:05:44.674530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:44.675201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:44.680835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:44.681091 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:44.681237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:44.736435 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:44.737402 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:44.738386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:05:44.741985 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.742201 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:05:44.742358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:44.757850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.758039 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:05:44.758231 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:05:44.767820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:44.768761 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:05:44.769571 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:05:44.773034 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.773289 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.773473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:44.783986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.784326 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.784644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:44.799812 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:05:44.801059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fe350>]}
[0m15:05:44.801373 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:44.802213 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.802453 [debug] [MainThread]: On master: BEGIN
[0m15:05:44.803581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.803801 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.803997 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:44.804181 [debug] [MainThread]: On master: COMMIT
[0m15:05:44.804877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:44.805131 [debug] [MainThread]: On master: Close
[0m15:05:44.805594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:44.805891 [info ] [MainThread]: 
[0m15:05:44.808914 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:05:44.809200 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:05:44.809513 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:05:44.809878 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:05:44.810400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:05:44.810876 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:05:44.811132 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:05:44.811360 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:05:44.813393 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.815164 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:05:44.815868 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:05:44.811536 => 15:05:44.815744
[0m15:05:44.816133 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:05:44.813589 => 15:05:44.816010
[0m15:05:44.816365 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:05:44.816581 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:05:44.840960 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:05:44.843140 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:05:44.843583 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.843790 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.843964 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:05:44.844137 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:05:44.844303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:44.844458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:44.866180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:44.866794 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:44.867018 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:44.867238 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:44.867460 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:05:45.184059 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.193965 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.194249 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:05:45.195482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.196950 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.197126 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:05:45.198123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.208961 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.209261 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.209432 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:05:45.226309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.229158 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:05:45.229372 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:05:45.236660 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.237559 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:05:44.841129 => 15:05:45.237471
[0m15:05:45.237742 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:05:45.238134 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf290>]}
[0m15:05:45.238455 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.43s]
[0m15:05:45.238789 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:05:45.278875 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 0.0 seconds
[0m15:05:45.283717 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.284017 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:05:45.285416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.287186 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.287375 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:05:45.288633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.289961 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.290136 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.290289 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:05:45.294822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.296159 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:05:45.296346 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:05:45.316539 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.319009 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:05:44.816732 => 15:05:45.318718
[0m15:05:45.319496 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:05:45.320465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecd0d0>]}
[0m15:05:45.321106 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.51s]
[0m15:05:45.321558 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:05:45.322085 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.322310 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:05:45.322588 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:05:45.322911 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:05:45.323404 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:05:45.323758 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:05:45.323939 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.324104 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:05:45.326036 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.327486 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.327914 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:05:45.326248 => 15:05:45.327818
[0m15:05:45.328111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:05:45.324243 => 15:05:45.328017
[0m15:05:45.328283 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:05:45.328471 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.330585 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:05:45.332600 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333013 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.333190 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.333396 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:05:45.333588 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:05:45.333756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:45.333948 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:45.342314 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342568 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.342785 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.342971 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.343157 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    COUNT(*) AS total_views
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.343346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:05:45.463310 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.463875 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:05:45.468579 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.472496 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.472923 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:05:45.473125 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:05:45.474195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.475792 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.475998 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:05:45.476170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.477706 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.477890 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.478067 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:05:45.480159 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480389 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.480560 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:05:45.480972 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:45.482183 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.482368 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.482526 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:05:45.483282 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.484444 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:05:45.484612 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:05:45.484881 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.485953 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:05:45.486122 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:05:45.487376 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488222 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:05:45.330717 => 15:05:45.488122
[0m15:05:45.488423 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:05:45.488583 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:45.488989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008c90>]}
[0m15:05:45.489688 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:05:45.328604 => 15:05:45.489597
[0m15:05:45.489997 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.490242 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:05:45.490517 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:05:45.490958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bb855e-8014-4fd0-8a8f-6fe8847b33c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e9ad0>]}
[0m15:05:45.491391 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:05:45.491724 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:05:45.492582 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.492746 [debug] [MainThread]: On master: BEGIN
[0m15:05:45.492879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:45.501284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:45.501614 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.501776 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.501913 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.502490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:45.502631 [debug] [MainThread]: On master: Close
[0m15:05:45.502960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:45.503089 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:05:45.503208 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:05:45.503323 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:05:45.503435 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:05:45.503588 [info ] [MainThread]: 
[0m15:05:45.503790 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:05:45.504372 [debug] [MainThread]: Command end result
[0m15:05:45.507387 [info ] [MainThread]: 
[0m15:05:45.507622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:45.507808 [info ] [MainThread]: 
[0m15:05:45.508004 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:05:45.508314 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:45.508269 after 0.97 seconds
[0m15:05:45.508502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d68690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1dd0>]}
[0m15:05:45.508680 [debug] [MainThread]: Flushing usage events
[0m15:11:44.338699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e15290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2db90>]}


============================== 15:11:44.342392 | 7133d1bd-0fc7-416e-a64f-a43d75e67829 ==============================
[0m15:11:44.342392 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:11:44.342792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:11:44.387477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e56bd0>]}
[0m15:11:44.394554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0b3d0>]}
[0m15:11:44.394973 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:11:44.405875 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:11:44.424575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:44.424920 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_views.sql
[0m15:11:44.436593 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m15:11:44.447206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3450>]}
[0m15:11:44.468300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1d10>]}
[0m15:11:44.468583 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:11:44.468796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd9090>]}
[0m15:11:44.469608 [info ] [MainThread]: 
[0m15:11:44.470035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:44.470697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:11:44.476212 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:11:44.476459 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:11:44.476598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:44.544969 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:11:44.545958 [debug] [ThreadPool]: On list_mydb: Close
[0m15:11:44.546950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:11:44.550626 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.550838 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:11:44.551008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:44.560618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.560941 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:11:44.561171 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:11:44.571133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:11:44.572133 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:11:44.572948 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:11:44.576404 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.576660 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.576838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:44.587471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.587738 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.588047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:44.633361 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:11:44.634919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585f610>]}
[0m15:11:44.635338 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:44.636569 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.636823 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.638544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.638836 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.639105 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.639335 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.640239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:44.640491 [debug] [MainThread]: On master: Close
[0m15:11:44.641044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:44.641425 [info ] [MainThread]: 
[0m15:11:44.645649 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:11:44.645964 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:11:44.646336 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:11:44.646751 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:11:44.647371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:11:44.647874 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:11:44.648135 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:11:44.648378 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:11:44.650693 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.652721 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:11:44.653966 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:11:44.650943 => 15:11:44.653784
[0m15:11:44.654286 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:11:44.648552 => 15:11:44.654131
[0m15:11:44.654559 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:11:44.654819 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:11:44.679834 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:11:44.682190 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:11:44.682620 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.682835 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.683020 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:11:44.683212 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:11:44.683404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:11:44.683575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:44.693015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693310 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:44.693525 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:44.693744 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:44.693972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:44.694237 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:11:45.142368 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.154736 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.155061 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:11:45.156671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.158362 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.158562 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:11:45.159337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.170519 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.170866 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.171059 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:11:45.180733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.183561 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:11:45.183759 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:11:45.197473 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.198500 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:11:44.654991 => 15:11:45.198401
[0m15:11:45.198708 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:11:45.199129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3950>]}
[0m15:11:45.199465 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:11:45.199818 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:11:45.200862 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:11:45.202643 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.202874 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:11:45.204270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.206062 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.206293 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:11:45.207144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.208554 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.208746 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.208908 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:11:45.213696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.215126 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:11:45.215342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:11:45.247272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.248148 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:11:44.680010 => 15:11:45.248056
[0m15:11:45.248342 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:11:45.248720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2da50>]}
[0m15:11:45.249014 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.60s]
[0m15:11:45.249384 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:11:45.249856 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.250050 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:11:45.250370 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:11:45.250654 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:11:45.251102 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:11:45.251431 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:11:45.251605 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.251766 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:11:45.253849 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.255735 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.256511 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:11:45.254104 => 15:11:45.256357
[0m15:11:45.256714 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:11:45.256947 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:11:45.251887 => 15:11:45.256859
[0m15:11:45.259629 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:11:45.259896 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.262369 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.262907 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.263114 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:11:45.263300 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.263486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:45.263666 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:11:45.263933 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:45.274638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.274921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.275170 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.275378 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.275599 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:11:45.275794 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    movie_id,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY movie_id
  );
  
[0m15:11:45.396146 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.402086 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.402545 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:11:45.403097 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:11:45.405253 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.405515 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:11:45.406374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.406565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.407927 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.409283 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.409462 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:11:45.409633 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:11:45.410411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.412358 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412531 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.412682 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:11:45.412857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:45.414060 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.414260 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.414420 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:11:45.416532 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.417650 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:11:45.417821 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:11:45.418084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.419150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:11:45.419323 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:11:45.420863 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.421689 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:11:45.260118 => 15:11:45.421592
[0m15:11:45.421891 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:11:45.422049 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:11:45.422442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0df50>]}
[0m15:11:45.423087 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:11:45.257216 => 15:11:45.423002
[0m15:11:45.423386 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.423640 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:11:45.423901 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:11:45.424272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7133d1bd-0fc7-416e-a64f-a43d75e67829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667fc50>]}
[0m15:11:45.424791 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.17s]
[0m15:11:45.425125 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:11:45.425962 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.426152 [debug] [MainThread]: On master: BEGIN
[0m15:11:45.426291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:45.435303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:45.435601 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.435754 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.435894 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.436512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:45.436700 [debug] [MainThread]: On master: Close
[0m15:11:45.437069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:45.437208 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:11:45.437332 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:11:45.437460 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:11:45.437579 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:11:45.437736 [info ] [MainThread]: 
[0m15:11:45.438071 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m15:11:45.438605 [debug] [MainThread]: Command end result
[0m15:11:45.441590 [info ] [MainThread]: 
[0m15:11:45.441817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:45.442007 [info ] [MainThread]: 
[0m15:11:45.442207 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:11:45.442512 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:45.442469 after 1.12 seconds
[0m15:11:45.442697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023a8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f1dd0>]}
[0m15:11:45.442865 [debug] [MainThread]: Flushing usage events
[0m15:16:58.197577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104321450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043221d0>]}


============================== 15:16:58.201298 | 49886db4-9e37-44bf-9f96-6adee53d1d5e ==============================
[0m15:16:58.201298 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:16:58.201672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:58.244712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434b5d0>]}
[0m15:16:58.251791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432ec50>]}
[0m15:16:58.252220 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:16:58.262490 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:16:58.285491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:58.285874 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m15:16:58.297532 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m15:16:58.308333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334790>]}
[0m15:16:58.329730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498aa50>]}
[0m15:16:58.330009 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:16:58.330226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020cd090>]}
[0m15:16:58.331054 [info ] [MainThread]: 
[0m15:16:58.331513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:58.332135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:16:58.337638 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:16:58.337900 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:16:58.338053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:58.411393 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:16:58.412432 [debug] [ThreadPool]: On list_mydb: Close
[0m15:16:58.413513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:16:58.417191 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.417405 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:16:58.417577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:58.432067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.432285 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:16:58.432485 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:16:58.444648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:16:58.445722 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:16:58.446526 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:16:58.450356 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.450634 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.450827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:58.463666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.463921 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.464249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:58.483367 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:16:58.484764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104390a10>]}
[0m15:16:58.485105 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:58.486023 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.486304 [debug] [MainThread]: On master: BEGIN
[0m15:16:58.487543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.487775 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.487981 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:58.488243 [debug] [MainThread]: On master: COMMIT
[0m15:16:58.489085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:58.489376 [debug] [MainThread]: On master: Close
[0m15:16:58.489896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:58.490213 [info ] [MainThread]: 
[0m15:16:58.494094 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:16:58.494413 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m15:16:58.494780 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:16:58.495254 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:16:58.495846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.movie_viewings)
[0m15:16:58.496321 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:16:58.496562 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:16:58.496782 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m15:16:58.498804 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.500561 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:16:58.501595 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 15:16:58.499007 => 15:16:58.501431
[0m15:16:58.501926 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:16:58.496937 => 15:16:58.501792
[0m15:16:58.502160 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m15:16:58.502414 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:16:58.526004 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:16:58.528325 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:16:58.528763 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.528962 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.529153 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m15:16:58.529330 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:16:58.529498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:58.529656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:58.538614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.538905 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:58.539117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:58.539383 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.539599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.539847 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:16:58.980884 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:58.991087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.991386 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:16:58.993037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:58.994683 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:58.994871 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:16:58.995782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.006469 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.006738 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.006899 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m15:16:59.026166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.029078 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:16:59.029282 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:16:59.036447 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.037371 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 15:16:58.502610 => 15:16:59.037275
[0m15:16:59.037561 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m15:16:59.037948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e59d0>]}
[0m15:16:59.038280 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.54s]
[0m15:16:59.038628 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m15:16:59.086158 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:16:59.089836 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.090075 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:16:59.093136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.094457 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.094625 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:16:59.095424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.096783 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.096961 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.097114 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:16:59.112291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.113571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:16:59.113740 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:16:59.143245 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.146777 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:16:58.526171 => 15:16:59.146379
[0m15:16:59.147395 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:16:59.148511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399e250>]}
[0m15:16:59.149186 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:16:59.149597 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:16:59.150096 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.150314 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:16:59.150558 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:16:59.150867 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:16:59.151422 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_viewing_time'
[0m15:16:59.151761 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.sum_movie_views'
[0m15:16:59.151935 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.152097 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:16:59.154078 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.155588 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.156012 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:16:59.152209 => 15:16:59.155917
[0m15:16:59.156230 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:16:59.154309 => 15:16:59.156116
[0m15:16:59.156423 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.156588 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:16:59.158689 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.160745 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161224 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.161393 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.161568 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:16:59.161729 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:16:59.161882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:16:59.162031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:16:59.177054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.177644 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.177845 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.178035 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.178231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:16:59.307497 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.308067 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:16:59.314005 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.317054 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.317308 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:16:59.317490 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:16:59.318507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.318679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.320106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.321429 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.321598 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:16:59.321764 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:16:59.322592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.322766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:59.324788 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.325893 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.326068 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.326229 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.326384 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:16:59.326528 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:16:59.331612 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.332761 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:16:59.332947 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:16:59.333214 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.334375 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:16:59.334560 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:16:59.335917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.336648 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:16:59.156703 => 15:16:59.336559
[0m15:16:59.336839 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:16:59.337220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73a90>]}
[0m15:16:59.337531 [info ] [Thread-4 (]: 3 of 4 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.337861 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:16:59.338453 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:59.339238 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:16:59.158820 => 15:16:59.339144
[0m15:16:59.339436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:16:59.339810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49886db4-9e37-44bf-9f96-6adee53d1d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b0cd0>]}
[0m15:16:59.340097 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.19s]
[0m15:16:59.340435 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:16:59.341935 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.342260 [debug] [MainThread]: On master: BEGIN
[0m15:16:59.342402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:59.349615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:59.349906 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.350120 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:59.350290 [debug] [MainThread]: On master: COMMIT
[0m15:16:59.351034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:59.351252 [debug] [MainThread]: On master: Close
[0m15:16:59.351606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:59.351739 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:16:59.351855 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:16:59.351965 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:16:59.352072 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:16:59.352232 [info ] [MainThread]: 
[0m15:16:59.352420 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:16:59.352944 [debug] [MainThread]: Command end result
[0m15:16:59.356019 [info ] [MainThread]: 
[0m15:16:59.356330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:59.356527 [info ] [MainThread]: 
[0m15:16:59.356751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:16:59.357111 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:59.357058 after 1.17 seconds
[0m15:16:59.357305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10089c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009e5e90>]}
[0m15:16:59.357481 [debug] [MainThread]: Flushing usage events
[0m15:31:28.885297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487f90>]}


============================== 15:31:28.889159 | 291e5c32-c9e2-4124-ad98-c2f68608ce73 ==============================
[0m15:31:28.889159 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:31:28.889562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:31:28.932880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aab50>]}
[0m15:31:28.939923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655f690>]}
[0m15:31:28.940297 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:31:28.950590 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:31:28.972544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:31:28.972908 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m15:31:28.973127 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m15:31:28.984980 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:31:28.992257 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:31:28.997745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106492c10>]}
[0m15:31:29.018676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d850>]}
[0m15:31:29.018954 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:31:29.019168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104255090>]}
[0m15:31:29.020063 [info ] [MainThread]: 
[0m15:31:29.020487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:29.021119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:31:29.026482 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:31:29.026723 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:31:29.026874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:29.106698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:31:29.107802 [debug] [ThreadPool]: On list_mydb: Close
[0m15:31:29.108949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:31:29.113008 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.113228 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:31:29.113404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:29.126561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.126845 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:31:29.127070 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:31:29.136612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:31:29.137659 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:31:29.138466 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:31:29.142146 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.142401 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.142588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:29.154724 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.155052 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.155357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:29.179557 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:31:29.180830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b108d0>]}
[0m15:31:29.181151 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:29.181992 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.182193 [debug] [MainThread]: On master: BEGIN
[0m15:31:29.183478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.183744 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.183956 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:29.184141 [debug] [MainThread]: On master: COMMIT
[0m15:31:29.184889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.185112 [debug] [MainThread]: On master: Close
[0m15:31:29.185574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:29.185859 [info ] [MainThread]: 
[0m15:31:29.189024 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:31:29.189313 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:31:29.189553 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:31:29.189776 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:31:29.190088 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:31:29.190494 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:31:29.190890 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:31:29.191257 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:31:29.191859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:31:29.192360 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:31:29.192827 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:31:29.193257 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:31:29.193487 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:31:29.193710 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:31:29.193924 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:31:29.194134 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:31:29.196153 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:31:29.197932 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.199669 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:31:29.201396 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:31:29.202160 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:31:29.194289 => 15:31:29.202039
[0m15:31:29.202518 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:31:29.202780 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:31:29.198119 => 15:31:29.202674
[0m15:31:29.215665 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:31:29.196350 => 15:31:29.215499
[0m15:31:29.215885 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:31:29.199843 => 15:31:29.215801
[0m15:31:29.226601 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:31:29.226925 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:31:29.227100 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:31:29.227263 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:31:29.230198 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:31:29.232432 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:31:29.234469 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:31:29.234821 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.235150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.235339 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:31:29.235539 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:31:29.235694 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.235865 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.236041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.236203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:29.236399 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:31:29.236598 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:31:29.236952 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:29.237119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:29.251005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.251518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.251819 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.252186 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.252379 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.252568 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.253696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.253972 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.254275 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:31:29.254487 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:31:29.254709 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.254952 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id,
FROM mydb.public.raw_netflix
  );
  
[0m15:31:29.256366 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.256958 [debug] [Thread-4 (]: On model.maker_warehouse.users: ROLLBACK
[0m15:31:29.258565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM mydb.public.raw_netflix
         ^

[0m15:31:29.259111 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:31:29.232586 => 15:31:29.258990
[0m15:31:29.259353 [debug] [Thread-1 (]: On model.maker_warehouse.genres: ROLLBACK
[0m15:31:29.259597 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:31:29.262911 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:31:29.202957 => 15:31:29.262742
[0m15:31:29.263207 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:31:29.267741 [debug] [Thread-1 (]: Database Error in model genres (models/facts/genres.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:29.269372 [debug] [Thread-4 (]: Database Error in model users (models/facts/users.sql)
  syntax error at or near "FROM"
  LINE 16: FROM mydb.public.raw_netflix
           ^
  compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:29.269757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be090>]}
[0m15:31:29.270046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a290>]}
[0m15:31:29.270465 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model dbt_warehouse.genres ..................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271291 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model dbt_warehouse.users ...................... [[31mERROR[0m in 0.08s]
[0m15:31:29.271703 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:31:29.271923 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:31:29.721352 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.731687 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.732037 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:31:29.733853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.736048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.736292 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:31:29.737543 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.748687 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.748981 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.749146 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:31:29.761118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.764048 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:31:29.764255 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:31:29.771492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.772478 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:31:29.227461 => 15:31:29.772385
[0m15:31:29.772676 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:31:29.773077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32510>]}
[0m15:31:29.773382 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.58s]
[0m15:31:29.773720 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:31:29.788430 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:31:29.790356 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.790586 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:31:29.792618 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.794479 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.794686 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:31:29.795750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:29.797056 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.797246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.797408 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:31:29.804207 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:29.805740 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:31:29.805931 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:31:29.840859 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:29.843773 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:31:29.230361 => 15:31:29.843473
[0m15:31:29.844356 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:31:29.845384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c44290>]}
[0m15:31:29.845875 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.65s]
[0m15:31:29.846263 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:31:29.846867 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.847092 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:31:29.847407 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:31:29.847692 [info ] [Thread-4 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:31:29.848294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:31:29.848698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:31:29.848969 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.849191 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:31:29.851346 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.853243 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.854028 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:31:29.849329 => 15:31:29.853872
[0m15:31:29.854276 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:31:29.851674 => 15:31:29.854155
[0m15:31:29.854540 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:29.854721 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:31:29.857271 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860061 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:31:29.860670 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.860864 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:31:29.861031 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.861197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:29.861355 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:31:29.861593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:29.870657 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.870921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:29.871171 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:29.871385 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:29.871583 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.871803 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:31:29.998844 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:29.999902 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:31:30.006224 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.008976 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.009228 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:31:30.009421 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:31:30.011869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.012060 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.013740 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.015142 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.015330 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:31:30.015518 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:31:30.016387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.016577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:30.017818 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019007 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.019200 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.019373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.019538 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:31:30.019701 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:31:30.024619 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.025921 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:31:30.026093 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:31:30.026271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.027466 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:31:30.027648 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:31:30.029642 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.030399 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:31:29.857447 => 15:31:30.030303
[0m15:31:30.030599 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:31:30.030978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e750>]}
[0m15:31:30.031149 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:30.031433 [info ] [Thread-4 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.18s]
[0m15:31:30.032181 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:31:29.854854 => 15:31:30.032094
[0m15:31:30.032479 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:31:30.032679 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:31:30.033147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291e5c32-c9e2-4124-ad98-c2f68608ce73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9bdd0>]}
[0m15:31:30.033452 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.19s]
[0m15:31:30.033827 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:31:30.034748 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.034942 [debug] [MainThread]: On master: BEGIN
[0m15:31:30.035081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:30.042904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:30.043163 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043305 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:30.043428 [debug] [MainThread]: On master: COMMIT
[0m15:31:30.043964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:30.044142 [debug] [MainThread]: On master: Close
[0m15:31:30.044484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:30.044628 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:31:30.044751 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:31:30.044867 [debug] [MainThread]: Connection 'model.maker_warehouse.movies' was properly closed.
[0m15:31:30.044978 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:31:30.045135 [info ] [MainThread]: 
[0m15:31:30.045328 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:31:30.045906 [debug] [MainThread]: Command end result
[0m15:31:30.048886 [info ] [MainThread]: 
[0m15:31:30.049126 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:31:30.049309 [info ] [MainThread]: 
[0m15:31:30.049564 [error] [MainThread]: [33mDatabase Error in model genres (models/facts/genres.sql)[0m
[0m15:31:30.049815 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.050006 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.050181 [error] [MainThread]:            ^
[0m15:31:30.050349 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/genres.sql
[0m15:31:30.050521 [info ] [MainThread]: 
[0m15:31:30.050699 [error] [MainThread]: [33mDatabase Error in model users (models/facts/users.sql)[0m
[0m15:31:30.050865 [error] [MainThread]:   syntax error at or near "FROM"
[0m15:31:30.051025 [error] [MainThread]:   LINE 16: FROM mydb.public.raw_netflix
[0m15:31:30.051184 [error] [MainThread]:            ^
[0m15:31:30.051343 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/users.sql
[0m15:31:30.051513 [info ] [MainThread]: 
[0m15:31:30.051706 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m15:31:30.052085 [debug] [MainThread]: Command `dbt run` failed at 15:31:30.052027 after 1.18 seconds
[0m15:31:30.052303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106360550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bb210>]}
[0m15:31:30.052492 [debug] [MainThread]: Flushing usage events
[0m15:32:34.691504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fbf90>]}


============================== 15:32:34.695471 | 7fc677d9-cb84-4527-89a1-a072a9ebb691 ==============================
[0m15:32:34.695471 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:32:34.695844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:32:34.738832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.745770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3ed0>]}
[0m15:32:34.746147 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:32:34.756388 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:32:34.776472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:32:34.776892 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/users.sql
[0m15:32:34.777081 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/genres.sql
[0m15:32:34.788833 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m15:32:34.796071 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m15:32:34.801672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f76150>]}
[0m15:32:34.822815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b890>]}
[0m15:32:34.823093 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:32:34.823307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cecfd0>]}
[0m15:32:34.824144 [info ] [MainThread]: 
[0m15:32:34.824585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:34.825242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:32:34.830168 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:32:34.830341 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:32:34.830487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:34.913057 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:32:34.914152 [debug] [ThreadPool]: On list_mydb: Close
[0m15:32:34.915369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:32:34.919467 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.919709 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:32:34.919901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:34.932980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.933283 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:32:34.933512 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:32:34.944612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:32:34.945802 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:32:34.946797 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:32:34.951199 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.951527 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.951750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:34.963587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.963938 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.964264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:34.988580 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:32:34.990177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c58dd0>]}
[0m15:32:34.990583 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:34.991752 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.992070 [debug] [MainThread]: On master: BEGIN
[0m15:32:34.993851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:34.994151 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.994392 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:34.994625 [debug] [MainThread]: On master: COMMIT
[0m15:32:34.995552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:34.995828 [debug] [MainThread]: On master: Close
[0m15:32:34.996430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:34.996750 [info ] [MainThread]: 
[0m15:32:35.000411 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:32:35.000780 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:32:35.001069 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:32:35.001318 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:32:35.001706 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:32:35.002145 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:32:35.002670 [info ] [Thread-3 (]: 3 of 6 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:32:35.003089 [info ] [Thread-4 (]: 4 of 6 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:32:35.003840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:32:35.004391 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:32:35.004909 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:32:35.005428 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:32:35.005824 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:32:35.006143 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:32:35.006424 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:32:35.006714 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:32:35.009401 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:32:35.011474 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.013349 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:32:35.015246 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:32:35.016037 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:32:35.006919 => 15:32:35.015894
[0m15:32:35.016433 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:32:35.016710 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:32:35.009722 => 15:32:35.016597
[0m15:32:35.016948 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:32:35.011694 => 15:32:35.016847
[0m15:32:35.024378 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:32:35.013570 => 15:32:35.024119
[0m15:32:35.041517 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:32:35.041793 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:32:35.041984 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:32:35.042161 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:32:35.045276 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:32:35.047498 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:32:35.047695 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.049711 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:32:35.050010 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:32:35.050206 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.050453 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.050628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.050828 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:32:35.050983 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.051141 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:32:35.051382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:32:35.051549 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:32:35.051710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:32:35.051934 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:32:35.068826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.069210 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.069439 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.069830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.070027 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.070270 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.071609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.071838 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.072186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.072404 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.072633 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.072880 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:32:35.333866 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:32:35.345117 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.345742 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:32:35.347263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.357407 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.357696 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.357872 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:32:35.368739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.371720 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:32:35.371964 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:32:35.373098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.373909 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:32:35.017100 => 15:32:35.373816
[0m15:32:35.374100 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:32:35.374494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b950>]}
[0m15:32:35.374810 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:32:35.375135 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:32:35.526460 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:35.529011 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.529261 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:32:35.532983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.534850 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.535076 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:32:35.536234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.539052 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.539356 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.539563 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:32:35.557658 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.559241 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:32:35.559495 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:32:35.565851 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.566840 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:32:35.045461 => 15:32:35.566741
[0m15:32:35.567044 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:32:35.567481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e3ed0>]}
[0m15:32:35.567913 [info ] [Thread-3 (]: 3 of 6 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.56s]
[0m15:32:35.568316 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:32:35.698965 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:32:35.705632 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.706303 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:32:35.712590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.715794 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.716045 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.716215 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:32:35.729353 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.733486 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:32:35.733775 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:32:35.734731 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.735609 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:32:35.047830 => 15:32:35.735513
[0m15:32:35.735808 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:32:35.736207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702c490>]}
[0m15:32:35.736579 [info ] [Thread-4 (]: 4 of 6 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.73s]
[0m15:32:35.737237 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:32:35.858880 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:32:35.865380 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.865703 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:32:35.866868 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.868577 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.868769 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:32:35.869721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:35.870946 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.871122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.871278 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:32:35.879637 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:35.883400 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:32:35.884735 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:32:35.928267 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:35.930685 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:32:35.042366 => 15:32:35.930424
[0m15:32:35.931238 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:32:35.932295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8f90>]}
[0m15:32:35.933270 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.93s]
[0m15:32:35.934456 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:32:35.935762 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.936324 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:32:35.936859 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:32:35.937188 [info ] [Thread-3 (]: 6 of 6 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:32:35.937714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:32:35.938073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_views)
[0m15:32:35.938285 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.938462 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:32:35.940271 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.942574 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.943359 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:32:35.938585 => 15:32:35.943212
[0m15:32:35.943599 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:35.946189 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.946677 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:32:35.940619 => 15:32:35.946516
[0m15:32:35.946875 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:32:35.947077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.949222 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:32:35.949404 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:32:35.949642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:35.949966 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.950144 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:32:35.950298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:35.961350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:32:35.961862 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:35.962077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:35.962404 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:35.962675 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:32:36.115793 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.116955 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:32:36.122016 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.123517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.123705 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:32:36.123877 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:32:36.124962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.125134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.126486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.127714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.127898 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:32:36.128068 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:32:36.128916 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.130158 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130328 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.130486 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:32:36.130644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:36.132064 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.132332 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.132506 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:32:36.134387 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.134678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.136512 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:32:36.137793 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:32:36.137994 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:32:36.138184 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:32:36.143103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.143336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:36.144195 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:32:35.943730 => 15:32:36.144082
[0m15:32:36.144850 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:32:35.947219 => 15:32:36.144767
[0m15:32:36.145048 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:32:36.145234 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:32:36.145685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033bd0>]}
[0m15:32:36.146588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc677d9-cb84-4527-89a1-a072a9ebb691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033d10>]}
[0m15:32:36.146079 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.147545 [info ] [Thread-3 (]: 6 of 6 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.21s]
[0m15:32:36.148548 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:32:36.148901 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:32:36.150278 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.150511 [debug] [MainThread]: On master: BEGIN
[0m15:32:36.150660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:36.162057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:36.162385 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.162602 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:36.162772 [debug] [MainThread]: On master: COMMIT
[0m15:32:36.163505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:36.163667 [debug] [MainThread]: On master: Close
[0m15:32:36.164016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:36.164155 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:32:36.164278 [debug] [MainThread]: Connection 'model.maker_warehouse.movie_viewings' was properly closed.
[0m15:32:36.164396 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:32:36.164509 [debug] [MainThread]: Connection 'model.maker_warehouse.users' was properly closed.
[0m15:32:36.164692 [info ] [MainThread]: 
[0m15:32:36.164907 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m15:32:36.165681 [debug] [MainThread]: Command end result
[0m15:32:36.169456 [info ] [MainThread]: 
[0m15:32:36.169808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:36.170325 [info ] [MainThread]: 
[0m15:32:36.170696 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:32:36.171677 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:36.171595 after 1.50 seconds
[0m15:32:36.172136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023b8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102501dd0>]}
[0m15:32:36.172431 [debug] [MainThread]: Flushing usage events
[0m15:41:17.578055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ddf10>]}


============================== 15:41:17.581613 | 9754a8f3-b6d6-4cd2-83e6-8de2f248630b ==============================
[0m15:41:17.581613 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:41:17.581996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:17.628243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f6010>]}
[0m15:41:17.635425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904390>]}
[0m15:41:17.635876 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:41:17.647037 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:41:17.668300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:41:17.668712 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:41:17.668875 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m15:41:17.680602 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:41:17.687944 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m15:41:17.693683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108986150>]}
[0m15:41:17.715010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089903d0>]}
[0m15:41:17.715300 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:41:17.715514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106689090>]}
[0m15:41:17.716460 [info ] [MainThread]: 
[0m15:41:17.716897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:17.717580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:41:17.723196 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:41:17.723439 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:41:17.723582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:17.798573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:41:17.799547 [debug] [ThreadPool]: On list_mydb: Close
[0m15:41:17.800627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:41:17.804256 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.804461 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:41:17.804633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:17.820288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.820574 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:41:17.820806 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:41:17.831777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:41:17.832834 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:41:17.833664 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:41:17.837620 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.837881 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.838068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:17.849850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.850181 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.850485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:17.873235 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:41:17.874648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089910d0>]}
[0m15:41:17.875006 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:17.876005 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.876282 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.877685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.877914 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.878120 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.878319 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.879091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:17.879329 [debug] [MainThread]: On master: Close
[0m15:41:17.879835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:17.880143 [info ] [MainThread]: 
[0m15:41:17.883573 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:41:17.883874 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:41:17.884160 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:41:17.884391 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:41:17.884705 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:41:17.885128 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:41:17.885571 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:41:17.885949 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:41:17.886475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:41:17.886939 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:41:17.887377 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:41:17.887800 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:41:17.888025 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:41:17.888237 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:41:17.888440 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:41:17.888641 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:41:17.890629 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:41:17.892384 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.893989 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:41:17.895551 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:41:17.896877 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:41:17.888787 => 15:41:17.896748
[0m15:41:17.897134 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:41:17.892568 => 15:41:17.897018
[0m15:41:17.897361 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:41:17.894152 => 15:41:17.897262
[0m15:41:17.897600 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:41:17.890822 => 15:41:17.897496
[0m15:41:17.897790 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:41:17.897989 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:41:17.898183 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:41:17.898381 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:41:17.921312 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:41:17.924284 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:41:17.926346 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:41:17.928401 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:41:17.929019 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.929252 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.929426 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:41:17.929588 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.929743 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.929910 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:41:17.930074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:17.930234 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:41:17.930387 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:41:17.930616 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:17.930920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:17.931100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:17.940823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.941164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:17.941388 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.942399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.942600 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:17.942783 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.943147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.943375 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:17.943581 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:41:17.944507 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:17.944702 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:17.944888 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:41:18.210875 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:41:18.219412 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.219761 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:41:18.221410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.223033 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.223239 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:41:18.224515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.236892 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.237272 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.237464 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:41:18.251345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.255030 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:41:18.255296 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:41:18.264730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.266145 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:41:17.898542 => 15:41:18.266026
[0m15:41:18.266403 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:41:18.266846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb4750>]}
[0m15:41:18.267396 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.38s]
[0m15:41:18.267788 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:41:18.393092 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.398671 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.399381 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:41:18.403938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.408115 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.408559 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:41:18.409669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.411322 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.411550 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.411729 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:41:18.425671 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.429319 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:41:18.429813 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:41:18.438811 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.440702 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:41:17.921482 => 15:41:18.440453
[0m15:41:18.441189 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:41:18.442101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c1850>]}
[0m15:41:18.442637 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:41:18.443002 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:41:18.477989 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:18.482535 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.482878 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:41:18.484737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.486543 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.486779 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:41:18.488313 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.489740 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.489955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.490119 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:41:18.500473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.502099 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:41:18.502293 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:41:18.514291 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.516786 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:41:17.924463 => 15:41:18.516496
[0m15:41:18.517288 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:41:18.518194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089919d0>]}
[0m15:41:18.518861 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.63s]
[0m15:41:18.519348 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:41:18.571529 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:41:18.573197 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.573412 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:41:18.574916 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.577556 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.577805 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:41:18.579079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.580463 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.580666 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.580829 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:41:18.591038 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.592458 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:41:18.592633 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:41:18.636115 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.638353 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:41:17.926495 => 15:41:18.638097
[0m15:41:18.638843 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:41:18.639865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830f550>]}
[0m15:41:18.640593 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.75s]
[0m15:41:18.641454 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:41:18.642631 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:41:18.643144 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.643694 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:41:18.644142 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:41:18.644815 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:41:18.645441 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:41:18.645787 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:41:18.646076 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:41:18.646541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:41:18.646854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:41:18.647144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:41:18.647439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:41:18.647768 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:41:18.647985 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.648153 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:41:18.648322 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:41:18.650939 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.652427 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.653912 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.655222 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.655833 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:41:18.648448 => 15:41:18.655722
[0m15:41:18.656032 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:41:18.658241 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:41:18.658551 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:41:18.652590 => 15:41:18.658464
[0m15:41:18.658717 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:41:18.660709 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:41:18.660961 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:41:18.651166 => 15:41:18.660857
[0m15:41:18.661201 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:41:18.654074 => 15:41:18.661120
[0m15:41:18.661383 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:18.661602 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.661799 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.661962 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:41:18.664146 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.664422 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:41:18.664614 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:41:18.667086 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:41:18.667420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:18.667634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:18.667824 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.668249 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.668421 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:41:18.668615 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:41:18.668795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:18.669003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:18.678334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.678667 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.678864 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.681734 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682541 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.682754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:41:18.682972 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:18.683182 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:41:18.683373 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:41:18.683547 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:41:18.683774 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    genres,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:41:18.686839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "movie_id" is ambiguous
LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                            ^

[0m15:41:18.687100 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: ROLLBACK
[0m15:41:18.688362 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:41:18.656159 => 15:41:18.688224
[0m15:41:18.688594 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:41:18.693992 [debug] [Thread-1 (]: Database Error in model sum_genre_views (models/facts/sum_genre_views.sql)
  column reference "movie_id" is ambiguous
  LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
                              ^
  compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:18.694320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911a850>]}
[0m15:41:18.694634 [error] [Thread-1 (]: 5 of 8 ERROR creating sql table model dbt_warehouse.sum_genre_views ............ [[31mERROR[0m in 0.05s]
[0m15:41:18.694928 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:41:18.901672 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903358 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.903572 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:41:18.903773 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:41:18.905275 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.905563 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:41:18.906639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908167 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.908356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.908570 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:41:18.910832 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.911078 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:41:18.911898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.913100 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913279 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.913436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:41:18.913616 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:18.914855 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.915057 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.915224 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:41:18.917447 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.918875 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:41:18.919061 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:18.919223 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:41:18.920329 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:41:18.920549 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:41:18.926917 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.927811 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:41:18.658826 => 15:41:18.927718
[0m15:41:18.927977 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:18.928177 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:41:18.928875 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:41:18.662083 => 15:41:18.928787
[0m15:41:18.929091 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:41:18.929437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d57d0>]}
[0m15:41:18.929794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108794390>]}
[0m15:41:18.930174 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.930930 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.28s]
[0m15:41:18.931741 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:41:18.932183 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:41:19.326668 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:41:19.331472 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.332128 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:41:19.333873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:41:19.336836 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.337351 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.337793 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:41:19.348878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.352246 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:41:19.352517 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:41:19.353314 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:41:19.354097 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:41:18.664745 => 15:41:19.354003
[0m15:41:19.354287 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:41:19.354672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9754a8f3-b6d6-4cd2-83e6-8de2f248630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd5350>]}
[0m15:41:19.354984 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 0.71s]
[0m15:41:19.355310 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:41:19.356323 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.356552 [debug] [MainThread]: On master: BEGIN
[0m15:41:19.356700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:19.366218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:41:19.366513 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.366673 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:19.366815 [debug] [MainThread]: On master: COMMIT
[0m15:41:19.367395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:41:19.367581 [debug] [MainThread]: On master: Close
[0m15:41:19.367924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:19.368071 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:41:19.368195 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:41:19.368311 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:41:19.368434 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:41:19.368604 [info ] [MainThread]: 
[0m15:41:19.368805 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m15:41:19.369523 [debug] [MainThread]: Command end result
[0m15:41:19.372544 [info ] [MainThread]: 
[0m15:41:19.372791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:19.373021 [info ] [MainThread]: 
[0m15:41:19.373218 [error] [MainThread]: [33mDatabase Error in model sum_genre_views (models/facts/sum_genre_views.sql)[0m
[0m15:41:19.373405 [error] [MainThread]:   column reference "movie_id" is ambiguous
[0m15:41:19.373578 [error] [MainThread]:   LINE 16:     COUNT(DISTINCT movie_id) AS each_movie_viewed,
[0m15:41:19.373743 [error] [MainThread]:                               ^
[0m15:41:19.373907 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_genre_views.sql
[0m15:41:19.374082 [info ] [MainThread]: 
[0m15:41:19.374274 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:41:19.374589 [debug] [MainThread]: Command `dbt run` failed at 15:41:19.374542 after 1.81 seconds
[0m15:41:19.374780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa1e90>]}
[0m15:41:19.374951 [debug] [MainThread]: Flushing usage events
[0m15:43:10.788336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d05290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfbf90>]}


============================== 15:43:10.791988 | ce23b147-5871-4b2e-a756-99fa3ff46ded ==============================
[0m15:43:10.791988 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:43:10.792396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:10.837996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd3490>]}
[0m15:43:10.845245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfad10>]}
[0m15:43:10.845663 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:43:10.857439 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:43:10.878886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:10.879389 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_genre_views.sql
[0m15:43:10.891283 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m15:43:10.920541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa950>]}
[0m15:43:10.923934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950b190>]}
[0m15:43:10.924164 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:43:10.924380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9090>]}
[0m15:43:10.925263 [info ] [MainThread]: 
[0m15:43:10.925666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:10.926303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:43:10.931954 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:43:10.932384 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:43:10.932539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:11.011753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:43:11.012909 [debug] [ThreadPool]: On list_mydb: Close
[0m15:43:11.014128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m15:43:11.018129 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.018363 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m15:43:11.018547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:11.037011 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.037260 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m15:43:11.037504 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m15:43:11.048099 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:43:11.049284 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m15:43:11.050253 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m15:43:11.054707 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.054976 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.055180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:11.067926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.068285 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.068654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:11.091964 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:43:11.093371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821bf90>]}
[0m15:43:11.093723 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:11.094717 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.094933 [debug] [MainThread]: On master: BEGIN
[0m15:43:11.096467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.096711 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.096927 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:11.097128 [debug] [MainThread]: On master: COMMIT
[0m15:43:11.097957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.098216 [debug] [MainThread]: On master: Close
[0m15:43:11.098745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:11.099040 [info ] [MainThread]: 
[0m15:43:11.102675 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m15:43:11.102948 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movie_viewings
[0m15:43:11.103201 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m15:43:11.103438 [debug] [Thread-4 (]: Began running node model.maker_warehouse.users
[0m15:43:11.103726 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m15:43:11.104120 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m15:43:11.104535 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m15:43:11.104925 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_warehouse.users ............................... [RUN]
[0m15:43:11.105461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m15:43:11.105899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m15:43:11.106323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m15:43:11.106725 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.users'
[0m15:43:11.106984 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m15:43:11.107221 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m15:43:11.107451 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m15:43:11.107674 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.users
[0m15:43:11.109953 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m15:43:11.111930 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.113700 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m15:43:11.115523 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m15:43:11.116496 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 15:43:11.107851 => 15:43:11.116318
[0m15:43:11.116856 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m15:43:11.117212 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (compile): 15:43:11.113903 => 15:43:11.117089
[0m15:43:11.117527 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 15:43:11.112147 => 15:43:11.117372
[0m15:43:11.123475 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 15:43:11.110168 => 15:43:11.123363
[0m15:43:11.142198 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.users
[0m15:43:11.142532 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m15:43:11.142748 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m15:43:11.142935 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movie_viewings
[0m15:43:11.145280 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m15:43:11.147960 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m15:43:11.150286 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m15:43:11.150739 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.150975 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.151137 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m15:43:11.151294 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.151442 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.151597 [debug] [Thread-4 (]: On model.maker_warehouse.users: BEGIN
[0m15:43:11.151750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.151905 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m15:43:11.152055 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m15:43:11.152195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:43:11.152446 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:43:11.152613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:43:11.161878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.162182 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.162379 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.164107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.164386 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.164589 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.166335 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.166650 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.166869 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.167165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.167383 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.167580 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m15:43:11.414405 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m15:43:11.423139 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.423721 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m15:43:11.425558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.429391 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.429685 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m15:43:11.430785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.448126 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.448454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.448639 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m15:43:11.465476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.469487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m15:43:11.469753 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m15:43:11.476117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.477086 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 15:43:11.117711 => 15:43:11.476990
[0m15:43:11.477341 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m15:43:11.477771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c2d10>]}
[0m15:43:11.478179 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.37s]
[0m15:43:11.478534 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m15:43:11.607414 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:11.611676 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.612198 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m15:43:11.613772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.617721 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.618210 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m15:43:11.619463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.620837 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.621106 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.621327 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m15:43:11.632869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.636409 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m15:43:11.636702 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m15:43:11.654578 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.656826 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 15:43:11.145602 => 15:43:11.656576
[0m15:43:11.657308 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m15:43:11.658264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dde150>]}
[0m15:43:11.659011 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.55s]
[0m15:43:11.660019 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m15:43:11.689946 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:11.691695 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.691892 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m15:43:11.724689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.729637 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.730220 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m15:43:11.731404 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.733828 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.734052 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.734230 [debug] [Thread-4 (]: On model.maker_warehouse.users: COMMIT
[0m15:43:11.740414 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.741833 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.users"
[0m15:43:11.742016 [debug] [Thread-4 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m15:43:11.753152 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.755153 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.users (execute): 15:43:11.143061 => 15:43:11.754916
[0m15:43:11.755623 [debug] [Thread-4 (]: On model.maker_warehouse.users: Close
[0m15:43:11.756208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.756541 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.65s]
[0m15:43:11.756865 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.users
[0m15:43:11.804099 [debug] [Thread-2 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m15:43:11.808757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.809288 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m15:43:11.810623 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.813529 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.813822 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m15:43:11.814661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:11.815954 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.816139 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.816292 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m15:43:11.855367 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:11.861314 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m15:43:11.861927 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m15:43:11.894270 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:11.896364 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 15:43:11.148182 => 15:43:11.896105
[0m15:43:11.896832 [debug] [Thread-2 (]: On model.maker_warehouse.movie_viewings: Close
[0m15:43:11.897752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2910>]}
[0m15:43:11.898791 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 0.79s]
[0m15:43:11.900003 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movie_viewings
[0m15:43:11.901390 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m15:43:11.901936 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.902348 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m15:43:11.902776 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_user_activity
[0m15:43:11.903383 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m15:43:11.904083 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m15:43:11.904446 [info ] [Thread-4 (]: 7 of 8 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m15:43:11.904736 [info ] [Thread-2 (]: 8 of 8 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m15:43:11.905223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m15:43:11.905576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m15:43:11.905885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m15:43:11.906168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m15:43:11.906369 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m15:43:11.906560 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.906721 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m15:43:11.906882 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m15:43:11.908874 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.910292 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.911904 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.913327 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.914672 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 15:43:11.909039 => 15:43:11.914531
[0m15:43:11.914954 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 15:43:11.912083 => 15:43:11.914824
[0m15:43:11.915187 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 15:43:11.906996 => 15:43:11.915096
[0m15:43:11.915355 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:11.915534 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 15:43:11.910465 => 15:43:11.915455
[0m15:43:11.915725 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m15:43:11.915889 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m15:43:11.918572 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.918778 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m15:43:11.920911 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m15:43:11.922943 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m15:43:11.925141 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m15:43:11.925499 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.925664 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.925912 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m15:43:11.926112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.926274 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m15:43:11.926465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:43:11.926646 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.926812 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m15:43:11.926984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:43:11.927241 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m15:43:11.927404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.927632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:43:11.938388 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.938705 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:11.938901 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.939819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940118 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:11.940310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940491 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:11.940699 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m15:43:11.940894 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:11.941057 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:11.941284 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m15:43:11.941510 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m15:43:12.294264 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.298883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.299459 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m15:43:12.301447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.301947 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m15:43:12.306627 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.308427 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.308678 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m15:43:12.308945 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m15:43:12.310281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.311958 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.312159 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.312397 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m15:43:12.314039 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.314461 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.314657 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m15:43:12.316543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.317966 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.318227 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.318408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.318581 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m15:43:12.319882 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m15:43:12.320272 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m15:43:12.321519 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.322785 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m15:43:12.323034 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m15:43:12.326708 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.327633 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 15:43:11.916136 => 15:43:12.327540
[0m15:43:12.327813 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.328021 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m15:43:12.328764 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 15:43:11.923130 => 15:43:12.328671
[0m15:43:12.329298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c0990>]}
[0m15:43:12.329501 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m15:43:12.329907 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.330731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109590b10>]}
[0m15:43:12.331064 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m15:43:12.331390 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.42s]
[0m15:43:12.332181 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m15:43:12.671796 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m15:43:12.677674 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.678323 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m15:43:12.679996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.682909 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.683393 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.683833 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m15:43:12.690378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.693001 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m15:43:12.693296 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m15:43:12.694154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.695010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 15:43:11.921049 => 15:43:12.694898
[0m15:43:12.695214 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m15:43:12.695667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109631850>]}
[0m15:43:12.696045 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.79s]
[0m15:43:12.696662 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m15:43:12.898803 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m15:43:12.904599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.905125 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m15:43:12.906687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.910477 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.910796 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m15:43:12.911806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:12.913217 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.913418 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.913593 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m15:43:12.949968 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.955393 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m15:43:12.955937 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m15:43:12.966609 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:12.968893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 15:43:11.918911 => 15:43:12.968574
[0m15:43:12.969464 [debug] [Thread-2 (]: On model.maker_warehouse.sum_user_activity: Close
[0m15:43:12.970407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce23b147-5871-4b2e-a756-99fa3ff46ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096726d0>]}
[0m15:43:12.971159 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.06s]
[0m15:43:12.971757 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m15:43:12.972884 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.973137 [debug] [MainThread]: On master: BEGIN
[0m15:43:12.973305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:12.983438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:12.983738 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.983892 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:12.984032 [debug] [MainThread]: On master: COMMIT
[0m15:43:12.984668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:12.984859 [debug] [MainThread]: On master: Close
[0m15:43:12.985220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:12.985365 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m15:43:12.985493 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m15:43:12.985616 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m15:43:12.985732 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m15:43:12.985909 [info ] [MainThread]: 
[0m15:43:12.986117 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m15:43:12.987325 [debug] [MainThread]: Command end result
[0m15:43:12.991959 [info ] [MainThread]: 
[0m15:43:12.992239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:12.992435 [info ] [MainThread]: 
[0m15:43:12.992701 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:43:12.993141 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:12.993088 after 2.22 seconds
[0m15:43:12.993373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bca7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d11e90>]}
[0m15:43:12.993567 [debug] [MainThread]: Flushing usage events
[0m17:03:01.478122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f05b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bfed0>]}


============================== 17:03:01.481723 | 13e8596e-82f1-42fb-8131-07224a8663c1 ==============================
[0m17:03:01.481723 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:03:01.482072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:03:01.664394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc38d0>]}
[0m17:03:01.672704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f061d0>]}
[0m17:03:01.673185 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:03:01.699859 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:03:01.720972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:03:01.721310 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m17:03:01.732228 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m17:03:01.739850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m17:03:01.763619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8d010>]}
[0m17:03:01.767318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ee350>]}
[0m17:03:01.767538 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:03:01.767757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103934e90>]}
[0m17:03:01.768772 [info ] [MainThread]: 
[0m17:03:01.769306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:01.770006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:03:01.775748 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:03:01.775981 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:03:01.776116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:01.871311 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:03:01.872393 [debug] [ThreadPool]: On list_mydb: Close
[0m17:03:01.873628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m17:03:01.877686 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.877920 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m17:03:01.878109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:01.888930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.889206 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m17:03:01.889417 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m17:03:01.910508 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:03:01.911747 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m17:03:01.912612 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m17:03:01.917152 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.917429 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.917634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:01.933229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.933778 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.934180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:01.968822 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m17:03:01.969839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0d750>]}
[0m17:03:01.970080 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:01.970689 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.970831 [debug] [MainThread]: On master: BEGIN
[0m17:03:01.971717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:01.971919 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972079 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:01.972210 [debug] [MainThread]: On master: COMMIT
[0m17:03:01.972694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:01.972838 [debug] [MainThread]: On master: Close
[0m17:03:01.973174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:01.973372 [info ] [MainThread]: 
[0m17:03:01.975970 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m17:03:01.976170 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m17:03:01.976354 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m17:03:01.976503 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m17:03:01.976739 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m17:03:01.977047 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m17:03:01.977350 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m17:03:01.977616 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m17:03:01.978007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m17:03:01.978340 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m17:03:01.978662 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m17:03:01.978976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m17:03:01.979138 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m17:03:01.979301 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m17:03:01.979454 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m17:03:01.979604 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m17:03:01.981129 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m17:03:01.982543 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m17:03:01.983855 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m17:03:01.985705 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m17:03:01.986392 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 17:03:01.979721 => 17:03:01.986284
[0m17:03:01.986607 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m17:03:02.004956 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 17:03:01.982701 => 17:03:02.004754
[0m17:03:02.005267 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 17:03:01.981265 => 17:03:02.005132
[0m17:03:02.010021 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m17:03:02.010307 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m17:03:02.010568 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 17:03:01.983993 => 17:03:02.010438
[0m17:03:02.010788 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m17:03:02.013416 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m17:03:02.013658 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m17:03:02.013861 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.024463 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m17:03:02.027021 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m17:03:02.027233 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m17:03:02.027486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.027728 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.027917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.028113 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m17:03:02.028297 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.028483 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m17:03:02.028735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:03:02.028921 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m17:03:02.029099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:02.029383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:03:02.041223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.041798 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.042013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.042420 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.042652 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.042880 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.043087 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:02.043289 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m17:03:02.043535 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.043752 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.057810 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:02.061609 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.061840 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m17:03:02.067326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.075994 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.076293 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.076528 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m17:03:02.089439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.092295 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m17:03:02.092538 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m17:03:02.093695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:02.094575 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 17:03:02.013999 => 17:03:02.094476
[0m17:03:02.094802 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m17:03:02.095293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2f250>]}
[0m17:03:02.095991 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m17:03:02.096610 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m17:03:02.096996 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m17:03:02.097335 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m17:03:02.098197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m17:03:02.098506 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m17:03:02.100681 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m17:03:02.101230 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 17:03:02.098712 => 17:03:02.101078
[0m17:03:02.101499 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m17:03:02.104747 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m17:03:02.105897 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.106376 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m17:03:02.106597 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:02.122935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.124049 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:02.125059 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m17:03:02.826083 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:02.830693 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.831265 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m17:03:02.833555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.838671 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.839014 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m17:03:02.841394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.846268 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.846571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.846744 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m17:03:02.883051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.887114 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m17:03:02.887743 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m17:03:02.912283 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.913378 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 17:03:01.986861 => 17:03:02.913274
[0m17:03:02.913776 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m17:03:02.914440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf950>]}
[0m17:03:02.914865 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.94s]
[0m17:03:02.915274 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m17:03:02.927918 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m17:03:02.929989 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.930224 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m17:03:02.932043 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.933955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.934222 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m17:03:02.935710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.937592 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.938151 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.938389 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m17:03:02.959197 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.960947 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m17:03:02.961189 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m17:03:02.981206 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.982128 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 17:03:02.024781 => 17:03:02.982028
[0m17:03:02.982323 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m17:03:02.982706 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d710>]}
[0m17:03:02.983002 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.00s]
[0m17:03:02.983329 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m17:03:03.087916 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m17:03:03.094457 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.094980 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m17:03:03.096726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.100076 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.100504 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m17:03:03.101588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.102975 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.103174 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.103341 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m17:03:03.125793 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.129852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m17:03:03.130214 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m17:03:03.141344 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:03.143190 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.143423 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m17:03:03.145170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.146882 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.147083 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m17:03:03.148218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.149563 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.149758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.149914 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m17:03:03.151713 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.153164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m17:03:03.153350 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m17:03:03.184032 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.187306 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 17:03:02.101633 => 17:03:03.186944
[0m17:03:03.187991 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m17:03:03.189286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b350>]}
[0m17:03:03.190177 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 1.09s]
[0m17:03:03.190886 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m17:03:03.263265 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.267258 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 17:03:02.011005 => 17:03:03.266880
[0m17:03:03.267903 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m17:03:03.269051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554dfd0>]}
[0m17:03:03.269845 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 1.29s]
[0m17:03:03.270920 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m17:03:03.271956 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m17:03:03.272190 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.272419 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m17:03:03.272587 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m17:03:03.272860 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m17:03:03.273178 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m17:03:03.273485 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m17:03:03.274264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m17:03:03.273831 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m17:03:03.274763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m17:03:03.275113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m17:03:03.275328 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m17:03:03.275632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m17:03:03.275803 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.275959 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m17:03:03.277967 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.278154 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m17:03:03.279460 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.280802 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.282167 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.282523 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 17:03:03.276075 => 17:03:03.282428
[0m17:03:03.282781 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 17:03:03.278274 => 17:03:03.282688
[0m17:03:03.283033 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 17:03:03.279587 => 17:03:03.282938
[0m17:03:03.283190 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m17:03:03.283369 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 17:03:03.280989 => 17:03:03.283292
[0m17:03:03.283540 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.283718 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m17:03:03.286716 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m17:03:03.286924 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m17:03:03.289076 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.291504 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m17:03:03.294127 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m17:03:03.294553 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.294982 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.295267 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.295547 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m17:03:03.295768 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.295980 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m17:03:03.296193 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m17:03:03.296396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:03.296585 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m17:03:03.296754 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:03:03.296926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:03.297202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:03.312596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.312915 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:03.313116 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m17:03:03.315621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316077 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316303 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.316526 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.316791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:03.316972 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m17:03:03.317203 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.317411 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.317688 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m17:03:03.649511 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.650091 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m17:03:03.654408 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.658668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.659264 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m17:03:03.659740 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m17:03:03.661417 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.661867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.665798 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.669538 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.670231 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m17:03:03.670729 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m17:03:03.672339 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.672806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.676603 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.679951 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.680506 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.680961 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.681406 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m17:03:03.681838 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m17:03:03.693538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.694070 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.697370 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m17:03:03.700480 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m17:03:03.700964 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m17:03:03.701436 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m17:03:03.707257 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.708170 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 17:03:03.287052 => 17:03:03.708075
[0m17:03:03.708513 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.709049 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m17:03:03.710787 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 17:03:03.289286 => 17:03:03.710558
[0m17:03:03.711720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3c410>]}
[0m17:03:03.712137 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m17:03:03.712855 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.714068 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m17:03:03.714991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc2450>]}
[0m17:03:03.716002 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.44s]
[0m17:03:03.716608 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m17:03:03.943691 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m17:03:03.949599 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.950106 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m17:03:03.951353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.954596 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.954844 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m17:03:03.955739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:03.957157 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.957350 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.957517 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m17:03:03.981833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:03.985327 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m17:03:03.986066 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m17:03:03.990747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:03.991703 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 17:03:03.283838 => 17:03:03.991607
[0m17:03:03.991903 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m17:03:03.992309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe90d0>]}
[0m17:03:03.992617 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.72s]
[0m17:03:03.992938 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m17:03:04.201642 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m17:03:04.205922 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.206523 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m17:03:04.208134 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.213669 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.213896 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m17:03:04.214620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:04.215798 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.215968 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.216119 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m17:03:04.234836 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.238823 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m17:03:04.239084 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m17:03:04.273614 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:04.277030 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 17:03:03.291763 => 17:03:04.276722
[0m17:03:04.277674 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m17:03:04.278776 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13e8596e-82f1-42fb-8131-07224a8663c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0c450>]}
[0m17:03:04.279636 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.00s]
[0m17:03:04.280502 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m17:03:04.282126 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.282387 [debug] [MainThread]: On master: BEGIN
[0m17:03:04.282534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:04.291381 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:04.291686 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.291849 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:04.291981 [debug] [MainThread]: On master: COMMIT
[0m17:03:04.292501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:04.292649 [debug] [MainThread]: On master: Close
[0m17:03:04.292977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:04.293112 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m17:03:04.293232 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m17:03:04.293347 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m17:03:04.293455 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m17:03:04.293640 [info ] [MainThread]: 
[0m17:03:04.293852 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m17:03:04.294693 [debug] [MainThread]: Command end result
[0m17:03:04.297885 [info ] [MainThread]: 
[0m17:03:04.298117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:04.298314 [info ] [MainThread]: 
[0m17:03:04.298520 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:03:04.298949 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:04.298905 after 2.84 seconds
[0m17:03:04.299159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10123fb90>]}
[0m17:03:04.299340 [debug] [MainThread]: Flushing usage events
[0m11:15:03.471248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad22d0>]}


============================== 11:15:03.475071 | 926b2733-f81c-47df-a15b-2830e6ac4788 ==============================
[0m11:15:03.475071 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:15:03.475419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:03.674734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1cd0>]}
[0m11:15:03.683076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac0a90>]}
[0m11:15:03.683505 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m11:15:03.714107 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:15:03.736295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:15:03.736651 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/schema.yml
[0m11:15:03.795597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7a6d0>]}
[0m11:15:03.799663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abaad0>]}
[0m11:15:03.799899 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:15:03.800122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687d090>]}
[0m11:15:03.801098 [info ] [MainThread]: 
[0m11:15:03.801496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:03.802161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m11:15:03.807060 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m11:15:03.807242 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m11:15:03.807387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:03.928371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:15:03.929705 [debug] [ThreadPool]: On list_mydb: Close
[0m11:15:03.931369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m11:15:03.936582 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m11:15:03.936870 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m11:15:03.937080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:03.955607 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:15:03.956060 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m11:15:03.956358 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m11:15:03.974442 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:15:03.975783 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m11:15:03.976763 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m11:15:03.981955 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:03.982269 [debug] [MainThread]: On master: BEGIN
[0m11:15:03.982491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:03.995644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:03.995951 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:03.996249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:04.025900 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m11:15:04.026841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae4bd0>]}
[0m11:15:04.027074 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:04.028519 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:04.028664 [debug] [MainThread]: On master: BEGIN
[0m11:15:04.030641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.030783 [debug] [MainThread]: On master: COMMIT
[0m11:15:04.030913 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:04.031039 [debug] [MainThread]: On master: COMMIT
[0m11:15:04.032077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:04.032259 [debug] [MainThread]: On master: Close
[0m11:15:04.032620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:04.032836 [info ] [MainThread]: 
[0m11:15:04.035791 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m11:15:04.036025 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m11:15:04.036199 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m11:15:04.036364 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m11:15:04.036620 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m11:15:04.036886 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m11:15:04.037478 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m11:15:04.037826 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m11:15:04.038327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m11:15:04.038707 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m11:15:04.039057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m11:15:04.039377 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m11:15:04.039561 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m11:15:04.039720 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m11:15:04.039874 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m11:15:04.040020 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m11:15:04.041679 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m11:15:04.043027 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m11:15:04.044231 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m11:15:04.045512 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m11:15:04.046746 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 11:15:04.043156 => 11:15:04.046606
[0m11:15:04.046999 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 11:15:04.044363 => 11:15:04.046895
[0m11:15:04.047192 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 11:15:04.040131 => 11:15:04.047108
[0m11:15:04.047411 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m11:15:04.047591 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 11:15:04.041816 => 11:15:04.047512
[0m11:15:04.047775 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m11:15:04.047976 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m11:15:04.065664 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m11:15:04.072495 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m11:15:04.075304 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m11:15:04.077841 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m11:15:04.089009 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m11:15:04.089743 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.090018 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m11:15:04.090208 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:04.090379 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:15:04.090545 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:04.090734 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:04.090938 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m11:15:04.091220 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m11:15:04.091389 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m11:15:04.091552 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:15:04.091710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:04.091909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:15:04.101573 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.101983 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.102223 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m11:15:04.103490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.103833 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:04.104047 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.104957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.105201 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:04.105399 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.106100 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.106393 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:04.106640 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:04.118687 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:15:04.122373 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.122635 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m11:15:04.124757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:04.127276 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.127533 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m11:15:04.128899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:04.138683 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m11:15:04.138960 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.139135 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m11:15:04.158577 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:04.163948 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m11:15:04.164379 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m11:15:04.182223 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:15:04.183281 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 11:15:04.078019 => 11:15:04.183137
[0m11:15:04.183496 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m11:15:04.183914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333790>]}
[0m11:15:04.184346 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:15:04.185190 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m11:15:04.185932 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m11:15:04.186537 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m11:15:04.187964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m11:15:04.188795 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m11:15:04.191861 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m11:15:04.193130 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 11:15:04.189115 => 11:15:04.192792
[0m11:15:04.193653 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m11:15:04.202544 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m11:15:04.206393 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:04.207096 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m11:15:04.207757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:15:04.230868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:04.231370 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:04.231599 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m11:15:05.074475 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m11:15:05.079568 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.080148 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m11:15:05.082084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.084112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.084425 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m11:15:05.086112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.089706 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m11:15:05.089961 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.090167 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m11:15:05.175135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.180645 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m11:15:05.181210 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m11:15:05.212205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.214586 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 11:15:04.075508 => 11:15:05.214308
[0m11:15:05.215178 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m11:15:05.216442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108571590>]}
[0m11:15:05.217251 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 1.18s]
[0m11:15:05.218136 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m11:15:05.224641 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m11:15:05.227967 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.228914 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m11:15:05.238347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.240419 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.240810 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m11:15:05.244214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.246370 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m11:15:05.246865 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.247135 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m11:15:05.308738 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.313429 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m11:15:05.313925 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m11:15:05.349674 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.351819 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 11:15:04.072783 => 11:15:05.351561
[0m11:15:05.352390 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m11:15:05.353857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7a8d0>]}
[0m11:15:05.354780 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.31s]
[0m11:15:05.355706 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m11:15:05.702205 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m11:15:05.708400 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.709058 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m11:15:05.715075 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.716784 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.716996 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m11:15:05.719696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.720990 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m11:15:05.721186 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.721348 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m11:15:05.801099 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.805560 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m11:15:05.806228 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m11:15:05.868754 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 2.0 seconds
[0m11:15:05.874394 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.874926 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m11:15:05.876609 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.881057 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.881305 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m11:15:05.882364 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:05.883669 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m11:15:05.883856 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.884017 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m11:15:05.902589 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:05.906911 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m11:15:05.907521 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m11:15:05.909074 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:05.909986 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 11:15:04.194221 => 11:15:05.909865
[0m11:15:05.910199 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m11:15:05.910706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093840d0>]}
[0m11:15:05.911129 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 1.72s]
[0m11:15:05.911492 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m11:15:06.210017 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.212643 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 11:15:04.048110 => 11:15:06.212379
[0m11:15:06.213251 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m11:15:06.214389 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109398850>]}
[0m11:15:06.215191 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 2.18s]
[0m11:15:06.216084 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m11:15:06.217902 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m11:15:06.218602 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.219208 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m11:15:06.219539 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m11:15:06.220038 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m11:15:06.220633 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m11:15:06.221036 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m11:15:06.221364 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m11:15:06.221893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m11:15:06.222332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m11:15:06.223058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m11:15:06.223521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m11:15:06.223789 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m11:15:06.223977 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.224178 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m11:15:06.224381 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m11:15:06.226706 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m11:15:06.228317 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.230222 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m11:15:06.231875 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m11:15:06.233002 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 11:15:06.228521 => 11:15:06.232841
[0m11:15:06.233338 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m11:15:06.233556 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 11:15:06.226901 => 11:15:06.233469
[0m11:15:06.236582 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m11:15:06.236986 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 11:15:06.230459 => 11:15:06.236860
[0m11:15:06.237213 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 11:15:06.224531 => 11:15:06.237100
[0m11:15:06.237440 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.237674 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m11:15:06.237850 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m11:15:06.240160 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.242485 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m11:15:06.242715 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.245131 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m11:15:06.245622 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m11:15:06.245906 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.246171 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:06.246530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:15:06.246809 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.246989 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m11:15:06.247184 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m11:15:06.247488 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m11:15:06.247744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:15:06.247922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:15:06.248149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:06.260859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.261198 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.261478 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.261679 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.261918 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m11:15:06.262222 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m11:15:06.264324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.264680 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.264894 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m11:15:06.265571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:15:06.265796 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:06.265985 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m11:15:06.565537 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m11:15:06.569810 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.570477 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m11:15:06.572653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.577062 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.577611 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m11:15:06.579174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.581345 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m11:15:06.581603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.581788 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m11:15:06.595752 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m11:15:06.599865 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.600126 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:06.600400 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m11:15:06.602703 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m11:15:06.603199 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m11:15:06.604140 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.606154 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.606385 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m11:15:06.608412 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.611022 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m11:15:06.611533 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.611800 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m11:15:06.616846 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:06.619058 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m11:15:06.619563 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m11:15:06.632244 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.633262 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 11:15:06.233689 => 11:15:06.633149
[0m11:15:06.633551 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m11:15:06.634003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c6590>]}
[0m11:15:06.634362 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.41s]
[0m11:15:06.634705 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m11:15:06.645239 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:06.646265 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 11:15:06.238006 => 11:15:06.646162
[0m11:15:06.646615 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m11:15:06.647258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae3dd0>]}
[0m11:15:06.647703 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.43s]
[0m11:15:06.648143 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m11:15:06.969264 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m11:15:06.971617 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.971883 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m11:15:06.975403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.977225 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.977467 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m11:15:06.979044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:06.980573 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m11:15:06.980758 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:06.980913 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m11:15:07.019929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.021336 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m11:15:07.021633 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m11:15:07.029323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:07.030188 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 11:15:06.242859 => 11:15:07.030096
[0m11:15:07.030382 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m11:15:07.030760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913af50>]}
[0m11:15:07.031069 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.81s]
[0m11:15:07.031503 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m11:15:07.276485 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m11:15:07.282118 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.282771 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m11:15:07.284313 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:07.288062 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.288336 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m11:15:07.289136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:07.290367 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m11:15:07.290535 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.290691 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m11:15:07.315075 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.320240 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m11:15:07.320989 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m11:15:07.380066 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:15:07.383876 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 11:15:06.240354 => 11:15:07.383442
[0m11:15:07.384693 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m11:15:07.385857 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926b2733-f81c-47df-a15b-2830e6ac4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c0b10>]}
[0m11:15:07.386676 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.16s]
[0m11:15:07.387600 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m11:15:07.389098 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:07.389338 [debug] [MainThread]: On master: BEGIN
[0m11:15:07.389485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:07.403157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:07.403651 [debug] [MainThread]: On master: COMMIT
[0m11:15:07.403864 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:07.404020 [debug] [MainThread]: On master: COMMIT
[0m11:15:07.404978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:07.405199 [debug] [MainThread]: On master: Close
[0m11:15:07.405638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:07.405822 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m11:15:07.405986 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m11:15:07.406128 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m11:15:07.406255 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m11:15:07.406450 [info ] [MainThread]: 
[0m11:15:07.406671 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m11:15:07.407588 [debug] [MainThread]: Command end result
[0m11:15:07.412159 [info ] [MainThread]: 
[0m11:15:07.412457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:07.412707 [info ] [MainThread]: 
[0m11:15:07.412968 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:15:07.413536 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:07.413467 after 3.96 seconds
[0m11:15:07.413799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195e90>]}
[0m11:15:07.413990 [debug] [MainThread]: Flushing usage events
[0m09:36:28.850075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d06f50>]}


============================== 09:36:28.853805 | c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6 ==============================
[0m09:36:28.853805 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:36:28.854151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:36:28.949678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d358d0>]}
[0m09:36:28.956772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d36610>]}
[0m09:36:28.957169 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:36:28.994325 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:36:29.021269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:29.021535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:29.025454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181a7e50>]}
[0m09:36:29.031256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118104ad0>]}
[0m09:36:29.031543 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:36:29.031763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a5350>]}
[0m09:36:29.032951 [info ] [MainThread]: 
[0m09:36:29.033470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:29.034313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:36:29.040469 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:36:29.040725 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:36:29.040868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:29.136237 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.136639 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:36:29.136893 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:36:29.163116 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:36:29.164704 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:36:29.166505 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:36:29.196880 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.197156 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.197319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:29.209657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.209972 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.210242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:29.254171 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:36:29.255591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e2a74b-fcc7-41f7-ad0b-9916f22e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00910>]}
[0m09:36:29.255939 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:29.256759 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.256972 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.258273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.258517 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.258800 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.259058 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.259790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:36:29.260013 [debug] [MainThread]: On master: Close
[0m09:36:29.260477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:36:29.260749 [info ] [MainThread]: 
[0m09:36:29.264040 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.264316 [debug] [Thread-2 (]: Began running node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.264550 [debug] [Thread-3 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.264767 [debug] [Thread-4 (]: Began running node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.265025 [info ] [Thread-1 (]: 1 of 7 START test has_rows_sum_genre_views_ .................................... [RUN]
[0m09:36:29.265362 [info ] [Thread-2 (]: 2 of 7 START test has_rows_sum_movie_viewing_time_ ............................. [RUN]
[0m09:36:29.265709 [info ] [Thread-3 (]: 3 of 7 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:36:29.266059 [info ] [Thread-4 (]: 4 of 7 START test has_rows_sum_user_activity_ .................................. [RUN]
[0m09:36:29.266662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90)
[0m09:36:29.267140 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0'
[0m09:36:29.267592 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe'
[0m09:36:29.268040 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c'
[0m09:36:29.268293 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.268530 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.268750 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.268971 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.281159 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90 (compile): 09:36:29.269137 => 09:36:29.280995
[0m09:36:29.281546 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0 (compile): 09:36:29.274438 => 09:36:29.281411
[0m09:36:29.281871 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:36:29.276686 => 09:36:29.281772
[0m09:36:29.282175 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c (compile): 09:36:29.278711 => 09:36:29.282082
[0m09:36:29.288136 [debug] [Thread-2 (]: Compilation Error in test has_rows_sum_movie_viewing_time_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.288830 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_genre_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.289449 [debug] [Thread-4 (]: Compilation Error in test has_rows_sum_user_activity_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.290031 [debug] [Thread-3 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.290299 [error] [Thread-2 (]: 2 of 7 ERROR has_rows_sum_movie_viewing_time_ .................................. [[31mERROR[0m in 0.02s]
[0m09:36:29.290649 [error] [Thread-1 (]: 1 of 7 ERROR has_rows_sum_genre_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.290965 [error] [Thread-4 (]: 4 of 7 ERROR has_rows_sum_user_activity_ ....................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.291312 [error] [Thread-3 (]: 3 of 7 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:36:29.291628 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0
[0m09:36:29.291863 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90
[0m09:36:29.292097 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c
[0m09:36:29.292318 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:36:29.292547 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.292811 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.293039 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.293319 [info ] [Thread-2 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:36:29.293577 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:36:29.293823 [info ] [Thread-4 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:36:29.294235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_viewing_time_.eb8ed653e0, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:36:29.294545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_genre_views_.ef88317f90, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:36:29.294873 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_user_activity_.33bd5bd05c, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:36:29.295072 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.295254 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.295426 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.300325 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.302606 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.304880 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.305723 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:36:29.295552 => 09:36:29.305555
[0m09:36:29.305949 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:36:29.300520 => 09:36:29.305866
[0m09:36:29.306195 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.306404 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:36:29.302808 => 09:36:29.306324
[0m09:36:29.306598 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.313724 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.313943 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.315029 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.316078 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.316486 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.316657 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.317858 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.318097 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:36:29.318285 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:36:29.318457 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:36:29.318648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:29.318812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:36:29.318974 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:36:29.329218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.329537 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:36:29.329788 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:36:29.330498 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.330709 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:36:29.330894 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:36:29.331134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.331358 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:36:29.331548 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:36:29.337599 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.340925 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:36:29.306778 => 09:36:29.340494
[0m09:36:29.341210 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:36:29.343940 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:36:29.344528 [info ] [Thread-2 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:36:29.345212 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:36:29.532511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.533538 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:36:29.315209 => 09:36:29.533424
[0m09:36:29.533762 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:36:29.535367 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:36:29.535873 [info ] [Thread-4 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.24s]
[0m09:36:29.536477 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:36:29.665212 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:36:29.668921 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:36:29.314071 => 09:36:29.668200
[0m09:36:29.669916 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:36:29.671334 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:36:29.672559 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.38s]
[0m09:36:29.673643 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:36:29.675590 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.676077 [debug] [MainThread]: On master: BEGIN
[0m09:36:29.676552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:29.686131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:36:29.686464 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.686633 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:29.686778 [debug] [MainThread]: On master: COMMIT
[0m09:36:29.687347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:36:29.687545 [debug] [MainThread]: On master: Close
[0m09:36:29.687920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:29.688063 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:36:29.688188 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:36:29.688304 [debug] [MainThread]: Connection 'test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe' was properly closed.
[0m09:36:29.688417 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:36:29.688570 [info ] [MainThread]: 
[0m09:36:29.688771 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m09:36:29.689501 [debug] [MainThread]: Command end result
[0m09:36:29.693362 [info ] [MainThread]: 
[0m09:36:29.693648 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:36:29.693863 [info ] [MainThread]: 
[0m09:36:29.694125 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:36:29.694368 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.694547 [info ] [MainThread]: 
[0m09:36:29.694740 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_genre_views_ (models/schema.yml)[0m
[0m09:36:29.694954 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.695172 [info ] [MainThread]: 
[0m09:36:29.695407 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_user_activity_ (models/schema.yml)[0m
[0m09:36:29.695617 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.695807 [info ] [MainThread]: 
[0m09:36:29.695987 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:36:29.696157 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:36:29.696359 [info ] [MainThread]: 
[0m09:36:29.696574 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:36:29.696943 [debug] [MainThread]: Command `dbt test` failed at 09:36:29.696887 after 0.86 seconds
[0m09:36:29.697163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b20690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c1e90>]}
[0m09:36:29.697377 [debug] [MainThread]: Flushing usage events
[0m09:39:03.061500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bd710>]}


============================== 09:39:03.065092 | 13241d13-0787-4d9e-bcc1-4cf5ee52ec0a ==============================
[0m09:39:03.065092 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:39:03.065462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:39:03.076721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13241d13-0787-4d9e-bcc1-4cf5ee52ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc550>]}
[0m09:39:03.077204 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:39:03.077599 [debug] [MainThread]: Command `dbt deps` succeeded at 09:39:03.077523 after 0.03 seconds
[0m09:39:03.077814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10293a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a81dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a81e90>]}
[0m09:39:03.078008 [debug] [MainThread]: Flushing usage events
[0m09:41:13.011299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106546ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655dc50>]}


============================== 09:41:13.015398 | 07d81e2c-1aaa-42da-893d-4469ee2e2d80 ==============================
[0m09:41:13.015398 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:41:13.015778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:41:13.059126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654ca10>]}
[0m09:41:13.066282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065708d0>]}
[0m09:41:13.066758 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:41:13.079205 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:41:13.100615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:13.101188 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:41:13.113230 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:41:13.120560 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:41:13.122576 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:41:13.124457 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:41:13.172785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbcd0>]}
[0m09:41:13.176853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c71b50>]}
[0m09:41:13.177071 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:41:13.177290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104309090>]}
[0m09:41:13.178325 [info ] [MainThread]: 
[0m09:41:13.178813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:41:13.179619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:41:13.185239 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:41:13.185481 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:41:13.185613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:13.244518 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.244837 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:41:13.245047 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:41:13.265886 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:41:13.267132 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:41:13.268322 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:41:13.272640 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.272918 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.273096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:13.285478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.285756 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.286024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:41:13.309207 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:41:13.310596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d81e2c-1aaa-42da-893d-4469ee2e2d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c113d0>]}
[0m09:41:13.310937 [debug] [MainThread]: On master: ROLLBACK
[0m09:41:13.311757 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.311971 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.313314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.313564 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.313778 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.313979 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.314749 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:13.314982 [debug] [MainThread]: On master: Close
[0m09:41:13.315473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:41:13.315764 [info ] [MainThread]: 
[0m09:41:13.318929 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.319224 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.319500 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.319790 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.320039 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:41:13.320390 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:41:13.320737 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:41:13.321048 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:41:13.321610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:41:13.322099 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:41:13.322555 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:41:13.323010 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:41:13.323259 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.323484 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.323740 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.324035 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.333870 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:41:13.324245 => 09:41:13.333703
[0m09:41:13.334263 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:41:13.327333 => 09:41:13.334130
[0m09:41:13.334625 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:41:13.329497 => 09:41:13.334512
[0m09:41:13.335325 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:41:13.331510 => 09:41:13.335218
[0m09:41:13.341111 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.341846 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.342276 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:41:13.342972 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.343534 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.343788 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:41:13.344127 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:41:13.344394 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:41:13.344696 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:41:13.344970 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:41:13.345254 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.345571 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:41:13.345783 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:41:13.345998 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.346214 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:41:13.346474 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.346730 [info ] [Thread-3 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:41:13.347140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:41:13.347337 [info ] [Thread-1 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:41:13.347725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:41:13.347921 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.348238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:41:13.348413 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.353305 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.353517 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.355591 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.358278 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.358838 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:41:13.348538 => 09:41:13.358716
[0m09:41:13.359091 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.359293 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:41:13.353646 => 09:41:13.359202
[0m09:41:13.359474 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:41:13.355866 => 09:41:13.359397
[0m09:41:13.366094 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.366289 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.366467 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.368566 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.369617 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.369805 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.370121 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:41:13.370291 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.370487 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:41:13.370657 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.370830 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:41:13.371075 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:41:13.371236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:41:13.371413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:13.382187 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.382548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.382826 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:41:13.383039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.383243 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:41:13.383462 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:41:13.383666 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:41:13.383865 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:41:13.384099 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:41:13.386822 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.388551 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:41:13.359599 => 09:41:13.388333
[0m09:41:13.388894 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:41:13.390927 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:41:13.391969 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:41:13.392434 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:41:13.428285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.430825 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:41:13.368729 => 09:41:13.430338
[0m09:41:13.431407 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:41:13.433271 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:41:13.434573 [info ] [Thread-1 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.09s]
[0m09:41:13.435286 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:41:13.468108 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:13.469095 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:41:13.366637 => 09:41:13.468981
[0m09:41:13.469298 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:41:13.470166 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:41:13.470652 [info ] [Thread-3 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.12s]
[0m09:41:13.470998 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:41:13.472899 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.473245 [debug] [MainThread]: On master: BEGIN
[0m09:41:13.473404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:13.481876 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:13.482198 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.482351 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:13.482482 [debug] [MainThread]: On master: COMMIT
[0m09:41:13.483031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:13.483179 [debug] [MainThread]: On master: Close
[0m09:41:13.483499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:13.483631 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:41:13.483751 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d' was properly closed.
[0m09:41:13.483866 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:41:13.483976 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:41:13.484126 [info ] [MainThread]: 
[0m09:41:13.484336 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m09:41:13.484913 [debug] [MainThread]: Command end result
[0m09:41:13.488957 [info ] [MainThread]: 
[0m09:41:13.489256 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:41:13.489457 [info ] [MainThread]: 
[0m09:41:13.489690 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:41:13.489882 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.490061 [info ] [MainThread]: 
[0m09:41:13.490232 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:41:13.490409 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.490579 [info ] [MainThread]: 
[0m09:41:13.490745 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:41:13.491015 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.491253 [info ] [MainThread]: 
[0m09:41:13.491502 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:41:13.491700 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:13.491890 [info ] [MainThread]: 
[0m09:41:13.492106 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:41:13.492506 [debug] [MainThread]: Command `dbt test` failed at 09:41:13.492451 after 0.50 seconds
[0m09:41:13.492731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106540d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c21e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104308f50>]}
[0m09:41:13.492982 [debug] [MainThread]: Flushing usage events
[0m09:42:57.934907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fcbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106446250>]}


============================== 09:42:57.938546 | 140b73f0-ea2d-4932-8b73-a9b342f131d3 ==============================
[0m09:42:57.938546 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:42:57.938917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:42:57.981920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbdc90>]}
[0m09:42:57.988908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106428650>]}
[0m09:42:57.989336 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:42:58.000665 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:42:58.022733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:58.023312 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:42:58.035076 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:42:58.042425 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:42:58.044456 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:42:58.046315 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:42:58.093968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106463a10>]}
[0m09:42:58.098876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40210>]}
[0m09:42:58.099102 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:42:58.099319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f1090>]}
[0m09:42:58.100341 [info ] [MainThread]: 
[0m09:42:58.100768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:58.101526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:42:58.107510 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:42:58.107750 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:42:58.107881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:58.177142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.177502 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:42:58.177751 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:42:58.190865 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:42:58.192052 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:42:58.192921 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:42:58.196760 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.197012 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.197196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:58.209818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.210085 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.210352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:58.231892 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:42:58.233185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '140b73f0-ea2d-4932-8b73-a9b342f131d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40950>]}
[0m09:42:58.233498 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:58.234347 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.234546 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.236027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.236227 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.236444 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.236632 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.237355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:58.237559 [debug] [MainThread]: On master: Close
[0m09:42:58.238001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:58.238291 [info ] [MainThread]: 
[0m09:42:58.242782 [debug] [Thread-1 (]: Began running node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.243069 [debug] [Thread-2 (]: Began running node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.243337 [debug] [Thread-3 (]: Began running node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.243560 [info ] [Thread-1 (]: 1 of 7 START test count_sum_genre_views_ ....................................... [RUN]
[0m09:42:58.243871 [debug] [Thread-4 (]: Began running node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.244129 [info ] [Thread-2 (]: 2 of 7 START test count_sum_movie_viewing_time_ ................................ [RUN]
[0m09:42:58.244446 [info ] [Thread-3 (]: 3 of 7 START test count_sum_movie_views_ ....................................... [RUN]
[0m09:42:58.245045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.count_sum_genre_views_.1fe3815a3d)
[0m09:42:58.245350 [info ] [Thread-4 (]: 4 of 7 START test count_sum_user_activity_ ..................................... [RUN]
[0m09:42:58.245931 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0'
[0m09:42:58.246385 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_movie_views_.3629ba83dc'
[0m09:42:58.246616 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.247035 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.count_sum_user_activity_.ee4feb4835'
[0m09:42:58.247257 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.247466 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.250092 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.252567 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.count_sum_genre_views_.1fe3815a3d (compile): 09:42:58.247617 => 09:42:58.252445
[0m09:42:58.255067 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.count_sum_movie_views_.3629ba83dc (compile): 09:42:58.252701 => 09:42:58.254928
[0m09:42:58.255467 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0 (compile): 09:42:58.250272 => 09:42:58.255322
[0m09:42:58.258340 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.count_sum_user_activity_.ee4feb4835 (compile): 09:42:58.255689 => 09:42:58.258183
[0m09:42:58.264598 [debug] [Thread-2 (]: Compilation Error in test count_sum_movie_viewing_time_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.265191 [debug] [Thread-1 (]: Compilation Error in test count_sum_genre_views_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.265457 [error] [Thread-2 (]: 2 of 7 ERROR count_sum_movie_viewing_time_ ..................................... [[31mERROR[0m in 0.02s]
[0m09:42:58.266151 [debug] [Thread-3 (]: Compilation Error in test count_sum_movie_views_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.266722 [debug] [Thread-4 (]: Compilation Error in test count_sum_user_activity_ (models/schema.yml)
  'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.266948 [error] [Thread-1 (]: 1 of 7 ERROR count_sum_genre_views_ ............................................ [[31mERROR[0m in 0.02s]
[0m09:42:58.267235 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0
[0m09:42:58.267464 [error] [Thread-3 (]: 3 of 7 ERROR count_sum_movie_views_ ............................................ [[31mERROR[0m in 0.02s]
[0m09:42:58.267779 [error] [Thread-4 (]: 4 of 7 ERROR count_sum_user_activity_ .......................................... [[31mERROR[0m in 0.02s]
[0m09:42:58.268070 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.count_sum_genre_views_.1fe3815a3d
[0m09:42:58.268298 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.268559 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.count_sum_movie_views_.3629ba83dc
[0m09:42:58.268766 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.count_sum_user_activity_.ee4feb4835
[0m09:42:58.268974 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.269182 [info ] [Thread-2 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:42:58.269449 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.269700 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:42:58.270120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_movie_viewing_time_.642bf5e5c0, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:42:58.270326 [info ] [Thread-3 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:42:58.270726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_genre_views_.1fe3815a3d, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:42:58.270916 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.271251 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.count_sum_movie_views_.3629ba83dc, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:42:58.271447 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.276663 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.277092 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.279448 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.281561 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.281896 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:42:58.271584 => 09:42:58.281801
[0m09:42:58.282152 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:42:58.277244 => 09:42:58.282071
[0m09:42:58.282306 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.282493 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.282716 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:42:58.279681 => 09:42:58.282629
[0m09:42:58.290039 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.292952 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.293201 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.294369 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.294692 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.294961 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:42:58.295133 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:42:58.295407 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.295646 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.295809 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:42:58.296073 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:42:58.296291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:58.296602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:42:58.308325 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.308956 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:42:58.309225 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:42:58.310589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.310829 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:42:58.311020 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:42:58.311411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.311600 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:42:58.311774 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:42:58.312783 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.314187 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:42:58.282818 => 09:42:58.314037
[0m09:42:58.314454 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:42:58.315794 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:42:58.316930 [info ] [Thread-2 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:42:58.317872 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:42:58.339848 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.341149 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:42:58.293466 => 09:42:58.340981
[0m09:42:58.341438 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:42:58.343086 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:42:58.343680 [info ] [Thread-3 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:42:58.344063 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:42:58.378424 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:58.379319 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:42:58.290327 => 09:42:58.379217
[0m09:42:58.379507 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:42:58.380192 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:42:58.380609 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:42:58.380931 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:42:58.381752 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.381932 [debug] [MainThread]: On master: BEGIN
[0m09:42:58.382072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:58.390238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:58.390576 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.390727 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:58.390858 [debug] [MainThread]: On master: COMMIT
[0m09:42:58.391634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:58.391811 [debug] [MainThread]: On master: Close
[0m09:42:58.392245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:58.392383 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:42:58.392508 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:42:58.392640 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:42:58.392752 [debug] [MainThread]: Connection 'test.maker_warehouse.count_sum_user_activity_.ee4feb4835' was properly closed.
[0m09:42:58.392963 [info ] [MainThread]: 
[0m09:42:58.393173 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:42:58.393784 [debug] [MainThread]: Command end result
[0m09:42:58.397801 [info ] [MainThread]: 
[0m09:42:58.398026 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:42:58.398202 [info ] [MainThread]: 
[0m09:42:58.398424 [error] [MainThread]: [33mCompilation Error in test count_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:42:58.398616 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.398797 [info ] [MainThread]: 
[0m09:42:58.398982 [error] [MainThread]: [33mCompilation Error in test count_sum_genre_views_ (models/schema.yml)[0m
[0m09:42:58.399225 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.399428 [info ] [MainThread]: 
[0m09:42:58.399624 [error] [MainThread]: [33mCompilation Error in test count_sum_movie_views_ (models/schema.yml)[0m
[0m09:42:58.399807 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.399980 [info ] [MainThread]: 
[0m09:42:58.400149 [error] [MainThread]: [33mCompilation Error in test count_sum_user_activity_ (models/schema.yml)[0m
[0m09:42:58.400316 [error] [MainThread]:   'test_count' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:42:58.400490 [info ] [MainThread]: 
[0m09:42:58.400682 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:42:58.401044 [debug] [MainThread]: Command `dbt test` failed at 09:42:58.400979 after 0.48 seconds
[0m09:42:58.401260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b09e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b09dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fc950>]}
[0m09:42:58.401462 [debug] [MainThread]: Flushing usage events
[0m09:44:01.133799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077069d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771da10>]}


============================== 09:44:01.137435 | bc0f94dd-78e6-4f8a-8095-e382052565f4 ==============================
[0m09:44:01.137435 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:44:01.137837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:44:01.184621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771d890>]}
[0m09:44:01.191630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e710>]}
[0m09:44:01.192051 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:44:01.203520 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:44:01.225079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:01.225617 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:44:01.237147 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:44:01.244432 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:44:01.246350 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:44:01.248187 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:44:01.296271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e31ed0>]}
[0m09:44:01.300026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb1f90>]}
[0m09:44:01.300242 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:44:01.300460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eced0>]}
[0m09:44:01.301495 [info ] [MainThread]: 
[0m09:44:01.301934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:01.302699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m09:44:01.308358 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m09:44:01.308614 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m09:44:01.308760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:01.388292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:44:01.389353 [debug] [ThreadPool]: On list_mydb: Close
[0m09:44:01.390610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m09:44:01.394583 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:01.394796 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:44:01.394972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:01.407551 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.407860 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:01.408099 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:44:01.417705 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:44:01.418841 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:44:01.419617 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:44:01.423813 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.424077 [debug] [MainThread]: On master: BEGIN
[0m09:44:01.424271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:01.434859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.435196 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.435501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:01.455841 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:44:01.457221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80950>]}
[0m09:44:01.457573 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:01.458445 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.458682 [debug] [MainThread]: On master: BEGIN
[0m09:44:01.460119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.460382 [debug] [MainThread]: On master: COMMIT
[0m09:44:01.460599 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:01.460797 [debug] [MainThread]: On master: COMMIT
[0m09:44:01.461526 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:01.461755 [debug] [MainThread]: On master: Close
[0m09:44:01.462272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:01.462573 [info ] [MainThread]: 
[0m09:44:01.467154 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m09:44:01.467477 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m09:44:01.467781 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m09:44:01.468065 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m09:44:01.468385 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m09:44:01.468796 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m09:44:01.469293 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m09:44:01.469729 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m09:44:01.470345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m09:44:01.470820 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m09:44:01.471257 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m09:44:01.471671 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m09:44:01.471906 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m09:44:01.472115 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m09:44:01.472325 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m09:44:01.472533 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m09:44:01.474971 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m09:44:01.476932 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m09:44:01.478702 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m09:44:01.480286 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m09:44:01.481647 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 09:44:01.472685 => 09:44:01.481502
[0m09:44:01.481953 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 09:44:01.477121 => 09:44:01.481819
[0m09:44:01.482195 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 09:44:01.478874 => 09:44:01.482091
[0m09:44:01.482421 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m09:44:01.482659 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 09:44:01.475309 => 09:44:01.482558
[0m09:44:01.482871 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m09:44:01.483080 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m09:44:01.505908 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m09:44:01.506160 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m09:44:01.508509 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m09:44:01.510633 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m09:44:01.520718 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m09:44:01.521346 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:01.521683 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m09:44:01.521890 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:01.522086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:01.522274 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.522462 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:01.522621 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m09:44:01.522892 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m09:44:01.523061 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m09:44:01.523231 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:01.523401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:01.523574 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:01.532782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533125 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.533734 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:01.533956 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:01.534164 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.534375 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.534593 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.534795 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m09:44:01.535998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.536207 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:01.536383 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:01.552314 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:01.556561 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.556829 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m09:44:01.559958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:01.561905 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.562138 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m09:44:01.564025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:01.574869 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m09:44:01.575168 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.575358 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m09:44:01.605564 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:01.608868 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m09:44:01.609208 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m09:44:01.630765 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:01.631755 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 09:44:01.510839 => 09:44:01.631659
[0m09:44:01.631954 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m09:44:01.632354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f9bd0>]}
[0m09:44:01.632790 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m09:44:01.633330 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m09:44:01.633564 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m09:44:01.633873 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m09:44:01.634472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m09:44:01.634694 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m09:44:01.636555 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m09:44:01.637293 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 09:44:01.634810 => 09:44:01.637106
[0m09:44:01.637527 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m09:44:01.641424 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m09:44:01.642255 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:01.642477 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m09:44:01.642646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:01.650709 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:01.651004 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:01.651290 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m09:44:02.943190 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m09:44:02.945229 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.945519 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m09:44:02.948802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:02.950682 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.950916 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m09:44:02.953884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:02.957832 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m09:44:02.958114 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:02.958283 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m09:44:03.022292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.027690 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m09:44:03.028321 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m09:44:03.074538 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 2.0 seconds
[0m09:44:03.075130 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.079803 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.082774 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 09:44:01.483224 => 09:44:03.081987
[0m09:44:03.083124 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m09:44:03.083582 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m09:44:03.084389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110053ed0>]}
[0m09:44:03.085006 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 1.61s]
[0m09:44:03.085504 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m09:44:03.093559 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.095893 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.096171 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m09:44:03.155335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.156774 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m09:44:03.156969 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.157133 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m09:44:03.185724 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.190297 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m09:44:03.190662 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m09:44:03.323154 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.327237 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 09:44:01.508664 => 09:44:03.326724
[0m09:44:03.328199 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m09:44:03.329333 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5b10>]}
[0m09:44:03.330233 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 1.86s]
[0m09:44:03.331210 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m09:44:03.666446 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 2.0 seconds
[0m09:44:03.674530 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.674836 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 2.0 seconds
[0m09:44:03.675068 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m09:44:03.676602 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.676843 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m09:44:03.679028 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.679193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.680634 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.681992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.682179 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m09:44:03.682372 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m09:44:03.683740 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.683891 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:03.685063 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m09:44:03.686188 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m09:44:03.686368 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.686579 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.686772 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m09:44:03.686936 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m09:44:03.713992 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.714771 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:03.717468 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m09:44:03.718667 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m09:44:03.718847 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m09:44:03.719033 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m09:44:03.803815 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.807642 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 09:44:01.637678 => 09:44:03.807200
[0m09:44:03.808490 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m09:44:03.809795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5bad0>]}
[0m09:44:03.810752 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 2.18s]
[0m09:44:03.811780 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m09:44:03.900277 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:03.904173 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 09:44:01.506343 => 09:44:03.903789
[0m09:44:03.904996 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m09:44:03.906197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f59690>]}
[0m09:44:03.907198 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 2.43s]
[0m09:44:03.908216 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m09:44:03.909387 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m09:44:03.909655 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.909830 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m09:44:03.910023 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m09:44:03.910307 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m09:44:03.910627 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m09:44:03.910964 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m09:44:03.911237 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m09:44:03.911701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m09:44:03.912067 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m09:44:03.912407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m09:44:03.912758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m09:44:03.912991 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m09:44:03.913183 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.913399 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m09:44:03.913600 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m09:44:03.915586 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m09:44:03.916915 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.918265 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m09:44:03.919531 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m09:44:03.920147 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 09:44:03.917051 => 09:44:03.920042
[0m09:44:03.920380 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 09:44:03.913726 => 09:44:03.920295
[0m09:44:03.920536 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m09:44:03.920743 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 09:44:03.918396 => 09:44:03.920664
[0m09:44:03.920921 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 09:44:03.915727 => 09:44:03.920843
[0m09:44:03.921083 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m09:44:03.923580 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m09:44:03.923884 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m09:44:03.924099 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:03.926440 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m09:44:03.928727 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m09:44:03.930803 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.931091 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:03.931367 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m09:44:03.931531 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:03.931721 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:03.931890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:03.932073 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.932230 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m09:44:03.932408 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m09:44:03.932670 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m09:44:03.932839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:03.933003 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:03.933185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:03.944071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.944485 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:03.944694 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m09:44:03.946355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.946739 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:03.946949 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m09:44:03.953549 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.954207 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:03.954536 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m09:44:03.967953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:03.968318 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:03.968546 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m09:44:04.288845 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m09:44:04.301964 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.302964 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m09:44:04.305486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.311603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.312468 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m09:44:04.313252 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m09:44:04.313796 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.324578 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.326515 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m09:44:04.327541 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m09:44:04.328145 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.328824 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m09:44:04.330026 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.332661 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.332929 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m09:44:04.334177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.335672 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m09:44:04.335876 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.336064 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m09:44:04.338273 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.339673 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m09:44:04.339872 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.340066 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m09:44:04.341559 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m09:44:04.342006 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m09:44:04.357777 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.358114 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.358983 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 09:44:03.921219 => 09:44:04.358886
[0m09:44:04.359768 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 09:44:03.928875 => 09:44:04.359677
[0m09:44:04.360029 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m09:44:04.360229 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m09:44:04.360706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec5c10>]}
[0m09:44:04.361183 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8f810>]}
[0m09:44:04.361526 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.45s]
[0m09:44:04.361950 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.45s]
[0m09:44:04.362527 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m09:44:04.362814 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m09:44:04.634106 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m09:44:04.639786 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.640500 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m09:44:04.649002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.653215 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.653502 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m09:44:04.654804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.656392 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m09:44:04.656632 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.656805 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m09:44:04.667764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.669215 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m09:44:04.669404 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m09:44:04.674388 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:04.676574 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 09:44:03.924245 => 09:44:04.676304
[0m09:44:04.676845 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m09:44:04.677321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110091190>]}
[0m09:44:04.677663 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.77s]
[0m09:44:04.678017 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m09:44:04.864331 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m09:44:04.868852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.869181 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m09:44:04.889740 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.894084 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.894312 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m09:44:04.895226 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:04.896475 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m09:44:04.896657 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.896818 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m09:44:04.902917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:04.905905 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m09:44:04.906103 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m09:44:05.019981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:05.023799 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 09:44:03.926661 => 09:44:05.023280
[0m09:44:05.024594 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m09:44:05.025939 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0f94dd-78e6-4f8a-8095-e382052565f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000d490>]}
[0m09:44:05.027036 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.11s]
[0m09:44:05.027957 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m09:44:05.029051 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:05.029279 [debug] [MainThread]: On master: BEGIN
[0m09:44:05.029422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:05.038604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:05.038901 [debug] [MainThread]: On master: COMMIT
[0m09:44:05.039054 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:05.039184 [debug] [MainThread]: On master: COMMIT
[0m09:44:05.039795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:05.039983 [debug] [MainThread]: On master: Close
[0m09:44:05.040331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:05.040474 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m09:44:05.040591 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m09:44:05.040702 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m09:44:05.040814 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m09:44:05.041008 [info ] [MainThread]: 
[0m09:44:05.041221 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:44:05.042100 [debug] [MainThread]: Command end result
[0m09:44:05.046649 [info ] [MainThread]: 
[0m09:44:05.046900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:05.047099 [info ] [MainThread]: 
[0m09:44:05.047356 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:44:05.047853 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:05.047800 after 3.93 seconds
[0m09:44:05.048099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab1bd0>]}
[0m09:44:05.048284 [debug] [MainThread]: Flushing usage events
[0m09:44:08.090139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab05290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1e090>]}


============================== 09:44:08.093534 | 4991a506-105b-4789-a744-e468df30fc6f ==============================
[0m09:44:08.093534 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:44:08.093878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:44:08.127733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd3790>]}
[0m09:44:08.134800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2eb10>]}
[0m09:44:08.135238 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:44:08.145198 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:44:08.165765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:08.166014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:08.169742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b138790>]}
[0m09:44:08.173922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b1ad0>]}
[0m09:44:08.174227 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:44:08.174447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672ced0>]}
[0m09:44:08.175612 [info ] [MainThread]: 
[0m09:44:08.176051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:08.176795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:44:08.182117 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:08.182279 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:44:08.182444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:08.214383 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.214700 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:44:08.214898 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:44:08.223103 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:44:08.224368 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:44:08.225214 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:44:08.251767 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.252042 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.252203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:08.268099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.268422 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.268737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:08.284232 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:44:08.285437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4991a506-105b-4789-a744-e468df30fc6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e28090>]}
[0m09:44:08.285735 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:08.286531 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.286717 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.287923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.288127 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.288301 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.288460 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.289140 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:08.289342 [debug] [MainThread]: On master: Close
[0m09:44:08.289769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:08.290027 [info ] [MainThread]: 
[0m09:44:08.293001 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.293257 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.293481 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.293682 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.293915 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:44:08.294255 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:44:08.294616 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:44:08.294914 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:44:08.295404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:44:08.295845 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:44:08.296254 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:44:08.296662 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:44:08.296875 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.297084 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.297288 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.297511 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.306329 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:44:08.297676 => 09:44:08.306124
[0m09:44:08.306768 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:44:08.301866 => 09:44:08.306654
[0m09:44:08.307130 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:44:08.303941 => 09:44:08.307018
[0m09:44:08.309462 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:44:08.307260 => 09:44:08.309340
[0m09:44:08.315497 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.316054 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.316377 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:44:08.317027 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.317490 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.317729 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:44:08.317997 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:44:08.318220 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:44:08.318499 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:44:08.318783 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:44:08.319011 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.319272 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:44:08.319473 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:44:08.319672 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.319852 [info ] [Thread-3 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:44:08.320139 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.320401 [info ] [Thread-4 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:44:08.320803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:44:08.321008 [info ] [Thread-2 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:44:08.321396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:44:08.321641 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.321993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:44:08.322194 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.327074 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.327324 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.329286 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.331310 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.331924 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:44:08.327456 => 09:44:08.331823
[0m09:44:08.332111 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:44:08.322330 => 09:44:08.332031
[0m09:44:08.332279 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:44:08.329488 => 09:44:08.332205
[0m09:44:08.332434 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.332587 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.332735 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.339510 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.340935 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.341924 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.342356 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.342550 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.342717 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:44:08.342915 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:44:08.344201 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.344392 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:08.344582 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:08.344762 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:44:08.345128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:08.358904 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.359350 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:44:08.359576 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:44:08.359775 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.360037 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:44:08.360256 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:44:08.360504 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.360731 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:44:08.360932 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:44:08.363263 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.364640 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:44:08.339819 => 09:44:08.364508
[0m09:44:08.364874 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:44:08.365595 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:44:08.366098 [info ] [Thread-3 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:44:08.366469 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:44:08.389198 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.390288 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:44:08.341091 => 09:44:08.390155
[0m09:44:08.390525 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:44:08.391338 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:44:08.391846 [info ] [Thread-2 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:44:08.392228 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:44:08.425904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:08.426824 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:44:08.332847 => 09:44:08.426715
[0m09:44:08.427023 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:44:08.427706 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:44:08.428124 [info ] [Thread-4 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:44:08.428446 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:44:08.429379 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.429561 [debug] [MainThread]: On master: BEGIN
[0m09:44:08.429701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:08.442774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:08.443080 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.443232 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:08.443372 [debug] [MainThread]: On master: COMMIT
[0m09:44:08.444107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:08.444282 [debug] [MainThread]: On master: Close
[0m09:44:08.444628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:08.444769 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6' was properly closed.
[0m09:44:08.444897 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:44:08.445018 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:44:08.445134 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:44:08.445284 [info ] [MainThread]: 
[0m09:44:08.445504 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m09:44:08.446061 [debug] [MainThread]: Command end result
[0m09:44:08.450518 [info ] [MainThread]: 
[0m09:44:08.450848 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:44:08.451093 [info ] [MainThread]: 
[0m09:44:08.451321 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:44:08.451515 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.451744 [info ] [MainThread]: 
[0m09:44:08.451979 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:44:08.452186 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.452377 [info ] [MainThread]: 
[0m09:44:08.452570 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:44:08.452747 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.452920 [info ] [MainThread]: 
[0m09:44:08.453091 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:44:08.453343 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:08.453565 [info ] [MainThread]: 
[0m09:44:08.453766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:44:08.454118 [debug] [MainThread]: Command `dbt test` failed at 09:44:08.454063 after 0.38 seconds
[0m09:44:08.454329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104409e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104409dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c3810>]}
[0m09:44:08.454540 [debug] [MainThread]: Flushing usage events
[0m09:45:16.128757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251d310>]}


============================== 09:45:16.132357 | 12bce1c3-bcf2-4efb-80b0-92e7c6380244 ==============================
[0m09:45:16.132357 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:45:16.132745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:16.143751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12bce1c3-bcf2-4efb-80b0-92e7c6380244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11208ec10>]}
[0m09:45:16.147798 [debug] [MainThread]: Command `dbt clean` succeeded at 09:45:16.147707 after 0.03 seconds
[0m09:45:16.148022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5dd0>]}
[0m09:45:16.148210 [debug] [MainThread]: Flushing usage events
[0m09:45:26.623789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104885e50>]}


============================== 09:45:26.627268 | 04138c2f-0799-4664-a69f-7ab836124a16 ==============================
[0m09:45:26.627268 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:45:26.627612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:26.670147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104935290>]}
[0m09:45:26.677280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104885c90>]}
[0m09:45:26.677910 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:45:26.699389 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:45:26.699951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:45:26.700293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048950d0>]}
[0m09:45:26.982440 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m09:45:26.989170 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m09:45:26.991066 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m09:45:26.992970 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m09:45:26.994765 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m09:45:26.996927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m09:45:26.997876 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m09:45:26.999690 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m09:45:27.001658 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:45:27.003575 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m09:45:27.058031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437ec10>]}
[0m09:45:27.061879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fac650>]}
[0m09:45:27.062095 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:45:27.062305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102631090>]}
[0m09:45:27.063293 [info ] [MainThread]: 
[0m09:45:27.063702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:45:27.064441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:45:27.070164 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:45:27.070460 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:45:27.070612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:27.151681 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.152033 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:45:27.152265 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:45:27.170201 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:45:27.171663 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:45:27.172724 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:45:27.177496 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.177814 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.178006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:27.189183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.189550 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.189894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:45:27.217062 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:45:27.218543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04138c2f-0799-4664-a69f-7ab836124a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432d550>]}
[0m09:45:27.218920 [debug] [MainThread]: On master: ROLLBACK
[0m09:45:27.220805 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.221024 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.223898 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.224151 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.224401 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.224617 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.225353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:45:27.225564 [debug] [MainThread]: On master: Close
[0m09:45:27.226026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:27.226301 [info ] [MainThread]: 
[0m09:45:27.229474 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.229748 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.230001 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.230263 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.230494 [info ] [Thread-1 (]: 1 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:45:27.230893 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:45:27.231280 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_views_ ................................... [RUN]
[0m09:45:27.231611 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:45:27.232130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6)
[0m09:45:27.232615 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:45:27.233130 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5'
[0m09:45:27.233629 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:45:27.233897 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.234150 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.234391 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.234628 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.243506 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:45:27.234801 => 09:45:27.243314
[0m09:45:27.243939 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:45:27.237666 => 09:45:27.243792
[0m09:45:27.244333 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5 (compile): 09:45:27.240651 => 09:45:27.244210
[0m09:45:27.246979 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:45:27.244474 => 09:45:27.246840
[0m09:45:27.253856 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.254577 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.255253 [debug] [Thread-1 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.255866 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.256208 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:45:27.256593 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:45:27.256939 [error] [Thread-1 (]: 1 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:45:27.257275 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:45:27.257610 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:45:27.257872 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:45:27.258135 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:45:27.258365 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5
[0m09:45:27.258616 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.258898 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.259137 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.259434 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:45:27.259719 [info ] [Thread-2 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:45:27.260014 [info ] [Thread-1 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:45:27.260463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:45:27.260815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:45:27.261150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:45:27.261344 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.261535 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.261716 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.266745 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.268899 [debug] [Thread-2 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.271262 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.272214 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:45:27.269069 => 09:45:27.272032
[0m09:45:27.272514 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.272769 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:45:27.261848 => 09:45:27.272660
[0m09:45:27.278174 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:45:27.266906 => 09:45:27.278073
[0m09:45:27.280309 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.280521 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.280712 [debug] [Thread-2 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.282950 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.283978 [debug] [Thread-2 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.284428 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.284620 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.284797 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:45:27.284955 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.285123 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:45:27.285285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:27.285473 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:45:27.285657 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:45:27.285920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:45:27.295882 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.296218 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:45:27.296474 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:45:27.296901 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.297128 [debug] [Thread-2 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:45:27.297334 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:45:27.297804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.297998 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:45:27.298194 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:45:27.299653 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.301006 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:45:27.280921 => 09:45:27.300874
[0m09:45:27.301248 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:45:27.302097 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:45:27.302709 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:45:27.303186 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:45:27.329897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.330923 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:45:27.272894 => 09:45:27.330806
[0m09:45:27.331145 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:45:27.332066 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:45:27.332531 [info ] [Thread-1 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.07s]
[0m09:45:27.332888 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:45:27.366078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:45:27.367003 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:45:27.283106 => 09:45:27.366897
[0m09:45:27.367194 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:45:27.367954 [debug] [Thread-2 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:45:27.368390 [info ] [Thread-2 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:45:27.368868 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:45:27.370152 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.370511 [debug] [MainThread]: On master: BEGIN
[0m09:45:27.370655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:27.379456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:45:27.379778 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.379933 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:27.380064 [debug] [MainThread]: On master: COMMIT
[0m09:45:27.380577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:45:27.380745 [debug] [MainThread]: On master: Close
[0m09:45:27.381085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:27.381230 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:45:27.381352 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:45:27.381468 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_movie_views_.4005da58d5' was properly closed.
[0m09:45:27.381584 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:45:27.381735 [info ] [MainThread]: 
[0m09:45:27.381932 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m09:45:27.382455 [debug] [MainThread]: Command end result
[0m09:45:27.385942 [info ] [MainThread]: 
[0m09:45:27.386233 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:45:27.386418 [info ] [MainThread]: 
[0m09:45:27.386596 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:45:27.386883 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.387089 [info ] [MainThread]: 
[0m09:45:27.387340 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:45:27.387531 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.387743 [info ] [MainThread]: 
[0m09:45:27.388038 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:45:27.388229 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.388403 [info ] [MainThread]: 
[0m09:45:27.388575 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_views_ (models/schema.yml)[0m
[0m09:45:27.388744 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:45:27.388918 [info ] [MainThread]: 
[0m09:45:27.389109 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:45:27.389430 [debug] [MainThread]: Command `dbt test` failed at 09:45:27.389380 after 0.78 seconds
[0m09:45:27.389632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f49e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f49dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486a1d0>]}
[0m09:45:27.389824 [debug] [MainThread]: Flushing usage events
[0m09:53:49.142928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109306f50>]}


============================== 09:53:49.146520 | 57d2e47c-fac5-4e85-b817-f971401b740e ==============================
[0m09:53:49.146520 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:53:49.146889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:53:49.200292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932e650>]}
[0m09:53:49.207356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3810>]}
[0m09:53:49.207728 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:53:49.219396 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:53:49.241088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:49.241549 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:53:49.253104 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:53:49.302591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d1d0>]}
[0m09:53:49.306167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109339dd0>]}
[0m09:53:49.306387 [info ] [MainThread]: Found 9 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:53:49.306605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fcf50>]}
[0m09:53:49.307688 [info ] [MainThread]: 
[0m09:53:49.308110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:49.308884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:53:49.314907 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:53:49.315202 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:53:49.315357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:49.376142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.376449 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:53:49.376662 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:53:49.400373 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:53:49.401584 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:53:49.402662 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:53:49.407005 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.407276 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.407465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:49.417006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.417292 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.417592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:49.457130 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:53:49.458565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d2e47c-fac5-4e85-b817-f971401b740e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721aad0>]}
[0m09:53:49.458910 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:49.459807 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.460063 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.461467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.461755 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.462054 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.462273 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.462996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:49.463234 [debug] [MainThread]: On master: Close
[0m09:53:49.463757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:49.464065 [info ] [MainThread]: 
[0m09:53:49.467522 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.467829 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.468103 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.468356 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.468648 [info ] [Thread-1 (]: 1 of 9 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:53:49.469023 [info ] [Thread-2 (]: 2 of 9 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:53:49.469449 [info ] [Thread-3 (]: 3 of 9 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:53:49.469832 [info ] [Thread-4 (]: 4 of 9 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:53:49.470420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe)
[0m09:53:49.470955 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6'
[0m09:53:49.471496 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:53:49.471994 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:53:49.472253 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.472508 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.472746 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.472998 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.481407 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:53:49.473177 => 09:53:49.481239
[0m09:53:49.481788 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:53:49.476053 => 09:53:49.481668
[0m09:53:49.482146 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:53:49.478688 => 09:53:49.482036
[0m09:53:49.484858 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:53:49.482287 => 09:53:49.484677
[0m09:53:49.491901 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.492330 [error] [Thread-3 (]: 3 of 9 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:53:49.493137 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.493741 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.494360 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.494636 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:53:49.494912 [error] [Thread-4 (]: 4 of 9 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:53:49.495244 [error] [Thread-2 (]: 2 of 9 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:53:49.495611 [error] [Thread-1 (]: 1 of 9 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.03s]
[0m09:53:49.495937 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.496227 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:53:49.496461 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:53:49.496679 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:53:49.496885 [info ] [Thread-3 (]: 5 of 9 START test not_null_genres_genres ....................................... [RUN]
[0m09:53:49.497198 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.497481 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.497758 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.498154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:53:49.498391 [info ] [Thread-4 (]: 6 of 9 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:53:49.498689 [info ] [Thread-2 (]: 7 of 9 START test not_null_sum_movie_views_total_views ......................... [RUN]
[0m09:53:49.498996 [info ] [Thread-1 (]: 8 of 9 START test not_null_users_user_id ....................................... [RUN]
[0m09:53:49.499265 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.499691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:53:49.500070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6, now test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842)
[0m09:53:49.500397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:53:49.505741 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.505988 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.506168 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.506343 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.508657 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.511046 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842 (compile): 09:53:49.508821 => 09:53:49.510930
[0m09:53:49.513237 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.513464 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:53:49.500545 => 09:53:49.513372
[0m09:53:49.514310 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:53:49.506549 => 09:53:49.514199
[0m09:53:49.514499 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.514712 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:53:49.511213 => 09:53:49.514622
[0m09:53:49.514903 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.522164 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.522568 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.523165 [debug] [Thread-2 (]: Compilation Error in test not_null_sum_movie_views_total_views (models/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m09:53:49.525308 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.526368 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.526633 [error] [Thread-2 (]: 7 of 9 ERROR not_null_sum_movie_views_total_views .............................. [[31mERROR[0m in 0.03s]
[0m09:53:49.526929 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.527282 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842
[0m09:53:49.527494 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.527672 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:53:49.527840 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.528035 [debug] [Thread-2 (]: Began running node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.528238 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:53:49.528397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:49.528554 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:53:49.528718 [info ] [Thread-2 (]: 9 of 9 START test unique_key_sum_movie_views_movie_id .......................... [RUN]
[0m09:53:49.528944 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:49.529176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:49.529476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_null_sum_movie_views_total_views.a6df060842, now test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263)
[0m09:53:49.529889 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.532710 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263 (compile): 09:53:49.530038 => 09:53:49.532525
[0m09:53:49.533748 [debug] [Thread-2 (]: Compilation Error in test unique_key_sum_movie_views_movie_id (models/schema.yml)
  'test_unique_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.534068 [error] [Thread-2 (]: 9 of 9 ERROR unique_key_sum_movie_views_movie_id ............................... [[31mERROR[0m in 0.00s]
[0m09:53:49.534357 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263
[0m09:53:49.540490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.540836 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:53:49.541041 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:53:49.541249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.541456 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:53:49.541641 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:53:49.541823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.542086 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:53:49.542281 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:53:49.544708 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.546047 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:53:49.515072 => 09:53:49.545934
[0m09:53:49.546265 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:53:49.547327 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:53:49.547958 [info ] [Thread-3 (]: 5 of 9 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.05s]
[0m09:53:49.548351 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:53:49.598006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.600300 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:53:49.525500 => 09:53:49.599764
[0m09:53:49.600789 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:53:49.602282 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:53:49.603242 [info ] [Thread-1 (]: 8 of 9 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.10s]
[0m09:53:49.603750 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:53:49.641867 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:49.642904 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:53:49.523288 => 09:53:49.642788
[0m09:53:49.643112 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:53:49.643851 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:53:49.644298 [info ] [Thread-4 (]: 6 of 9 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.14s]
[0m09:53:49.644637 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:53:49.645623 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.645853 [debug] [MainThread]: On master: BEGIN
[0m09:53:49.646004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:49.656272 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.656589 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.656777 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:49.656961 [debug] [MainThread]: On master: COMMIT
[0m09:53:49.657751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:49.657907 [debug] [MainThread]: On master: Close
[0m09:53:49.658250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:49.658387 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:53:49.658511 [debug] [MainThread]: Connection 'test.maker_warehouse.unique_key_sum_movie_views_movie_id.f870048263' was properly closed.
[0m09:53:49.658634 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:53:49.658748 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:53:49.658913 [info ] [MainThread]: 
[0m09:53:49.659119 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:53:49.659725 [debug] [MainThread]: Command end result
[0m09:53:49.663133 [info ] [MainThread]: 
[0m09:53:49.663381 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m09:53:49.663603 [info ] [MainThread]: 
[0m09:53:49.663807 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:53:49.663996 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.664180 [info ] [MainThread]: 
[0m09:53:49.664375 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:53:49.664578 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.664814 [info ] [MainThread]: 
[0m09:53:49.665035 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:53:49.665267 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.665479 [info ] [MainThread]: 
[0m09:53:49.665684 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:53:49.665874 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.666046 [info ] [MainThread]: 
[0m09:53:49.666217 [error] [MainThread]: [33mCompilation Error in test not_null_sum_movie_views_total_views (models/schema.yml)[0m
[0m09:53:49.666390 [error] [MainThread]:   macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m09:53:49.666569 [info ] [MainThread]: 
[0m09:53:49.666790 [error] [MainThread]: [33mCompilation Error in test unique_key_sum_movie_views_movie_id (models/schema.yml)[0m
[0m09:53:49.666980 [error] [MainThread]:   'test_unique_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:49.667192 [info ] [MainThread]: 
[0m09:53:49.667411 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=6 SKIP=0 TOTAL=9
[0m09:53:49.667779 [debug] [MainThread]: Command `dbt test` failed at 09:53:49.667719 after 0.54 seconds
[0m09:53:49.668015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c15dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c15e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b8a10>]}
[0m09:53:49.668231 [debug] [MainThread]: Flushing usage events
[0m09:54:06.094811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032d9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480dd10>]}


============================== 09:54:06.098407 | d776184d-e2e2-4f79-a67f-ccf70cfcfb67 ==============================
[0m09:54:06.098407 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:54:06.098798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:54:06.139458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480db50>]}
[0m09:54:06.146382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c4890>]}
[0m09:54:06.146776 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:54:06.157525 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:54:06.180255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:06.180755 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/schema.yml
[0m09:54:06.193631 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m09:54:06.238744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f810d0>]}
[0m09:54:06.242243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea1bd0>]}
[0m09:54:06.242456 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:54:06.242671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b9090>]}
[0m09:54:06.243650 [info ] [MainThread]: 
[0m09:54:06.244072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:06.244763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb_dbt_warehouse'
[0m09:54:06.249895 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:54:06.250200 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m09:54:06.250348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:06.313547 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.313850 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m09:54:06.314061 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m09:54:06.331460 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m09:54:06.332687 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m09:54:06.333659 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m09:54:06.338281 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.338540 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.338724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:06.349707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.350010 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.350351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:06.375833 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m09:54:06.377284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd776184d-e2e2-4f79-a67f-ccf70cfcfb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ad4d0>]}
[0m09:54:06.377632 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:06.378606 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.378848 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.380136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.380359 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.380596 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.380807 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.381601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:06.381832 [debug] [MainThread]: On master: Close
[0m09:54:06.382326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:06.382631 [info ] [MainThread]: 
[0m09:54:06.386647 [debug] [Thread-1 (]: Began running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.386964 [debug] [Thread-2 (]: Began running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.387248 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.387528 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.387789 [info ] [Thread-1 (]: 1 of 7 START test has_rows_sum_movie_views_ .................................... [RUN]
[0m09:54:06.388182 [info ] [Thread-2 (]: 2 of 7 START test not_empty_sum_genre_views_ ................................... [RUN]
[0m09:54:06.388598 [info ] [Thread-3 (]: 3 of 7 START test not_empty_sum_movie_viewing_time_ ............................ [RUN]
[0m09:54:06.389000 [info ] [Thread-4 (]: 4 of 7 START test not_empty_sum_user_activity_ ................................. [RUN]
[0m09:54:06.389602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe)
[0m09:54:06.390130 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6'
[0m09:54:06.390576 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d'
[0m09:54:06.391008 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59'
[0m09:54:06.391252 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.391484 [debug] [Thread-2 (]: Began compiling node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.391710 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.391929 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.399543 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe (compile): 09:54:06.392090 => 09:54:06.399383
[0m09:54:06.399948 [debug] [Thread-2 (]: Timing info for test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6 (compile): 09:54:06.394646 => 09:54:06.399818
[0m09:54:06.400352 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d (compile): 09:54:06.396935 => 09:54:06.400206
[0m09:54:06.403149 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59 (compile): 09:54:06.400504 => 09:54:06.403007
[0m09:54:06.409301 [debug] [Thread-4 (]: Compilation Error in test not_empty_sum_user_activity_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.409919 [debug] [Thread-1 (]: Compilation Error in test has_rows_sum_movie_views_ (models/schema.yml)
  'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.410507 [debug] [Thread-3 (]: Compilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.411354 [debug] [Thread-2 (]: Compilation Error in test not_empty_sum_genre_views_ (models/schema.yml)
  'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.410759 [error] [Thread-4 (]: 4 of 7 ERROR not_empty_sum_user_activity_ ...................................... [[31mERROR[0m in 0.02s]
[0m09:54:06.411716 [error] [Thread-1 (]: 1 of 7 ERROR has_rows_sum_movie_views_ ......................................... [[31mERROR[0m in 0.02s]
[0m09:54:06.412018 [error] [Thread-3 (]: 3 of 7 ERROR not_empty_sum_movie_viewing_time_ ................................. [[31mERROR[0m in 0.02s]
[0m09:54:06.412301 [error] [Thread-2 (]: 2 of 7 ERROR not_empty_sum_genre_views_ ........................................ [[31mERROR[0m in 0.02s]
[0m09:54:06.412643 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59
[0m09:54:06.412881 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe
[0m09:54:06.413115 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d
[0m09:54:06.413337 [debug] [Thread-2 (]: Finished running node test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6
[0m09:54:06.413555 [debug] [Thread-4 (]: Began running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.413824 [debug] [Thread-1 (]: Began running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.414052 [debug] [Thread-3 (]: Began running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.414312 [info ] [Thread-4 (]: 5 of 7 START test not_null_genres_genres ....................................... [RUN]
[0m09:54:06.414569 [info ] [Thread-1 (]: 6 of 7 START test not_null_movie_viewings_movie_id ............................. [RUN]
[0m09:54:06.414847 [info ] [Thread-3 (]: 7 of 7 START test not_null_users_user_id ....................................... [RUN]
[0m09:54:06.415296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_user_activity_.f5740d6a59, now test.maker_warehouse.not_null_genres_genres.e8d3ce78a8)
[0m09:54:06.415654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.has_rows_sum_movie_views_.e3492a91fe, now test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c)
[0m09:54:06.415988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.maker_warehouse.not_empty_sum_movie_viewing_time_.76df15f91d, now test.maker_warehouse.not_null_users_user_id.fa10ab166c)
[0m09:54:06.416207 [debug] [Thread-4 (]: Began compiling node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.416420 [debug] [Thread-1 (]: Began compiling node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.416627 [debug] [Thread-3 (]: Began compiling node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.422020 [debug] [Thread-4 (]: Writing injected SQL for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.424250 [debug] [Thread-1 (]: Writing injected SQL for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.426272 [debug] [Thread-3 (]: Writing injected SQL for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.426939 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (compile): 09:54:06.424401 => 09:54:06.426827
[0m09:54:06.427174 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (compile): 09:54:06.422213 => 09:54:06.427073
[0m09:54:06.427366 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (compile): 09:54:06.416765 => 09:54:06.427281
[0m09:54:06.427522 [debug] [Thread-3 (]: Began executing node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.427698 [debug] [Thread-1 (]: Began executing node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.427873 [debug] [Thread-4 (]: Began executing node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.434813 [debug] [Thread-3 (]: Writing runtime sql for node "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.436194 [debug] [Thread-1 (]: Writing runtime sql for node "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.437214 [debug] [Thread-4 (]: Writing runtime sql for node "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.437831 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.438012 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.438183 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.438347 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: BEGIN
[0m09:54:06.438530 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: BEGIN
[0m09:54:06.438715 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: BEGIN
[0m09:54:06.438896 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:54:06.439059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:06.439215 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:54:06.451071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451473 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.451947 [debug] [Thread-4 (]: Using postgres connection "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"
[0m09:54:06.452168 [debug] [Thread-3 (]: Using postgres connection "test.maker_warehouse.not_null_users_user_id.fa10ab166c"
[0m09:54:06.452366 [debug] [Thread-1 (]: Using postgres connection "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"
[0m09:54:06.452570 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_genres_genres.e8d3ce78a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genres
from "mydb"."dbt_warehouse"."genres"
where genres is null



      
    ) dbt_internal_test
[0m09:54:06.452777 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_users_user_id.fa10ab166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "mydb"."dbt_warehouse"."users"
where user_id is null



      
    ) dbt_internal_test
[0m09:54:06.452986 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "mydb"."dbt_warehouse"."movie_viewings"
where movie_id is null



      
    ) dbt_internal_test
[0m09:54:06.456024 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.457473 [debug] [Thread-4 (]: Timing info for test.maker_warehouse.not_null_genres_genres.e8d3ce78a8 (execute): 09:54:06.436342 => 09:54:06.457332
[0m09:54:06.457715 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: ROLLBACK
[0m09:54:06.458488 [debug] [Thread-4 (]: On test.maker_warehouse.not_null_genres_genres.e8d3ce78a8: Close
[0m09:54:06.459023 [info ] [Thread-4 (]: 5 of 7 PASS not_null_genres_genres ............................................. [[32mPASS[0m in 0.04s]
[0m09:54:06.459417 [debug] [Thread-4 (]: Finished running node test.maker_warehouse.not_null_genres_genres.e8d3ce78a8
[0m09:54:06.491993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.494667 [debug] [Thread-3 (]: Timing info for test.maker_warehouse.not_null_users_user_id.fa10ab166c (execute): 09:54:06.427990 => 09:54:06.494347
[0m09:54:06.495225 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: ROLLBACK
[0m09:54:06.496994 [debug] [Thread-3 (]: On test.maker_warehouse.not_null_users_user_id.fa10ab166c: Close
[0m09:54:06.497725 [info ] [Thread-3 (]: 7 of 7 PASS not_null_users_user_id ............................................. [[32mPASS[0m in 0.08s]
[0m09:54:06.498526 [debug] [Thread-3 (]: Finished running node test.maker_warehouse.not_null_users_user_id.fa10ab166c
[0m09:54:06.518899 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:06.519898 [debug] [Thread-1 (]: Timing info for test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c (execute): 09:54:06.435056 => 09:54:06.519780
[0m09:54:06.520110 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: ROLLBACK
[0m09:54:06.520791 [debug] [Thread-1 (]: On test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c: Close
[0m09:54:06.521273 [info ] [Thread-1 (]: 6 of 7 PASS not_null_movie_viewings_movie_id ................................... [[32mPASS[0m in 0.11s]
[0m09:54:06.521633 [debug] [Thread-1 (]: Finished running node test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c
[0m09:54:06.522581 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.522793 [debug] [MainThread]: On master: BEGIN
[0m09:54:06.522949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:06.530529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:06.530823 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.530971 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:06.531106 [debug] [MainThread]: On master: COMMIT
[0m09:54:06.531718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:06.531875 [debug] [MainThread]: On master: Close
[0m09:54:06.532220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:06.532365 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_movie_viewings_movie_id.fb2255194c' was properly closed.
[0m09:54:06.532489 [debug] [MainThread]: Connection 'test.maker_warehouse.not_empty_sum_genre_views_.af19c6ecb6' was properly closed.
[0m09:54:06.532606 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_users_user_id.fa10ab166c' was properly closed.
[0m09:54:06.532718 [debug] [MainThread]: Connection 'test.maker_warehouse.not_null_genres_genres.e8d3ce78a8' was properly closed.
[0m09:54:06.532880 [info ] [MainThread]: 
[0m09:54:06.533090 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:54:06.533713 [debug] [MainThread]: Command end result
[0m09:54:06.538274 [info ] [MainThread]: 
[0m09:54:06.538541 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:54:06.538750 [info ] [MainThread]: 
[0m09:54:06.538985 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_user_activity_ (models/schema.yml)[0m
[0m09:54:06.539180 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.539361 [info ] [MainThread]: 
[0m09:54:06.539531 [error] [MainThread]: [33mCompilation Error in test has_rows_sum_movie_views_ (models/schema.yml)[0m
[0m09:54:06.539700 [error] [MainThread]:   'test_has_rows' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.539869 [info ] [MainThread]: 
[0m09:54:06.540034 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_movie_viewing_time_ (models/schema.yml)[0m
[0m09:54:06.540202 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.540367 [info ] [MainThread]: 
[0m09:54:06.540532 [error] [MainThread]: [33mCompilation Error in test not_empty_sum_genre_views_ (models/schema.yml)[0m
[0m09:54:06.540699 [error] [MainThread]:   'test_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:54:06.540871 [info ] [MainThread]: 
[0m09:54:06.541061 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
[0m09:54:06.541374 [debug] [MainThread]: Command `dbt test` failed at 09:54:06.541326 after 0.46 seconds
[0m09:54:06.541570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed3b90>]}
[0m09:54:06.541762 [debug] [MainThread]: Flushing usage events
[0m12:35:17.061610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f81290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77f90>]}


============================== 12:35:17.065174 | b2600c37-badd-448c-bad9-c6cf59a73369 ==============================
[0m12:35:17.065174 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:35:17.065519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:17.170901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2600c37-badd-448c-bad9-c6cf59a73369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99d90>]}
[0m12:35:17.178303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2600c37-badd-448c-bad9-c6cf59a73369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa9bd0>]}
[0m12:35:17.178712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:35:17.201268 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:35:17.223870 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:35:17.224207 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:35:17.224373 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:35:17.224518 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:35:17.224655 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test.sql
[0m12:35:17.224791 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:35:17.224922 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:35:17.225055 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:35:17.225186 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:35:17.225316 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:35:17.225445 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:35:17.225638 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:35:17.225781 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:35:17.225913 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:35:17.226040 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:35:17.226160 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:35:17.226270 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:35:17.226387 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:35:17.226506 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:35:17.226628 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:35:17.226744 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:35:17.237842 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:35:17.245515 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:35:17.246903 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:35:17.248883 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:35:17.250711 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test.sql
[0m12:35:17.270135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test.sql
[0m12:35:17.270462 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "mac_test".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("mac_test").
  
  To fix this, change the name of one of these resources:
  - model.maker_warehouse.mac_test (models/raw_banking/mac_test.sql)
  - model.maker_warehouse.mac_test (models/raw_netflix/mac_test.sql)
[0m12:35:17.270823 [debug] [MainThread]: Command `dbt run` failed at 12:35:17.270762 after 0.23 seconds
[0m12:35:17.271022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10065de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104055f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104054a50>]}
[0m12:35:17.271230 [debug] [MainThread]: Flushing usage events
[0m12:35:51.273470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997f90>]}


============================== 12:35:51.277105 | 87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd ==============================
[0m12:35:51.277105 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:35:51.277501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:51.320196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ca4d0>]}
[0m12:35:51.327352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b5b114-3dfe-44c0-ac3c-3ecf1bb499bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cde10>]}
[0m12:35:51.327742 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:35:51.337613 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:35:51.361413 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:35:51.361774 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test_banking.sql
[0m12:35:51.361940 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:35:51.362088 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:35:51.362228 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:35:51.362378 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:35:51.362511 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:35:51.362661 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:35:51.362801 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:35:51.362935 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:35:51.363074 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:35:51.363270 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:35:51.363416 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:35:51.363556 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:35:51.363701 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:35:51.363831 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:35:51.363956 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:35:51.364092 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:35:51.364215 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:35:51.364341 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:35:51.364468 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:35:51.374946 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test_banking.sql
[0m12:35:51.382782 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test_banking.sql
[0m12:35:51.384107 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m12:35:51.386103 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:35:51.408275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:35:51.409474 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m12:35:51.411345 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m12:35:51.413248 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:35:51.415102 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m12:35:51.417015 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m12:35:51.418890 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:35:51.420667 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m12:35:51.462466 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/raw_netflix/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m12:35:51.462948 [debug] [MainThread]: Command `dbt run` failed at 12:35:51.462881 after 0.21 seconds
[0m12:35:51.463157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d7d10>]}
[0m12:35:51.463370 [debug] [MainThread]: Flushing usage events
[0m12:36:37.896610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491df10>]}


============================== 12:36:37.900277 | 500c9baf-2d41-4ba9-b213-24e310da627e ==============================
[0m12:36:37.900277 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:36:37.900639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:37.942225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '500c9baf-2d41-4ba9-b213-24e310da627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d39d0>]}
[0m12:36:37.949264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '500c9baf-2d41-4ba9-b213-24e310da627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906150>]}
[0m12:36:37.949629 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m12:36:37.960599 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:36:37.982143 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 10 files added, 1 files changed.
[0m12:36:37.982469 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m12:36:37.982633 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m12:36:37.982777 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/mac_test_banking.sql
[0m12:36:37.982915 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m12:36:37.983048 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m12:36:37.983180 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m12:36:37.983310 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m12:36:37.983444 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m12:36:37.983571 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m12:36:37.983701 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m12:36:37.983900 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m12:36:37.984044 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m12:36:37.984171 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m12:36:37.984299 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m12:36:37.984429 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m12:36:37.984561 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m12:36:37.984675 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m12:36:37.984797 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m12:36:37.984922 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m12:36:37.985045 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m12:36:37.996450 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m12:36:38.004246 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m12:36:38.005597 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m12:36:38.007463 [debug] [MainThread]: 1603: static parser failed on raw_banking/mac_test_banking.sql
[0m12:36:38.027746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_banking/mac_test_banking.sql
[0m12:36:38.028919 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m12:36:38.030815 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m12:36:38.032606 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m12:36:38.034399 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m12:36:38.036253 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m12:36:38.038009 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m12:36:38.039757 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m12:36:38.078061 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/raw_netflix/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m12:36:38.078473 [debug] [MainThread]: Command `dbt run` failed at 12:36:38.078407 after 0.20 seconds
[0m12:36:38.078682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104900ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490cbd0>]}
[0m12:36:38.078891 [debug] [MainThread]: Flushing usage events
[0m13:56:59.564644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c9c50>]}


============================== 13:56:59.569260 | 21df9884-d5dc-4d63-a93e-008dee4fe9ee ==============================
[0m13:56:59.569260 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:56:59.569650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:56:59.622220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21df9884-d5dc-4d63-a93e-008dee4fe9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c9a10>]}
[0m13:56:59.629713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21df9884-d5dc-4d63-a93e-008dee4fe9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057229d0>]}
[0m13:56:59.630433 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:56:59.647606 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:56:59.678218 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 9 files added, 1 files changed.
[0m13:56:59.678647 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m13:56:59.678827 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m13:56:59.678988 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m13:56:59.679138 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m13:56:59.679288 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m13:56:59.679434 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m13:56:59.679576 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m13:56:59.679717 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m13:56:59.679858 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m13:56:59.680085 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:56:59.680219 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m13:56:59.680382 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m13:56:59.680523 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m13:56:59.680660 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m13:56:59.680798 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m13:56:59.680933 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m13:56:59.681063 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m13:56:59.681193 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m13:56:59.681323 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m13:56:59.692982 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:56:59.700562 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:56:59.703007 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:56:59.705100 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:56:59.707193 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m13:56:59.710813 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m13:56:59.712142 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:56:59.741834 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:56:59.744304 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:56:59.748408 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:56:59.789536 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/raw_netflix/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m13:56:59.790025 [debug] [MainThread]: Command `dbt run` failed at 13:56:59.789958 after 0.25 seconds
[0m13:56:59.790278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ca010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067acf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b3810>]}
[0m13:56:59.790522 [debug] [MainThread]: Flushing usage events
[0m13:57:11.779131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d79290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d92010>]}


============================== 13:57:11.782761 | a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564 ==============================
[0m13:57:11.782761 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:57:11.783114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.824102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d805d0>]}
[0m13:57:11.831088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e47ad0>]}
[0m13:57:11.831526 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:57:11.842646 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:57:11.862698 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 9 files added, 1 files changed.
[0m13:57:11.863087 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m13:57:11.863254 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m13:57:11.863402 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m13:57:11.863542 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m13:57:11.863677 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/users.sql
[0m13:57:11.863807 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m13:57:11.863946 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m13:57:11.864083 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/movies.sql
[0m13:57:11.864219 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_netflix/genres.sql
[0m13:57:11.864395 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:57:11.864559 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m13:57:11.864706 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m13:57:11.864847 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m13:57:11.864972 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m13:57:11.865098 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m13:57:11.865218 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m13:57:11.865332 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m13:57:11.865448 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m13:57:11.865565 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m13:57:11.877472 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:57:11.884668 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:57:11.886637 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:57:11.888549 [debug] [MainThread]: 1603: static parser failed on raw_netflix/mac_test.sql
[0m13:57:11.891192 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_netflix/mac_test.sql
[0m13:57:11.892184 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:57:11.894027 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:57:11.913939 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:57:11.915946 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:57:11.917768 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:57:11.954768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d906d0>]}
[0m13:57:11.959815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407410>]}
[0m13:57:11.960025 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m13:57:11.960238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3d090>]}
[0m13:57:11.961291 [info ] [MainThread]: 
[0m13:57:11.961816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:11.962581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:57:11.968088 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:57:11.968346 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:57:11.968487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:12.071567 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:57:12.072774 [debug] [ThreadPool]: On list_mydb: Close
[0m13:57:12.074168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m13:57:12.078759 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:12.079022 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:57:12.079233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:12.093477 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.093817 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:12.094080 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:57:12.114484 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m13:57:12.115806 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:57:12.116991 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:57:12.121964 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.122279 [debug] [MainThread]: On master: BEGIN
[0m13:57:12.122485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:12.136579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.137000 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.137446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:12.182748 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m13:57:12.184131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d807d0>]}
[0m13:57:12.184418 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:12.185145 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.185312 [debug] [MainThread]: On master: BEGIN
[0m13:57:12.186296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.186504 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.186665 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:12.186813 [debug] [MainThread]: On master: COMMIT
[0m13:57:12.187856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:12.188054 [debug] [MainThread]: On master: Close
[0m13:57:12.188483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:12.188718 [info ] [MainThread]: 
[0m13:57:12.193387 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m13:57:12.193619 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m13:57:12.193804 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m13:57:12.194001 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m13:57:12.194240 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m13:57:12.194532 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m13:57:12.194820 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m13:57:12.195131 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m13:57:12.195579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m13:57:12.195937 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m13:57:12.196268 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m13:57:12.196621 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m13:57:12.196812 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m13:57:12.196986 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m13:57:12.197151 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m13:57:12.197301 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m13:57:12.198988 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m13:57:12.200494 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m13:57:12.201911 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m13:57:12.203464 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:57:12.204164 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 13:57:12.197426 => 13:57:12.204055
[0m13:57:12.204701 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m13:57:12.204911 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 13:57:12.199158 => 13:57:12.204825
[0m13:57:12.211323 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 13:57:12.200668 => 13:57:12.211020
[0m13:57:12.223751 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 13:57:12.202117 => 13:57:12.223563
[0m13:57:12.229846 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m13:57:12.230122 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m13:57:12.230346 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m13:57:12.230552 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m13:57:12.241675 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m13:57:12.244067 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m13:57:12.246418 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:57:12.246625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:12.247029 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.247253 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:12.247427 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m13:57:12.247639 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m13:57:12.247823 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:12.248001 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m13:57:12.248178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:12.248350 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:57:12.248521 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m13:57:12.248686 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:12.249001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:57:12.263870 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.264266 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:12.264496 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.269034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.269476 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:12.269965 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.270191 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.270553 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.270889 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m13:57:12.273828 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.274248 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:12.274467 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:12.283377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:57:12.287408 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.287764 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m13:57:12.289407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:12.291361 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.291616 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m13:57:12.292788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:12.303414 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:12.303726 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.303912 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:12.310183 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:12.313517 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:12.313832 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m13:57:12.323076 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:57:12.324603 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 13:57:12.230783 => 13:57:12.324448
[0m13:57:12.324842 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m13:57:12.325332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065db490>]}
[0m13:57:12.325728 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m13:57:12.327011 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m13:57:12.327317 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m13:57:12.327874 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m13:57:12.328923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m13:57:12.329244 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m13:57:12.331261 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m13:57:12.331734 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 13:57:12.329375 => 13:57:12.331628
[0m13:57:12.331956 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m13:57:12.334562 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m13:57:12.334992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:12.335200 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m13:57:12.335369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:12.345939 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:12.346253 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:12.346478 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:14.435474 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 2.0 seconds
[0m13:57:14.443447 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.443797 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m13:57:14.460471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.465205 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.465467 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m13:57:14.475805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.481700 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:14.482008 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.482183 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:14.593525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.600537 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:14.601214 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 2.0 seconds
[0m13:57:14.601870 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m13:57:14.604684 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.605062 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m13:57:14.615723 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.618810 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.619089 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:57:14.681689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.687192 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:14.687767 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:14.688430 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.690532 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 13:57:12.205029 => 13:57:14.690144
[0m13:57:14.690960 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:14.691210 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m13:57:14.691990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661b1d0>]}
[0m13:57:14.692643 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 2.50s]
[0m13:57:14.693070 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m13:57:14.732155 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.734197 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:14.734486 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:57:14.789192 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:14.790334 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 13:57:12.244258 => 13:57:14.790210
[0m13:57:14.790720 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m13:57:14.790915 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 3.0 seconds
[0m13:57:14.791450 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106564a10>]}
[0m13:57:14.793288 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.793655 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 2.59s]
[0m13:57:14.793940 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m13:57:14.794370 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m13:57:14.796952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.799302 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.799686 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m13:57:14.807952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:14.813917 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:14.814471 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.814973 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:14.863077 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:14.864634 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:14.864823 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m13:57:15.086116 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 3.0 seconds
[0m13:57:15.092667 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.093327 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m13:57:15.101559 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:15.103272 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.103494 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m13:57:15.104411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:15.105772 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:15.105951 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.106108 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:15.164469 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:15.169026 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:15.169582 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m13:57:15.393625 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:15.396014 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 13:57:12.332094 => 13:57:15.395852
[0m13:57:15.396290 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m13:57:15.396881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bb990>]}
[0m13:57:15.397265 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 3.07s]
[0m13:57:15.397635 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m13:57:15.513907 [debug] [Thread-3 (]: SQL status: DROP TABLE in 1.0 seconds
[0m13:57:15.517548 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 13:57:12.241861 => 13:57:15.517157
[0m13:57:15.518319 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m13:57:15.519501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bc1d0>]}
[0m13:57:15.520404 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 3.32s]
[0m13:57:15.521371 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m13:57:15.522523 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m13:57:15.522805 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.523040 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m13:57:15.523330 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m13:57:15.523643 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m13:57:15.523966 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m13:57:15.524295 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m13:57:15.524630 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m13:57:15.525135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m13:57:15.525507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m13:57:15.525828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m13:57:15.526516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m13:57:15.526817 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m13:57:15.527015 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.527195 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m13:57:15.527370 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m13:57:15.529163 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m13:57:15.530655 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.531994 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m13:57:15.533311 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m13:57:15.533801 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 13:57:15.527515 => 13:57:15.533701
[0m13:57:15.534000 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 13:57:15.529321 => 13:57:15.533907
[0m13:57:15.534209 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m13:57:15.534388 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 13:57:15.530801 => 13:57:15.534309
[0m13:57:15.534565 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 13:57:15.532137 => 13:57:15.534486
[0m13:57:15.534737 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:15.536954 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m13:57:15.537133 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m13:57:15.537306 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m13:57:15.540388 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.543245 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m13:57:15.545712 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m13:57:15.545940 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:15.546363 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.546563 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:15.546753 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m13:57:15.546915 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:15.547085 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m13:57:15.547272 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m13:57:15.547467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:15.547634 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m13:57:15.547797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:57:15.547951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:15.548206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:57:15.560616 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561252 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.561523 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:15.561745 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:15.561940 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:15.562156 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:15.562398 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m13:57:15.562598 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:15.562817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:15.563355 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:15.563562 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m13:57:16.001970 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:16.007470 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.008022 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m13:57:16.010601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.014310 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.014810 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m13:57:16.015276 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:16.016876 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.017089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.017294 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m13:57:16.018732 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:16.019067 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.019236 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:16.024185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.026125 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.026386 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m13:57:16.027510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.028899 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:16.029091 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.029257 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:16.043401 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.045013 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:16.045225 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m13:57:16.045820 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.047196 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:16.047398 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m13:57:16.071792 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.074326 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 13:57:15.537432 => 13:57:16.073974
[0m13:57:16.074691 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m13:57:16.075301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dccd0>]}
[0m13:57:16.075787 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.55s]
[0m13:57:16.076497 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:16.080093 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.081542 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 13:57:15.540899 => 13:57:16.081430
[0m13:57:16.081828 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m13:57:16.082304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106477550>]}
[0m13:57:16.083027 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.56s]
[0m13:57:16.083721 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m13:57:16.330901 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m13:57:16.334472 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.334703 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m13:57:16.336479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.338632 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.338882 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m13:57:16.340077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.342091 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:16.342388 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.342571 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:16.353333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.355145 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:16.355400 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m13:57:16.363011 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.363957 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 13:57:15.534857 => 13:57:16.363863
[0m13:57:16.364167 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m13:57:16.364597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106559790>]}
[0m13:57:16.364921 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.84s]
[0m13:57:16.365382 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m13:57:16.632337 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:16.638586 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.639536 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m13:57:16.641072 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.644189 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.644505 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m13:57:16.645401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:16.646881 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:16.647076 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.647239 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:16.679912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.683959 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:16.684578 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m13:57:16.843728 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:16.847420 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 13:57:15.543495 => 13:57:16.847021
[0m13:57:16.848169 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m13:57:16.849398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d4cdd3-d977-4b7c-ae4c-ec37d0d06564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648d8d0>]}
[0m13:57:16.850304 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.32s]
[0m13:57:16.851207 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m13:57:16.852875 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:16.853129 [debug] [MainThread]: On master: BEGIN
[0m13:57:16.853281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:16.862457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:16.862761 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.862961 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:16.863145 [debug] [MainThread]: On master: COMMIT
[0m13:57:16.863758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:16.863928 [debug] [MainThread]: On master: Close
[0m13:57:16.864289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:16.864435 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m13:57:16.864560 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m13:57:16.864677 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m13:57:16.864791 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m13:57:16.864979 [info ] [MainThread]: 
[0m13:57:16.865204 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m13:57:16.866098 [debug] [MainThread]: Command end result
[0m13:57:16.871273 [info ] [MainThread]: 
[0m13:57:16.871656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:16.871900 [info ] [MainThread]: 
[0m13:57:16.872117 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:57:16.872589 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:16.872539 after 5.11 seconds
[0m13:57:16.872819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ad6d0>]}
[0m13:57:16.873011 [debug] [MainThread]: Flushing usage events
[0m13:57:53.177704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410e010>]}


============================== 13:57:53.181295 | 85e14ded-19c4-4242-837f-2e1a69adfe02 ==============================
[0m13:57:53.181295 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:57:53.181652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:57:53.224288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f1f90>]}
[0m13:57:53.231642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c3690>]}
[0m13:57:53.232022 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:57:53.243372 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:57:53.264633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:53.265311 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m13:57:53.276722 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m13:57:53.283954 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m13:57:53.285900 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m13:57:53.287804 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m13:57:53.289693 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m13:57:53.291929 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m13:57:53.293723 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m13:57:53.295515 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m13:57:53.356610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104849210>]}
[0m13:57:53.360489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ceb10>]}
[0m13:57:53.360699 [info ] [MainThread]: Found 9 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:57:53.360909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101eb9090>]}
[0m13:57:53.361888 [info ] [MainThread]: 
[0m13:57:53.362289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:53.362956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m13:57:53.368287 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m13:57:53.368543 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m13:57:53.368682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:53.442508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:57:53.443580 [debug] [ThreadPool]: On list_mydb: Close
[0m13:57:53.444804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m13:57:53.448922 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:53.449169 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m13:57:53.449358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:53.464925 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.465233 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m13:57:53.465469 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m13:57:53.475341 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m13:57:53.476506 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m13:57:53.477486 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m13:57:53.481986 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.482244 [debug] [MainThread]: On master: BEGIN
[0m13:57:53.482442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:53.492672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.493010 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.493313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:53.521105 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m13:57:53.522908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041eec10>]}
[0m13:57:53.523263 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:53.524187 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.524439 [debug] [MainThread]: On master: BEGIN
[0m13:57:53.526294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.526562 [debug] [MainThread]: On master: COMMIT
[0m13:57:53.526793 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:53.527015 [debug] [MainThread]: On master: COMMIT
[0m13:57:53.528159 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.528383 [debug] [MainThread]: On master: Close
[0m13:57:53.528881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:53.529181 [info ] [MainThread]: 
[0m13:57:53.532342 [debug] [Thread-1 (]: Began running node model.maker_warehouse.genres
[0m13:57:53.532605 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m13:57:53.532852 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movie_viewings
[0m13:57:53.533061 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movies
[0m13:57:53.533373 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_warehouse.genres .............................. [RUN]
[0m13:57:53.533784 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_warehouse.mac_test ............................. [RUN]
[0m13:57:53.534172 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_warehouse.movie_viewings ...................... [RUN]
[0m13:57:53.534567 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_warehouse.movies .............................. [RUN]
[0m13:57:53.535150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.genres)
[0m13:57:53.535636 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m13:57:53.536113 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m13:57:53.536571 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movies'
[0m13:57:53.536829 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.genres
[0m13:57:53.537064 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m13:57:53.537291 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m13:57:53.537513 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movies
[0m13:57:53.539791 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m13:57:53.542056 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m13:57:53.544072 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m13:57:53.545775 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m13:57:53.546599 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 13:57:53.540042 => 13:57:53.546457
[0m13:57:53.546908 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (compile): 13:57:53.537683 => 13:57:53.546792
[0m13:57:53.547183 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 13:57:53.542297 => 13:57:53.547058
[0m13:57:53.547408 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m13:57:53.547658 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (compile): 13:57:53.544260 => 13:57:53.547552
[0m13:57:53.547881 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.genres
[0m13:57:53.548115 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movie_viewings
[0m13:57:53.570605 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m13:57:53.570879 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movies
[0m13:57:53.583184 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m13:57:53.585586 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m13:57:53.587887 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m13:57:53.588376 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:53.588565 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.588757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.588926 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:53.589101 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m13:57:53.589294 [debug] [Thread-1 (]: On model.maker_warehouse.genres: BEGIN
[0m13:57:53.589472 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m13:57:53.589648 [debug] [Thread-4 (]: On model.maker_warehouse.movies: BEGIN
[0m13:57:53.589819 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:53.589995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:53.590166 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:57:53.590326 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:57:53.604653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.605004 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:53.605233 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.608815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.609445 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.609686 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.610234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.610552 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:53.610769 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.612489 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.612811 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.613061 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m13:57:53.630983 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:57:53.635508 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.635788 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m13:57:53.637770 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.639758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.639975 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m13:57:53.641430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.651891 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:53.652179 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.652363 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m13:57:53.658234 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.662351 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m13:57:53.662680 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m13:57:53.672629 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:57:53.673893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 13:57:53.548273 => 13:57:53.673728
[0m13:57:53.674281 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m13:57:53.674736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8110>]}
[0m13:57:53.675089 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_warehouse.mac_test ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m13:57:53.675983 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m13:57:53.676276 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m13:57:53.676861 [info ] [Thread-2 (]: 5 of 9 START sql table model dbt_warehouse.users ............................... [RUN]
[0m13:57:53.678389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m13:57:53.678822 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m13:57:53.681601 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m13:57:53.682576 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 13:57:53.678975 => 13:57:53.682440
[0m13:57:53.682796 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m13:57:53.686945 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m13:57:53.687538 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:53.688377 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m13:57:53.688807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:53.751645 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:53.752018 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:53.752264 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m13:57:53.888812 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m13:57:53.890548 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.890884 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m13:57:53.892330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.893913 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.894156 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m13:57:53.895401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:53.899571 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:53.899852 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.900023 [debug] [Thread-1 (]: On model.maker_warehouse.genres: COMMIT
[0m13:57:53.952751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:53.956346 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.genres"
[0m13:57:53.956910 [debug] [Thread-1 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m13:57:53.962512 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:53.964641 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.genres (execute): 13:57:53.571042 => 13:57:53.964382
[0m13:57:53.965139 [debug] [Thread-1 (]: On model.maker_warehouse.genres: Close
[0m13:57:53.966105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a3eb10>]}
[0m13:57:53.966830 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_warehouse.genres ......................... [[32mSELECT 1190[0m in 0.43s]
[0m13:57:53.967646 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.genres
[0m13:57:54.097750 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:54.103900 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.104443 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m13:57:54.106462 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.110039 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.110346 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m13:57:54.112148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.113509 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:54.113696 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.113859 [debug] [Thread-4 (]: On model.maker_warehouse.movies: COMMIT
[0m13:57:54.189554 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.195025 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movies"
[0m13:57:54.195585 [debug] [Thread-4 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m13:57:54.217202 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.219720 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movies (execute): 13:57:53.585819 => 13:57:54.219429
[0m13:57:54.220392 [debug] [Thread-4 (]: On model.maker_warehouse.movies: Close
[0m13:57:54.221550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483ae10>]}
[0m13:57:54.222614 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_warehouse.movies ......................... [[32mSELECT 8472[0m in 0.69s]
[0m13:57:54.223821 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movies
[0m13:57:54.481122 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:54.484878 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.485154 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m13:57:54.486723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.488501 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.488702 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m13:57:54.489734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.491041 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:54.491221 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.491383 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m13:57:54.531813 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.533241 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m13:57:54.533421 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m13:57:54.556818 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.559050 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 13:57:53.683330 => 13:57:54.558800
[0m13:57:54.559586 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m13:57:54.560160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049691d0>]}
[0m13:57:54.560515 [info ] [Thread-2 (]: 5 of 9 OK created sql table model dbt_warehouse.users .......................... [[32mSELECT 161918[0m in 0.88s]
[0m13:57:54.560848 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m13:57:54.753201 [debug] [Thread-3 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m13:57:54.757139 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.757388 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m13:57:54.758485 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.760097 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.760274 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m13:57:54.761123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:54.762374 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:54.762564 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.762727 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m13:57:54.782357 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:54.785036 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m13:57:54.785302 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m13:57:54.851009 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:54.851956 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 13:57:53.583399 => 13:57:54.851862
[0m13:57:54.852162 [debug] [Thread-3 (]: On model.maker_warehouse.movie_viewings: Close
[0m13:57:54.852579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049934d0>]}
[0m13:57:54.852904 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_warehouse.movie_viewings ................. [[32mSELECT 671736[0m in 1.32s]
[0m13:57:54.853229 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movie_viewings
[0m13:57:54.853772 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m13:57:54.853996 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.854193 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m13:57:54.854568 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m13:57:54.854402 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_warehouse.sum_genre_views ..................... [RUN]
[0m13:57:54.854831 [info ] [Thread-4 (]: 7 of 9 START sql table model dbt_warehouse.sum_movie_viewing_time .............. [RUN]
[0m13:57:54.855282 [info ] [Thread-2 (]: 8 of 9 START sql table model dbt_warehouse.sum_movie_views ..................... [RUN]
[0m13:57:54.855608 [info ] [Thread-3 (]: 9 of 9 START sql table model dbt_warehouse.sum_user_activity ................... [RUN]
[0m13:57:54.856088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m13:57:54.856402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m13:57:54.856716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m13:57:54.857017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m13:57:54.857214 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m13:57:54.857395 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.857566 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m13:57:54.857727 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m13:57:54.859744 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m13:57:54.861342 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.862933 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m13:57:54.864396 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m13:57:54.865043 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 13:57:54.859917 => 13:57:54.864932
[0m13:57:54.865306 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 13:57:54.857865 => 13:57:54.865193
[0m13:57:54.865598 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 13:57:54.861517 => 13:57:54.865494
[0m13:57:54.865780 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:54.866161 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m13:57:54.866412 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 13:57:54.863097 => 13:57:54.866327
[0m13:57:54.866589 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m13:57:54.869817 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.874380 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m13:57:54.874749 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m13:57:54.877399 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m13:57:54.880385 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m13:57:54.880757 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.881014 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:54.881232 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:54.881415 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m13:57:54.881605 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m13:57:54.881770 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:54.881953 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m13:57:54.882132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:57:54.882297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:54.882471 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m13:57:54.882627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:57:54.882952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:57:54.904998 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.905408 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:54.905620 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:54.907660 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.908006 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:54.908213 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m13:57:54.910337 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.910619 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:54.910830 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m13:57:54.916074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:54.916505 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:54.916753 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m13:57:55.325947 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:55.334123 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.334473 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m13:57:55.336841 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.339100 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.339390 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m13:57:55.340671 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.342506 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:55.343134 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m13:57:55.343711 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.346306 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.346550 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m13:57:55.346737 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m13:57:55.348158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.349998 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.350265 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m13:57:55.351365 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.352739 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:55.352933 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.353095 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m13:57:55.401799 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.402392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.406147 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m13:57:55.407668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m13:57:55.407907 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m13:57:55.408113 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m13:57:55.413045 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.414308 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 13:57:54.874912 => 13:57:55.414075
[0m13:57:55.414561 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m13:57:55.415266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dbbd0>]}
[0m13:57:55.415861 [info ] [Thread-2 (]: 8 of 9 OK created sql table model dbt_warehouse.sum_movie_views ................ [[32mSELECT 8472[0m in 0.56s]
[0m13:57:55.416279 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m13:57:55.420270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.421686 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 13:57:54.866717 => 13:57:55.421572
[0m13:57:55.421961 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m13:57:55.422776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c0ad0>]}
[0m13:57:55.423123 [info ] [Thread-4 (]: 7 of 9 OK created sql table model dbt_warehouse.sum_movie_viewing_time ......... [[32mSELECT 8472[0m in 0.57s]
[0m13:57:55.423457 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m13:57:55.733679 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m13:57:55.738714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.739400 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m13:57:55.740871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.745502 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.746025 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m13:57:55.747119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.748732 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:55.748944 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.749127 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m13:57:55.750960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.752614 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m13:57:55.752842 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m13:57:55.755805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.756627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 13:57:54.870118 => 13:57:55.756537
[0m13:57:55.756810 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m13:57:55.757271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cdf50>]}
[0m13:57:55.757684 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_warehouse.sum_genre_views ................ [[32mSELECT 1190[0m in 0.90s]
[0m13:57:55.758244 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m13:57:55.964540 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m13:57:55.968875 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.969519 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m13:57:55.971149 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.974616 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.974912 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m13:57:55.975714 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:57:55.977085 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:55.977272 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.977445 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m13:57:55.978308 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:57:55.980702 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m13:57:55.980901 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m13:57:55.994404 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:57:55.996810 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 13:57:54.877906 => 13:57:55.996473
[0m13:57:55.997435 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m13:57:55.998148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e14ded-19c4-4242-837f-2e1a69adfe02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f92d0>]}
[0m13:57:55.998524 [info ] [Thread-3 (]: 9 of 9 OK created sql table model dbt_warehouse.sum_user_activity .............. [[32mSELECT 161918[0m in 1.14s]
[0m13:57:55.998914 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m13:57:56.000304 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:56.000507 [debug] [MainThread]: On master: BEGIN
[0m13:57:56.000723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:56.023803 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:56.024254 [debug] [MainThread]: On master: COMMIT
[0m13:57:56.024641 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:56.024899 [debug] [MainThread]: On master: COMMIT
[0m13:57:56.027064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:56.027359 [debug] [MainThread]: On master: Close
[0m13:57:56.028179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:56.028476 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m13:57:56.028690 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m13:57:56.028986 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m13:57:56.029374 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m13:57:56.029623 [info ] [MainThread]: 
[0m13:57:56.030207 [info ] [MainThread]: Finished running 1 view model, 8 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m13:57:56.033347 [debug] [MainThread]: Command end result
[0m13:57:56.043517 [info ] [MainThread]: 
[0m13:57:56.044180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:56.044827 [info ] [MainThread]: 
[0m13:57:56.045362 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:57:56.046310 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:56.046234 after 2.88 seconds
[0m13:57:56.046674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100688690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007d1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007d1dd0>]}
[0m13:57:56.046950 [debug] [MainThread]: Flushing usage events
[0m14:00:19.215080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d74f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75cd0>]}


============================== 14:00:19.218725 | 5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8 ==============================
[0m14:00:19.218725 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:00:19.219113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:00:19.264956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75b50>]}
[0m14:00:19.271930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccef90>]}
[0m14:00:19.272318 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:00:19.281834 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:19.303768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:00:19.304166 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:00:19.315924 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/sum_total_customers_by_gender.sql
[0m14:00:19.345481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce852cf-0ab0-4fa5-97b5-81e83d74dbe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e56510>]}
[0m14:00:19.348545 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:00:19.351520 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:00:19.352098 [debug] [MainThread]: Command `dbt run` failed at 14:00:19.352034 after 0.15 seconds
[0m14:00:19.352305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102439dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058155d0>]}
[0m14:00:19.352499 [debug] [MainThread]: Flushing usage events
[0m14:01:02.900985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106905290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691e190>]}


============================== 14:01:02.904842 | d9a3242c-9cbc-4c9e-b9e0-7d5d3befd164 ==============================
[0m14:01:02.904842 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:01:02.905205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:02.945765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a3242c-9cbc-4c9e-b9e0-7d5d3befd164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691db50>]}
[0m14:01:02.952748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9a3242c-9cbc-4c9e-b9e0-7d5d3befd164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb410>]}
[0m14:01:02.953110 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:01:02.962784 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:01:02.985119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:02.985921 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:01:02.997500 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:01:03.004908 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:01:03.006819 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:01:03.008649 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:01:03.010459 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:01:03.012674 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:01:03.014447 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:01:03.016204 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:01:03.070530 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:01:03.070979 [debug] [MainThread]: Command `dbt run` failed at 14:01:03.070915 after 0.19 seconds
[0m14:01:03.071184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106900e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106907b50>]}
[0m14:01:03.071445 [debug] [MainThread]: Flushing usage events
[0m14:04:23.542216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c61290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c78d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c79a90>]}


============================== 14:04:23.545829 | 4da38b03-0074-46cd-a49e-6e8e5825c9d9 ==============================
[0m14:04:23.545829 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:04:23.546201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:04:23.587824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4da38b03-0074-46cd-a49e-6e8e5825c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c881d0>]}
[0m14:04:23.594770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4da38b03-0074-46cd-a49e-6e8e5825c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c575d0>]}
[0m14:04:23.595119 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:04:23.605786 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:04:23.627635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:23.628305 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:04:23.639674 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:04:23.646939 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:04:23.648852 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:04:23.650734 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:04:23.652569 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:04:23.654778 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:04:23.656555 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:04:23.658320 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:04:23.713503 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:04:23.713981 [debug] [MainThread]: Command `dbt run` failed at 14:04:23.713915 after 0.19 seconds
[0m14:04:23.714189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c61190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d57f10>]}
[0m14:04:23.714398 [debug] [MainThread]: Flushing usage events
[0m14:05:52.910690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cff90>]}


============================== 14:05:52.914341 | 7ed463a9-29a6-4153-87a0-c3205013bb60 ==============================
[0m14:05:52.914341 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:05:52.914705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.957691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049043d0>]}
[0m14:05:52.964674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fd990>]}
[0m14:05:52.965115 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:05:52.976206 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:05:52.999088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:52.999746 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:05:53.011245 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:05:53.018537 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:05:53.020486 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:05:53.022331 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:05:53.024142 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:05:53.026353 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:05:53.028120 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:05:53.029873 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:05:53.090273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ed463a9-29a6-4153-87a0-c3205013bb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ffd10>]}
[0m14:05:53.093417 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:05:53.096308 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:05:53.096985 [debug] [MainThread]: Command `dbt run` failed at 14:05:53.096907 after 0.20 seconds
[0m14:05:53.097221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a8850>]}
[0m14:05:53.097427 [debug] [MainThread]: Flushing usage events
[0m14:07:31.660217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f13f90>]}


============================== 14:07:31.663791 | 657c0565-2c0d-40bb-8353-71df4e5dcacc ==============================
[0m14:07:31.663791 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:07:31.664137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:31.710581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '657c0565-2c0d-40bb-8353-71df4e5dcacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19f50>]}
[0m14:07:31.717738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '657c0565-2c0d-40bb-8353-71df4e5dcacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4ae50>]}
[0m14:07:31.718116 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:07:31.727811 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:07:31.750223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:07:31.750641 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/banking.sql
[0m14:07:31.762312 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/banking.sql
[0m14:07:31.768912 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.banking' (models/raw_banking/banking.sql) depends on a source named 'raw.raw_banking' which was not found
[0m14:07:31.769351 [debug] [MainThread]: Command `dbt run` failed at 14:07:31.769280 after 0.12 seconds
[0m14:07:31.769583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f9e90>]}
[0m14:07:31.769812 [debug] [MainThread]: Flushing usage events
[0m14:07:50.496198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0ff90>]}


============================== 14:07:50.499648 | 2ac2ec6a-e240-469d-9199-570fe67e108c ==============================
[0m14:07:50.499648 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:07:50.499998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:50.540646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ac2ec6a-e240-469d-9199-570fe67e108c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0f450>]}
[0m14:07:50.547645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ac2ec6a-e240-469d-9199-570fe67e108c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b01ad0>]}
[0m14:07:50.548023 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:07:50.558350 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:07:50.579198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:07:50.579564 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/raw_banking/banking.sql
[0m14:07:50.580093 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:07:50.591788 [debug] [MainThread]: 1699: static parser successfully parsed raw_banking/banking.sql
[0m14:07:50.599124 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/genres.sql
[0m14:07:50.601171 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_genre_views.sql
[0m14:07:50.603036 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_viewing_time.sql
[0m14:07:50.604867 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_movie_views.sql
[0m14:07:50.607114 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/sum_user_activity.sql
[0m14:07:50.608876 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movie_viewings.sql
[0m14:07:50.610650 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/movies.sql
[0m14:07:50.612430 [debug] [MainThread]: 1699: static parser successfully parsed raw_netflix/users.sql
[0m14:07:50.666938 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/raw_netflix/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:07:50.667416 [debug] [MainThread]: Command `dbt run` failed at 14:07:50.667351 after 0.19 seconds
[0m14:07:50.667641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b00d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213d150>]}
[0m14:07:50.667883 [debug] [MainThread]: Flushing usage events
[0m14:11:48.932799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106205290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f34bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c410>]}


============================== 14:11:48.936357 | 164f11b8-a005-47bf-87b6-f511066656b0 ==============================
[0m14:11:48.936357 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:11:48.936722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:48.981384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '164f11b8-a005-47bf-87b6-f511066656b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621f050>]}
[0m14:11:48.988680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '164f11b8-a005-47bf-87b6-f511066656b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c0d0>]}
[0m14:11:48.989102 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:11:49.000821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:11:49.023245 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:11:49.023585 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:11:49.023761 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:11:49.023905 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:11:49.024042 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:11:49.024179 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:11:49.024311 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:11:49.024443 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:11:49.024577 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:11:49.024706 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:11:49.024837 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:11:49.024965 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:11:49.025163 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:11:49.025307 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:11:49.025437 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:11:49.025561 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:11:49.025672 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:11:49.025795 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:11:49.025915 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:11:49.026037 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:11:49.026158 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:11:49.026274 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:11:49.026386 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:11:49.037116 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:11:49.044392 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:11:49.046351 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:11:49.048173 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:11:49.050654 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:11:49.051602 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:11:49.053404 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:11:49.073783 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:11:49.075823 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:11:49.077665 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:11:49.079441 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:11:49.081278 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:11:49.118916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movie_viewings' (models/facts/movie_viewings.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:11:49.119371 [debug] [MainThread]: Command `dbt run` failed at 14:11:49.119282 after 0.20 seconds
[0m14:11:49.119615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106200f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c47a50>]}
[0m14:11:49.119831 [debug] [MainThread]: Flushing usage events
[0m14:12:17.206661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ba190>]}


============================== 14:12:17.210163 | 95406de0-ecee-43be-b0c8-ed5a841ba26e ==============================
[0m14:12:17.210163 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:12:17.210548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:17.251172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95406de0-ecee-43be-b0c8-ed5a841ba26e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854bb90>]}
[0m14:12:17.258154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95406de0-ecee-43be-b0c8-ed5a841ba26e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a11f10>]}
[0m14:12:17.258496 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:12:17.269580 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:12:17.290908 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:12:17.291246 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:12:17.291408 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:12:17.291553 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:12:17.291687 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:12:17.291823 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:12:17.291953 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:12:17.292086 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:12:17.292220 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:12:17.292351 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:12:17.292482 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:12:17.292608 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:12:17.292808 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:12:17.292947 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:12:17.293076 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:12:17.293203 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:12:17.293326 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:12:17.293446 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:12:17.293567 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:12:17.293679 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:12:17.293799 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:12:17.293913 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:12:17.294031 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:12:17.305553 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:12:17.312823 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:12:17.314801 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:12:17.316611 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:12:17.319131 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:12:17.320085 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:12:17.321859 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:12:17.341108 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:12:17.343043 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:12:17.344828 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:12:17.346608 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:12:17.348431 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:12:17.385761 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/facts/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:12:17.386185 [debug] [MainThread]: Command `dbt run` failed at 14:12:17.386124 after 0.19 seconds
[0m14:12:17.386399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085350d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a11d0>]}
[0m14:12:17.386590 [debug] [MainThread]: Flushing usage events
[0m14:12:51.905357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109905b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991de50>]}


============================== 14:12:51.908977 | 1029ae14-9ca1-41fe-9ca0-3264d72c9278 ==============================
[0m14:12:51.908977 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:12:51.909358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:51.951208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1029ae14-9ca1-41fe-9ca0-3264d72c9278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992e010>]}
[0m14:12:51.958221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1029ae14-9ca1-41fe-9ca0-3264d72c9278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991dc90>]}
[0m14:12:51.958573 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:12:51.971668 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:12:51.993278 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:12:51.993614 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:12:51.993776 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:12:51.993919 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:12:51.994056 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:12:51.994191 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:12:51.994326 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:12:51.994467 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:12:51.994610 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:12:51.994750 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:12:51.994885 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:12:51.995017 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:12:51.995232 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:12:51.995388 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:12:51.995528 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:12:51.995656 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:12:51.995782 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:12:51.995907 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:12:51.996026 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:12:51.996148 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:12:51.996259 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:12:51.996371 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:12:51.996507 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:12:52.007953 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:12:52.015156 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:12:52.017016 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:12:52.019471 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:12:52.020448 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:12:52.022279 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:12:52.024078 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:12:52.043684 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:12:52.045752 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:12:52.047575 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:12:52.049357 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:12:52.051187 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:12:52.088556 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movie_viewings' (models/facts/movie_viewings.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:12:52.088962 [debug] [MainThread]: Command `dbt run` failed at 14:12:52.088899 after 0.20 seconds
[0m14:12:52.089172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109900d90>]}
[0m14:12:52.089370 [debug] [MainThread]: Flushing usage events
[0m14:13:01.915325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ded290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05fd0>]}


============================== 14:13:01.919089 | 042b1575-f184-427d-89bf-f0cc3c626d1a ==============================
[0m14:13:01.919089 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:13:01.919552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:01.952544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '042b1575-f184-427d-89bf-f0cc3c626d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e165d0>]}
[0m14:13:01.959491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '042b1575-f184-427d-89bf-f0cc3c626d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebb990>]}
[0m14:13:01.959844 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:13:01.971113 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:13:01.993893 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:13:01.994335 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:13:01.994516 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:13:01.994673 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:13:01.994816 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:13:01.994954 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:13:01.995091 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:13:01.995223 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:13:01.995360 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:13:01.995494 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:13:01.995626 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:13:01.995758 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:13:01.995986 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:13:01.996139 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:13:01.996272 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:13:01.996393 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:13:01.996527 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:13:01.996656 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:13:01.996782 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:13:01.996910 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:13:01.997032 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:13:01.997153 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:13:01.997266 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:13:02.007940 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:13:02.015277 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:13:02.017171 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:13:02.018997 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:13:02.020840 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:13:02.023002 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:13:02.042436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:13:02.043575 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:13:02.045475 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:13:02.047265 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:13:02.049000 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:13:02.050830 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:13:02.088187 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/facts/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:13:02.088596 [debug] [MainThread]: Command `dbt run` failed at 14:13:02.088527 after 0.19 seconds
[0m14:13:02.088803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df40d0>]}
[0m14:13:02.089013 [debug] [MainThread]: Flushing usage events
[0m14:13:31.086255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c3f90>]}


============================== 14:13:31.089813 | 5aa46b7b-726e-4ae6-8279-a4ee1c73339e ==============================
[0m14:13:31.089813 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:13:31.090160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:31.130495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aa46b7b-726e-4ae6-8279-a4ee1c73339e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f5d50>]}
[0m14:13:31.137514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aa46b7b-726e-4ae6-8279-a4ee1c73339e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610f010>]}
[0m14:13:31.137879 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:13:31.148979 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:13:31.169652 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:13:31.169992 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:13:31.170160 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:13:31.170306 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:13:31.170443 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:13:31.170577 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:13:31.170710 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:13:31.170841 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:13:31.170975 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:13:31.171104 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:13:31.171233 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:13:31.171359 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:13:31.171557 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:13:31.171704 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:13:31.171830 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:13:31.171946 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:13:31.172074 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:13:31.172197 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:13:31.172317 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:13:31.172426 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:13:31.172546 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:13:31.172665 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:13:31.172779 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:13:31.184478 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:13:31.191715 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:13:31.193621 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:13:31.195503 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:13:31.197439 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:13:31.199633 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:13:31.219016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:13:31.220270 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:13:31.222144 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:13:31.223946 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:13:31.225726 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:13:31.227576 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:13:31.265193 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.movies' (models/facts/movies.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:13:31.265619 [debug] [MainThread]: Command `dbt run` failed at 14:13:31.265525 after 0.20 seconds
[0m14:13:31.265863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cf110>]}
[0m14:13:31.266082 [debug] [MainThread]: Flushing usage events
[0m14:14:29.948217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f030d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e37b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f8410>]}


============================== 14:14:29.952097 | 20128475-4cbf-4199-8ccc-fa0a38493170 ==============================
[0m14:14:29.952097 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:14:29.952468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:14:30.004622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20128475-4cbf-4199-8ccc-fa0a38493170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641ab90>]}
[0m14:14:30.011628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20128475-4cbf-4199-8ccc-fa0a38493170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c0b90>]}
[0m14:14:30.011983 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:14:30.022278 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:14:30.043204 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:14:30.043574 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:14:30.043749 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:14:30.043902 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:14:30.044042 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:14:30.044176 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:14:30.044308 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:14:30.044441 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:14:30.044572 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:14:30.044704 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:14:30.044832 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:14:30.044965 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:14:30.045165 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:14:30.045309 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:14:30.045442 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:14:30.045569 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:14:30.045691 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:14:30.045812 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:14:30.045925 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:14:30.046044 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:14:30.046162 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:14:30.046280 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:14:30.046390 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:14:30.057774 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:14:30.065066 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:14:30.066957 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:14:30.069462 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:14:30.070425 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:14:30.072206 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:14:30.073985 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:14:30.093579 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:14:30.095547 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:14:30.097498 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:14:30.099317 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:14:30.101177 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:14:30.138752 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.genres' (models/facts/genres.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:14:30.139178 [debug] [MainThread]: Command `dbt run` failed at 14:14:30.139115 after 0.21 seconds
[0m14:14:30.139380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102acfb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d48d0>]}
[0m14:14:30.139569 [debug] [MainThread]: Flushing usage events
[0m14:15:32.919251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7f90>]}


============================== 14:15:32.922884 | 89a3b46a-3341-4fff-b59d-96e9dd61228f ==============================
[0m14:15:32.922884 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:15:32.923240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:15:32.964607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a3b46a-3341-4fff-b59d-96e9dd61228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f9a50>]}
[0m14:15:32.971565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a3b46a-3341-4fff-b59d-96e9dd61228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e84d0>]}
[0m14:15:32.971938 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:15:32.983552 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:15:33.005745 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 11 files added, 1 files changed.
[0m14:15:33.006091 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:15:33.006264 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/users.sql
[0m14:15:33.006414 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking.sql
[0m14:15:33.006550 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:15:33.006686 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:15:33.006819 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:15:33.006950 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:15:33.007083 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/movies.sql
[0m14:15:33.007210 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:15:33.007339 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/genres.sql
[0m14:15:33.007464 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/mac_test.sql
[0m14:15:33.007669 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/sources/sources.yml
[0m14:15:33.007813 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/users.sql
[0m14:15:33.007943 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_genre_views.sql
[0m14:15:33.008067 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movies.sql
[0m14:15:33.008191 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/genres.sql
[0m14:15:33.008314 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_user_activity.sql
[0m14:15:33.008426 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/mac_test.sql
[0m14:15:33.008546 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/movie_viewings.sql
[0m14:15:33.008659 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_banking/sum_total_customers_by_gender.sql
[0m14:15:33.008775 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_views.sql
[0m14:15:33.008892 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/raw_netflix/sum_movie_viewing_time.sql
[0m14:15:33.019667 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:15:33.026939 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:15:33.028922 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:15:33.030873 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:15:33.032868 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:15:33.035180 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:15:33.036972 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:15:33.038766 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:15:33.040543 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:15:33.042288 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:15:33.061609 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:15:33.063939 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:15:33.100468 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.users' (models/facts/users.sql) depends on a source named 'raw.raw_netflix' which was not found
[0m14:15:33.100889 [debug] [MainThread]: Command `dbt run` failed at 14:15:33.100828 after 0.20 seconds
[0m14:15:33.101094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e0f90>]}
[0m14:15:33.101309 [debug] [MainThread]: Flushing usage events
[0m14:15:39.401955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104175c10>]}


============================== 14:15:39.405554 | 1aa25501-882b-4cbe-856d-32542a41e9f6 ==============================
[0m14:15:39.405554 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:15:39.405911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:15:39.417444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa25501-882b-4cbe-856d-32542a41e9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041756d0>]}
[0m14:15:39.423419 [debug] [MainThread]: Command `dbt clean` succeeded at 14:15:39.423344 after 0.04 seconds
[0m14:15:39.423638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100839e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100791a10>]}
[0m14:15:39.423833 [debug] [MainThread]: Flushing usage events
[0m14:15:49.669514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108450410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108462450>]}


============================== 14:15:49.673382 | 515382ed-2cc1-4a34-9adf-46237cc614f4 ==============================
[0m14:15:49.673382 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:15:49.673799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:15:49.715144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '515382ed-2cc1-4a34-9adf-46237cc614f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108461150>]}
[0m14:15:49.722139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '515382ed-2cc1-4a34-9adf-46237cc614f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084738d0>]}
[0m14:15:49.722509 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:15:49.733231 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:15:49.733707 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:15:49.733969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '515382ed-2cc1-4a34-9adf-46237cc614f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c7690>]}
[0m14:15:50.013112 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:15:50.019851 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:15:50.021760 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:15:50.023655 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:15:50.025596 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:15:50.027414 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:15:50.029280 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:15:50.031374 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:15:50.032350 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:15:50.034236 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:15:50.035983 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:15:50.037716 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:15:50.092459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515382ed-2cc1-4a34-9adf-46237cc614f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b95110>]}
[0m14:15:50.095616 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:15:50.098380 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:15:50.099151 [debug] [MainThread]: Command `dbt run` failed at 14:15:50.099067 after 0.44 seconds
[0m14:15:50.099389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108444f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b25e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b09b90>]}
[0m14:15:50.099609 [debug] [MainThread]: Flushing usage events
[0m14:16:16.506890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657dbd0>]}


============================== 14:16:16.510459 | 298317cc-b1fc-4a68-bd3f-69532c2f9c7b ==============================
[0m14:16:16.510459 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:16:16.510821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:16.521734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '298317cc-b1fc-4a68-bd3f-69532c2f9c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657d590>]}
[0m14:16:16.523170 [debug] [MainThread]: Command `dbt clean` succeeded at 14:16:16.523094 after 0.03 seconds
[0m14:16:16.523377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102afa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c41dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c41e90>]}
[0m14:16:16.523561 [debug] [MainThread]: Flushing usage events
[0m14:16:19.699309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671dd10>]}


============================== 14:16:19.702473 | c4f66078-b0c8-464f-b0c9-4b9255f85155 ==============================
[0m14:16:19.702473 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:16:19.702834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:19.744729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f66078-b0c8-464f-b0c9-4b9255f85155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671db10>]}
[0m14:16:19.751854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f66078-b0c8-464f-b0c9-4b9255f85155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671db10>]}
[0m14:16:19.752203 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:16:19.762668 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:16:19.763160 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:19.763418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4f66078-b0c8-464f-b0c9-4b9255f85155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d3790>]}
[0m14:16:20.053014 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:16:20.059732 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:16:20.061641 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:16:20.063463 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:16:20.065254 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:16:20.067013 [debug] [MainThread]: 1603: static parser failed on facts/banking.sql
[0m14:16:20.068367 [error] [MainThread]: Encountered an error:
Compilation Error in model banking (models/facts/banking.sql)
  expected token ',', got '='
    line 2
      --     materialized = 'table',
[0m14:16:20.068740 [debug] [MainThread]: Command `dbt run` failed at 14:16:20.068678 after 0.39 seconds
[0m14:16:20.068945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063487d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106700cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106704f50>]}
[0m14:16:20.069134 [debug] [MainThread]: Flushing usage events
[0m14:16:44.620879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b14c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b15a50>]}


============================== 14:16:44.624455 | 8f6c0d34-6591-479d-9e7a-d321b776b1c2 ==============================
[0m14:16:44.624455 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:16:44.624815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:44.635771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6c0d34-6591-479d-9e7a-d321b776b1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b15850>]}
[0m14:16:44.636876 [debug] [MainThread]: Command `dbt clean` succeeded at 14:16:44.636803 after 0.03 seconds
[0m14:16:44.637070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d9e90>]}
[0m14:16:44.637243 [debug] [MainThread]: Flushing usage events
[0m14:16:47.674785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d9850>]}


============================== 14:16:47.679795 | 376716c8-7b71-4f3d-a458-140258bf067b ==============================
[0m14:16:47.679795 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:16:47.680189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:47.691743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376716c8-7b71-4f3d-a458-140258bf067b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d8550>]}
[0m14:16:47.692888 [debug] [MainThread]: Command `dbt clean` succeeded at 14:16:47.692778 after 0.03 seconds
[0m14:16:47.693140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b54690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c9de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c9de10>]}
[0m14:16:47.693361 [debug] [MainThread]: Flushing usage events
[0m14:16:51.322594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105201d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105206f50>]}


============================== 14:16:51.325597 | 8bd0a2b0-5694-4bc5-80c0-37de3b31f65d ==============================
[0m14:16:51.325597 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:16:51.325937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:16:51.369101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd0a2b0-5694-4bc5-80c0-37de3b31f65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521dad0>]}
[0m14:16:51.376483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bd0a2b0-5694-4bc5-80c0-37de3b31f65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d4990>]}
[0m14:16:51.377096 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:16:51.388435 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:16:51.388928 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:51.389200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8bd0a2b0-5694-4bc5-80c0-37de3b31f65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052da790>]}
[0m14:16:51.672548 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:16:51.679252 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:16:51.681141 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:16:51.682962 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:16:51.684748 [debug] [MainThread]: 1603: static parser failed on facts/sum_total_customers_by_gender.sql
[0m14:16:51.686288 [error] [MainThread]: Encountered an error:
Compilation Error in model sum_total_customers_by_gender (models/facts/sum_total_customers_by_gender.sql)
  expected token ',', got '='
    line 2
      --     materialized = 'table'
[0m14:16:51.686674 [debug] [MainThread]: Command `dbt run` failed at 14:16:51.686609 after 0.38 seconds
[0m14:16:51.686882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520cb50>]}
[0m14:16:51.687087 [debug] [MainThread]: Flushing usage events
[0m14:17:20.704902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085352d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108404bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854e310>]}


============================== 14:17:20.708542 | 022ad10e-0d9a-48fc-bb1b-e67564f98d82 ==============================
[0m14:17:20.708542 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:17:20.708931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:17:20.749006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854dc90>]}
[0m14:17:20.755977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853d050>]}
[0m14:17:20.756366 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:17:20.767280 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:17:20.767728 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:17:20.767984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086057d0>]}
[0m14:17:21.048525 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:17:21.055261 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:17:21.057157 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:17:21.058975 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:17:21.060772 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:17:21.062527 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:17:21.064693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:17:21.065635 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:17:21.067438 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:17:21.069313 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:17:21.071053 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:17:21.126351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7c510>]}
[0m14:17:21.129934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8a150>]}
[0m14:17:21.130149 [info ] [MainThread]: Found 10 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:17:21.130362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108560310>]}
[0m14:17:21.131388 [info ] [MainThread]: 
[0m14:17:21.131793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:21.132495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:17:21.137874 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:17:21.138108 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:17:21.138252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:21.225464 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:17:21.226703 [debug] [ThreadPool]: On list_mydb: Close
[0m14:17:21.228188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:17:21.232596 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:17:21.232884 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:17:21.233084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:21.245526 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.245844 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:17:21.246093 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:17:21.258198 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m14:17:21.259400 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:17:21.260250 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:17:21.264766 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:21.265044 [debug] [MainThread]: On master: BEGIN
[0m14:17:21.265243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:21.278602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.278947 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:21.279368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:21.308403 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:17:21.309877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b74190>]}
[0m14:17:21.310187 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:21.310915 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:21.311115 [debug] [MainThread]: On master: BEGIN
[0m14:17:21.312435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.312735 [debug] [MainThread]: On master: COMMIT
[0m14:17:21.312958 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:21.313151 [debug] [MainThread]: On master: COMMIT
[0m14:17:21.313789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:21.314035 [debug] [MainThread]: On master: Close
[0m14:17:21.314502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:21.314795 [info ] [MainThread]: 
[0m14:17:21.317751 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking
[0m14:17:21.317998 [debug] [Thread-2 (]: Began running node model.maker_warehouse.genres
[0m14:17:21.318213 [debug] [Thread-3 (]: Began running node model.maker_warehouse.mac_test
[0m14:17:21.318436 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:17:21.318704 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_warehouse.banking ............................ [RUN]
[0m14:17:21.319053 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:17:21.319383 [info ] [Thread-3 (]: 3 of 10 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:17:21.319720 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:17:21.320219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking)
[0m14:17:21.320654 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:17:21.321076 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:17:21.321470 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m14:17:21.321688 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking
[0m14:17:21.321899 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.genres
[0m14:17:21.322098 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:17:21.322297 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:17:21.324151 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking"
[0m14:17:21.325758 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:17:21.327516 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:17:21.329649 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:17:21.330632 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.genres (compile): 14:17:21.324361 => 14:17:21.330472
[0m14:17:21.330915 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:17:21.325946 => 14:17:21.330787
[0m14:17:21.331173 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:17:21.327757 => 14:17:21.331058
[0m14:17:21.331416 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking (compile): 14:17:21.322438 => 14:17:21.331310
[0m14:17:21.331652 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.genres
[0m14:17:21.331899 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.mac_test
[0m14:17:21.332129 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:17:21.332353 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking
[0m14:17:21.356539 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:17:21.366569 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:17:21.369873 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:17:21.372144 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking"
[0m14:17:21.372787 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:21.373030 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.373201 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:17:21.373379 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:17:21.373539 [debug] [Thread-2 (]: On model.maker_warehouse.genres: BEGIN
[0m14:17:21.373682 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.373833 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:17:21.373981 [debug] [Thread-1 (]: On model.maker_warehouse.banking: BEGIN
[0m14:17:21.374121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:17:21.374265 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:17:21.374500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:21.374733 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:17:21.385270 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.385834 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.386132 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:21.386430 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.386691 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:17:21.386935 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:17:21.387798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.388019 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:17:21.388225 [debug] [Thread-1 (]: On model.maker_warehouse.banking: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain,
	total_balance
FROM mydb.public.raw_banking
  );
  
[0m14:17:21.388614 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.388847 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.389045 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:17:21.391275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_balance" does not exist
LINE 21:  total_balance
          ^

[0m14:17:21.391850 [debug] [Thread-1 (]: On model.maker_warehouse.banking: ROLLBACK
[0m14:17:21.392854 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking (execute): 14:17:21.370101 => 14:17:21.392713
[0m14:17:21.393115 [debug] [Thread-1 (]: On model.maker_warehouse.banking: Close
[0m14:17:21.397478 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:21.401289 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.401568 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:17:21.402691 [debug] [Thread-1 (]: Database Error in model banking (models/facts/banking.sql)
  column "total_balance" does not exist
  LINE 21:  total_balance
            ^
  compiled Code at target/run/maker_warehouse/models/facts/banking.sql
[0m14:17:21.402988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90a10>]}
[0m14:17:21.403513 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.403325 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model dbt_warehouse.banking ................... [[31mERROR[0m in 0.08s]
[0m14:17:21.405358 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.405604 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking
[0m14:17:21.405804 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:17:21.406028 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:17:21.406466 [info ] [Thread-1 (]: 5 of 10 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:17:21.406872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking, now model.maker_warehouse.movies)
[0m14:17:21.407141 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:17:21.408725 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:17:21.409020 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.419781 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:17:21.420068 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.420278 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:17:21.420519 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:17:21.407272 => 14:17:21.420413
[0m14:17:21.420752 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:17:21.423301 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:17:21.423744 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:21.423917 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:17:21.424079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:21.435912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:21.442296 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:17:21.443218 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:17:21.446601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.447316 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:21.447950 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:17:21.451521 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:21.452583 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:17:21.356738 => 14:17:21.452479
[0m14:17:21.452869 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: Close
[0m14:17:21.453377 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf7990>]}
[0m14:17:21.453821 [info ] [Thread-3 (]: 3 of 10 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:17:21.454761 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.mac_test
[0m14:17:21.455047 [debug] [Thread-3 (]: Began running node model.maker_warehouse.users
[0m14:17:21.455379 [info ] [Thread-3 (]: 6 of 10 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:17:21.456054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.users)
[0m14:17:21.456287 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.users
[0m14:17:21.459304 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:17:21.460222 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.users (compile): 14:17:21.456630 => 14:17:21.460081
[0m14:17:21.460547 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.users
[0m14:17:21.463762 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:17:21.464585 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:21.465095 [debug] [Thread-3 (]: On model.maker_warehouse.users: BEGIN
[0m14:17:21.465986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:21.480184 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:21.480728 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:21.481287 [debug] [Thread-3 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:17:21.765198 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:17:21.767610 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.767888 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:17:21.770700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.772702 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.772958 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:17:21.774857 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.780879 [debug] [Thread-2 (]: On model.maker_warehouse.genres: COMMIT
[0m14:17:21.781296 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.781653 [debug] [Thread-2 (]: On model.maker_warehouse.genres: COMMIT
[0m14:17:21.805974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:21.808030 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:17:21.808286 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:17:21.818398 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:21.819439 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.genres (execute): 14:17:21.332513 => 14:17:21.819336
[0m14:17:21.819666 [debug] [Thread-2 (]: On model.maker_warehouse.genres: Close
[0m14:17:21.820089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c68110>]}
[0m14:17:21.820414 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.50s]
[0m14:17:21.820753 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.genres
[0m14:17:21.977421 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:17:21.983814 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:21.984452 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:17:21.986914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.991468 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:21.991760 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:17:21.993705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:21.995043 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:17:21.995238 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:21.995405 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:17:22.045736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:22.051004 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:17:22.051390 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:17:22.065857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:22.068015 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:17:21.420870 => 14:17:22.067768
[0m14:17:22.068524 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:17:22.069501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7f690>]}
[0m14:17:22.070299 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.66s]
[0m14:17:22.071039 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:17:22.228190 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:17:22.232624 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:22.233235 [debug] [Thread-3 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:17:22.235196 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.239329 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:22.239847 [debug] [Thread-3 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:17:22.241354 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.243892 [debug] [Thread-3 (]: On model.maker_warehouse.users: COMMIT
[0m14:17:22.244224 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:22.244410 [debug] [Thread-3 (]: On model.maker_warehouse.users: COMMIT
[0m14:17:22.261265 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:22.262807 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:17:22.263013 [debug] [Thread-3 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:17:22.272675 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:22.273660 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.users (execute): 14:17:21.460681 => 14:17:22.273555
[0m14:17:22.273854 [debug] [Thread-3 (]: On model.maker_warehouse.users: Close
[0m14:17:22.274256 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8a450>]}
[0m14:17:22.274567 [info ] [Thread-3 (]: 6 of 10 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.82s]
[0m14:17:22.274886 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.users
[0m14:17:22.298482 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:17:22.300015 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:22.300196 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:17:22.301381 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.302822 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:22.302996 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:17:22.303704 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.304887 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:17:22.305056 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:22.305211 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:17:22.317432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:22.319010 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:17:22.319219 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:17:22.412444 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:22.415269 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:17:21.366827 => 14:17:22.414979
[0m14:17:22.415815 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:17:22.416860 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf7b90>]}
[0m14:17:22.417837 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 1.10s]
[0m14:17:22.418910 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:17:22.420313 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:17:22.420825 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:17:22.421222 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:17:22.421523 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:17:22.421779 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_warehouse.sum_genre_views .................... [RUN]
[0m14:17:22.422097 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_warehouse.sum_movie_viewing_time ............. [RUN]
[0m14:17:22.422730 [info ] [Thread-3 (]: 9 of 10 START sql table model dbt_warehouse.sum_movie_views .................... [RUN]
[0m14:17:22.423073 [info ] [Thread-4 (]: 10 of 10 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:17:22.423762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m14:17:22.424174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:17:22.424530 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:17:22.424832 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:17:22.425249 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:17:22.425537 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:17:22.425741 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:17:22.425920 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:17:22.428323 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:17:22.430266 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.431828 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:17:22.433250 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:17:22.433901 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:17:22.426050 => 14:17:22.433795
[0m14:17:22.434131 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:17:22.428762 => 14:17:22.434043
[0m14:17:22.434287 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:17:22.434457 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:17:22.430489 => 14:17:22.434380
[0m14:17:22.434664 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:17:22.434835 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:17:22.432012 => 14:17:22.434758
[0m14:17:22.437096 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:17:22.437333 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:17:22.439585 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.439838 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:17:22.443547 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:17:22.446122 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:17:22.446378 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:22.446702 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.446936 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.447137 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:17:22.447312 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:22.447512 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:17:22.447699 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:17:22.447873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:22.448056 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:17:22.448228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:22.448399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:22.448643 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:22.465629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:22.466240 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:22.466543 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:22.466828 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:17:22.467579 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.468036 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:17:22.469240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:22.469501 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.469824 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:17:22.470904 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:22.471152 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:22.471353 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:17:22.770265 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:17:22.775025 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.775567 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:17:22.776807 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:17:22.777337 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.781072 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.784739 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.785250 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:17:22.785731 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:17:22.787683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.788161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.789973 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.791408 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:17:22.791642 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:17:22.791844 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.792340 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:17:22.793194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:22.794881 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:17:22.795158 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:22.795669 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.798095 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:17:22.797836 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:17:22.798337 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:17:22.799647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:22.801014 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:17:22.801211 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:17:22.806294 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:22.807708 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:17:22.440050 => 14:17:22.807606
[0m14:17:22.808042 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:17:22.808623 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9a710>]}
[0m14:17:22.809086 [info ] [Thread-3 (]: 9 of 10 OK created sql table model dbt_warehouse.sum_movie_views ............... [[32mSELECT 8472[0m in 0.38s]
[0m14:17:22.809381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:22.809960 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:17:22.811067 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:17:22.437460 => 14:17:22.810953
[0m14:17:22.811502 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:17:22.812065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d05590>]}
[0m14:17:22.812421 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_warehouse.sum_movie_viewing_time ........ [[32mSELECT 8472[0m in 0.39s]
[0m14:17:22.812805 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:17:23.123106 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:17:23.127936 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:23.128528 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:17:23.129953 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:23.134419 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:23.134950 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:17:23.135918 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:23.137305 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:17:23.137515 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:23.137685 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:17:23.163267 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:23.167781 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:17:23.168361 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:17:23.172576 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:23.174464 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:17:22.434949 => 14:17:23.174212
[0m14:17:23.174921 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:17:23.175387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c115d0>]}
[0m14:17:23.175736 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_warehouse.sum_genre_views ............... [[32mSELECT 1190[0m in 0.75s]
[0m14:17:23.176081 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:17:23.353801 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:17:23.359655 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:23.360426 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:17:23.361889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:23.365510 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:23.365820 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:17:23.366532 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:23.367790 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:17:23.367973 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:23.368132 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:17:23.390036 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:23.394732 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:17:23.395026 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:17:23.410447 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:23.412790 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:17:22.443867 => 14:17:23.412539
[0m14:17:23.413283 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:17:23.414184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022ad10e-0d9a-48fc-bb1b-e67564f98d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d813d0>]}
[0m14:17:23.414720 [info ] [Thread-4 (]: 10 of 10 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.99s]
[0m14:17:23.415177 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:17:23.416565 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:23.416766 [debug] [MainThread]: On master: BEGIN
[0m14:17:23.416912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:23.429219 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:23.429530 [debug] [MainThread]: On master: COMMIT
[0m14:17:23.429690 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:23.429885 [debug] [MainThread]: On master: COMMIT
[0m14:17:23.430554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:23.430704 [debug] [MainThread]: On master: Close
[0m14:17:23.431051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:23.431192 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:17:23.431318 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:17:23.431436 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:17:23.431550 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:17:23.431737 [info ] [MainThread]: 
[0m14:17:23.431952 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m14:17:23.432850 [debug] [MainThread]: Command end result
[0m14:17:23.437673 [info ] [MainThread]: 
[0m14:17:23.437916 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:23.438136 [info ] [MainThread]: 
[0m14:17:23.438379 [error] [MainThread]: [33mDatabase Error in model banking (models/facts/banking.sql)[0m
[0m14:17:23.438570 [error] [MainThread]:   column "total_balance" does not exist
[0m14:17:23.438748 [error] [MainThread]:   LINE 21:  total_balance
[0m14:17:23.438917 [error] [MainThread]:             ^
[0m14:17:23.439084 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/banking.sql
[0m14:17:23.439268 [info ] [MainThread]: 
[0m14:17:23.439475 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m14:17:23.439923 [debug] [MainThread]: Command `dbt run` failed at 14:17:23.439874 after 2.75 seconds
[0m14:17:23.440161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107007a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852bd90>]}
[0m14:17:23.440338 [debug] [MainThread]: Flushing usage events
[0m14:18:03.257488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107705290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771e250>]}


============================== 14:18:03.261159 | 5549b005-b34b-4d34-91bd-26ed78c72c92 ==============================
[0m14:18:03.261159 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:18:03.261520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:18:03.302730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771da50>]}
[0m14:18:03.309725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a4e50>]}
[0m14:18:03.310111 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:18:03.319832 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:18:03.340958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:03.341345 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/banking.sql
[0m14:18:03.353037 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking.sql
[0m14:18:03.382354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa81d0>]}
[0m14:18:03.386900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd5510>]}
[0m14:18:03.387145 [info ] [MainThread]: Found 10 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:18:03.387367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104321090>]}
[0m14:18:03.388449 [info ] [MainThread]: 
[0m14:18:03.388937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:03.389686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:18:03.395280 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:18:03.395543 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:18:03.395694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:03.469519 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:18:03.470653 [debug] [ThreadPool]: On list_mydb: Close
[0m14:18:03.471937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:18:03.476008 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:18:03.476275 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:18:03.476465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:03.488000 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.488361 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:18:03.488613 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:18:03.498953 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m14:18:03.500071 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:18:03.500900 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:18:03.505054 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:03.505294 [debug] [MainThread]: On master: BEGIN
[0m14:18:03.505479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:03.515878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.516136 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:03.516513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:18:03.536211 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:18:03.538033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1be50>]}
[0m14:18:03.538396 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:03.539309 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:03.539587 [debug] [MainThread]: On master: BEGIN
[0m14:18:03.540923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.541156 [debug] [MainThread]: On master: COMMIT
[0m14:18:03.541369 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:03.541657 [debug] [MainThread]: On master: COMMIT
[0m14:18:03.542555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:18:03.542819 [debug] [MainThread]: On master: Close
[0m14:18:03.543333 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:03.543642 [info ] [MainThread]: 
[0m14:18:03.547631 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking
[0m14:18:03.547941 [debug] [Thread-2 (]: Began running node model.maker_warehouse.genres
[0m14:18:03.548237 [debug] [Thread-3 (]: Began running node model.maker_warehouse.mac_test
[0m14:18:03.548517 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:18:03.548847 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_warehouse.banking ............................ [RUN]
[0m14:18:03.549290 [info ] [Thread-2 (]: 2 of 10 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:18:03.549753 [info ] [Thread-3 (]: 3 of 10 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:18:03.550193 [info ] [Thread-4 (]: 4 of 10 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:18:03.550798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking)
[0m14:18:03.551306 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:18:03.551739 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:18:03.552157 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.movie_viewings'
[0m14:18:03.552376 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking
[0m14:18:03.552585 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.genres
[0m14:18:03.552786 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:18:03.552988 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:18:03.555011 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking"
[0m14:18:03.557362 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:18:03.559094 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:18:03.560834 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:18:03.561778 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:18:03.557549 => 14:18:03.561625
[0m14:18:03.562065 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.genres (compile): 14:18:03.555200 => 14:18:03.561944
[0m14:18:03.562347 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking (compile): 14:18:03.553135 => 14:18:03.562242
[0m14:18:03.562602 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.mac_test
[0m14:18:03.562848 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:18:03.559295 => 14:18:03.562742
[0m14:18:03.563057 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.genres
[0m14:18:03.563252 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking
[0m14:18:03.584299 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:18:03.584529 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:18:03.595690 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:18:03.597897 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking"
[0m14:18:03.600034 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:18:03.600333 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.600612 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.600871 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:18:03.601020 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:03.601176 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:18:03.601329 [debug] [Thread-2 (]: On model.maker_warehouse.genres: BEGIN
[0m14:18:03.601476 [debug] [Thread-1 (]: On model.maker_warehouse.banking: BEGIN
[0m14:18:03.601660 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:18:03.601845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:18:03.602004 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:18:03.602153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:03.602297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:18:03.614313 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.614749 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:03.614972 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:18:03.618174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.618574 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.618844 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:18:03.619122 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.619443 [debug] [Thread-1 (]: On model.maker_warehouse.banking: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:18:03.619686 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.619906 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:18:03.620174 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.620472 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:18:03.626272 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:18:03.630542 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.630838 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:18:03.632551 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:03.634631 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.634896 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:18:03.636522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:03.649518 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:18:03.649884 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.650135 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:18:03.663901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:03.667756 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:18:03.668169 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:18:03.675056 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:18:03.677254 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:18:03.677504 [debug] [Thread-1 (]: On model.maker_warehouse.banking: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking"} */
alter table "mydb"."dbt_warehouse"."banking__dbt_tmp" rename to "banking"
[0m14:18:03.677825 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:18:03.678618 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:18:03.563394 => 14:18:03.678519
[0m14:18:03.678798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:03.679018 [debug] [Thread-3 (]: On model.maker_warehouse.mac_test: Close
[0m14:18:03.682086 [debug] [Thread-1 (]: On model.maker_warehouse.banking: COMMIT
[0m14:18:03.682567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107707290>]}
[0m14:18:03.682762 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:18:03.683155 [info ] [Thread-3 (]: 3 of 10 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:18:03.683843 [debug] [Thread-1 (]: On model.maker_warehouse.banking: COMMIT
[0m14:18:03.684164 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.mac_test
[0m14:18:03.684969 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m14:18:03.685386 [info ] [Thread-3 (]: 5 of 10 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:18:03.686227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movies)
[0m14:18:03.686440 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m14:18:03.689670 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:18:03.690626 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 14:18:03.686574 => 14:18:03.690516
[0m14:18:03.691535 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m14:18:03.695309 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:18:03.695916 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:03.696108 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m14:18:03.696277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:03.701448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:03.703955 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking"
[0m14:18:03.704233 [debug] [Thread-1 (]: On model.maker_warehouse.banking: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking"} */
drop table if exists "mydb"."dbt_warehouse"."banking__dbt_backup" cascade
[0m14:18:03.705440 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:03.706339 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking (execute): 14:18:03.595870 => 14:18:03.706241
[0m14:18:03.706552 [debug] [Thread-1 (]: On model.maker_warehouse.banking: Close
[0m14:18:03.706981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e1cd0>]}
[0m14:18:03.707309 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_warehouse.banking ....................... [[32mSELECT 10000[0m in 0.16s]
[0m14:18:03.707661 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking
[0m14:18:03.708443 [debug] [Thread-1 (]: Began running node model.maker_warehouse.users
[0m14:18:03.709465 [info ] [Thread-1 (]: 6 of 10 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:18:03.711106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking, now model.maker_warehouse.users)
[0m14:18:03.711992 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.users
[0m14:18:03.714154 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:18:03.714682 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.715107 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:03.715423 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:18:03.715828 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (compile): 14:18:03.712220 => 14:18:03.715722
[0m14:18:03.716020 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.users
[0m14:18:03.718622 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:18:03.719095 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:03.719275 [debug] [Thread-1 (]: On model.maker_warehouse.users: BEGIN
[0m14:18:03.719436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:03.734785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:03.735174 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:03.735381 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:18:03.895969 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:18:03.897830 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.898047 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:18:03.901386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:03.903145 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.903453 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:18:03.905528 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:03.907835 [debug] [Thread-2 (]: On model.maker_warehouse.genres: COMMIT
[0m14:18:03.908155 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.908402 [debug] [Thread-2 (]: On model.maker_warehouse.genres: COMMIT
[0m14:18:03.918999 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:03.920462 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:18:03.920662 [debug] [Thread-2 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:18:03.929453 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:03.930365 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.genres (execute): 14:18:03.584681 => 14:18:03.930273
[0m14:18:03.930566 [debug] [Thread-2 (]: On model.maker_warehouse.genres: Close
[0m14:18:03.930955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8190>]}
[0m14:18:03.931250 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.38s]
[0m14:18:03.931574 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.genres
[0m14:18:04.141836 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:18:04.147990 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:04.148565 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:18:04.150253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.153679 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:04.153928 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:18:04.155115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.156498 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m14:18:04.156704 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:04.156879 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m14:18:04.173162 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:04.177531 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:18:04.177797 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:18:04.195732 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:04.198073 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 14:18:03.691717 => 14:18:04.197784
[0m14:18:04.198596 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m14:18:04.199514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfb2d0>]}
[0m14:18:04.200240 [info ] [Thread-3 (]: 5 of 10 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.51s]
[0m14:18:04.200794 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m14:18:04.527653 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:18:04.529448 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:04.529646 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:18:04.530639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.532158 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:04.532341 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:18:04.533135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.534358 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:18:04.534540 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:04.534697 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:18:04.549232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:04.550678 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:18:04.550855 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:18:04.567288 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:04.568159 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (execute): 14:18:03.716140 => 14:18:04.568060
[0m14:18:04.568337 [debug] [Thread-1 (]: On model.maker_warehouse.users: Close
[0m14:18:04.568712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d53a90>]}
[0m14:18:04.569002 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.86s]
[0m14:18:04.569315 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.users
[0m14:18:04.576125 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:18:04.578926 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:04.579195 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:18:04.580724 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.582269 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:04.582453 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:18:04.583483 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.584789 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:18:04.584985 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:04.585154 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:18:04.597558 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:04.599144 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:18:04.599353 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:18:04.644740 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:04.647834 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:18:03.598114 => 14:18:04.647537
[0m14:18:04.648419 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:18:04.649524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef8750>]}
[0m14:18:04.650304 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 1.10s]
[0m14:18:04.651185 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:18:04.651981 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:18:04.652235 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:18:04.652482 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:18:04.652933 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:18:04.652717 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_warehouse.sum_genre_views .................... [RUN]
[0m14:18:04.653236 [info ] [Thread-3 (]: 8 of 10 START sql table model dbt_warehouse.sum_movie_viewing_time ............. [RUN]
[0m14:18:04.653522 [info ] [Thread-1 (]: 9 of 10 START sql table model dbt_warehouse.sum_movie_views .................... [RUN]
[0m14:18:04.653796 [info ] [Thread-4 (]: 10 of 10 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:18:04.654341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m14:18:04.654638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:18:04.654911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:18:04.655185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:18:04.655355 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:18:04.655509 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:18:04.655654 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:18:04.655801 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:18:04.657505 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:18:04.659242 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.660806 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:18:04.662548 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:18:04.663266 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:18:04.661038 => 14:18:04.663148
[0m14:18:04.663467 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:18:04.663677 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:18:04.655905 => 14:18:04.663583
[0m14:18:04.665792 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:18:04.665991 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:18:04.657675 => 14:18:04.665899
[0m14:18:04.666176 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:18:04.659461 => 14:18:04.666089
[0m14:18:04.666353 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:18:04.666551 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:18:04.666728 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:18:04.666890 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:04.669085 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:18:04.671157 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.673196 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:18:04.673384 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:18:04.673710 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:04.673896 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:04.674063 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.674261 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:18:04.674424 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:04.674662 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:18:04.674823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:04.675009 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:18:04.675483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:04.675190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:04.690603 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:04.691072 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.691351 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:18:04.693897 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:04.694181 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:04.694378 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:18:04.697099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:04.697381 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:04.697589 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:18:04.698150 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:04.698388 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:04.698624 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:18:04.979288 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:18:04.983647 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.984209 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:18:04.985664 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:18:04.989766 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:04.990230 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.990761 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:18:04.994411 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:04.994855 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:18:04.997067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:04.997949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.000796 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:18:05.003498 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:05.003766 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:05.004131 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:18:05.003957 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:18:05.006474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.008264 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:18:05.008914 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:05.009323 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:18:05.010060 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:05.011791 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:18:05.012013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:05.012214 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:18:05.013527 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:18:05.013798 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:18:05.022857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:05.023814 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:18:04.671289 => 14:18:05.023716
[0m14:18:05.024027 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:18:05.024455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f18d0>]}
[0m14:18:05.024763 [info ] [Thread-1 (]: 9 of 10 OK created sql table model dbt_warehouse.sum_movie_views ............... [[32mSELECT 8472[0m in 0.37s]
[0m14:18:05.025088 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:18:05.026845 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:05.028091 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:18:04.669224 => 14:18:05.027996
[0m14:18:05.028294 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:18:05.028758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d381d0>]}
[0m14:18:05.029071 [info ] [Thread-3 (]: 8 of 10 OK created sql table model dbt_warehouse.sum_movie_viewing_time ........ [[32mSELECT 8472[0m in 0.37s]
[0m14:18:05.029403 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:18:05.306957 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:18:05.312950 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:05.313554 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:18:05.315125 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.319124 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:05.319379 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:18:05.320140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.321400 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:18:05.321581 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:05.321740 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:18:05.333562 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:05.340155 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:18:05.340392 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:18:05.345134 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:05.346073 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:18:04.666999 => 14:18:05.345968
[0m14:18:05.346266 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:18:05.346682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e95650>]}
[0m14:18:05.347017 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_warehouse.sum_genre_views ............... [[32mSELECT 1190[0m in 0.69s]
[0m14:18:05.347342 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:18:05.567079 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:18:05.573636 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:05.574259 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:18:05.575773 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.579013 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:05.579289 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:18:05.580122 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:05.581381 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:18:05.581561 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:05.581719 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:18:05.585117 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:05.586697 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:18:05.586898 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:18:05.597759 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:18:05.599985 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:18:04.663780 => 14:18:05.599862
[0m14:18:05.600221 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:18:05.600638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5549b005-b34b-4d34-91bd-26ed78c72c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e951d0>]}
[0m14:18:05.600964 [info ] [Thread-4 (]: 10 of 10 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.95s]
[0m14:18:05.601297 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:18:05.602309 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:05.602501 [debug] [MainThread]: On master: BEGIN
[0m14:18:05.602640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:05.612918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:05.613216 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.613382 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:05.613531 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.614246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:18:05.614432 [debug] [MainThread]: On master: Close
[0m14:18:05.614775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:05.614907 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:18:05.615022 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:18:05.615133 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:18:05.615242 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:18:05.615413 [info ] [MainThread]: 
[0m14:18:05.615626 [info ] [MainThread]: Finished running 1 view model, 9 table models in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m14:18:05.616614 [debug] [MainThread]: Command end result
[0m14:18:05.620441 [info ] [MainThread]: 
[0m14:18:05.620680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:05.620880 [info ] [MainThread]: 
[0m14:18:05.621120 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:18:05.621477 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:05.621429 after 2.38 seconds
[0m14:18:05.621665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c39dd0>]}
[0m14:18:05.621844 [debug] [MainThread]: Flushing usage events
[0m14:18:38.449494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106975290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698df50>]}


============================== 14:18:38.453177 | 1fd3f5a9-fe61-4a74-a17d-b7a347b04dfc ==============================
[0m14:18:38.453177 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:18:38.453621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:18:38.494628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fd3f5a9-fe61-4a74-a17d-b7a347b04dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697d090>]}
[0m14:18:38.501683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fd3f5a9-fe61-4a74-a17d-b7a347b04dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697c410>]}
[0m14:18:38.502143 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:18:38.513193 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:18:38.532697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:18:38.533039 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:18:38.547941 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:18:38.578892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fd3f5a9-fe61-4a74-a17d-b7a347b04dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a5290>]}
[0m14:18:38.582094 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:18:38.584416 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:18:38.584978 [debug] [MainThread]: Command `dbt run` failed at 14:18:38.584913 after 0.15 seconds
[0m14:18:38.585187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698da10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106970e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dfa50>]}
[0m14:18:38.585369 [debug] [MainThread]: Flushing usage events
[0m14:19:13.814451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c06f50>]}


============================== 14:19:13.818029 | 5431f0b1-06f5-4176-9a7f-0c7f345ffcb2 ==============================
[0m14:19:13.818029 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:19:13.818388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:19:13.859592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5431f0b1-06f5-4176-9a7f-0c7f345ffcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c38d90>]}
[0m14:19:13.866517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5431f0b1-06f5-4176-9a7f-0c7f345ffcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0fd90>]}
[0m14:19:13.866881 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:19:13.877548 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:19:13.898938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:13.899305 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:19:13.910784 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:19:13.939887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5431f0b1-06f5-4176-9a7f-0c7f345ffcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1ced0>]}
[0m14:19:13.943053 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:19:13.945420 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:19:13.946217 [debug] [MainThread]: Command `dbt run` failed at 14:19:13.946119 after 0.15 seconds
[0m14:19:13.946468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c00d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298de10>]}
[0m14:19:13.946718 [debug] [MainThread]: Flushing usage events
[0m14:24:10.631554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084187d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ecbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108436490>]}


============================== 14:24:10.635193 | 82cdd5b2-7875-4a03-96dd-ac5ddd74751a ==============================
[0m14:24:10.635193 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:24:10.635544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:24:10.687155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82cdd5b2-7875-4a03-96dd-ac5ddd74751a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084244d0>]}
[0m14:24:10.694164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82cdd5b2-7875-4a03-96dd-ac5ddd74751a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108435010>]}
[0m14:24:10.694547 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:24:10.705524 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:24:10.727285 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m14:24:10.727641 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/customers_dim.sql
[0m14:24:10.727805 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/banking_fact.sql
[0m14:24:10.727951 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/salary_dim.sql
[0m14:24:10.728080 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/banking.sql
[0m14:24:10.728253 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:24:10.739686 [debug] [MainThread]: 1699: static parser successfully parsed facts/customers_dim.sql
[0m14:24:10.746885 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking_fact.sql
[0m14:24:10.748842 [debug] [MainThread]: 1699: static parser successfully parsed facts/salary_dim.sql
[0m14:24:10.750656 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:24:10.775294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82cdd5b2-7875-4a03-96dd-ac5ddd74751a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108449f50>]}
[0m14:24:10.778489 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:24:10.781003 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:24:10.781688 [debug] [MainThread]: Command `dbt run` failed at 14:24:10.781612 after 0.16 seconds
[0m14:24:10.781949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108419050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af9e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad18d0>]}
[0m14:24:10.782216 [debug] [MainThread]: Flushing usage events
[0m14:24:30.083831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106894bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ddf90>]}


============================== 14:24:30.087430 | bbda500d-5001-462f-8cf7-e7a8b55ef95e ==============================
[0m14:24:30.087430 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:24:30.087788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:24:30.128477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ec5d0>]}
[0m14:24:30.135513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a84890>]}
[0m14:24:30.135896 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:24:30.145614 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:24:30.165556 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:24:30.165870 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:24:30.171470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a84610>]}
[0m14:24:30.193001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47810>]}
[0m14:24:30.193280 [info ] [MainThread]: Found 12 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:24:30.193495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789090>]}
[0m14:24:30.194606 [info ] [MainThread]: 
[0m14:24:30.195062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:30.195807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:24:30.201607 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:24:30.201853 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:24:30.201994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:30.278903 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:24:30.280004 [debug] [ThreadPool]: On list_mydb: Close
[0m14:24:30.281376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:24:30.285581 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:24:30.285835 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:24:30.286015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:30.297206 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.297559 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:24:30.297792 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:24:30.321072 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:24:30.322577 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:24:30.325398 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:24:30.330312 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:30.330578 [debug] [MainThread]: On master: BEGIN
[0m14:24:30.330764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:30.340147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.340426 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:30.340742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:30.365788 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:24:30.367410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106074150>]}
[0m14:24:30.367744 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:30.368564 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:30.368852 [debug] [MainThread]: On master: BEGIN
[0m14:24:30.370531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.370787 [debug] [MainThread]: On master: COMMIT
[0m14:24:30.370992 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:30.371179 [debug] [MainThread]: On master: COMMIT
[0m14:24:30.371894 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.372093 [debug] [MainThread]: On master: Close
[0m14:24:30.372528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:30.372790 [info ] [MainThread]: 
[0m14:24:30.375832 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:24:30.376094 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:24:30.376324 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:24:30.376528 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:24:30.376816 [info ] [Thread-1 (]: 1 of 12 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:24:30.377170 [info ] [Thread-2 (]: 2 of 12 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:24:30.377501 [info ] [Thread-3 (]: 3 of 12 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:24:30.377830 [info ] [Thread-4 (]: 4 of 12 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:24:30.378320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:24:30.378846 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:24:30.379247 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:24:30.379692 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:24:30.379940 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:24:30.380160 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:24:30.380358 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:24:30.380613 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:24:30.382511 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:24:30.384578 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:24:30.386286 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:24:30.387896 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:24:30.388600 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:24:30.382732 => 14:24:30.388448
[0m14:24:30.388947 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:24:30.380769 => 14:24:30.388794
[0m14:24:30.389182 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:24:30.389484 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:24:30.384815 => 14:24:30.389351
[0m14:24:30.389722 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:24:30.389949 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:24:30.386463 => 14:24:30.389847
[0m14:24:30.413233 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:24:30.413476 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:24:30.416450 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:24:30.416672 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:24:30.418906 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:24:30.425480 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:24:30.428642 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:24:30.428897 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:24:30.429110 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:24:30.429299 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.429535 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:24:30.429746 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:24:30.429898 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.430049 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:24:30.430198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:30.430433 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:24:30.430592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:24:30.430855 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:24:30.445246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.445629 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.445846 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:24:30.447826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.448145 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:24:30.448373 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:24:30.451757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.452026 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.452457 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:24:30.452955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.453214 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:24:30.453423 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:24:30.458092 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:30.462125 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.462391 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:24:30.463919 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.466037 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.466273 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:24:30.467429 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.477860 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:24:30.478151 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.478377 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:24:30.481072 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.484181 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:24:30.484430 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:24:30.488457 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:24:30.490295 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:24:30.490515 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:24:30.492076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.495621 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:24:30.495846 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:24:30.496023 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:30.496261 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:24:30.497913 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:24:30.498670 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:24:30.419138 => 14:24:30.498566
[0m14:24:30.498874 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:24:30.499091 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:24:30.499317 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:24:30.499898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4cdd0>]}
[0m14:24:30.500340 [info ] [Thread-4 (]: 4 of 12 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:24:30.500967 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:24:30.501263 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:24:30.501768 [info ] [Thread-4 (]: 5 of 12 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:24:30.502397 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:24:30.502663 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:24:30.502871 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.505005 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:24:30.506451 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:24:30.506643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.506899 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:24:30.508402 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:24:30.508605 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:24:30.508813 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:24:30.503250 => 14:24:30.508718
[0m14:24:30.509003 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:24:30.509249 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:24:30.511840 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:24:30.512045 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:30.512204 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.513018 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:24:30.413632 => 14:24:30.512927
[0m14:24:30.514509 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:24:30.514905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107246bd0>]}
[0m14:24:30.514308 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:24:30.515195 [info ] [Thread-1 (]: 1 of 12 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.14s]
[0m14:24:30.516031 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:30.516571 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:24:30.517501 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:24:30.517849 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:24:30.518238 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:24:30.518931 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:24:30.520070 [info ] [Thread-1 (]: 6 of 12 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:24:30.520400 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:30.521111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:24:30.522296 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:24:30.390098 => 14:24:30.522185
[0m14:24:30.522510 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:24:30.522720 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:24:30.525738 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:24:30.526785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724fd50>]}
[0m14:24:30.527274 [info ] [Thread-2 (]: 2 of 12 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:24:30.528413 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:24:30.528783 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:24:30.522970 => 14:24:30.528655
[0m14:24:30.529434 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:24:30.529774 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:24:30.530042 [info ] [Thread-2 (]: 7 of 12 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:24:30.533141 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:24:30.534216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:24:30.534833 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:24:30.537219 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:24:30.537486 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:30.537672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.537927 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:24:30.538123 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:30.538302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:30.538536 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:24:30.534995 => 14:24:30.538446
[0m14:24:30.538709 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:24:30.539016 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:24:30.542136 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:24:30.542858 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:24:30.543168 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:24:30.543453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:24:30.551459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.552246 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:30.553023 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:24:30.558788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.559146 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:24:30.559565 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:24:30.583681 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:24:30.585773 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:24:30.586030 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:24:30.588307 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.590017 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:24:30.590260 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:24:30.590441 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:24:30.604225 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.606176 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:24:30.606493 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:24:30.608925 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:30.610739 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:24:30.539372 => 14:24:30.610517
[0m14:24:30.610963 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:24:30.611418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107255a50>]}
[0m14:24:30.611743 [info ] [Thread-2 (]: 7 of 12 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.08s]
[0m14:24:30.612546 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:24:30.612784 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:24:30.613114 [info ] [Thread-2 (]: 8 of 12 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:24:30.613562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:24:30.613803 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:24:30.616445 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:24:30.616988 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:24:30.613931 => 14:24:30.616884
[0m14:24:30.617395 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:24:30.620195 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:24:30.620663 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:30.620834 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:24:30.620989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:24:30.636826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:30.637188 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:30.637394 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:24:30.768921 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:24:30.770810 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.771050 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:24:30.772790 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.774708 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.774938 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:24:30.776839 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:30.778770 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:24:30.779000 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.779310 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:24:30.800730 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:30.804565 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:24:30.805095 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:24:30.815669 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:30.816648 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:24:30.416870 => 14:24:30.816548
[0m14:24:30.817216 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:24:30.818321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f74d0>]}
[0m14:24:30.819005 [info ] [Thread-3 (]: 3 of 12 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.44s]
[0m14:24:30.820103 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:24:31.001200 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:24:31.005265 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:31.005864 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:24:31.008734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.013354 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:31.014081 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:24:31.016769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.018290 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:24:31.018504 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:31.018668 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:24:31.029276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.032463 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:24:31.032759 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:24:31.042656 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.044759 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:24:30.530434 => 14:24:31.044514
[0m14:24:31.045271 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:24:31.045947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630ec90>]}
[0m14:24:31.046301 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.52s]
[0m14:24:31.046648 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:24:31.167825 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:24:31.175098 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:31.175545 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:24:31.176826 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.178600 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:31.178789 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:24:31.179616 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.180857 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:24:31.181033 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:31.181189 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:24:31.192447 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.193954 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:24:31.194163 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:24:31.208328 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.210502 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:24:30.617610 => 14:24:31.210261
[0m14:24:31.211004 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:24:31.211967 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f7690>]}
[0m14:24:31.212707 [info ] [Thread-2 (]: 8 of 12 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.60s]
[0m14:24:31.213185 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:24:31.217095 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:24:31.219129 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:31.219388 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:24:31.220726 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.222515 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:31.222721 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:24:31.223844 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.225172 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:24:31.225366 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:31.225532 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:24:31.237056 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.238554 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:24:31.238738 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:24:31.276719 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.278910 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:24:30.509423 => 14:24:31.278661
[0m14:24:31.279435 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:24:31.280748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072805d0>]}
[0m14:24:31.281532 [info ] [Thread-4 (]: 5 of 12 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.78s]
[0m14:24:31.282521 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:24:31.283867 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:24:31.284212 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:24:31.284714 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:24:31.284471 [info ] [Thread-3 (]: 9 of 12 START sql table model dbt_warehouse.sum_genre_views .................... [RUN]
[0m14:24:31.285085 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:24:31.285324 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:24:31.285682 [info ] [Thread-2 (]: 11 of 12 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:24:31.286322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m14:24:31.286574 [info ] [Thread-4 (]: 12 of 12 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:24:31.286953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:24:31.287270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:24:31.287462 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:24:31.287800 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:24:31.288275 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:24:31.288559 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:24:31.290620 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:24:31.290887 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:24:31.292286 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.293794 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:24:31.295252 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:24:31.295831 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:24:31.288732 => 14:24:31.295729
[0m14:24:31.296051 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:24:31.292439 => 14:24:31.295972
[0m14:24:31.296200 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:24:31.296369 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:24:31.294022 => 14:24:31.296292
[0m14:24:31.296534 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:24:31.291013 => 14:24:31.296461
[0m14:24:31.296688 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:24:31.299137 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:24:31.299547 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:24:31.299784 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:24:31.302222 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:24:31.304611 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:24:31.306920 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.307250 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:31.307769 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:31.307977 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.308219 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.308414 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:24:31.308601 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:24:31.308812 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:24:31.308985 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:24:31.309156 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:24:31.309316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:24:31.309469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:24:31.309620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.327078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.327460 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.327750 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:24:31.328161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.328713 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.328953 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.329278 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.329508 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:31.329738 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:31.330010 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:24:31.330302 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:24:31.330664 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:24:31.606904 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:24:31.614939 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.616265 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:24:31.619550 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.622487 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.622771 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:24:31.624355 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.626086 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:24:31.626327 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.626625 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:24:31.630400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.631992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:24:31.632208 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:24:31.637625 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.639884 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:24:31.299933 => 14:24:31.639598
[0m14:24:31.640468 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:24:31.641614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107052050>]}
[0m14:24:31.642532 [info ] [Thread-2 (]: 11 of 12 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.35s]
[0m14:24:31.643458 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:24:31.656617 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:24:31.658375 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.658616 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:24:31.665285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.667159 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.667378 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:24:31.668542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.669890 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:24:31.670078 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.670237 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:24:31.673562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.675144 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:24:31.675387 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:24:31.686816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.687712 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:24:31.304798 => 14:24:31.687617
[0m14:24:31.687917 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:24:31.688297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f6650>]}
[0m14:24:31.688609 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.40s]
[0m14:24:31.688946 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:24:31.993635 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:24:31.999878 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:32.000376 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:24:32.001886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:32.005361 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:32.005755 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:24:32.006530 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:32.007868 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:24:32.008057 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:32.008224 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:24:32.014332 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.015758 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:24:32.016056 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:24:32.019469 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:32.021487 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:24:31.296795 => 14:24:32.021217
[0m14:24:32.022026 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:24:32.022774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f7450>]}
[0m14:24:32.023170 [info ] [Thread-3 (]: 9 of 12 OK created sql table model dbt_warehouse.sum_genre_views ............... [[32mSELECT 1190[0m in 0.74s]
[0m14:24:32.023514 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:24:32.193752 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:24:32.202040 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:32.202408 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:24:32.203439 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:32.205040 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:32.205213 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:24:32.205941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:32.207158 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:24:32.207342 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:32.207503 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:24:32.210655 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.211873 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:24:32.212037 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:24:32.222325 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:32.224579 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:24:31.302503 => 14:24:32.224329
[0m14:24:32.225084 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:24:32.225986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbda500d-5001-462f-8cf7-e7a8b55ef95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa3910>]}
[0m14:24:32.226427 [info ] [Thread-4 (]: 12 of 12 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.94s]
[0m14:24:32.226789 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:24:32.228254 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.228459 [debug] [MainThread]: On master: BEGIN
[0m14:24:32.228606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:32.237770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.238099 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.238250 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.238390 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.239473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.239680 [debug] [MainThread]: On master: Close
[0m14:24:32.240093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:32.240234 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:24:32.240366 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:24:32.240494 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:24:32.240621 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:24:32.240827 [info ] [MainThread]: 
[0m14:24:32.241060 [info ] [MainThread]: Finished running 1 view model, 11 table models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:24:32.242392 [debug] [MainThread]: Command end result
[0m14:24:32.248641 [info ] [MainThread]: 
[0m14:24:32.249015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:32.249229 [info ] [MainThread]: 
[0m14:24:32.249504 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m14:24:32.249936 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:32.249883 after 2.18 seconds
[0m14:24:32.250143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f5a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a1e90>]}
[0m14:24:32.250329 [debug] [MainThread]: Flushing usage events
[0m14:25:53.978060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f01290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19bd0>]}


============================== 14:25:53.981796 | 8614eb07-2995-4720-9f43-1df84fe37d35 ==============================
[0m14:25:53.981796 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:25:53.982149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:25:54.024219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8614eb07-2995-4720-9f43-1df84fe37d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f31090>]}
[0m14:25:54.031254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8614eb07-2995-4720-9f43-1df84fe37d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f29f90>]}
[0m14:25:54.031671 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:25:54.042527 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:25:54.065158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:25:54.065534 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:25:54.077089 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:25:54.108654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8614eb07-2995-4720-9f43-1df84fe37d35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107059450>]}
[0m14:25:54.111857 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:25:54.114607 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:25:54.115573 [debug] [MainThread]: Command `dbt run` failed at 14:25:54.115462 after 0.15 seconds
[0m14:25:54.115836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dde90>]}
[0m14:25:54.116054 [debug] [MainThread]: Flushing usage events
[0m14:28:05.319902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d06ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1dad0>]}


============================== 14:28:05.323681 | f43e2145-4fca-48a4-85a7-977ffe05ec78 ==============================
[0m14:28:05.323681 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:28:05.324044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:28:05.366692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f43e2145-4fca-48a4-85a7-977ffe05ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1d710>]}
[0m14:28:05.373678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f43e2145-4fca-48a4-85a7-977ffe05ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1d710>]}
[0m14:28:05.374067 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:28:05.385631 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:28:05.396819 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:28:05.397263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f43e2145-4fca-48a4-85a7-977ffe05ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a37af90>]}
[0m14:28:05.682730 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:28:05.689371 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:28:05.691256 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:28:05.693187 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:28:05.695002 [debug] [MainThread]: 1699: static parser successfully parsed facts/salary_dim.sql
[0m14:28:05.696782 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:28:05.698541 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking_fact.sql
[0m14:28:05.700293 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:28:05.702505 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:28:05.703442 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:28:05.705218 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:28:05.707059 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:28:05.708797 [debug] [MainThread]: 1699: static parser successfully parsed facts/customers_dim.sql
[0m14:28:05.710514 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:28:05.763950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f43e2145-4fca-48a4-85a7-977ffe05ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a368190>]}
[0m14:28:05.767114 [error] [MainThread]: Encountered an error:
Found a cycle: model.maker_warehouse.sum_total_customers_by_gender
[0m14:28:05.770319 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/runnable.py", line 133, in _runtime_initialize
    self.compile_manifest()
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 483, in compile
    self.link_graph(linker, manifest, add_test_edges)
  File "/Users/ilhaam.ahmed/.pyenv/versions/3.11.2/lib/python3.11/site-packages/dbt/compilation.py", line 421, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.maker_warehouse.sum_total_customers_by_gender

[0m14:28:05.771360 [debug] [MainThread]: Command `dbt run` failed at 14:28:05.771270 after 0.47 seconds
[0m14:28:05.771591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d00d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d04fd0>]}
[0m14:28:05.771800 [debug] [MainThread]: Flushing usage events
[0m14:40:30.031846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871a150>]}


============================== 14:40:30.035529 | 95a0576b-5a3b-430f-9e11-b22f4e575c98 ==============================
[0m14:40:30.035529 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:30.035916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:30.078711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871a0d0>]}
[0m14:40:30.085637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871a0d0>]}
[0m14:40:30.086008 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:40:30.096291 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:40:30.104282 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:40:30.104672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7ab50>]}
[0m14:40:30.388530 [debug] [MainThread]: 1699: static parser successfully parsed facts/users.sql
[0m14:40:30.395039 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_genre_views.sql
[0m14:40:30.396932 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_viewing_time.sql
[0m14:40:30.398835 [debug] [MainThread]: 1699: static parser successfully parsed facts/movie_viewings.sql
[0m14:40:30.400627 [debug] [MainThread]: 1699: static parser successfully parsed facts/salary_dim.sql
[0m14:40:30.402370 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:40:30.404119 [debug] [MainThread]: 1699: static parser successfully parsed facts/banking_fact.sql
[0m14:40:30.405886 [debug] [MainThread]: 1603: static parser failed on facts/mac_test.sql
[0m14:40:30.408051 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/mac_test.sql
[0m14:40:30.408991 [debug] [MainThread]: 1699: static parser successfully parsed facts/movies.sql
[0m14:40:30.410745 [debug] [MainThread]: 1699: static parser successfully parsed facts/genres.sql
[0m14:40:30.412584 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_movie_views.sql
[0m14:40:30.414322 [debug] [MainThread]: 1699: static parser successfully parsed facts/customers_dim.sql
[0m14:40:30.416047 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_user_activity.sql
[0m14:40:30.470558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc8e10>]}
[0m14:40:30.474855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb7790>]}
[0m14:40:30.475091 [info ] [MainThread]: Found 13 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:40:30.475304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d1090>]}
[0m14:40:30.476436 [info ] [MainThread]: 
[0m14:40:30.476863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:30.477629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:40:30.483004 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:40:30.483258 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:40:30.483405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:30.587493 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:40:30.588698 [debug] [ThreadPool]: On list_mydb: Close
[0m14:40:30.590222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:40:30.594634 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:40:30.594887 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:40:30.595095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:30.609834 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.610154 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:40:30.610410 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:40:30.627182 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m14:40:30.628690 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:40:30.629632 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:40:30.635447 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:30.635758 [debug] [MainThread]: On master: BEGIN
[0m14:40:30.635974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:30.655082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.655495 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:30.655884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:30.683114 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:40:30.684505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e13850>]}
[0m14:40:30.684794 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:30.685464 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:30.685645 [debug] [MainThread]: On master: BEGIN
[0m14:40:30.687577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.687820 [debug] [MainThread]: On master: COMMIT
[0m14:40:30.687993 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:30.688149 [debug] [MainThread]: On master: COMMIT
[0m14:40:30.688727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:40:30.688913 [debug] [MainThread]: On master: Close
[0m14:40:30.689330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:30.689571 [info ] [MainThread]: 
[0m14:40:30.692839 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:40:30.693072 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:40:30.693265 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:40:30.693450 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:40:30.693717 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:40:30.694034 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:40:30.694346 [info ] [Thread-3 (]: 3 of 13 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:40:30.694693 [info ] [Thread-4 (]: 4 of 13 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:40:30.695164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:40:30.695558 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:40:30.695930 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:40:30.696294 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:40:30.696507 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:40:30.696719 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:40:30.696920 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:40:30.697113 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:40:30.698990 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:40:30.700604 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:40:30.702276 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:40:30.704104 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:40:30.705117 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:40:30.697257 => 14:40:30.704930
[0m14:40:30.705397 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:40:30.699167 => 14:40:30.705271
[0m14:40:30.705644 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:40:30.700766 => 14:40:30.705533
[0m14:40:30.705864 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:40:30.702463 => 14:40:30.705771
[0m14:40:30.706094 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:40:30.706333 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:40:30.706544 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:40:30.706773 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:40:30.734946 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:40:30.735099 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:40:30.737521 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:40:30.747631 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:40:30.748255 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.748470 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:30.748666 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.748828 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:40:30.748990 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.749164 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:40:30.749331 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:40:30.749495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:40:30.749658 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:40:30.749812 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:30.749959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:30.750203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:40:30.762633 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.762903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.763172 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.763414 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:30.763715 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.763963 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:40:30.764356 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:40:30.764573 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.764909 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:40:30.767006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.767259 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.767465 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:40:30.775869 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:40:30.780172 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.780445 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:40:30.783137 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.785083 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.785318 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:40:30.787526 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.798275 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:40:30.798574 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.798757 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:40:30.803915 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:30.807574 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:40:30.807846 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:40:30.821315 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:40:30.822433 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:40:30.737689 => 14:40:30.822332
[0m14:40:30.822643 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:40:30.823171 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910ca90>]}
[0m14:40:30.823534 [info ] [Thread-4 (]: 4 of 13 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:40:30.824117 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:40:30.824540 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:40:30.824805 [info ] [Thread-4 (]: 5 of 13 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:40:30.825405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:40:30.825649 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:40:30.828369 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:40:30.829328 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:40:30.825907 => 14:40:30.828946
[0m14:40:30.829585 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:40:30.833034 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:40:30.833290 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:40:30.835305 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.835900 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:40:30.836373 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:30.836593 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:40:30.836866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:30.837268 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:40:30.840314 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.840843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.841151 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:40:30.843020 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.843322 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:40:30.844602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.844782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.848239 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:40:30.850221 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.850582 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.850797 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.851007 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:40:30.851212 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:30.851386 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:40:30.851612 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:40:30.852850 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:30.854721 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:40:30.855013 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.855228 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:40:30.870490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:30.872329 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:40:30.872526 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:30.872749 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:40:30.874041 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:40:30.874293 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:40:30.885728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:30.886681 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:40:30.706958 => 14:40:30.886586
[0m14:40:30.886854 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:30.887084 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:40:30.887829 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:40:30.732564 => 14:40:30.887735
[0m14:40:30.888263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914c550>]}
[0m14:40:30.888452 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:40:30.888802 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.19s]
[0m14:40:30.889515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7a350>]}
[0m14:40:30.890332 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:40:30.890831 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.19s]
[0m14:40:30.891238 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:40:30.891718 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:40:30.892021 [info ] [Thread-1 (]: 6 of 13 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:40:30.892352 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:40:30.892903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:40:30.893198 [info ] [Thread-2 (]: 7 of 13 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:40:30.893515 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:40:30.894138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:40:30.895840 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:40:30.896096 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:40:30.898015 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:40:30.898467 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:40:30.896390 => 14:40:30.898369
[0m14:40:30.898773 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:40:30.894306 => 14:40:30.898626
[0m14:40:30.898936 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:40:30.899178 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:40:30.901717 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:40:30.904533 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:40:30.905176 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:30.905512 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:30.905693 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:40:30.905883 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:40:30.906077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:30.906262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:30.924239 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.925088 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:30.925338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:30.925612 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:40:30.925882 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:30.926149 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:40:31.052038 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:40:31.054476 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:31.054735 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:40:31.057531 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.061925 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:31.062289 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:40:31.064370 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.066024 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:40:31.066266 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:31.066520 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:40:31.088661 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:31.090350 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:40:31.090717 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:40:31.104114 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:31.105153 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:40:30.899300 => 14:40:31.105037
[0m14:40:31.105372 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:40:31.105831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a6650>]}
[0m14:40:31.106442 [info ] [Thread-2 (]: 7 of 13 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.21s]
[0m14:40:31.106969 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:40:31.107603 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:40:31.108320 [info ] [Thread-2 (]: 8 of 13 START sql table model dbt_warehouse.sum_total_customers_by_gender ...... [RUN]
[0m14:40:31.109012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:40:31.109291 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:40:31.111845 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.112465 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:40:31.109578 => 14:40:31.112336
[0m14:40:31.112695 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:40:31.116097 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.116618 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.116842 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:40:31.117036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:31.134304 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:31.134631 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.134832 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM customers
GROUP BY gender
  );
  
[0m14:40:31.142858 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:40:31.144767 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.145018 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:40:31.146149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.147400 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:40:31.147618 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.147815 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:40:31.177971 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:31.179924 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:40:31.180274 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:40:31.182786 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:31.184414 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:40:31.112831 => 14:40:31.184231
[0m14:40:31.184702 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:40:31.185568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a6650>]}
[0m14:40:31.186559 [info ] [Thread-2 (]: 8 of 13 OK created sql table model dbt_warehouse.sum_total_customers_by_gender . [[32mSELECT 0[0m in 0.08s]
[0m14:40:31.187830 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:40:31.188700 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:40:31.189477 [info ] [Thread-2 (]: 9 of 13 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:40:31.190301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.users)
[0m14:40:31.190565 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:40:31.193538 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:40:31.194353 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:40:31.190776 => 14:40:31.194081
[0m14:40:31.194606 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:40:31.197923 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:40:31.198583 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.198799 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:40:31.198977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:31.213194 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:31.213589 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.213859 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:40:31.506769 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:40:31.511378 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:31.512006 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:40:31.515499 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.519523 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:31.519824 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:40:31.521933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.524384 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:40:31.524671 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:31.524862 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:40:31.550453 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:31.554313 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:40:31.554853 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:40:31.562328 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:31.564318 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:40:30.735257 => 14:40:31.564079
[0m14:40:31.564797 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:40:31.565731 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc3010>]}
[0m14:40:31.566437 [info ] [Thread-3 (]: 3 of 13 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.87s]
[0m14:40:31.567329 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:40:31.614336 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:40:31.619011 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:31.619653 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:40:31.621956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.625133 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:31.625405 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:40:31.626861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.628250 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:40:31.628437 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:31.628603 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:40:31.651149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:31.654470 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:40:31.654858 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:40:31.670651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:31.672856 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:40:30.901933 => 14:40:31.672597
[0m14:40:31.673348 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:40:31.674431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109186410>]}
[0m14:40:31.675317 [info ] [Thread-1 (]: 6 of 13 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.78s]
[0m14:40:31.675991 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:40:31.928114 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:40:31.934151 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.934808 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:40:31.936702 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.940518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.940816 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:40:31.941899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:31.943258 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:40:31.943448 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.943613 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:40:31.965612 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:31.969923 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:40:31.970244 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:40:32.003187 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:32.007295 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:40:31.194785 => 14:40:32.006835
[0m14:40:32.008025 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:40:32.009176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd5b50>]}
[0m14:40:32.009841 [info ] [Thread-2 (]: 9 of 13 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.82s]
[0m14:40:32.010275 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:40:32.057995 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:40:32.063817 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:32.064333 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:40:32.065592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.067373 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:32.067573 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:40:32.068311 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.069495 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:40:32.069662 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:32.069816 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:40:32.084949 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:32.089292 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:40:32.089799 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:40:32.184994 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:32.187662 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:40:30.829760 => 14:40:32.187274
[0m14:40:32.188677 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:40:32.190479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e87bd0>]}
[0m14:40:32.191644 [info ] [Thread-4 (]: 5 of 13 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 1.37s]
[0m14:40:32.192710 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:40:32.194137 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:40:32.194672 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:40:32.195119 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:40:32.195633 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:40:32.195983 [info ] [Thread-3 (]: 10 of 13 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:40:32.196640 [info ] [Thread-1 (]: 11 of 13 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:40:32.197004 [info ] [Thread-2 (]: 12 of 13 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:40:32.197547 [info ] [Thread-4 (]: 13 of 13 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:40:32.198044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_genre_views)
[0m14:40:32.198354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:40:32.198634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:40:32.198911 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:40:32.199094 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:40:32.199255 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:40:32.199411 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:40:32.199564 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:40:32.201698 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:40:32.203600 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.205179 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:40:32.206665 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:40:32.207297 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:40:32.199674 => 14:40:32.207190
[0m14:40:32.207625 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:40:32.201924 => 14:40:32.207508
[0m14:40:32.207879 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:40:32.208062 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:40:32.203833 => 14:40:32.207980
[0m14:40:32.208278 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:40:32.205364 => 14:40:32.208181
[0m14:40:32.208431 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:40:32.210805 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:40:32.211038 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:40:32.211218 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:40:32.213526 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.215846 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:40:32.218016 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:40:32.218345 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.218617 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.218783 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.218981 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:40:32.219158 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:32.219366 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:40:32.219585 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:40:32.219785 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:32.219987 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:40:32.220175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:32.220350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:32.220693 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:32.237893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:32.238311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:32.238637 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:32.238978 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:32.239325 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.239557 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:40:32.239779 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.239998 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:40:32.240861 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:40:32.245856 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:32.246174 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.246372 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:40:32.557654 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:40:32.565163 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.565704 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:40:32.566255 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:40:32.569850 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.570505 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:40:32.571571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.572031 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.574034 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.575657 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.575911 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:40:32.576363 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:40:32.578004 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.578443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.581908 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:40:32.585055 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:40:32.585542 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.585805 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.585998 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:40:32.586173 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:40:32.593460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:32.593984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:32.598529 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:40:32.600963 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:40:32.601286 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:40:32.601490 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:40:32.612460 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:32.614882 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:40:32.211343 => 14:40:32.614562
[0m14:40:32.615254 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:40:32.615502 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:32.615970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e75dd0>]}
[0m14:40:32.616781 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:40:32.213747 => 14:40:32.616687
[0m14:40:32.617326 [info ] [Thread-1 (]: 11 of 13 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.42s]
[0m14:40:32.617884 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:40:32.618816 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:40:32.619878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f80d0>]}
[0m14:40:32.620789 [info ] [Thread-2 (]: 12 of 13 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.42s]
[0m14:40:32.621213 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:40:32.891786 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:40:32.893500 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.893698 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:40:32.894793 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.896316 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.896497 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:40:32.897193 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:32.898406 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:40:32.898577 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.898732 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:40:32.916209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:32.919617 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:40:32.919903 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:40:32.925024 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:32.925843 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:40:32.208555 => 14:40:32.925751
[0m14:40:32.926032 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:40:32.926407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873bc10>]}
[0m14:40:32.926705 [info ] [Thread-3 (]: 10 of 13 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.73s]
[0m14:40:32.927019 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:40:33.139658 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:40:33.145446 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:33.145994 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:40:33.147562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:33.150266 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:33.150539 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:40:33.151272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:40:33.152647 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:40:33.152841 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:33.153002 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:40:33.184309 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:40:33.189080 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:40:33.189564 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:40:33.231035 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:40:33.233286 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:40:32.216031 => 14:40:33.232910
[0m14:40:33.234016 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:40:33.235293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a0576b-5a3b-430f-9e11-b22f4e575c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cda4d0>]}
[0m14:40:33.236131 [info ] [Thread-4 (]: 13 of 13 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.04s]
[0m14:40:33.237122 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:40:33.239336 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:33.239679 [debug] [MainThread]: On master: BEGIN
[0m14:40:33.239842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:33.248730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:33.249062 [debug] [MainThread]: On master: COMMIT
[0m14:40:33.249221 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:33.249367 [debug] [MainThread]: On master: COMMIT
[0m14:40:33.250252 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:40:33.250498 [debug] [MainThread]: On master: Close
[0m14:40:33.250906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:33.251067 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:40:33.251196 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:40:33.251319 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:40:33.251439 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:40:33.251649 [info ] [MainThread]: 
[0m14:40:33.251879 [info ] [MainThread]: Finished running 1 view model, 12 table models in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m14:40:33.253027 [debug] [MainThread]: Command end result
[0m14:40:33.257632 [info ] [MainThread]: 
[0m14:40:33.257971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:33.258245 [info ] [MainThread]: 
[0m14:40:33.258486 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:40:33.259048 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:33.258994 after 3.24 seconds
[0m14:40:33.259286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa27d0>]}
[0m14:40:33.259480 [debug] [MainThread]: Flushing usage events
[0m14:42:16.636201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111919050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111906f50>]}


============================== 14:42:16.639814 | 9bc43d8b-d486-40a5-a826-28992f984b42 ==============================
[0m14:42:16.639814 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:42:16.640200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:42:16.683350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111930490>]}
[0m14:42:16.690346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192f290>]}
[0m14:42:16.690728 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:42:16.700547 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:42:16.723325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:16.723743 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:42:16.735295 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:42:16.765582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e80190>]}
[0m14:42:16.769794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d3090>]}
[0m14:42:16.770029 [info ] [MainThread]: Found 13 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:42:16.770243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3d090>]}
[0m14:42:16.771391 [info ] [MainThread]: 
[0m14:42:16.771873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:16.772647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:42:16.778008 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:42:16.778279 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:42:16.778436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:16.848172 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:42:16.849265 [debug] [ThreadPool]: On list_mydb: Close
[0m14:42:16.850569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:42:16.854241 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:42:16.854450 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:42:16.854622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:16.868230 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.868538 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:42:16.868741 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:42:16.881662 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:42:16.882861 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:42:16.883622 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:42:16.887937 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:16.888171 [debug] [MainThread]: On master: BEGIN
[0m14:42:16.888339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:16.898641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.898949 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:16.899220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:16.921360 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:42:16.922949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f64950>]}
[0m14:42:16.923271 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:16.924160 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:16.924395 [debug] [MainThread]: On master: BEGIN
[0m14:42:16.925850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.926103 [debug] [MainThread]: On master: COMMIT
[0m14:42:16.926309 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:16.926498 [debug] [MainThread]: On master: COMMIT
[0m14:42:16.927225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:16.927451 [debug] [MainThread]: On master: Close
[0m14:42:16.927901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:16.928182 [info ] [MainThread]: 
[0m14:42:16.931862 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:42:16.932137 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:42:16.932396 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:42:16.932635 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:42:16.932919 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:42:16.933316 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:42:16.933691 [info ] [Thread-3 (]: 3 of 13 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:42:16.934042 [info ] [Thread-4 (]: 4 of 13 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:42:16.934585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:42:16.935062 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:42:16.935646 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:42:16.936073 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:42:16.936306 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:42:16.936528 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:42:16.936767 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:42:16.937003 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:42:16.939053 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:42:16.941381 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:42:16.943005 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:42:16.944578 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:42:16.945644 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:42:16.941562 => 14:42:16.945504
[0m14:42:16.945904 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:42:16.937162 => 14:42:16.945793
[0m14:42:16.946114 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:42:16.939243 => 14:42:16.946025
[0m14:42:16.946303 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:42:16.946495 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:42:16.946739 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:42:16.943176 => 14:42:16.946609
[0m14:42:16.946947 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:42:16.969158 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:42:16.971511 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:42:16.971768 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:42:16.973892 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:42:16.983303 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:42:16.983663 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:16.983820 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:16.983999 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:16.984277 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:42:16.984463 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:16.984611 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:42:16.984766 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:42:16.984913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:16.985072 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:42:16.985220 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:16.985364 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:16.985612 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:16.995960 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.996381 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:16.996606 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:42:16.998117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.998379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:16.998603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:16.998849 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:16.999094 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:42:16.999335 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:42:17.003301 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:42:17.006934 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:17.007148 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.007408 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:42:17.007652 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:17.007902 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:42:17.009126 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.010972 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:17.011207 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:42:17.012322 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.022347 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:42:17.022650 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:17.022824 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:42:17.029854 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.033399 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:17.033683 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:42:17.037004 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:17.038994 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:17.039264 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:42:17.040982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.043592 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:17.043804 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:42:17.043984 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:17.045654 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:17.045868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.046080 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:42:17.049621 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:42:17.050039 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:17.050244 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:42:17.050761 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:42:17.051643 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:42:16.974190 => 14:42:17.051518
[0m14:42:17.051814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.052028 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:42:17.053833 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:17.054163 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:42:17.054632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c3750>]}
[0m14:42:17.054994 [info ] [Thread-4 (]: 4 of 13 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:42:17.055805 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:42:17.056150 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.056639 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:42:17.057296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.058954 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:42:17.059305 [info ] [Thread-4 (]: 5 of 13 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:42:17.061468 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:17.061729 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:17.062085 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:42:17.062281 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:42:17.062463 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:42:17.062645 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:42:17.064493 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:42:17.064730 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.066352 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:17.066585 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:42:17.066970 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:42:17.062849 => 14:42:17.066859
[0m14:42:17.067173 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:42:17.069842 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:42:17.070344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.071735 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:42:16.969334 => 14:42:17.071612
[0m14:42:17.072089 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:42:17.073153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa6f10>]}
[0m14:42:17.073578 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.074468 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.14s]
[0m14:42:17.075259 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:42:17.075526 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.075854 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:42:17.076051 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:17.077008 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:42:16.971898 => 14:42:17.076910
[0m14:42:17.077264 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:42:17.077630 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:42:17.077893 [info ] [Thread-1 (]: 6 of 13 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:42:17.078541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119dc350>]}
[0m14:42:17.078892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:42:17.079261 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.14s]
[0m14:42:17.079765 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:42:17.080123 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:42:17.081774 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:42:17.082052 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:42:17.082572 [info ] [Thread-2 (]: 7 of 13 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:42:17.083117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:42:17.083365 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:42:17.083586 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:42:17.080300 => 14:42:17.083491
[0m14:42:17.085489 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:42:17.085819 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:42:17.088761 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:42:17.089028 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.089321 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.089594 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:42:17.083696 => 14:42:17.089481
[0m14:42:17.089768 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:17.089979 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:42:17.090251 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.092660 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:42:17.092888 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:42:17.093121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:17.093698 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.093918 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:42:17.094087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:17.114842 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.115377 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.115586 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:42:17.116349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.116565 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.116788 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:17.135306 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:17.137242 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.137505 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:42:17.139082 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.141004 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.141244 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:42:17.142745 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.144289 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:42:17.144535 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.144745 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:42:17.190912 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.193533 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:17.193779 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:42:17.210177 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.211210 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:42:17.090363 => 14:42:17.211104
[0m14:42:17.211423 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:42:17.211835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a5dd0>]}
[0m14:42:17.212143 [info ] [Thread-2 (]: 7 of 13 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.13s]
[0m14:42:17.212479 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:42:17.212850 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:42:17.213077 [info ] [Thread-2 (]: 8 of 13 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:42:17.213604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:42:17.213778 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:42:17.215645 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:42:17.216269 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:42:17.213912 => 14:42:17.216119
[0m14:42:17.216480 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:42:17.219116 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:42:17.219633 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.219819 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:42:17.219984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:17.231817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.232152 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.232438 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:17.269194 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:42:17.271042 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:17.271283 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:42:17.272822 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.274380 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:17.274584 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:42:17.275772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.277146 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:42:17.277364 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:17.277539 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:42:17.295923 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.297550 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:17.297752 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:42:17.310370 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.311452 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:42:16.947093 => 14:42:17.311356
[0m14:42:17.311663 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:42:17.312063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111987a90>]}
[0m14:42:17.312365 [info ] [Thread-3 (]: 3 of 13 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.38s]
[0m14:42:17.312687 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:42:17.312893 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:17.313428 [info ] [Thread-3 (]: 9 of 13 START sql table model dbt_warehouse.sum_total_customers_by_gender ...... [RUN]
[0m14:42:17.313936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:42:17.314125 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:17.315797 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.316274 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:42:17.314246 => 14:42:17.316171
[0m14:42:17.316470 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:17.318901 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.319330 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.319516 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:42:17.319681 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:17.339993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.340433 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.340682 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:42:17.360537 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:42:17.363113 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.363368 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:42:17.366284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.370944 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.371707 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:42:17.374013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.377973 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:42:17.378245 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.378429 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:42:17.402643 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.405466 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:17.405752 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:42:17.413080 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.414345 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:42:17.316588 => 14:42:17.414246
[0m14:42:17.414554 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:42:17.415264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119dee10>]}
[0m14:42:17.416235 [info ] [Thread-3 (]: 9 of 13 OK created sql table model dbt_warehouse.sum_total_customers_by_gender . [[32mSELECT 2[0m in 0.10s]
[0m14:42:17.416985 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:17.570962 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:42:17.577263 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.577927 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:42:17.580081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.581826 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.582018 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:42:17.583437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.584754 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:42:17.584945 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.585108 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:42:17.602010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.606002 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:17.606340 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:42:17.621868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.623908 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:42:17.086116 => 14:42:17.623661
[0m14:42:17.624399 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:42:17.625336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d9c90>]}
[0m14:42:17.625864 [info ] [Thread-1 (]: 6 of 13 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.55s]
[0m14:42:17.626215 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:42:17.747263 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:42:17.753008 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.753662 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:42:17.755530 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.760084 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.760376 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:42:17.761319 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.762635 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:42:17.762822 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.762978 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:42:17.792848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.798122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:17.799163 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:42:17.820904 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.821846 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:42:17.216608 => 14:42:17.821757
[0m14:42:17.822040 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:42:17.822426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121dd450>]}
[0m14:42:17.822718 [info ] [Thread-2 (]: 8 of 13 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.61s]
[0m14:42:17.823034 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:42:17.883050 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:42:17.885611 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.885861 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:42:17.887108 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.888620 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.888814 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:42:17.889675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:17.890893 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:42:17.891076 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.891235 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:42:17.915999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:17.917505 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:17.917680 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:42:17.957002 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:17.958938 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:42:17.067303 => 14:42:17.958833
[0m14:42:17.959190 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:42:17.959582 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc1e90>]}
[0m14:42:17.959902 [info ] [Thread-4 (]: 5 of 13 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.90s]
[0m14:42:17.960224 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:42:17.960693 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:42:17.960906 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:17.961335 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:42:17.961133 [info ] [Thread-3 (]: 10 of 13 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:42:17.961601 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:42:17.961831 [info ] [Thread-1 (]: 11 of 13 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:42:17.962105 [info ] [Thread-2 (]: 12 of 13 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:42:17.962710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:42:17.963022 [info ] [Thread-4 (]: 13 of 13 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:42:17.963479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:42:17.963799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:42:17.963989 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:42:17.964270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:42:17.964445 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:17.964608 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:42:17.966364 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:42:17.966557 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:42:17.967917 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:17.969433 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:42:17.970988 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:42:17.971364 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:42:17.964747 => 14:42:17.971262
[0m14:42:17.971604 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:42:17.973694 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:42:17.974135 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:42:17.966677 => 14:42:17.974047
[0m14:42:17.974323 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:42:17.969695 => 14:42:17.974244
[0m14:42:17.974523 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:42:17.968101 => 14:42:17.974419
[0m14:42:17.974722 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:17.974897 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:17.975068 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:42:17.975235 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:42:17.977366 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:17.977538 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:42:17.979635 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:42:17.981713 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:42:17.981939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:17.982208 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:17.982488 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:17.982700 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:42:17.982887 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:17.983065 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:42:17.983317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:17.983550 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:42:17.983732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:17.984026 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:17.995661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.995948 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:17.996148 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:42:17.997884 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.998137 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.998492 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:17.998705 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:17.998967 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:17.999195 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:42:17.999418 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:42:17.999624 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:17.999903 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:42:18.268751 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:42:18.274775 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:18.275418 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:42:18.276747 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:42:18.277301 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.281218 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:18.285124 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:18.285672 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:42:18.286149 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:42:18.287672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.288072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.291406 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:42:18.295495 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:18.296141 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:18.296599 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:42:18.297047 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:42:18.298655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.300494 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:42:18.300740 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:18.300918 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:42:18.306602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:18.307140 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:18.310663 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:18.313564 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:18.313905 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:42:18.314107 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:42:18.320268 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:18.321872 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:42:17.975350 => 14:42:18.321715
[0m14:42:18.322346 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:42:18.322601 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:18.323597 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:42:17.979766 => 14:42:18.323513
[0m14:42:18.324190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112160750>]}
[0m14:42:18.324486 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:42:18.325017 [info ] [Thread-1 (]: 11 of 13 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.36s]
[0m14:42:18.325817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112115cd0>]}
[0m14:42:18.326503 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:18.327294 [info ] [Thread-2 (]: 12 of 13 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.36s]
[0m14:42:18.328592 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:42:18.621067 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:42:18.627247 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:18.627747 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:42:18.629182 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.632400 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:18.632707 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:42:18.633603 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.634953 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:42:18.635140 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:18.635313 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:42:18.654382 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:18.658152 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:18.658657 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:42:18.662319 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:18.663175 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:42:17.971723 => 14:42:18.663083
[0m14:42:18.663367 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:42:18.663760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc3d10>]}
[0m14:42:18.664059 [info ] [Thread-3 (]: 10 of 13 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.70s]
[0m14:42:18.664379 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:42:18.860900 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:42:18.866784 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:18.867087 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:42:18.868390 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.869970 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:18.870150 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:42:18.870865 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:18.872204 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:42:18.872387 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:18.872547 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:42:18.902916 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:18.907542 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:18.908132 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:42:18.918222 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:18.920408 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:42:17.977664 => 14:42:18.920097
[0m14:42:18.920988 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:42:18.921966 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc43d8b-d486-40a5-a826-28992f984b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120dbd90>]}
[0m14:42:18.922650 [info ] [Thread-4 (]: 13 of 13 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.96s]
[0m14:42:18.923486 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:42:18.924782 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:18.925025 [debug] [MainThread]: On master: BEGIN
[0m14:42:18.925181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:18.933136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:18.933450 [debug] [MainThread]: On master: COMMIT
[0m14:42:18.933615 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:18.933759 [debug] [MainThread]: On master: COMMIT
[0m14:42:18.934921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:18.935199 [debug] [MainThread]: On master: Close
[0m14:42:18.935624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:18.935772 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:42:18.935900 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:42:18.936023 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:42:18.936139 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:42:18.936340 [info ] [MainThread]: 
[0m14:42:18.936550 [info ] [MainThread]: Finished running 1 view model, 12 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m14:42:18.937863 [debug] [MainThread]: Command end result
[0m14:42:18.941602 [info ] [MainThread]: 
[0m14:42:18.941868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:18.942102 [info ] [MainThread]: 
[0m14:42:18.942340 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:42:18.943115 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:18.943065 after 2.32 seconds
[0m14:42:18.943394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460e7d0>]}
[0m14:42:18.943579 [debug] [MainThread]: Flushing usage events
[0m14:42:31.176032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491dcd0>]}


============================== 14:42:31.179650 | c74fa870-febd-422d-a120-40f9e6e123b7 ==============================
[0m14:42:31.179650 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:42:31.180006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:42:31.220489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c74fa870-febd-422d-a120-40f9e6e123b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fad90>]}
[0m14:42:31.227472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c74fa870-febd-422d-a120-40f9e6e123b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104648410>]}
[0m14:42:31.227834 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:42:31.238435 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:42:31.259039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:31.259399 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:42:31.270882 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_gender.sql
[0m14:42:31.277747 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.maker_warehouse.sum_total_customers_by_gender' (models/facts/sum_total_customers_by_gender.sql) depends on a node named 'customers' which was not found
[0m14:42:31.278207 [debug] [MainThread]: Command `dbt run` failed at 14:42:31.278130 after 0.12 seconds
[0m14:42:31.278441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104900e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105178b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006cde90>]}
[0m14:42:31.278691 [debug] [MainThread]: Flushing usage events
[0m14:42:36.954922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b6490>]}


============================== 14:42:36.958943 | 2efdf009-bf92-4a9a-ae9a-534dcc45d61b ==============================
[0m14:42:36.958943 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:42:36.959310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:42:36.992814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dc910>]}
[0m14:42:36.999784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ca1d0>]}
[0m14:42:37.000178 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:42:37.008719 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:42:37.029691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:37.029939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:37.033675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae750>]}
[0m14:42:37.038246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497b350>]}
[0m14:42:37.038514 [info ] [MainThread]: Found 13 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:42:37.038743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102661090>]}
[0m14:42:37.039997 [info ] [MainThread]: 
[0m14:42:37.040448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:37.041215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:42:37.046485 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:42:37.046655 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:42:37.046844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:37.121325 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:42:37.122403 [debug] [ThreadPool]: On list_mydb: Close
[0m14:42:37.123655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:42:37.145727 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:42:37.145987 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:42:37.146140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:37.162829 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.163005 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:42:37.163180 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:42:37.172791 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:42:37.173967 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:42:37.174786 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:42:37.178909 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:37.179163 [debug] [MainThread]: On master: BEGIN
[0m14:42:37.179338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:37.188757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.189212 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:37.189528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:37.209335 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:42:37.211081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104768a10>]}
[0m14:42:37.211408 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:37.212220 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:37.212432 [debug] [MainThread]: On master: BEGIN
[0m14:42:37.213689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.213927 [debug] [MainThread]: On master: COMMIT
[0m14:42:37.214190 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:37.214425 [debug] [MainThread]: On master: COMMIT
[0m14:42:37.215173 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.215390 [debug] [MainThread]: On master: Close
[0m14:42:37.215844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:37.216122 [info ] [MainThread]: 
[0m14:42:37.219200 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:42:37.219490 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:42:37.219715 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:42:37.219937 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:42:37.220262 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:42:37.220668 [info ] [Thread-2 (]: 2 of 13 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:42:37.221059 [info ] [Thread-3 (]: 3 of 13 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:42:37.221471 [info ] [Thread-4 (]: 4 of 13 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:42:37.222017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:42:37.222457 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:42:37.222886 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:42:37.223315 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:42:37.223541 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:42:37.223741 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:42:37.223936 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:42:37.224124 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:42:37.226030 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:42:37.227652 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:42:37.229049 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:42:37.230571 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:42:37.231340 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:42:37.224260 => 14:42:37.231225
[0m14:42:37.231630 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:42:37.231850 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:42:37.227802 => 14:42:37.231756
[0m14:42:37.232047 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:42:37.226201 => 14:42:37.231961
[0m14:42:37.232242 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:42:37.229200 => 14:42:37.232157
[0m14:42:37.253520 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:42:37.253758 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:42:37.253971 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:42:37.254141 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:42:37.256569 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:42:37.258671 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:42:37.265211 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.268720 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:42:37.269118 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:42:37.269363 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.269538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:37.269746 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:42:37.269917 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.270177 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.270338 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:37.270493 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:42:37.270723 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:42:37.270991 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:37.271158 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:37.281520 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.281817 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.282016 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:42:37.282297 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.282520 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.282818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.283040 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.283257 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.283462 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.283659 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:42:37.283857 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:42:37.284033 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:42:37.293172 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:42:37.297974 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.298258 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:42:37.311715 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.314060 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.314330 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:42:37.316014 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.327458 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:42:37.327721 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:37.327971 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.329716 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.329960 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:42:37.330287 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:42:37.332360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.334838 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.335068 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:37.335312 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:42:37.337169 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.337566 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:42:37.338797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.342893 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:42:37.343236 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.343478 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.345429 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.345691 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:42:37.345912 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:42:37.347258 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.348909 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:42:37.349128 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.349299 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:42:37.356027 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.359335 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:42:37.359603 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.359765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.359971 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:42:37.361386 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:42:37.362648 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:42:37.362909 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:42:37.363112 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:42:37.366254 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:42:37.367283 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:42:37.258849 => 14:42:37.367179
[0m14:42:37.367499 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:42:37.368048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc7390>]}
[0m14:42:37.368436 [info ] [Thread-4 (]: 4 of 13 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:42:37.368818 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:42:37.369093 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:42:37.369476 [info ] [Thread-4 (]: 5 of 13 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:42:37.370136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:42:37.370408 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:42:37.373603 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:42:37.375296 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:42:37.370538 => 14:42:37.374820
[0m14:42:37.376531 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:42:37.380700 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:42:37.380952 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.381124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.382077 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:42:37.256718 => 14:42:37.381974
[0m14:42:37.383280 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:42:37.232365 => 14:42:37.383173
[0m14:42:37.383524 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:37.383745 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:42:37.383941 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:42:37.384121 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:42:37.384553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a57d0>]}
[0m14:42:37.384953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104959750>]}
[0m14:42:37.385587 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:37.386972 [info ] [Thread-2 (]: 2 of 13 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.16s]
[0m14:42:37.387830 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.16s]
[0m14:42:37.388502 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:42:37.388789 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:42:37.389034 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:42:37.389501 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_dim
[0m14:42:37.389831 [info ] [Thread-2 (]: 6 of 13 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:42:37.390218 [info ] [Thread-1 (]: 7 of 13 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:42:37.390756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.movies)
[0m14:42:37.391106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.salary_dim)
[0m14:42:37.391306 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:42:37.391496 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:42:37.393061 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:42:37.395731 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:42:37.396258 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:42:37.391628 => 14:42:37.396151
[0m14:42:37.396464 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:42:37.393231 => 14:42:37.396368
[0m14:42:37.396675 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:42:37.396897 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:42:37.399389 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:42:37.399707 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.402326 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:42:37.402802 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:37.403188 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:37.403484 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.403839 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:42:37.404107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.404313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:37.404511 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:42:37.404783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:37.415412 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.415983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.416284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.416487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.416686 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:37.416937 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:42:37.434760 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:42:37.436691 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.436951 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:42:37.439413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.441421 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.441678 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:42:37.442955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.444691 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:42:37.445109 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.445351 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:42:37.493365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.495270 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:42:37.495514 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:42:37.523939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.524929 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:42:37.399900 => 14:42:37.524830
[0m14:42:37.525137 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: Close
[0m14:42:37.525536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104970810>]}
[0m14:42:37.525844 [info ] [Thread-1 (]: 7 of 13 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.13s]
[0m14:42:37.526181 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:42:37.526404 [debug] [Thread-1 (]: Began running node model.maker_warehouse.users
[0m14:42:37.527090 [info ] [Thread-1 (]: 8 of 13 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:42:37.528302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:42:37.528874 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.users
[0m14:42:37.530784 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:42:37.531419 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (compile): 14:42:37.529205 => 14:42:37.531312
[0m14:42:37.531625 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.users
[0m14:42:37.534236 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:42:37.534852 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:37.535036 [debug] [Thread-1 (]: On model.maker_warehouse.users: BEGIN
[0m14:42:37.535202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:37.544520 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:42:37.546383 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.546597 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:42:37.547944 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.549750 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.550060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.550357 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:42:37.550637 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:37.550921 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:42:37.552067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.553486 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:42:37.553696 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.553869 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:42:37.576404 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.579070 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:42:37.579372 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:42:37.588279 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.589262 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:42:37.254353 => 14:42:37.589166
[0m14:42:37.589488 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:42:37.589881 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049338d0>]}
[0m14:42:37.590200 [info ] [Thread-3 (]: 3 of 13 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.37s]
[0m14:42:37.590521 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:42:37.591121 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:37.591400 [info ] [Thread-3 (]: 9 of 13 START sql table model dbt_warehouse.sum_total_customers_by_gender ...... [RUN]
[0m14:42:37.591806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:42:37.591984 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:37.593521 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.594154 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:42:37.592100 => 14:42:37.594037
[0m14:42:37.594361 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:37.596966 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.597386 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.597566 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:42:37.597731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:37.611657 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:37.612313 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.612530 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:42:37.693054 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:42:37.694781 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.695010 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:42:37.696279 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.698638 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.698867 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:42:37.700077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.701393 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:42:37.701585 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.701754 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:42:37.710989 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.712807 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:42:37.713027 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:42:37.718578 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.719465 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:42:37.594487 => 14:42:37.719373
[0m14:42:37.719671 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:42:37.720051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f76090>]}
[0m14:42:37.720353 [info ] [Thread-3 (]: 9 of 13 OK created sql table model dbt_warehouse.sum_total_customers_by_gender . [[32mSELECT 2[0m in 0.13s]
[0m14:42:37.720672 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:42:37.863130 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:42:37.867845 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.868485 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:42:37.872261 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.875432 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.875766 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:42:37.877282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:37.879161 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:42:37.879415 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.879589 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:42:37.887684 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:37.889082 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:42:37.889283 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:42:37.894820 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:37.895761 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:42:37.397035 => 14:42:37.895668
[0m14:42:37.895972 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:42:37.896372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc5b50>]}
[0m14:42:37.896671 [info ] [Thread-2 (]: 6 of 13 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.51s]
[0m14:42:37.896990 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:42:38.094566 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:42:38.098477 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:38.098748 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:42:38.100520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.102364 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:38.102576 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:42:38.103581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.104869 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:42:38.105057 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:38.105221 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:42:38.111635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:38.113078 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:42:38.113258 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:42:38.121768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:38.122698 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (execute): 14:42:37.531759 => 14:42:38.122610
[0m14:42:38.122892 [debug] [Thread-1 (]: On model.maker_warehouse.users: Close
[0m14:42:38.123275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105150ad0>]}
[0m14:42:38.123579 [info ] [Thread-1 (]: 8 of 13 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.60s]
[0m14:42:38.123981 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.users
[0m14:42:38.154815 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:42:38.156991 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:38.157334 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:42:38.159917 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.162139 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:38.162376 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:42:38.163626 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.164931 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:42:38.165113 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:38.165276 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:42:38.172983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:38.176017 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:42:38.176297 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:42:38.257994 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:38.259250 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:42:37.377254 => 14:42:38.259140
[0m14:42:38.259455 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:42:38.259902 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b7150>]}
[0m14:42:38.260256 [info ] [Thread-4 (]: 5 of 13 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.89s]
[0m14:42:38.260671 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:42:38.261539 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:42:38.262165 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:38.262423 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:42:38.262703 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:42:38.261915 [info ] [Thread-3 (]: 10 of 13 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:42:38.263025 [info ] [Thread-2 (]: 11 of 13 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:42:38.263335 [info ] [Thread-1 (]: 12 of 13 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:42:38.263621 [info ] [Thread-4 (]: 13 of 13 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:42:38.264109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:42:38.264434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:42:38.264727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:42:38.265008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:42:38.265198 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:42:38.265366 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:38.265522 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:42:38.265715 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:42:38.267894 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:42:38.269876 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.273161 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:42:38.277587 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:42:38.278446 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:42:38.265862 => 14:42:38.278302
[0m14:42:38.278697 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:42:38.268153 => 14:42:38.278586
[0m14:42:38.279104 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:42:38.279412 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:42:38.273560 => 14:42:38.279312
[0m14:42:38.279636 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:42:38.270180 => 14:42:38.279536
[0m14:42:38.279806 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:38.283108 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:42:38.283381 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:42:38.283563 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:42:38.286211 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.288830 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:42:38.291315 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:42:38.291677 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:38.292041 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.292241 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:38.292417 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:42:38.292624 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.292788 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:42:38.292974 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:42:38.293143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:38.293322 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:42:38.293487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:38.293643 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:38.293886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:38.321026 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:38.321461 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:38.321677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:38.321923 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:42:38.322254 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:38.322476 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.322768 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:38.323027 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:42:38.323700 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:42:38.340132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:42:38.340979 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.341546 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:42:38.726379 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:42:38.729272 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.729519 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:42:38.731104 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.733365 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.733859 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:42:38.735239 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.737328 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:42:38.737698 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.737950 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:42:38.912319 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 1.0 seconds
[0m14:42:38.917245 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.917911 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:38.918884 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:42:38.920849 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:42:38.921174 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:42:38.922308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.924211 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.924492 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:42:38.926329 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:38.927243 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:42:38.283721 => 14:42:38.927122
[0m14:42:38.927449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:38.927700 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:42:38.929038 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:42:38.929596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104965310>]}
[0m14:42:38.929822 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.930242 [info ] [Thread-2 (]: 11 of 13 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.67s]
[0m14:42:38.930947 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:42:38.931309 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:42:38.933329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:38.935161 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:42:38.935545 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:42:38.940625 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:38.941964 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:42:38.289052 => 14:42:38.941867
[0m14:42:38.942528 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:42:38.943774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f511d0>]}
[0m14:42:38.944333 [info ] [Thread-1 (]: 12 of 13 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.68s]
[0m14:42:38.944784 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:42:39.208943 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:42:39.214249 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:39.214880 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:42:39.216520 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:39.219674 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:39.219923 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:42:39.220885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:39.222408 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:42:39.222632 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:39.222806 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:42:39.229158 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:39.230611 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:42:39.230789 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:42:39.233110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:39.233965 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:42:38.279943 => 14:42:39.233842
[0m14:42:39.234190 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:42:39.234597 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc7350>]}
[0m14:42:39.234937 [info ] [Thread-3 (]: 10 of 13 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.97s]
[0m14:42:39.235290 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:42:39.420914 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:42:39.427664 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:39.428242 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:42:39.429699 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:39.433607 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:39.433852 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:42:39.434842 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:39.436080 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:42:39.436265 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:39.436430 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:42:39.465397 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:42:39.469731 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:42:39.470005 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:42:39.484156 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:39.486396 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:42:38.286554 => 14:42:39.486139
[0m14:42:39.487015 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:42:39.488132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efdf009-bf92-4a9a-ae9a-534dcc45d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104978c50>]}
[0m14:42:39.488662 [info ] [Thread-4 (]: 13 of 13 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.22s]
[0m14:42:39.489088 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:42:39.490926 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:39.491310 [debug] [MainThread]: On master: BEGIN
[0m14:42:39.491495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:39.502371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:39.502734 [debug] [MainThread]: On master: COMMIT
[0m14:42:39.502899 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:39.503045 [debug] [MainThread]: On master: COMMIT
[0m14:42:39.503785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:39.503997 [debug] [MainThread]: On master: Close
[0m14:42:39.504428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:39.504631 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:42:39.504795 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:42:39.504926 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:42:39.505047 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:42:39.505258 [info ] [MainThread]: 
[0m14:42:39.505479 [info ] [MainThread]: Finished running 1 view model, 12 table models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m14:42:39.506623 [debug] [MainThread]: Command end result
[0m14:42:39.511033 [info ] [MainThread]: 
[0m14:42:39.511376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:39.511612 [info ] [MainThread]: 
[0m14:42:39.511834 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:42:39.512395 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:39.512330 after 2.57 seconds
[0m14:42:39.512670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e30690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed1c50>]}
[0m14:42:39.512874 [debug] [MainThread]: Flushing usage events
[0m14:43:51.611498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d21290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d310d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0ff90>]}


============================== 14:43:51.615191 | 5c026bfb-6488-4682-b2c5-e8da1669bc17 ==============================
[0m14:43:51.615191 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:43:51.615587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:51.656068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd79d0>]}
[0m14:43:51.663016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d31010>]}
[0m14:43:51.663385 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:43:51.674059 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:43:51.697435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:43:51.697797 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/customer_balances.sql
[0m14:43:51.709305 [debug] [MainThread]: 1699: static parser successfully parsed facts/customer_balances.sql
[0m14:43:51.738733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ae0d0>]}
[0m14:43:51.742506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df3990>]}
[0m14:43:51.742726 [info ] [MainThread]: Found 14 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:51.742939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101add090>]}
[0m14:43:51.744040 [info ] [MainThread]: 
[0m14:43:51.744436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:51.745244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:43:51.750439 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:43:51.750736 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:43:51.750898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:51.827054 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:43:51.828185 [debug] [ThreadPool]: On list_mydb: Close
[0m14:43:51.829657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:43:51.833881 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:43:51.834129 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:43:51.834322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:51.844203 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.844461 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:43:51.844679 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:43:51.855157 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:43:51.856359 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:43:51.857181 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:43:51.861872 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:51.862121 [debug] [MainThread]: On master: BEGIN
[0m14:43:51.862303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:51.872528 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.872815 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:51.873213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:51.898700 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:43:51.900467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c74a50>]}
[0m14:43:51.900823 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:51.901753 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:51.901972 [debug] [MainThread]: On master: BEGIN
[0m14:43:51.904138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.904427 [debug] [MainThread]: On master: COMMIT
[0m14:43:51.904647 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:51.904850 [debug] [MainThread]: On master: COMMIT
[0m14:43:51.905672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:51.905941 [debug] [MainThread]: On master: Close
[0m14:43:51.906477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:51.906827 [info ] [MainThread]: 
[0m14:43:51.910339 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:43:51.910636 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customer_balances
[0m14:43:51.910902 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_dim
[0m14:43:51.911145 [debug] [Thread-4 (]: Began running node model.maker_warehouse.genres
[0m14:43:51.911486 [info ] [Thread-1 (]: 1 of 14 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:43:51.911909 [info ] [Thread-2 (]: 2 of 14 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:43:51.912365 [info ] [Thread-3 (]: 3 of 14 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:43:51.912812 [info ] [Thread-4 (]: 4 of 14 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:43:51.913434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:43:51.913978 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customer_balances'
[0m14:43:51.914598 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:43:51.915108 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:43:51.915368 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:43:51.915627 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:43:51.915874 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:43:51.916109 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.genres
[0m14:43:51.918338 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:43:51.922192 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:43:51.924645 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:43:51.926654 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:43:51.927679 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:43:51.918827 => 14:43:51.927480
[0m14:43:51.927954 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:43:51.916290 => 14:43:51.927842
[0m14:43:51.928256 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:43:51.928531 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.genres (compile): 14:43:51.924976 => 14:43:51.928428
[0m14:43:51.928751 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:43:51.922502 => 14:43:51.928656
[0m14:43:51.928956 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:43:51.952647 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:43:51.952888 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.genres
[0m14:43:51.953094 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:43:51.955420 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:43:51.957677 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:43:51.959842 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:43:51.960112 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:43:51.960444 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:43:51.960623 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:51.960804 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:43:51.961013 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:51.961168 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:43:51.961321 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:51.961575 [debug] [Thread-4 (]: On model.maker_warehouse.genres: BEGIN
[0m14:43:51.961738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:51.961895 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:43:51.962042 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:43:51.962290 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:43:51.970956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.971425 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:51.971654 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.971878 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:43:51.972087 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:51.972372 [debug] [Thread-4 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:43:51.974087 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.974302 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:43:51.974480 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM customers c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:43:51.977436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:51.977840 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:51.978050 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:43:51.985318 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:43:51.989676 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:43:51.989999 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:43:51.991545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.003597 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:43:52.003870 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:43:52.004114 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:43:52.005703 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:52.005894 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:43:52.006068 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:43:52.007683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.009734 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:52.009981 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:43:52.011606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.015628 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:43:52.015879 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.016124 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:52.016282 [debug] [Thread-3 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:43:52.020067 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:43:52.020383 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:43:52.022231 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:52.022492 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:43:52.022862 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:43:52.024200 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.025282 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:43:51.929102 => 14:43:52.025154
[0m14:43:52.025481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.025706 [debug] [Thread-2 (]: On model.maker_warehouse.customer_balances: Close
[0m14:43:52.025902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.027637 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:52.028982 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:43:52.029385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b090>]}
[0m14:43:52.029622 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:43:52.029819 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:43:52.030182 [info ] [Thread-2 (]: 2 of 14 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.12s]
[0m14:43:52.031086 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:43:52.031337 [debug] [Thread-2 (]: Began running node model.maker_warehouse.mac_test
[0m14:43:52.032628 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.032077 [info ] [Thread-2 (]: 5 of 14 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:43:52.034249 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:43:52.034849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.mac_test)
[0m14:43:52.035535 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:52.035991 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:43:52.036356 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:43:52.038400 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:43:52.038632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.039609 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:43:51.953224 => 14:43:52.039510
[0m14:43:52.039919 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:43:52.040108 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.040310 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:43:52.036538 => 14:43:52.040230
[0m14:43:52.040718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a3b10>]}
[0m14:43:52.042103 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:43:52.042369 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.mac_test
[0m14:43:52.042725 [info ] [Thread-1 (]: 1 of 14 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:43:52.043137 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:43:52.054510 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:43:52.054962 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:43:52.055426 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:43:52.055855 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.056104 [info ] [Thread-1 (]: 6 of 14 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:43:52.056371 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:43:52.056898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movie_viewings)
[0m14:43:52.057132 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:52.057335 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:43:52.059345 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:43:52.059861 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:43:52.057632 => 14:43:52.059749
[0m14:43:52.060067 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:43:52.062899 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:43:52.063165 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.064068 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:43:51.957857 => 14:43:52.063973
[0m14:43:52.064282 [debug] [Thread-3 (]: On model.maker_warehouse.customers_dim: Close
[0m14:43:52.064473 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.064922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445cc50>]}
[0m14:43:52.065238 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:43:52.065595 [info ] [Thread-3 (]: 3 of 14 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:43:52.066227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:52.066542 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:43:52.066928 [debug] [Thread-3 (]: Began running node model.maker_warehouse.movies
[0m14:43:52.068026 [info ] [Thread-3 (]: 7 of 14 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:43:52.068741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.movies)
[0m14:43:52.068987 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.movies
[0m14:43:52.070997 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:43:52.071585 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (compile): 14:43:52.069125 => 14:43:52.071484
[0m14:43:52.071782 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.movies
[0m14:43:52.074561 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:43:52.074804 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.075194 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.075476 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:43:52.075671 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.076012 [debug] [Thread-3 (]: On model.maker_warehouse.movies: BEGIN
[0m14:43:52.076202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:43:52.079600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.079905 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:52.080097 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.081843 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.082116 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:43:52.082622 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:43:52.087003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.089723 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.090147 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:43:52.092318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.093200 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.094978 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:43:52.095318 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.095510 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.095711 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:43:52.095935 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:43:52.098363 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.102088 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:43:52.102417 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:43:52.111474 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:52.112962 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:43:52.043306 => 14:43:52.112862
[0m14:43:52.113180 [debug] [Thread-2 (]: On model.maker_warehouse.mac_test: Close
[0m14:43:52.114059 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104615150>]}
[0m14:43:52.114449 [info ] [Thread-2 (]: 5 of 14 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:43:52.114803 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.mac_test
[0m14:43:52.115038 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:43:52.115762 [info ] [Thread-2 (]: 8 of 14 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:43:52.117096 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.salary_dim)
[0m14:43:52.117492 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:43:52.119237 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:43:52.119901 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:43:52.117622 => 14:43:52.119735
[0m14:43:52.120103 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:43:52.122928 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:43:52.123498 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.123692 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:43:52.123868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:52.137989 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.138322 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.138606 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:43:52.178365 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:43:52.180674 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.180932 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:43:52.182847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.184682 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.184929 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:43:52.186404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.188470 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:43:52.188731 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.188915 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:43:52.213906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.215518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:43:52.215720 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:43:52.223130 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.224096 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:43:52.120220 => 14:43:52.223998
[0m14:43:52.224302 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:43:52.224709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461a350>]}
[0m14:43:52.225015 [info ] [Thread-2 (]: 8 of 14 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.11s]
[0m14:43:52.225341 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:43:52.225552 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:43:52.225852 [info ] [Thread-2 (]: 9 of 14 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:43:52.226304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:43:52.226483 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:43:52.228068 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:43:52.228529 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:43:52.226607 => 14:43:52.228434
[0m14:43:52.228710 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:43:52.231352 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:43:52.231967 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.232167 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:43:52.232337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:52.247479 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.247999 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.248993 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:43:52.259048 [debug] [Thread-4 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:43:52.261582 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:52.261882 [debug] [Thread-4 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:43:52.264319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.269248 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:52.269539 [debug] [Thread-4 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:43:52.270962 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.272355 [debug] [Thread-4 (]: On model.maker_warehouse.genres: COMMIT
[0m14:43:52.272559 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:52.272728 [debug] [Thread-4 (]: On model.maker_warehouse.genres: COMMIT
[0m14:43:52.319644 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.321188 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:43:52.321387 [debug] [Thread-4 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:43:52.325685 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.326565 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.genres (execute): 14:43:51.955646 => 14:43:52.326475
[0m14:43:52.326762 [debug] [Thread-4 (]: On model.maker_warehouse.genres: Close
[0m14:43:52.327140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e2ad0>]}
[0m14:43:52.327435 [info ] [Thread-4 (]: 4 of 14 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.41s]
[0m14:43:52.327754 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.genres
[0m14:43:52.328086 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:43:52.328662 [info ] [Thread-4 (]: 10 of 14 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:43:52.329504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:43:52.329732 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:43:52.331273 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.333518 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:43:52.329866 => 14:43:52.333330
[0m14:43:52.333810 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:43:52.336452 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.336909 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.337086 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:43:52.337244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:43:52.346943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.347299 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.347494 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:43:52.357596 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:43:52.359226 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.359440 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:43:52.366097 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.367924 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.368145 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:43:52.369359 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.370772 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:43:52.370978 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.371146 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:43:52.375794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.378046 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:43:52.378286 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:43:52.385571 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.386955 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:43:52.333932 => 14:43:52.386852
[0m14:43:52.387173 [debug] [Thread-4 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:43:52.387575 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104536c10>]}
[0m14:43:52.387877 [info ] [Thread-4 (]: 10 of 14 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.06s]
[0m14:43:52.388200 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:43:52.503310 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:43:52.505085 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.505278 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:43:52.506494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.507942 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.508127 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:43:52.508983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.510420 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m14:43:52.510613 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.510779 [debug] [Thread-3 (]: On model.maker_warehouse.movies: COMMIT
[0m14:43:52.520830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.524034 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:43:52.524285 [debug] [Thread-3 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:43:52.529449 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.531541 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.movies (execute): 14:43:52.071941 => 14:43:52.531249
[0m14:43:52.531861 [debug] [Thread-3 (]: On model.maker_warehouse.movies: Close
[0m14:43:52.532271 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046135d0>]}
[0m14:43:52.532576 [info ] [Thread-3 (]: 7 of 14 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.46s]
[0m14:43:52.532902 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.movies
[0m14:43:52.731243 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 0.0 seconds
[0m14:43:52.735808 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.736556 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:43:52.738413 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.742857 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.743434 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:43:52.744761 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.746214 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:43:52.746418 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.746592 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:43:52.758382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.761888 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:43:52.762178 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:43:52.764178 [debug] [Thread-1 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:43:52.765790 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.766002 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:43:52.768055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.771749 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.772041 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:43:52.773162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:52.773354 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.774659 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:43:52.775405 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:43:52.228827 => 14:43:52.775311
[0m14:43:52.775603 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.775805 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:43:52.776008 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:43:52.776387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459b010>]}
[0m14:43:52.776727 [info ] [Thread-2 (]: 9 of 14 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.55s]
[0m14:43:52.777334 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:43:52.778338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:52.780238 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:43:52.780525 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:43:52.832759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:52.836540 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:43:52.060193 => 14:43:52.836161
[0m14:43:52.837290 [debug] [Thread-1 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:43:52.838429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f0090>]}
[0m14:43:52.839259 [info ] [Thread-1 (]: 6 of 14 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.78s]
[0m14:43:52.839805 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:43:52.840329 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:43:52.840516 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:43:52.840745 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:43:52.841116 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:43:52.840947 [info ] [Thread-4 (]: 11 of 14 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:43:52.841571 [info ] [Thread-3 (]: 12 of 14 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:43:52.841965 [info ] [Thread-2 (]: 13 of 14 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:43:52.842267 [info ] [Thread-1 (]: 14 of 14 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:43:52.842957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:43:52.843298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:43:52.843578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:43:52.843842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:43:52.844014 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:43:52.844172 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:43:52.844321 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:43:52.844469 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:43:52.846176 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:43:52.847518 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:52.849047 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:43:52.850727 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:43:52.851874 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:43:52.846316 => 14:43:52.851751
[0m14:43:52.852091 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:43:52.849223 => 14:43:52.851989
[0m14:43:52.852298 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:43:52.844579 => 14:43:52.852200
[0m14:43:52.852487 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:43:52.847670 => 14:43:52.852404
[0m14:43:52.852676 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:43:52.852877 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:43:52.853069 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:43:52.853251 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:43:52.855619 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:52.858889 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:43:52.861240 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:43:52.863423 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:43:52.863893 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:52.864110 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:52.864344 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:52.864529 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:43:52.864719 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:43:52.864899 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:43:52.865070 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:52.865261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:43:52.865444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:52.865612 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:43:52.865804 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:43:52.866242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:52.882117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.882606 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.882815 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.883148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:52.883440 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:52.883733 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:52.883955 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:52.884172 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:52.884397 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:43:52.884654 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:43:52.884885 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:43:52.885094 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:43:53.172055 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:43:53.177115 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:53.177421 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:43:53.178878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.180665 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:53.180965 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:43:53.182428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.185634 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:43:53.186109 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:43:53.186565 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:53.189520 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:53.189934 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:43:53.190321 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:43:53.192640 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.194636 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:53.194897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:53.195261 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:43:53.197323 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:43:53.198045 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:43:53.199174 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.201699 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:43:53.202181 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:53.202444 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:43:53.203785 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:53.205113 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:43:52.861393 => 14:43:53.204872
[0m14:43:53.205450 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:53.205659 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:43:53.207357 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:43:53.207849 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:43:53.208416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466ce50>]}
[0m14:43:53.209146 [info ] [Thread-2 (]: 13 of 14 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.36s]
[0m14:43:53.209756 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:43:53.215308 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:53.216399 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:43:52.853382 => 14:43:53.216299
[0m14:43:53.216606 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:43:53.217006 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460b150>]}
[0m14:43:53.217394 [info ] [Thread-3 (]: 12 of 14 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.37s]
[0m14:43:53.217801 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:43:53.592909 [debug] [Thread-4 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:43:53.599144 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:53.599978 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:43:53.602028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.605849 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:53.606346 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:43:53.607231 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.608847 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:43:53.609066 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:53.609240 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:43:53.613142 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:53.614598 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:43:53.614805 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:43:53.618009 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:53.619211 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:43:52.859107 => 14:43:53.618874
[0m14:43:53.619765 [debug] [Thread-4 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:43:53.620484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460be90>]}
[0m14:43:53.620857 [info ] [Thread-4 (]: 11 of 14 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.78s]
[0m14:43:53.621294 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:43:53.843330 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:43:53.847783 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:53.848350 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:43:53.849866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.853395 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:53.853682 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:43:53.854401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:53.855665 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:43:53.855847 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:53.855999 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:43:53.859878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:53.862322 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:43:53.862504 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:43:53.876466 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:53.878995 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:43:52.855778 => 14:43:53.878753
[0m14:43:53.879485 [debug] [Thread-1 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:43:53.880413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c026bfb-6488-4682-b2c5-e8da1669bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468cb90>]}
[0m14:43:53.880971 [info ] [Thread-1 (]: 14 of 14 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.04s]
[0m14:43:53.881336 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:43:53.882674 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:53.882892 [debug] [MainThread]: On master: BEGIN
[0m14:43:53.883039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:53.891294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:53.891566 [debug] [MainThread]: On master: COMMIT
[0m14:43:53.891745 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:53.891899 [debug] [MainThread]: On master: COMMIT
[0m14:43:53.892531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:53.892668 [debug] [MainThread]: On master: Close
[0m14:43:53.893007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:53.893150 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:43:53.893269 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:43:53.893383 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:43:53.893492 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:43:53.893695 [info ] [MainThread]: 
[0m14:43:53.893917 [info ] [MainThread]: Finished running 13 table models, 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m14:43:53.895026 [debug] [MainThread]: Command end result
[0m14:43:53.898577 [info ] [MainThread]: 
[0m14:43:53.898834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:53.899097 [info ] [MainThread]: 
[0m14:43:53.899334 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m14:43:53.899908 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:53.899832 after 2.30 seconds
[0m14:43:53.900281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d204d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002ae7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003f5e90>]}
[0m14:43:53.900508 [debug] [MainThread]: Flushing usage events
[0m14:44:35.703630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9f10>]}


============================== 14:44:35.707312 | 04bff732-412f-4275-8b6d-85314d96076a ==============================
[0m14:44:35.707312 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:44:35.707661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:44:35.749922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d8f90>]}
[0m14:44:35.756874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048eb890>]}
[0m14:44:35.757230 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:44:35.766966 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:44:35.789807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:35.790198 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/customer_balances.sql
[0m14:44:35.802461 [debug] [MainThread]: 1699: static parser successfully parsed facts/customer_balances.sql
[0m14:44:35.832545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bdf90>]}
[0m14:44:35.836282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497f050>]}
[0m14:44:35.836497 [info ] [MainThread]: Found 14 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:44:35.836709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102685090>]}
[0m14:44:35.837871 [info ] [MainThread]: 
[0m14:44:35.838339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:35.839142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:44:35.844480 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:44:35.844745 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:44:35.844890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:35.925089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:44:35.926206 [debug] [ThreadPool]: On list_mydb: Close
[0m14:44:35.927591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:44:35.931262 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:44:35.931475 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:44:35.931648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:35.948571 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:44:35.948871 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:44:35.949106 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:44:35.957607 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:44:35.958807 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:44:35.959635 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:44:35.964291 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:35.964522 [debug] [MainThread]: On master: BEGIN
[0m14:44:35.964696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:35.974896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:35.975186 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:35.975472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:35.995867 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:44:35.997654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f700d0>]}
[0m14:44:35.998024 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:35.999024 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:35.999297 [debug] [MainThread]: On master: BEGIN
[0m14:44:36.000621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.000855 [debug] [MainThread]: On master: COMMIT
[0m14:44:36.001066 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:36.001262 [debug] [MainThread]: On master: COMMIT
[0m14:44:36.002041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.002293 [debug] [MainThread]: On master: Close
[0m14:44:36.002806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:36.003127 [info ] [MainThread]: 
[0m14:44:36.006485 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:44:36.006755 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:44:36.007000 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:44:36.007224 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:44:36.007497 [info ] [Thread-1 (]: 1 of 14 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:44:36.007878 [info ] [Thread-2 (]: 2 of 14 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:44:36.008239 [info ] [Thread-3 (]: 3 of 14 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:44:36.008635 [info ] [Thread-4 (]: 4 of 14 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:44:36.009166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:44:36.009642 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:44:36.010226 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:44:36.010660 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:44:36.010889 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:44:36.011110 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:44:36.011325 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:44:36.011530 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:44:36.013421 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:44:36.015716 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:44:36.017483 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:44:36.019331 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:44:36.020560 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:44:36.011685 => 14:44:36.020404
[0m14:44:36.020822 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:44:36.013602 => 14:44:36.020707
[0m14:44:36.021052 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:44:36.017693 => 14:44:36.020954
[0m14:44:36.021291 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:44:36.015917 => 14:44:36.021171
[0m14:44:36.021517 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:44:36.021734 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:44:36.021940 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:44:36.022131 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:44:36.044207 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:44:36.046519 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:44:36.055846 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:44:36.057979 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:44:36.058453 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.058714 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.058915 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.059127 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:44:36.059296 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.059453 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:44:36.059603 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:44:36.059774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:36.059934 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:44:36.060079 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:44:36.060229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:36.060447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:36.070983 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.071375 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.071587 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:44:36.073887 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.074345 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.074533 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:44:36.075438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.075650 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.075850 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:44:36.077548 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.077767 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:44:36.077987 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.081830 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.082119 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:44:36.082345 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:44:36.084152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.085897 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.086094 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:44:36.087161 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.097893 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:44:36.098203 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.098387 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:44:36.106654 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:44:36.108839 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.109231 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:44:36.111173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.112935 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.113163 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:44:36.114534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.119244 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:44:36.119529 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.119727 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:44:36.126761 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:44:36.128578 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.128852 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:44:36.130611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.132490 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.132734 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:44:36.134313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.135808 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:44:36.136038 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.136219 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:44:36.163201 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.166814 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:44:36.167029 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.167195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.167397 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:44:36.168665 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:44:36.169815 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:44:36.170065 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:44:36.170252 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:44:36.173724 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:44:36.174648 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:44:36.046680 => 14:44:36.174550
[0m14:44:36.174849 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:44:36.175263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b85d0>]}
[0m14:44:36.175593 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:44:36.175927 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:44:36.176565 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:44:36.177265 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.177043 [info ] [Thread-4 (]: 5 of 14 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:44:36.178384 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:44:36.044373 => 14:44:36.178288
[0m14:44:36.179005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:44:36.179332 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:44:36.179563 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.179970 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:44:36.180509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ad050>]}
[0m14:44:36.181460 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:44:36.022263 => 14:44:36.181326
[0m14:44:36.183261 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:44:36.183794 [info ] [Thread-2 (]: 2 of 14 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.17s]
[0m14:44:36.184215 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:44:36.184924 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:44:36.185826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105098a10>]}
[0m14:44:36.186106 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:44:36.181694 => 14:44:36.185972
[0m14:44:36.186365 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:44:36.186773 [info ] [Thread-1 (]: 1 of 14 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.18s]
[0m14:44:36.187112 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:44:36.187349 [info ] [Thread-2 (]: 6 of 14 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:44:36.187694 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:44:36.190521 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:44:36.190912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.movies)
[0m14:44:36.191161 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_dim
[0m14:44:36.191444 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:44:36.191880 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:36.191692 [info ] [Thread-1 (]: 7 of 14 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:44:36.193478 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:44:36.193683 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:44:36.194020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.salary_dim)
[0m14:44:36.194248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:36.194450 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:44:36.194732 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:44:36.192120 => 14:44:36.194639
[0m14:44:36.196318 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:44:36.196573 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:44:36.199071 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:44:36.199658 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.199920 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:44:36.194856 => 14:44:36.199792
[0m14:44:36.200125 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:44:36.200343 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:44:36.200591 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:36.203163 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:44:36.203894 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.204080 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:44:36.204246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:36.208667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.209241 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:36.209444 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:44:36.224753 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.225610 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.226083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.226297 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:44:36.226510 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.226763 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:44:36.254914 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:44:36.256865 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.257098 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:44:36.258563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.260252 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.260463 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:44:36.261866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.263347 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:44:36.263574 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.263766 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:44:36.270568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.274930 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:44:36.275482 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:44:36.283771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.284729 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:44:36.200724 => 14:44:36.284632
[0m14:44:36.284935 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: Close
[0m14:44:36.285340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038331d0>]}
[0m14:44:36.285636 [info ] [Thread-1 (]: 7 of 14 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.09s]
[0m14:44:36.285969 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:44:36.286426 [debug] [Thread-1 (]: Began running node model.maker_warehouse.users
[0m14:44:36.287233 [info ] [Thread-1 (]: 8 of 14 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:44:36.288084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:44:36.288320 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.users
[0m14:44:36.289937 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:44:36.290483 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (compile): 14:44:36.288450 => 14:44:36.290329
[0m14:44:36.290668 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.users
[0m14:44:36.293439 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:44:36.293955 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.294131 [debug] [Thread-1 (]: On model.maker_warehouse.users: BEGIN
[0m14:44:36.294672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:36.341108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.341951 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.342182 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:44:36.372978 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:44:36.374652 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.374857 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:44:36.376401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.378044 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.378244 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:44:36.379340 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.380606 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:44:36.380809 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.380981 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:44:36.444729 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.446387 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:44:36.446602 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:44:36.450749 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.451694 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:44:36.056012 => 14:44:36.451597
[0m14:44:36.451900 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:44:36.452298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519c110>]}
[0m14:44:36.452597 [info ] [Thread-3 (]: 3 of 14 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.44s]
[0m14:44:36.452915 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:44:36.453120 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:44:36.453351 [info ] [Thread-3 (]: 9 of 14 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:44:36.453816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:44:36.454021 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:44:36.455642 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:44:36.456547 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:44:36.454148 => 14:44:36.456086
[0m14:44:36.457166 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:44:36.460928 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:44:36.461599 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.461781 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:44:36.461946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:36.473662 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.474008 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.474208 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:44:36.483976 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:44:36.485678 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.485902 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:44:36.487188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.488801 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.488998 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:44:36.489897 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.491155 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:44:36.491347 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.491510 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:44:36.498647 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.500190 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:44:36.500421 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:44:36.505421 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.506299 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:44:36.457501 => 14:44:36.506205
[0m14:44:36.506497 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:44:36.506888 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f7110>]}
[0m14:44:36.507191 [info ] [Thread-3 (]: 9 of 14 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.05s]
[0m14:44:36.507508 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:44:36.507858 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:44:36.508245 [info ] [Thread-3 (]: 10 of 14 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:44:36.508662 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:44:36.508857 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:44:36.510621 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.511211 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:44:36.508977 => 14:44:36.511107
[0m14:44:36.511400 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:44:36.513827 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.514224 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.514397 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:44:36.514556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:36.525263 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:36.525686 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.525933 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:44:36.538439 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:44:36.540552 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.540820 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:44:36.543304 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.544974 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.545199 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:44:36.546347 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.548635 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:44:36.548879 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.549046 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:44:36.556635 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.558989 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:44:36.559275 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:44:36.563760 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.564623 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:44:36.511516 => 14:44:36.564531
[0m14:44:36.564816 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:44:36.565199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d46d0>]}
[0m14:44:36.565485 [info ] [Thread-3 (]: 10 of 14 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.06s]
[0m14:44:36.565796 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:44:36.660002 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:44:36.662063 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.662295 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:44:36.663958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.665680 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.665894 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:44:36.667329 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.668852 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:44:36.669064 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.669237 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:44:36.675180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.676712 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:44:36.676913 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:44:36.682536 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.683475 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:44:36.196780 => 14:44:36.683385
[0m14:44:36.683689 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:44:36.684187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a06d0>]}
[0m14:44:36.684527 [info ] [Thread-2 (]: 6 of 14 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.49s]
[0m14:44:36.685169 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:44:36.963780 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:44:36.968615 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.968954 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:44:36.970540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.972444 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.972694 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:44:36.974002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:36.975363 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:44:36.975554 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.975720 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:44:36.982449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:36.983985 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:44:36.984178 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:44:36.995439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:36.996480 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (execute): 14:44:36.290788 => 14:44:36.996359
[0m14:44:36.996690 [debug] [Thread-1 (]: On model.maker_warehouse.users: Close
[0m14:44:36.997237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ce410>]}
[0m14:44:36.997619 [info ] [Thread-1 (]: 8 of 14 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.71s]
[0m14:44:36.998077 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.users
[0m14:44:36.998717 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:44:37.000539 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:37.000874 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:44:37.002462 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.004209 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:37.004397 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:44:37.005120 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.006342 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:44:37.006523 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:37.006686 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:44:37.009622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:37.011124 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:44:37.011308 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:44:37.065550 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:37.066497 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:44:36.187832 => 14:44:37.066392
[0m14:44:37.066695 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:44:37.067089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497cfd0>]}
[0m14:44:37.067404 [info ] [Thread-4 (]: 5 of 14 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.89s]
[0m14:44:37.067790 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:44:37.068351 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:44:37.068582 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:44:37.068823 [info ] [Thread-3 (]: 11 of 14 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:44:37.069229 [info ] [Thread-2 (]: 12 of 14 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:44:37.069748 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:44:37.070207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:44:37.070402 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:44:37.070736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:44:37.070976 [info ] [Thread-1 (]: 13 of 14 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:44:37.071217 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:44:37.071441 [info ] [Thread-4 (]: 14 of 14 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:44:37.071686 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:44:37.072007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:44:37.073918 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:44:37.074256 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:44:37.075702 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.075894 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:44:37.076119 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:44:37.077495 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:44:37.078753 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:44:37.078977 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:44:37.072145 => 14:44:37.078880
[0m14:44:37.079212 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:44:37.074399 => 14:44:37.079122
[0m14:44:37.079453 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:44:37.076305 => 14:44:37.079367
[0m14:44:37.079627 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:44:37.079792 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:44:37.079973 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:44:37.077620 => 14:44:37.079892
[0m14:44:37.080138 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:44:37.082311 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:44:37.085529 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.085800 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:44:37.088131 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:44:37.090461 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:44:37.090674 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.090854 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.091165 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:44:37.091370 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.091511 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:44:37.091659 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:37.091820 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:37.091976 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:44:37.092140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:37.092307 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:44:37.092539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:37.092740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:37.105505 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:37.105991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:37.106264 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:37.106701 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.106967 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:44:37.107211 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:44:37.110081 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:37.110359 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.110557 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:44:37.110783 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:37.110952 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.111381 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:44:37.463702 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:44:37.470261 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.470917 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:44:37.472637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.475597 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.475868 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:44:37.476077 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:44:37.477883 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.478109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.478342 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:44:37.479836 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:44:37.480158 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.480321 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:44:37.481449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.483436 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.483670 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:44:37.483915 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:37.485685 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:44:37.485922 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:44:37.486138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.487880 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:44:37.488110 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.488276 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:44:37.489856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:37.491505 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:44:37.491762 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:44:37.494261 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:37.495208 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:44:37.082447 => 14:44:37.495102
[0m14:44:37.495409 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:44:37.495911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051251d0>]}
[0m14:44:37.496294 [info ] [Thread-2 (]: 12 of 14 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.43s]
[0m14:44:37.496773 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:44:37.499723 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:37.501063 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:44:37.085950 => 14:44:37.500965
[0m14:44:37.501288 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:44:37.501738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e7ed0>]}
[0m14:44:37.502058 [info ] [Thread-1 (]: 13 of 14 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.43s]
[0m14:44:37.502552 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:44:37.892131 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:44:37.898038 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.898641 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:44:37.900161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.903592 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.903899 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:44:37.904637 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:37.905895 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:44:37.906087 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.906245 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:44:37.913898 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:37.917188 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:44:37.917440 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:44:37.920092 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:37.920925 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:44:37.080256 => 14:44:37.920828
[0m14:44:37.921116 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:44:37.921495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510f6d0>]}
[0m14:44:37.921797 [info ] [Thread-3 (]: 11 of 14 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.85s]
[0m14:44:37.922112 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:44:38.097517 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:44:38.105283 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:38.106999 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:44:38.109863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:38.111514 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:38.111700 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:44:38.112682 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:38.114873 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:44:38.115040 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:38.115188 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:44:38.120713 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:38.121942 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:44:38.122108 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:44:38.137342 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:44:38.139484 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:44:37.088412 => 14:44:38.139241
[0m14:44:38.139976 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:44:38.140954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff732-412f-4275-8b6d-85314d96076a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105194750>]}
[0m14:44:38.141606 [info ] [Thread-4 (]: 14 of 14 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.07s]
[0m14:44:38.142037 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:44:38.143223 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:38.143427 [debug] [MainThread]: On master: BEGIN
[0m14:44:38.143567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:38.152103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:38.152420 [debug] [MainThread]: On master: COMMIT
[0m14:44:38.152557 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:38.152678 [debug] [MainThread]: On master: COMMIT
[0m14:44:38.153224 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:38.153417 [debug] [MainThread]: On master: Close
[0m14:44:38.153779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:38.153921 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:44:38.154042 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:44:38.154159 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:44:38.154269 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:44:38.154467 [info ] [MainThread]: 
[0m14:44:38.154682 [info ] [MainThread]: Finished running 1 view model, 13 table models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m14:44:38.155808 [debug] [MainThread]: Command end result
[0m14:44:38.159701 [info ] [MainThread]: 
[0m14:44:38.159957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:38.160160 [info ] [MainThread]: 
[0m14:44:38.160397 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m14:44:38.160848 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:38.160801 after 2.47 seconds
[0m14:44:38.161071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e54690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f9fb90>]}
[0m14:44:38.161246 [debug] [MainThread]: Flushing usage events
[0m14:45:13.980987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e02110>]}


============================== 14:45:13.984696 | c584cd94-6c42-451f-b1e8-70e4ff88fb79 ==============================
[0m14:45:13.984696 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:45:13.985040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:45:14.032129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e01910>]}
[0m14:45:14.039576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7b50>]}
[0m14:45:14.040158 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:45:14.050266 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:45:14.072631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:45:14.072981 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/customer_salary.sql
[0m14:45:14.084596 [debug] [MainThread]: 1699: static parser successfully parsed facts/customer_salary.sql
[0m14:45:14.113872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e11290>]}
[0m14:45:14.117684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846fb90>]}
[0m14:45:14.117904 [info ] [MainThread]: Found 15 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:45:14.118122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bad090>]}
[0m14:45:14.119291 [info ] [MainThread]: 
[0m14:45:14.119764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:14.120596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:45:14.125928 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:45:14.126190 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:45:14.126376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:14.210255 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:45:14.211515 [debug] [ThreadPool]: On list_mydb: Close
[0m14:45:14.213185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:45:14.217387 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:45:14.217637 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:45:14.217832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:14.228334 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.228631 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:45:14.228861 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:45:14.252537 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:45:14.253937 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:45:14.254822 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:45:14.260220 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:14.260510 [debug] [MainThread]: On master: BEGIN
[0m14:45:14.260721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:14.271345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.271701 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:14.272080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:14.297995 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:45:14.299812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea8890>]}
[0m14:45:14.300168 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:14.301110 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:14.301333 [debug] [MainThread]: On master: BEGIN
[0m14:45:14.302708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.302975 [debug] [MainThread]: On master: COMMIT
[0m14:45:14.303197 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:14.303399 [debug] [MainThread]: On master: COMMIT
[0m14:45:14.304267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.304570 [debug] [MainThread]: On master: Close
[0m14:45:14.305102 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:45:14.305484 [info ] [MainThread]: 
[0m14:45:14.308980 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:45:14.309254 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:45:14.309490 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:45:14.309728 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:45:14.310013 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:45:14.310387 [info ] [Thread-2 (]: 2 of 15 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:45:14.310749 [info ] [Thread-3 (]: 3 of 15 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:45:14.311098 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:45:14.311645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:45:14.312127 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:45:14.312706 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:45:14.313138 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:45:14.313366 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:45:14.313587 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:45:14.313804 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:45:14.314010 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:45:14.315968 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:45:14.318778 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:45:14.320754 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:45:14.322518 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:45:14.323713 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:45:14.320957 => 14:45:14.323584
[0m14:45:14.323965 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:45:14.316184 => 14:45:14.323847
[0m14:45:14.324197 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:45:14.314166 => 14:45:14.324094
[0m14:45:14.324416 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:45:14.319043 => 14:45:14.324316
[0m14:45:14.324629 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:45:14.324842 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:45:14.325044 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:45:14.325236 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:45:14.346483 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:45:14.357895 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:45:14.360117 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:45:14.362198 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:45:14.362872 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.363113 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:45:14.363318 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.363487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.363665 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:14.363828 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.363993 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:45:14.364161 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:45:14.364391 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:45:14.364550 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:14.364717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:14.364876 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:14.374751 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.375075 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.375283 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:45:14.376405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.376667 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.376867 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:45:14.380312 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.380606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.380844 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.381070 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.381310 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:45:14.381489 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:45:14.381692 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:45:14.385485 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.385775 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:45:14.387188 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.389014 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.389245 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:45:14.391065 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.401721 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:45:14.402001 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.402182 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:45:14.407631 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.411255 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:45:14.411508 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:45:14.411766 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:45:14.414249 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.414539 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:45:14.416140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.417986 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.418215 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:45:14.419489 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:45:14.419687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.420461 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:45:14.325375 => 14:45:14.420368
[0m14:45:14.423607 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:45:14.423848 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:45:14.424047 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.424260 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:45:14.424788 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108625750>]}
[0m14:45:14.425805 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:45:14.426780 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:45:14.427043 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:45:14.427530 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:45:14.429603 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.429935 [info ] [Thread-4 (]: 5 of 15 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:45:14.430939 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:45:14.431808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:45:14.432592 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:45:14.435179 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:45:14.435860 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:45:14.433251 => 14:45:14.435743
[0m14:45:14.436089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.436298 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:45:14.438433 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.441154 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:45:14.441451 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:45:14.442003 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:14.442192 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:45:14.442363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:14.444046 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.446182 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:45:14.446429 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.446614 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:45:14.461885 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.462306 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:14.462501 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:45:14.496204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.497965 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:45:14.498189 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.498397 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:45:14.499768 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:45:14.500080 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:45:14.508003 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.509108 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:45:14.346647 => 14:45:14.509001
[0m14:45:14.509333 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:45:14.509527 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.509951 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867a150>]}
[0m14:45:14.510742 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:45:14.358058 => 14:45:14.510643
[0m14:45:14.511632 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:45:14.511145 [info ] [Thread-2 (]: 2 of 15 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.20s]
[0m14:45:14.512308 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:45:14.512720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849d210>]}
[0m14:45:14.512969 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:45:14.513485 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.20s]
[0m14:45:14.514332 [info ] [Thread-2 (]: 6 of 15 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:45:14.515150 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:45:14.515592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.movies)
[0m14:45:14.515846 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_dim
[0m14:45:14.516105 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:45:14.516355 [info ] [Thread-1 (]: 7 of 15 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:45:14.518458 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:45:14.518932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.salary_dim)
[0m14:45:14.519204 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:45:14.520689 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:45:14.521082 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:45:14.516563 => 14:45:14.520963
[0m14:45:14.521281 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:45:14.521495 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:45:14.519344 => 14:45:14.521402
[0m14:45:14.523948 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:45:14.524173 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:45:14.526589 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:45:14.526927 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:14.527106 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:45:14.527274 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.527450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:14.527616 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:45:14.527855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:14.549047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.549883 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.550162 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:45:14.554035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.554366 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:14.554563 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:45:14.577042 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:45:14.578844 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.579617 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:45:14.582652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.585357 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.585965 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:45:14.588664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.592372 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:45:14.592702 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.592895 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:45:14.602522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.605822 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:45:14.606105 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:45:14.613397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.614368 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:45:14.524360 => 14:45:14.614271
[0m14:45:14.614576 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: Close
[0m14:45:14.614991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f41d0>]}
[0m14:45:14.615299 [info ] [Thread-1 (]: 7 of 15 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.10s]
[0m14:45:14.615636 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:45:14.615863 [debug] [Thread-1 (]: Began running node model.maker_warehouse.users
[0m14:45:14.616334 [info ] [Thread-1 (]: 8 of 15 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:45:14.616774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:45:14.616954 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.users
[0m14:45:14.618789 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:45:14.619347 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (compile): 14:45:14.617073 => 14:45:14.619241
[0m14:45:14.619541 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.users
[0m14:45:14.622213 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:45:14.622631 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:14.622818 [debug] [Thread-1 (]: On model.maker_warehouse.users: BEGIN
[0m14:45:14.622990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:14.637382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.638063 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:14.638404 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:45:14.658035 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:45:14.659850 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.660071 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:45:14.661319 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.662856 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.663050 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:45:14.664710 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.666071 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:45:14.666260 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.666419 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:45:14.714702 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.716182 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:45:14.716503 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:45:14.720653 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.721591 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:45:14.360266 => 14:45:14.721488
[0m14:45:14.721794 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:45:14.722195 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867ff50>]}
[0m14:45:14.722493 [info ] [Thread-3 (]: 3 of 15 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.41s]
[0m14:45:14.722819 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:45:14.723022 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:45:14.723616 [info ] [Thread-3 (]: 9 of 15 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:45:14.724809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:45:14.725287 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:45:14.726944 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:45:14.727594 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:45:14.725424 => 14:45:14.727489
[0m14:45:14.727782 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:45:14.730293 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:45:14.730718 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.730894 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:45:14.731052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:14.741878 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.742208 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.742402 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:45:14.750309 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:45:14.752123 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.752341 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:45:14.753604 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.755203 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.755403 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:45:14.756563 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.757932 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:45:14.758125 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.758290 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:45:14.766129 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.767690 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:45:14.767914 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:45:14.772284 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.773170 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:45:14.727902 => 14:45:14.773078
[0m14:45:14.773365 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:45:14.773751 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861c550>]}
[0m14:45:14.774041 [info ] [Thread-3 (]: 9 of 15 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.05s]
[0m14:45:14.774364 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:45:14.774641 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:45:14.774884 [info ] [Thread-3 (]: 10 of 15 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:45:14.776227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:45:14.776718 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:45:14.779623 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:45:14.780762 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:45:14.776872 => 14:45:14.780200
[0m14:45:14.781087 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:45:14.785555 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:45:14.786262 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:45:14.786475 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:45:14.786643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:14.796557 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.796903 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:45:14.797100 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:45:14.805911 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:45:14.807626 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:45:14.807834 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:45:14.808843 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.809991 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:45:14.810179 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:45:14.810342 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:45:14.852926 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.855883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:45:14.856122 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:45:14.858529 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.859631 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:45:14.781264 => 14:45:14.859533
[0m14:45:14.859834 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:45:14.860275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c70d0>]}
[0m14:45:14.860580 [info ] [Thread-3 (]: 10 of 15 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.08s]
[0m14:45:14.860905 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:45:14.861114 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:45:14.861596 [info ] [Thread-3 (]: 11 of 15 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:45:14.862036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:45:14.862233 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:45:14.863899 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.864674 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:45:14.862357 => 14:45:14.864272
[0m14:45:14.864979 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:45:14.868292 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.868901 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.869096 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:45:14.869408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:14.893878 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:14.894333 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.894810 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:45:14.927909 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:45:14.929981 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.930228 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:45:14.931616 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.933236 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.933474 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:45:14.934634 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.936227 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:45:14.936446 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.936625 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:45:14.944411 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:14.945953 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:45:14.946288 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:45:14.953356 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:14.954300 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:45:14.865117 => 14:45:14.954206
[0m14:45:14.954492 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:45:14.954700 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:45:14.956145 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:14.956568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108720d90>]}
[0m14:45:14.956798 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:45:14.957126 [info ] [Thread-3 (]: 11 of 15 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.09s]
[0m14:45:14.957815 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:45:14.959727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.961517 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:14.961722 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:45:14.962788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:14.964211 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:45:14.964404 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:14.964638 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:45:15.015090 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:15.016641 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:45:15.016843 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:45:15.025243 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:15.026186 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:45:14.521611 => 14:45:15.026095
[0m14:45:15.026396 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:45:15.026786 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852e850>]}
[0m14:45:15.027148 [info ] [Thread-2 (]: 6 of 15 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.51s]
[0m14:45:15.027540 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:45:15.175331 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:45:15.181852 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:15.182515 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:45:15.184444 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:45:15.184941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.188517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:15.190291 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:15.190507 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:45:15.190715 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:45:15.191732 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.191900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.193094 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:45:15.194472 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:15.194674 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:15.194866 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:45:15.195048 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:45:15.195830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.197065 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:45:15.197255 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:15.197419 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:45:15.202193 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:15.202385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:15.203691 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:45:15.205649 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:45:15.205827 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:45:15.205993 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:45:15.215692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:15.216705 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (execute): 14:45:14.619670 => 14:45:15.216603
[0m14:45:15.216920 [debug] [Thread-1 (]: On model.maker_warehouse.users: Close
[0m14:45:15.217327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108748f50>]}
[0m14:45:15.217639 [info ] [Thread-1 (]: 8 of 15 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.60s]
[0m14:45:15.217977 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.users
[0m14:45:15.265920 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:15.266815 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:45:14.438698 => 14:45:15.266727
[0m14:45:15.267000 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:45:15.267359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087483d0>]}
[0m14:45:15.267644 [info ] [Thread-4 (]: 5 of 15 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.84s]
[0m14:45:15.267956 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:45:15.268418 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:45:15.268601 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:45:15.268819 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:45:15.268973 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:45:15.269180 [info ] [Thread-3 (]: 12 of 15 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:45:15.269464 [info ] [Thread-2 (]: 13 of 15 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:45:15.269748 [info ] [Thread-1 (]: 14 of 15 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:45:15.270029 [info ] [Thread-4 (]: 15 of 15 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:45:15.270487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:45:15.270779 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:45:15.271050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:45:15.271386 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:45:15.271601 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:45:15.271772 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:45:15.271930 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:45:15.272094 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:45:15.273777 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:45:15.275060 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.276357 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:45:15.277533 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:45:15.277957 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:45:15.272207 => 14:45:15.277866
[0m14:45:15.278179 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:45:15.273913 => 14:45:15.278087
[0m14:45:15.278409 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:45:15.275188 => 14:45:15.278325
[0m14:45:15.278566 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:45:15.278761 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:45:15.278937 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:45:15.276485 => 14:45:15.278861
[0m14:45:15.279096 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:45:15.281287 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:45:15.283661 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.283931 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:45:15.286092 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:45:15.288413 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:45:15.288698 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.288871 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:15.289125 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:45:15.289294 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.289471 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:45:15.289623 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:15.289797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:15.289985 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:45:15.290155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:15.290326 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:45:15.290573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:15.290804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:15.304830 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:15.305151 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:15.305416 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:15.305668 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.305916 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:45:15.306134 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:45:15.306976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:15.307411 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.307635 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:45:15.313643 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:45:15.313918 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:15.314463 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:45:15.458548 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:45:15.463020 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.463613 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:45:15.465256 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.469239 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.469746 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:45:15.471093 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.472921 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:45:15.473182 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.473360 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:45:15.475453 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:15.477136 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:45:15.477381 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:45:15.481227 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:15.483332 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:45:15.281455 => 14:45:15.483084
[0m14:45:15.483690 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:45:15.484190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a6890>]}
[0m14:45:15.484603 [info ] [Thread-2 (]: 13 of 15 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.21s]
[0m14:45:15.485039 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:45:15.598863 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:45:15.603038 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.603670 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:45:15.605404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.609625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.609934 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:45:15.611028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:15.612640 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:45:15.612875 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.613050 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:45:15.615219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:15.617817 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:45:15.618079 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:45:15.622397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:15.623412 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:45:15.284072 => 14:45:15.623319
[0m14:45:15.623672 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:45:15.624059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849d350>]}
[0m14:45:15.624381 [info ] [Thread-1 (]: 14 of 15 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.35s]
[0m14:45:15.624981 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:45:16.028101 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:45:16.035880 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:16.036386 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:45:16.039088 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:16.041061 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:16.041305 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:45:16.042549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:16.044079 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:45:16.044374 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:16.044576 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:45:16.048979 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:16.050622 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:45:16.051374 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:45:16.056972 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:16.058200 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:45:15.279211 => 14:45:16.058029
[0m14:45:16.058432 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:45:16.059176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ab390>]}
[0m14:45:16.059756 [info ] [Thread-3 (]: 12 of 15 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.79s]
[0m14:45:16.060203 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:45:16.225148 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:45:16.231804 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:16.232390 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:45:16.233970 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:16.236749 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:16.237155 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:45:16.237958 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:45:16.239149 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:45:16.239317 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:16.239476 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:45:16.244393 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:45:16.245838 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:45:16.246120 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:45:16.264204 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:45:16.267498 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:45:15.286333 => 14:45:16.267113
[0m14:45:16.268236 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:45:16.269953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c584cd94-6c42-451f-b1e8-70e4ff88fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108671650>]}
[0m14:45:16.270931 [info ] [Thread-4 (]: 15 of 15 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.00s]
[0m14:45:16.271501 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:45:16.274292 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:16.274602 [debug] [MainThread]: On master: BEGIN
[0m14:45:16.274946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:16.291974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:45:16.292463 [debug] [MainThread]: On master: COMMIT
[0m14:45:16.292785 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:16.293365 [debug] [MainThread]: On master: COMMIT
[0m14:45:16.294335 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:45:16.294533 [debug] [MainThread]: On master: Close
[0m14:45:16.294910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:16.295050 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:45:16.295197 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:45:16.295357 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:45:16.295555 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:45:16.295798 [info ] [MainThread]: 
[0m14:45:16.296047 [info ] [MainThread]: Finished running 1 view model, 14 table models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m14:45:16.297476 [debug] [MainThread]: Command end result
[0m14:45:16.302423 [info ] [MainThread]: 
[0m14:45:16.302753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:16.302983 [info ] [MainThread]: 
[0m14:45:16.303216 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m14:45:16.303716 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:16.303658 after 2.34 seconds
[0m14:45:16.303959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107deb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c5e10>]}
[0m14:45:16.304148 [debug] [MainThread]: Flushing usage events
[0m14:47:55.668370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a61290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a68410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a57f90>]}


============================== 14:47:55.671967 | c432fbd0-898b-4452-a5af-424550ba6145 ==============================
[0m14:47:55.671967 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:47:55.672364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:47:55.714461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92090>]}
[0m14:47:55.721715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92090>]}
[0m14:47:55.722126 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:47:55.733076 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:47:55.757091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:47:55.757441 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_avg_balance_by_geography.sql
[0m14:47:55.768266 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_avg_balance_by_geography.sql
[0m14:47:55.798247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a93650>]}
[0m14:47:55.802171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b35b90>]}
[0m14:47:55.802385 [info ] [MainThread]: Found 16 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:47:55.802596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102825090>]}
[0m14:47:55.803745 [info ] [MainThread]: 
[0m14:47:55.804248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:55.805124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:47:55.810633 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:47:55.810865 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:47:55.811003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:55.881299 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:47:55.882446 [debug] [ThreadPool]: On list_mydb: Close
[0m14:47:55.884049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:47:55.888640 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:47:55.888971 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:47:55.889148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:55.899200 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:47:55.899518 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:47:55.899750 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:47:55.910443 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m14:47:55.911715 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:47:55.912613 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:47:55.917744 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:55.918043 [debug] [MainThread]: On master: BEGIN
[0m14:47:55.918221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:55.928082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:47:55.928430 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:55.928796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:47:55.947723 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:47:55.949365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a61410>]}
[0m14:47:55.949697 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:55.950555 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:55.950784 [debug] [MainThread]: On master: BEGIN
[0m14:47:55.951996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:47:55.952195 [debug] [MainThread]: On master: COMMIT
[0m14:47:55.952410 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:55.952606 [debug] [MainThread]: On master: COMMIT
[0m14:47:55.953363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:47:55.953620 [debug] [MainThread]: On master: Close
[0m14:47:55.954089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:47:55.954376 [info ] [MainThread]: 
[0m14:47:55.957546 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:47:55.957825 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:47:55.958072 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:47:55.958311 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:47:55.958641 [info ] [Thread-1 (]: 1 of 16 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:47:55.959035 [info ] [Thread-2 (]: 2 of 16 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:47:55.959438 [info ] [Thread-3 (]: 3 of 16 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:47:55.959801 [info ] [Thread-4 (]: 4 of 16 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:47:55.960320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:47:55.960787 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:47:55.961225 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:47:55.961631 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:47:55.961865 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:47:55.962078 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:47:55.962281 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:47:55.962483 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:47:55.965135 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:47:55.967096 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:47:55.968645 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:47:55.970317 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:47:55.971495 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:47:55.968817 => 14:47:55.971366
[0m14:47:55.971755 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:47:55.967290 => 14:47:55.971640
[0m14:47:55.971983 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:47:55.962632 => 14:47:55.971883
[0m14:47:55.972196 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:47:55.965379 => 14:47:55.972103
[0m14:47:55.972398 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:47:55.972597 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:47:55.972780 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:47:55.972986 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:47:55.993579 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:47:56.004753 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:47:56.006932 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:47:56.009060 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:47:56.009516 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.009882 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.010045 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.010188 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:47:56.010334 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.010494 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:47:56.010645 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:47:56.010792 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:47:56.010937 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:47:56.011082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:56.011221 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:56.011458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:47:56.022943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.023335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.023713 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.023927 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.024282 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.024463 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.024698 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:47:56.024936 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.025138 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.025354 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:47:56.025608 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:47:56.025817 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:47:56.030993 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:47:56.035043 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.035314 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:47:56.036580 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.038409 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.038649 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:47:56.042389 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.053209 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:47:56.053551 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.053760 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:47:56.059124 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.063245 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:47:56.063513 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:47:56.068082 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:47:56.069867 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.070079 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:47:56.072262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.074231 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.074426 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:47:56.074600 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:47:56.074833 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:47:56.075627 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:47:55.973148 => 14:47:56.075532
[0m14:47:56.077123 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.077451 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:47:56.077694 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:47:56.078219 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105232a90>]}
[0m14:47:56.078635 [info ] [Thread-4 (]: 4 of 16 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:47:56.079226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.080364 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.080711 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:47:56.085065 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:47:56.086915 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.087198 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:47:56.087441 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.087636 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:47:56.087882 [info ] [Thread-4 (]: 5 of 16 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:47:56.088252 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:47:56.088717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:47:56.088964 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:47:56.091040 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:47:56.091268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.091433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.092854 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:47:56.094370 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:47:56.094622 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:47:56.089141 => 14:47:56.094498
[0m14:47:56.094826 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.095039 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:47:56.095255 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:47:56.095451 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:47:56.098153 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:47:56.098908 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.099115 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:47:56.099290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:47:56.100492 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.102710 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:47:56.103008 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:47:56.103960 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.104889 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:47:56.004925 => 14:47:56.104786
[0m14:47:56.105106 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:47:56.105517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22bd0>]}
[0m14:47:56.105837 [info ] [Thread-1 (]: 1 of 16 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.15s]
[0m14:47:56.106184 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:47:56.106400 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:47:56.106622 [info ] [Thread-1 (]: 6 of 16 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:47:56.107554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:47:56.107811 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:47:56.109754 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:47:56.110287 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:47:56.107946 => 14:47:56.110155
[0m14:47:56.110484 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:47:56.110668 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.113513 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:47:56.114653 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:47:56.007079 => 14:47:56.114543
[0m14:47:56.115278 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:47:56.115858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e45d0>]}
[0m14:47:56.116903 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.116244 [info ] [Thread-2 (]: 2 of 16 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.16s]
[0m14:47:56.118075 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.118336 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:47:56.118648 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:47:56.118862 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.119056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:56.119304 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:47:56.119609 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:47:56.120141 [info ] [Thread-2 (]: 7 of 16 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:47:56.121383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:47:56.122038 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:47:56.127117 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:47:56.128606 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:47:56.122303 => 14:47:56.128180
[0m14:47:56.129333 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:47:56.137652 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:47:56.139453 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.140035 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:47:56.140573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:47:56.145555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.145904 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.146101 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:47:56.168263 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.169101 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.169624 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:47:56.277905 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:47:56.282520 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.282929 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:47:56.286487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.288712 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.288962 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:47:56.293675 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.297509 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:47:56.298053 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.298517 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:47:56.305438 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.307119 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:47:56.307347 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:47:56.315168 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.316145 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:47:56.129868 => 14:47:56.316047
[0m14:47:56.316354 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:47:56.316762 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105371890>]}
[0m14:47:56.317067 [info ] [Thread-2 (]: 7 of 16 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.20s]
[0m14:47:56.317394 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:47:56.317608 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:47:56.318052 [info ] [Thread-2 (]: 8 of 16 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:47:56.318455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:47:56.318629 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:47:56.320254 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:47:56.320746 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:47:56.318746 => 14:47:56.320612
[0m14:47:56.320927 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:47:56.323381 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:47:56.323803 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.323973 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:47:56.324129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:47:56.328929 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:47:56.330777 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.331009 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:47:56.334299 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.335964 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.336166 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.336382 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:47:56.336555 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.336790 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:47:56.338343 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.340294 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:47:56.340748 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.340951 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:47:56.348932 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.351930 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:47:56.352199 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:47:56.363648 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.365221 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:47:55.993740 => 14:47:56.364948
[0m14:47:56.365806 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:47:56.366955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522dd90>]}
[0m14:47:56.367872 [info ] [Thread-3 (]: 3 of 16 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.41s]
[0m14:47:56.368843 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:47:56.369202 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:47:56.369767 [info ] [Thread-3 (]: 9 of 16 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:47:56.370890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:47:56.371489 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:47:56.374074 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:47:56.374621 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:47:56.372012 => 14:47:56.374486
[0m14:47:56.374814 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:47:56.377240 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:47:56.377645 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.377817 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:47:56.377974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:56.389323 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.389696 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.389899 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:47:56.402043 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:47:56.404577 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.405169 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:47:56.407435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.410618 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.410890 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:47:56.449223 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.450663 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:47:56.450873 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.451040 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:47:56.457339 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.458856 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:47:56.459060 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:47:56.463334 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.465029 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:47:56.374933 => 14:47:56.464763
[0m14:47:56.465612 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:47:56.466601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105231d10>]}
[0m14:47:56.467382 [info ] [Thread-3 (]: 9 of 16 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.10s]
[0m14:47:56.468450 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:47:56.468755 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:47:56.469064 [info ] [Thread-3 (]: 10 of 16 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:47:56.470158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:47:56.470912 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:47:56.472626 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:47:56.473137 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:47:56.471117 => 14:47:56.472996
[0m14:47:56.473327 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:47:56.479201 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:47:56.480175 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.480383 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:47:56.480546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:56.498418 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.498775 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.499108 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:47:56.506217 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:47:56.507839 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.508044 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:47:56.509290 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.510897 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.511097 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:47:56.511998 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.513277 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:47:56.513470 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.513637 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:47:56.519521 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.520997 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:47:56.521194 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:47:56.525549 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.526455 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:47:56.473445 => 14:47:56.526362
[0m14:47:56.526654 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:47:56.527037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b37790>]}
[0m14:47:56.527333 [info ] [Thread-3 (]: 10 of 16 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.06s]
[0m14:47:56.527649 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:47:56.527852 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:47:56.528498 [info ] [Thread-3 (]: 11 of 16 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:47:56.529734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:47:56.530380 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:47:56.532213 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.532686 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:47:56.530565 => 14:47:56.532584
[0m14:47:56.532876 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:47:56.535406 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.535822 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.536000 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:47:56.536162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:56.546046 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.546770 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.547123 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:47:56.601727 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:47:56.603494 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.603712 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:47:56.604886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.606313 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:47:56.606520 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.606692 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:47:56.616428 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.618543 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:47:56.618801 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:47:56.620806 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.621908 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:47:56.532992 => 14:47:56.621804
[0m14:47:56.622179 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:47:56.623323 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b35fd0>]}
[0m14:47:56.624026 [info ] [Thread-3 (]: 11 of 16 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.09s]
[0m14:47:56.624630 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:47:56.625175 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:47:56.625461 [info ] [Thread-3 (]: 12 of 16 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:47:56.627010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:47:56.627562 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:47:56.631241 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.632031 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:47:56.627767 => 14:47:56.631885
[0m14:47:56.632249 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:47:56.635247 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.635617 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:47:56.637299 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.637522 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.637732 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:47:56.637929 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:47:56.638215 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:56.640140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.641919 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.642148 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:47:56.643259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.644524 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:47:56.644721 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.644882 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:47:56.648754 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.649138 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.649352 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:47:56.651264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.652672 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:47:56.652887 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:47:56.658105 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.659152 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:47:56.110829 => 14:47:56.659061
[0m14:47:56.659320 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:47:56.659520 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:47:56.660898 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.661338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fb750>]}
[0m14:47:56.661637 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:47:56.662693 [info ] [Thread-1 (]: 6 of 16 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.55s]
[0m14:47:56.663422 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:47:56.666312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.668255 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.668501 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:47:56.670207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.672563 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:47:56.672865 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.673045 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:47:56.678270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.681144 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:47:56.681431 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:47:56.716059 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.717019 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:47:56.632373 => 14:47:56.716919
[0m14:47:56.717229 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:47:56.717630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a1a50>]}
[0m14:47:56.717939 [info ] [Thread-3 (]: 12 of 16 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.09s]
[0m14:47:56.718262 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:47:56.839363 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:47:56.844498 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.845076 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:47:56.847328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.850964 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.851265 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:47:56.852486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.853783 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:47:56.853970 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.854128 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:47:56.860385 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.864058 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:47:56.864325 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:47:56.865119 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:47:56.866832 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.867049 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:47:56.868251 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.870158 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.870384 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:47:56.871418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:56.872859 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:47:56.873074 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.873246 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:47:56.874471 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:56.876013 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:47:56.876206 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:47:56.876378 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.877319 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:47:56.321043 => 14:47:56.877226
[0m14:47:56.877597 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:47:56.878342 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105232490>]}
[0m14:47:56.878773 [info ] [Thread-2 (]: 8 of 16 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.56s]
[0m14:47:56.879710 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:47:56.942543 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:56.943529 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:47:56.095722 => 14:47:56.943435
[0m14:47:56.943725 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:47:56.944115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527b290>]}
[0m14:47:56.944419 [info ] [Thread-4 (]: 5 of 16 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.86s]
[0m14:47:56.944733 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:47:56.945317 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:47:56.945536 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:47:56.945736 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:47:56.945909 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:47:56.946151 [info ] [Thread-1 (]: 13 of 16 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:47:56.946510 [info ] [Thread-3 (]: 14 of 16 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:47:56.947028 [info ] [Thread-2 (]: 15 of 16 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:47:56.947403 [info ] [Thread-4 (]: 16 of 16 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:47:56.947923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_genre_views)
[0m14:47:56.948260 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:47:56.948560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:47:56.948890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:47:56.949156 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:47:56.949343 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:47:56.949525 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:47:56.949696 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:47:56.951295 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:47:56.952856 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:56.954281 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:47:56.955487 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:47:56.956042 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:47:56.949815 => 14:47:56.955940
[0m14:47:56.956239 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:47:56.951435 => 14:47:56.956160
[0m14:47:56.956454 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:47:56.954430 => 14:47:56.956359
[0m14:47:56.956626 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:47:56.956819 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:47:56.953013 => 14:47:56.956727
[0m14:47:56.957117 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:47:56.957290 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:47:56.959506 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:47:56.959696 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:47:56.961856 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:56.964150 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:47:56.967374 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:47:56.967732 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:56.967950 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:56.968130 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:47:56.968311 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:56.968514 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:47:56.968679 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:56.968854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:56.969024 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:47:56.969189 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:47:56.969356 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:47:56.969590 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:47:56.969806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:47:56.990156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.990419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.990689 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:56.990902 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:56.991103 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:47:56.991275 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.991475 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:47:56.991728 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:56.991994 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:47:56.993109 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:47:56.993340 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:56.993532 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:47:57.303350 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:47:57.308906 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:57.309474 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:47:57.311517 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.313794 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:57.314163 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:47:57.315797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.317681 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:47:57.317922 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:57.318098 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:47:57.320978 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:57.322612 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:47:57.322984 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:47:57.329654 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:57.330867 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:47:56.959828 => 14:47:57.330739
[0m14:47:57.331093 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:47:57.331582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378150>]}
[0m14:47:57.332009 [info ] [Thread-3 (]: 14 of 16 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.38s]
[0m14:47:57.332743 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:47:57.338075 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:47:57.339736 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:57.339944 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:47:57.341282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.343321 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:57.343581 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:47:57.344872 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.346714 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:47:57.346986 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:57.347156 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:47:57.348676 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:57.350407 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:47:57.350668 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:47:57.355277 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:57.356270 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:47:56.964452 => 14:47:57.356176
[0m14:47:57.356470 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:47:57.356916 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a47d0>]}
[0m14:47:57.357239 [info ] [Thread-2 (]: 15 of 16 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.41s]
[0m14:47:57.357567 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:47:57.640510 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:47:57.646592 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:57.647311 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:47:57.649731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.653738 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:57.654033 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:47:57.655353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.656842 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:47:57.657029 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:57.657187 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:47:57.694141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:57.698129 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:47:57.698715 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:47:57.703407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:57.705741 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:47:56.957410 => 14:47:57.705469
[0m14:47:57.706249 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:47:57.707180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a63050>]}
[0m14:47:57.707809 [info ] [Thread-1 (]: 13 of 16 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.76s]
[0m14:47:57.708235 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:47:57.943866 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:47:57.950193 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:57.950875 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:47:57.952348 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.955396 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:57.955647 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:47:57.956468 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:47:57.957699 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:47:57.957882 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:57.958037 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:47:57.961412 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:47:57.962722 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:47:57.962900 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:47:57.990504 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:47:57.993591 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:47:56.961999 => 14:47:57.993269
[0m14:47:57.994491 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:47:57.996055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c432fbd0-898b-4452-a5af-424550ba6145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105304050>]}
[0m14:47:57.996437 [info ] [Thread-4 (]: 16 of 16 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.05s]
[0m14:47:57.996777 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:47:57.999091 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:57.999416 [debug] [MainThread]: On master: BEGIN
[0m14:47:57.999660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:58.010233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:47:58.010527 [debug] [MainThread]: On master: COMMIT
[0m14:47:58.010704 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:58.010876 [debug] [MainThread]: On master: COMMIT
[0m14:47:58.011364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:47:58.011524 [debug] [MainThread]: On master: Close
[0m14:47:58.011895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:58.012035 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:47:58.012160 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:47:58.012277 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:47:58.012390 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:47:58.012602 [info ] [MainThread]: 
[0m14:47:58.012826 [info ] [MainThread]: Finished running 1 view model, 15 table models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m14:47:58.014123 [debug] [MainThread]: Command end result
[0m14:47:58.019039 [info ] [MainThread]: 
[0m14:47:58.019296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:58.019536 [info ] [MainThread]: 
[0m14:47:58.019809 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m14:47:58.020307 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:58.020246 after 2.37 seconds
[0m14:47:58.020541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ff4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10113de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10113ddd0>]}
[0m14:47:58.020725 [debug] [MainThread]: Flushing usage events
[0m14:49:23.023159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db6050>]}


============================== 14:49:23.026742 | f0c3c06b-3ff5-4336-a051-d970f4b5002a ==============================
[0m14:49:23.026742 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:49:23.027136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:49:23.068637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ddebd0>]}
[0m14:49:23.075583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102881c90>]}
[0m14:49:23.075982 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:49:23.086831 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:49:23.112352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:49:23.112722 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_exited_by_card_type.sql
[0m14:49:23.124601 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_exited_by_card_type.sql
[0m14:49:23.154282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da48d0>]}
[0m14:49:23.158194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e7bcd0>]}
[0m14:49:23.158417 [info ] [MainThread]: Found 17 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:49:23.158637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b61090>]}
[0m14:49:23.159796 [info ] [MainThread]: 
[0m14:49:23.160238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:23.161091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:49:23.166520 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:49:23.166753 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:49:23.166895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:23.250173 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:49:23.251303 [debug] [ThreadPool]: On list_mydb: Close
[0m14:49:23.252912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:49:23.257017 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:49:23.257272 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:49:23.257460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:23.268737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.269054 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:49:23.269284 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:49:23.283566 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m14:49:23.284834 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:49:23.285684 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:49:23.290607 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:23.290857 [debug] [MainThread]: On master: BEGIN
[0m14:49:23.291042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:23.302761 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.303043 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:23.303329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:23.324517 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:49:23.326307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6cb50>]}
[0m14:49:23.326674 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:23.327565 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:23.327857 [debug] [MainThread]: On master: BEGIN
[0m14:49:23.329310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.329611 [debug] [MainThread]: On master: COMMIT
[0m14:49:23.329868 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:23.330090 [debug] [MainThread]: On master: COMMIT
[0m14:49:23.330888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.331101 [debug] [MainThread]: On master: Close
[0m14:49:23.331574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:23.331854 [info ] [MainThread]: 
[0m14:49:23.334941 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:49:23.335206 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:49:23.335441 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:49:23.335667 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:49:23.335937 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:49:23.336321 [info ] [Thread-2 (]: 2 of 17 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:49:23.336679 [info ] [Thread-3 (]: 3 of 17 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:49:23.337086 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:49:23.337657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:49:23.338139 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:49:23.338568 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:49:23.338983 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:49:23.339209 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:49:23.339420 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:49:23.339622 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:49:23.339819 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:49:23.342333 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:49:23.344145 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:49:23.345833 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:49:23.347701 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:49:23.349158 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:49:23.339970 => 14:49:23.349002
[0m14:49:23.349425 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:49:23.346032 => 14:49:23.349310
[0m14:49:23.349662 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:49:23.344332 => 14:49:23.349554
[0m14:49:23.349905 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:49:23.342530 => 14:49:23.349802
[0m14:49:23.350098 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:49:23.350302 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:49:23.350493 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:49:23.350708 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:49:23.373260 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:49:23.382490 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:49:23.384787 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:49:23.386899 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:49:23.387324 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.387514 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.387797 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:49:23.387958 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.388122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.388281 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:49:23.388436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:23.388588 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:49:23.388733 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:49:23.388875 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:23.389108 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:23.389264 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:49:23.397629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.398047 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.398251 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:49:23.399133 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.399341 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.399527 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:49:23.401173 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.401560 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.401768 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:49:23.402060 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.402261 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.402647 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:49:23.407406 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:49:23.411621 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.411938 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:49:23.413558 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.415425 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.415651 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:49:23.416863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.427702 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:49:23.428038 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.428224 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:49:23.432423 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:49:23.435155 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.435407 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:49:23.437402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.439184 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.439407 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:49:23.440569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.444333 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:49:23.444619 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.444821 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:49:23.446267 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.449387 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:49:23.449623 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:49:23.449790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.449991 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:49:23.451504 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.452749 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:49:23.452995 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:49:23.453238 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:49:23.454915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.457554 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.457809 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:49:23.458040 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:49:23.458907 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:49:23.373404 => 14:49:23.458804
[0m14:49:23.459090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.459350 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:49:23.460169 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:49:23.350861 => 14:49:23.460080
[0m14:49:23.460341 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.460798 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104459750>]}
[0m14:49:23.460983 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:49:23.462327 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:49:23.462875 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:49:23.463502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ec350>]}
[0m14:49:23.463951 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.464675 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:49:23.465544 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:49:23.466576 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:49:23.466895 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:49:23.467664 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:49:23.468230 [info ] [Thread-4 (]: 5 of 17 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:49:23.469095 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:49:23.469645 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:49:23.469921 [info ] [Thread-1 (]: 6 of 17 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:49:23.470178 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.470362 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:49:23.470716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:49:23.472335 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:49:23.474040 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:49:23.474307 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:49:23.474521 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:49:23.476116 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:49:23.476489 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:49:23.472525 => 14:49:23.476382
[0m14:49:23.476803 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:49:23.479483 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:49:23.480335 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:23.480627 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:49:23.474715 => 14:49:23.480510
[0m14:49:23.480854 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:49:23.481073 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:49:23.481246 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:23.484768 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:49:23.485030 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.486169 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:49:23.384938 => 14:49:23.486061
[0m14:49:23.486395 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:49:23.486992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441ea10>]}
[0m14:49:23.487360 [info ] [Thread-2 (]: 2 of 17 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:49:23.488257 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:23.488747 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:49:23.489038 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:49:23.489398 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:49:23.490099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:23.490446 [info ] [Thread-2 (]: 7 of 17 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:49:23.491261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:49:23.491479 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:49:23.493297 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:49:23.493797 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:49:23.491611 => 14:49:23.493694
[0m14:49:23.493988 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:49:23.497679 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:49:23.499010 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.499304 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:49:23.499487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:23.501385 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.501794 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:23.502002 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:49:23.508873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.509550 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:23.509765 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:49:23.531424 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.531768 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.531969 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:49:23.555372 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:49:23.558426 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.558727 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:49:23.561269 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.565666 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.565963 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:49:23.567535 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.569437 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:49:23.569667 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.569834 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:49:23.584864 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.586564 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:49:23.586798 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:49:23.596075 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.597105 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:49:23.494112 => 14:49:23.597003
[0m14:49:23.597322 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:49:23.597741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104699550>]}
[0m14:49:23.598070 [info ] [Thread-2 (]: 7 of 17 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.11s]
[0m14:49:23.598413 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:49:23.598805 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:49:23.599483 [info ] [Thread-2 (]: 8 of 17 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:49:23.600262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:49:23.600955 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:49:23.604286 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:49:23.605113 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:49:23.601546 => 14:49:23.604988
[0m14:49:23.605337 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:49:23.608179 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:49:23.608690 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:23.608890 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:49:23.609065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:23.634606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.634948 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:23.635167 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:49:23.692404 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:49:23.694194 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.694396 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:49:23.696459 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.697986 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.698175 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:49:23.699441 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.700804 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:49:23.701016 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.701188 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:49:23.724069 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.726000 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:49:23.726222 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:49:23.734996 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.737323 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:49:23.382645 => 14:49:23.737074
[0m14:49:23.737829 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:49:23.738793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449c750>]}
[0m14:49:23.739580 [info ] [Thread-3 (]: 3 of 17 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.40s]
[0m14:49:23.740604 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:49:23.741445 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:49:23.742265 [info ] [Thread-3 (]: 9 of 17 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:49:23.743794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:49:23.744418 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:49:23.746415 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:49:23.747142 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:49:23.744574 => 14:49:23.747028
[0m14:49:23.747334 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:49:23.749887 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:49:23.750515 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.750691 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:49:23.750848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:23.760676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.761301 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.761524 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:49:23.773924 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:23.776254 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.776578 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:49:23.779599 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.781803 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.782077 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:49:23.783624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.785142 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:49:23.785351 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.785517 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:49:23.800740 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.802162 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:49:23.802476 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:49:23.807949 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.808844 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:49:23.747451 => 14:49:23.808753
[0m14:49:23.809042 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:49:23.809425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104458810>]}
[0m14:49:23.809717 [info ] [Thread-3 (]: 9 of 17 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.07s]
[0m14:49:23.810030 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:49:23.810235 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:49:23.810851 [info ] [Thread-3 (]: 10 of 17 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:49:23.811897 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:49:23.812125 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:49:23.813653 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:49:23.814110 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:49:23.812250 => 14:49:23.814010
[0m14:49:23.814289 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:49:23.816914 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:49:23.817369 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.817547 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:49:23.817708 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:23.834682 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.835424 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.835795 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:49:23.848597 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:23.852097 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.852395 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:49:23.854618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.858836 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.859410 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:49:23.863846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.866823 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:49:23.867122 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.867301 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:49:23.880857 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.882442 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:49:23.882647 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:49:23.888262 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.889160 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:49:23.814405 => 14:49:23.889066
[0m14:49:23.889355 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:49:23.889743 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c2590>]}
[0m14:49:23.890036 [info ] [Thread-3 (]: 10 of 17 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.08s]
[0m14:49:23.890359 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:49:23.890572 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:49:23.891189 [info ] [Thread-3 (]: 11 of 17 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:49:23.892006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:49:23.892216 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:49:23.893834 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.894733 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:49:23.892340 => 14:49:23.894626
[0m14:49:23.894921 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:49:23.897561 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.898013 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.898187 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:49:23.898345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:23.908349 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:23.908848 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.909058 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:49:23.935333 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:49:23.937196 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.937441 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:49:23.953352 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.955437 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.955681 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:49:23.957302 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.958692 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:49:23.958906 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.959100 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:49:23.976997 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:23.978757 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:49:23.979011 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:49:23.983233 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:49:23.985145 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:23.985393 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:49:23.987189 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:23.988111 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:49:23.895038 => 14:49:23.988013
[0m14:49:23.988294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.988494 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:49:23.989981 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:23.990471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104697090>]}
[0m14:49:23.990684 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:49:23.991011 [info ] [Thread-3 (]: 11 of 17 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.10s]
[0m14:49:23.991816 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:49:23.992072 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:49:23.993234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:23.992666 [info ] [Thread-3 (]: 12 of 17 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:49:23.995484 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:49:23.996215 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:49:23.996415 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:23.996603 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:49:23.996781 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:49:23.998348 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:23.998982 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:49:23.996902 => 14:49:23.998869
[0m14:49:23.999176 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:49:24.001759 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.002264 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.002483 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:49:24.002669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:24.010384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.011963 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:49:24.012199 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:49:24.022298 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.022636 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.023134 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:49:24.023640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.024882 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:49:23.481909 => 14:49:24.024783
[0m14:49:24.025097 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:49:24.025807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104431450>]}
[0m14:49:24.026153 [info ] [Thread-1 (]: 6 of 17 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.56s]
[0m14:49:24.027111 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:49:24.027484 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:49:24.027895 [info ] [Thread-1 (]: 13 of 17 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:49:24.029401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:49:24.030628 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:49:24.032767 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:49:24.033321 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:49:24.030924 => 14:49:24.033214
[0m14:49:24.033509 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:49:24.037684 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:49:24.038168 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:49:24.038385 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:49:24.038567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:24.048675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.049000 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:49:24.049332 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = TRUE
GROUP BY c.cardtype
  );
  
[0m14:49:24.049730 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:49:24.051513 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.051755 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:49:24.053562 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = boolean
LINE 19: WHERE b.exited = TRUE
                        ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m14:49:24.053959 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.054235 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: ROLLBACK
[0m14:49:24.055854 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.056120 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:49:24.056803 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:49:24.033628 => 14:49:24.056687
[0m14:49:24.057057 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:49:24.058122 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.060021 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:49:24.060318 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.060541 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:49:24.064466 [debug] [Thread-1 (]: Database Error in model sum_total_exited_by_card_type (models/facts/sum_total_exited_by_card_type.sql)
  operator does not exist: integer = boolean
  LINE 19: WHERE b.exited = TRUE
                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/maker_warehouse/models/facts/sum_total_exited_by_card_type.sql
[0m14:49:24.064827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463fd90>]}
[0m14:49:24.065171 [error] [Thread-1 (]: 13 of 17 ERROR creating sql table model dbt_warehouse.sum_total_exited_by_card_type  [[31mERROR[0m in 0.04s]
[0m14:49:24.065525 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:49:24.073626 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.075043 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:49:24.075260 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:49:24.089923 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.090890 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:49:23.999293 => 14:49:24.090792
[0m14:49:24.091100 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:49:24.091496 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104697a90>]}
[0m14:49:24.091802 [info ] [Thread-3 (]: 12 of 17 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.10s]
[0m14:49:24.092132 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:49:24.127084 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 0.0 seconds
[0m14:49:24.129234 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:24.129524 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:49:24.131025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.132922 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:24.133160 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:49:24.134375 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.135747 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:49:24.135949 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:24.136111 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:49:24.149537 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.151007 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:49:24.151197 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:49:24.160856 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.161728 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:49:23.605468 => 14:49:24.161641
[0m14:49:24.161917 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:49:24.162299 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104611a90>]}
[0m14:49:24.162586 [info ] [Thread-2 (]: 8 of 17 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.56s]
[0m14:49:24.162960 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:49:24.180545 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:49:24.182109 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:24.182285 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:49:24.183284 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.184746 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:24.184917 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:49:24.185685 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.186898 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:49:24.187077 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:24.187244 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:49:24.195935 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.197378 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:49:24.197554 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:49:24.242078 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.242974 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:49:23.476938 => 14:49:24.242886
[0m14:49:24.243155 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:49:24.243514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b5950>]}
[0m14:49:24.243804 [info ] [Thread-4 (]: 5 of 17 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.77s]
[0m14:49:24.244120 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:49:24.244660 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:49:24.244900 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:49:24.245490 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:49:24.245190 [info ] [Thread-1 (]: 14 of 17 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:49:24.245715 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:49:24.245934 [info ] [Thread-3 (]: 15 of 17 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:49:24.246199 [info ] [Thread-2 (]: 16 of 17 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:49:24.246602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_genre_views)
[0m14:49:24.246816 [info ] [Thread-4 (]: 17 of 17 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:49:24.247235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:49:24.247528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:49:24.247747 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:49:24.248129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:49:24.248344 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:49:24.248522 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:49:24.250259 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:49:24.250446 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:49:24.251719 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.253073 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:49:24.254404 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:49:24.254815 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:49:24.248638 => 14:49:24.254713
[0m14:49:24.255051 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:49:24.251849 => 14:49:24.254968
[0m14:49:24.255266 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:49:24.250561 => 14:49:24.255177
[0m14:49:24.255420 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:49:24.255607 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:49:24.255801 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:49:24.253279 => 14:49:24.255722
[0m14:49:24.255941 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:49:24.258193 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:49:24.261285 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:49:24.261539 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:49:24.263907 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.266529 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:49:24.266813 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.267005 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.267253 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:49:24.267438 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.267655 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:49:24.267823 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:24.267995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:24.268187 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:49:24.268366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:24.268536 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:49:24.268851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:24.269160 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:24.285967 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.286427 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.286654 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:49:24.288013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.288813 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:24.289022 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:49:24.296205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.296672 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.296977 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:49:24.315382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:24.315700 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.315891 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:49:24.596565 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:49:24.603675 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.604498 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:49:24.610592 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.614422 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.614720 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:49:24.615989 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.616238 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:49:24.617701 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:49:24.619720 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.620150 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.620383 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:49:24.620580 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:49:24.622542 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.624528 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.624787 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:49:24.627077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.628611 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:49:24.628844 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.629015 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:49:24.629454 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.631209 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:49:24.631553 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.632036 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:49:24.635575 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:49:24.636425 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:49:24.643058 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.644114 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:49:24.261687 => 14:49:24.643975
[0m14:49:24.644346 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:49:24.644836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d4c50>]}
[0m14:49:24.645231 [info ] [Thread-3 (]: 15 of 17 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.40s]
[0m14:49:24.645568 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:49:24.646838 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.649279 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:49:24.258335 => 14:49:24.648983
[0m14:49:24.650058 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:49:24.651995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046452d0>]}
[0m14:49:24.652686 [info ] [Thread-2 (]: 16 of 17 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.40s]
[0m14:49:24.653043 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:49:24.962093 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:49:24.968861 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.969451 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:49:24.971032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.974005 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.974298 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:49:24.975137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:24.976553 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:49:24.976731 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.976887 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:49:24.989324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:24.991909 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:49:24.992296 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:49:24.995362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:24.997281 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:49:24.256056 => 14:49:24.997014
[0m14:49:24.997787 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:49:24.998767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e77e50>]}
[0m14:49:24.999275 [info ] [Thread-1 (]: 14 of 17 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.75s]
[0m14:49:24.999658 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:49:25.162229 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:49:25.168175 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:25.168790 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:49:25.170232 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:25.173169 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:25.173457 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:49:25.174199 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:25.175441 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:49:25.175621 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:25.175770 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:49:25.198408 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:25.204463 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:49:25.204758 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:49:25.221889 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:25.224579 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:49:24.264249 => 14:49:25.224295
[0m14:49:25.225123 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:49:25.225673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c3c06b-3ff5-4336-a051-d970f4b5002a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc7f10>]}
[0m14:49:25.226074 [info ] [Thread-4 (]: 17 of 17 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.98s]
[0m14:49:25.226543 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:49:25.229832 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:25.230183 [debug] [MainThread]: On master: BEGIN
[0m14:49:25.230536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:25.244582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:25.244966 [debug] [MainThread]: On master: COMMIT
[0m14:49:25.245130 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:25.245278 [debug] [MainThread]: On master: COMMIT
[0m14:49:25.246328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:25.246584 [debug] [MainThread]: On master: Close
[0m14:49:25.246960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:25.247105 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:49:25.247228 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:49:25.247346 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:49:25.247460 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:49:25.247708 [info ] [MainThread]: 
[0m14:49:25.247944 [info ] [MainThread]: Finished running 1 view model, 16 table models in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m14:49:25.249418 [debug] [MainThread]: Command end result
[0m14:49:25.254090 [info ] [MainThread]: 
[0m14:49:25.254364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:25.254554 [info ] [MainThread]: 
[0m14:49:25.254746 [error] [MainThread]: [33mDatabase Error in model sum_total_exited_by_card_type (models/facts/sum_total_exited_by_card_type.sql)[0m
[0m14:49:25.254918 [error] [MainThread]:   operator does not exist: integer = boolean
[0m14:49:25.255083 [error] [MainThread]:   LINE 19: WHERE b.exited = TRUE
[0m14:49:25.255244 [error] [MainThread]:                           ^
[0m14:49:25.255404 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m14:49:25.255632 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/sum_total_exited_by_card_type.sql
[0m14:49:25.255828 [info ] [MainThread]: 
[0m14:49:25.256049 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m14:49:25.256535 [debug] [MainThread]: Command `dbt run` failed at 14:49:25.256474 after 2.25 seconds
[0m14:49:25.256781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100479dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100479e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fc650>]}
[0m14:49:25.256964 [debug] [MainThread]: Flushing usage events
[0m14:51:22.363495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b79290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b91190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6ff90>]}


============================== 14:51:22.367088 | 167848b8-9dd7-4e15-a9f0-7960bc18deae ==============================
[0m14:51:22.367088 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:51:22.367485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:22.413640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b91e10>]}
[0m14:51:22.420609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ed0>]}
[0m14:51:22.420972 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:51:22.431580 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:51:22.454974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:22.455371 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/sum_total_exited_by_card_type.sql
[0m14:51:22.467244 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_exited_by_card_type.sql
[0m14:51:22.496736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108453850>]}
[0m14:51:22.500684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4c710>]}
[0m14:51:22.500908 [info ] [MainThread]: Found 17 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:51:22.501128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693d090>]}
[0m14:51:22.502358 [info ] [MainThread]: 
[0m14:51:22.502873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:22.503774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:51:22.509098 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:51:22.509331 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:51:22.509484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:22.592796 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:51:22.594035 [debug] [ThreadPool]: On list_mydb: Close
[0m14:51:22.595558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:51:22.599666 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:51:22.599905 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:51:22.600099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:22.613337 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.613643 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:51:22.613866 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:51:22.627591 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m14:51:22.628929 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:51:22.629883 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:51:22.635242 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.635489 [debug] [MainThread]: On master: BEGIN
[0m14:51:22.635679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:22.649896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.650233 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.650558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:22.674027 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:51:22.676136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e0f90>]}
[0m14:51:22.676556 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:22.677894 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.678223 [debug] [MainThread]: On master: BEGIN
[0m14:51:22.681000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.681300 [debug] [MainThread]: On master: COMMIT
[0m14:51:22.681562 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.681846 [debug] [MainThread]: On master: COMMIT
[0m14:51:22.683184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:51:22.683510 [debug] [MainThread]: On master: Close
[0m14:51:22.684103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:22.684457 [info ] [MainThread]: 
[0m14:51:22.688328 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:51:22.688671 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:51:22.688976 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:51:22.689221 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:51:22.689584 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:51:22.690048 [info ] [Thread-2 (]: 2 of 17 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:51:22.690469 [info ] [Thread-3 (]: 3 of 17 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:51:22.690889 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:51:22.691494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:51:22.691987 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:51:22.692456 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:51:22.692914 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:51:22.693167 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:51:22.693410 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:51:22.693637 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:51:22.693857 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:51:22.696847 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:51:22.699193 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:51:22.700878 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:51:22.702721 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:51:22.704003 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:51:22.697177 => 14:51:22.703861
[0m14:51:22.704288 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:51:22.699400 => 14:51:22.704159
[0m14:51:22.704531 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:51:22.701065 => 14:51:22.704428
[0m14:51:22.704811 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:51:22.694026 => 14:51:22.704679
[0m14:51:22.705038 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:51:22.705271 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:51:22.705483 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:51:22.705691 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:51:22.729079 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:51:22.731599 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:51:22.741027 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:51:22.743252 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:51:22.743752 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.743952 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:22.744143 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.744323 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:51:22.744509 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:51:22.744693 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.744849 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:51:22.745006 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:22.745158 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:22.745309 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:51:22.745456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:51:22.745766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:22.756275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.756625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.756903 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:51:22.757364 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.757817 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:22.758024 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.758322 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:51:22.758630 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.758945 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:51:22.759495 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.759761 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.760043 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:51:22.766132 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:51:22.770426 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.770755 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:51:22.772540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.774460 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.774703 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:51:22.776074 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.787538 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:51:22.787828 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:51:22.788103 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.790625 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.790846 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:51:22.791038 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:51:22.793558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.795471 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.795746 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:51:22.797181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.801044 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:51:22.801328 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.801526 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:51:22.802282 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:51:22.802482 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:22.804242 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.804472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:22.807440 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:51:22.807680 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:51:22.809027 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:51:22.809223 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:51:22.809447 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:51:22.810680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.812470 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.812676 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:51:22.812879 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:51:22.813775 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:51:22.731775 => 14:51:22.813662
[0m14:51:22.813977 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.814207 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:51:22.815606 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:51:22.815794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:22.816233 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6f990>]}
[0m14:51:22.816414 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.817166 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:51:22.741189 => 14:51:22.817072
[0m14:51:22.817522 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:51:22.817792 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:51:22.817985 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:51:22.818267 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:51:22.818868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fcc10>]}
[0m14:51:22.819133 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:51:22.820046 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:51:22.820658 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:22.820931 [info ] [Thread-4 (]: 5 of 17 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:51:22.821474 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:51:22.823193 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:51:22.823669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:51:22.824032 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:51:22.824357 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:51:22.824639 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:51:22.824922 [info ] [Thread-1 (]: 6 of 17 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:51:22.826825 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:51:22.827961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:51:22.829324 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:51:22.825241 => 14:51:22.829032
[0m14:51:22.829693 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:51:22.829967 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:51:22.832131 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:51:22.834724 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:51:22.834977 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:22.835985 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:51:22.705840 => 14:51:22.835882
[0m14:51:22.836256 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:51:22.836527 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:22.836931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63850>]}
[0m14:51:22.837317 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:51:22.830127 => 14:51:22.837216
[0m14:51:22.837493 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:51:22.838131 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:51:22.837914 [info ] [Thread-2 (]: 2 of 17 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:51:22.838579 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:22.841329 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:51:22.841737 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:51:22.842157 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:51:22.842555 [info ] [Thread-2 (]: 7 of 17 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:51:22.843474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:51:22.843708 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:51:22.846004 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:51:22.846960 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:22.847667 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:51:22.843843 => 14:51:22.847162
[0m14:51:22.848381 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:51:22.848686 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:51:22.848905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:22.851604 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:51:22.852273 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.852464 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:51:22.852625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:22.855186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.855813 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:22.856053 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:51:22.865142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.865623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.866068 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:22.866285 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.866509 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:51:22.866719 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:51:22.884591 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:51:22.886648 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.886911 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:51:22.890023 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.893484 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.893985 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:51:22.896545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:22.898340 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:51:22.898589 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.898819 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:51:22.918085 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:22.922066 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:51:22.922648 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:51:22.934341 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:22.935333 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:51:22.849054 => 14:51:22.935231
[0m14:51:22.935561 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:51:22.935998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945d7d0>]}
[0m14:51:22.936321 [info ] [Thread-2 (]: 7 of 17 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.09s]
[0m14:51:22.936671 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:51:22.936895 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:51:22.937149 [info ] [Thread-2 (]: 8 of 17 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:51:22.937745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:51:22.937964 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:51:22.939602 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:51:22.940131 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:51:22.938099 => 14:51:22.940004
[0m14:51:22.940327 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:51:22.943732 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:51:22.944842 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:22.945081 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:51:22.945258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:22.970071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:22.970452 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:22.970663 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:51:23.017429 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:51:23.019195 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:23.019414 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:51:23.020780 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.022447 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:23.022652 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:51:23.023756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.025047 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:51:23.025242 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:23.025404 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:51:23.046127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.049831 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:51:23.050152 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:51:23.056194 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.057142 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:51:22.729260 => 14:51:23.057046
[0m14:51:23.057350 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:51:23.057759 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922d010>]}
[0m14:51:23.058068 [info ] [Thread-3 (]: 3 of 17 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.37s]
[0m14:51:23.058409 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:51:23.058623 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:51:23.058980 [info ] [Thread-3 (]: 9 of 17 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:51:23.059465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:51:23.059650 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:51:23.061301 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:51:23.061953 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:51:23.059772 => 14:51:23.061838
[0m14:51:23.062157 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:51:23.064675 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:51:23.065421 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.065610 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:51:23.065794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:23.076334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.076640 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.076826 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:51:23.095980 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:51:23.097863 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.098215 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:51:23.099561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.101162 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.101396 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:51:23.102495 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.103960 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:51:23.104166 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.104337 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:51:23.120304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.121703 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:51:23.121897 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:51:23.127127 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.128555 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:51:23.062284 => 14:51:23.128235
[0m14:51:23.128941 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:51:23.129846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bbf10>]}
[0m14:51:23.130967 [info ] [Thread-3 (]: 9 of 17 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.07s]
[0m14:51:23.132001 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:51:23.132608 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:51:23.132937 [info ] [Thread-3 (]: 10 of 17 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:51:23.133420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:51:23.133663 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:51:23.135845 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:51:23.136408 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:51:23.133807 => 14:51:23.136299
[0m14:51:23.136601 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:51:23.139116 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:51:23.139643 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.139818 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:51:23.139979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:23.150880 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.151396 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.151632 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:51:23.159370 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:51:23.162045 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.162331 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:51:23.163766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.165401 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.165605 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:51:23.166862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.168173 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:51:23.168371 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.168536 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:51:23.183585 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.185010 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:51:23.185336 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:51:23.191850 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.192777 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:51:23.136720 => 14:51:23.192683
[0m14:51:23.192976 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:51:23.193373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938f690>]}
[0m14:51:23.193669 [info ] [Thread-3 (]: 10 of 17 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.06s]
[0m14:51:23.193989 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:51:23.194194 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:51:23.194856 [info ] [Thread-3 (]: 11 of 17 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:51:23.196015 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:51:23.196475 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:51:23.198253 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.199165 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:51:23.196659 => 14:51:23.199052
[0m14:51:23.199368 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:51:23.201856 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.202270 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.202451 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:51:23.202617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:23.216264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.216644 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.216844 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:51:23.239516 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:51:23.241372 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.241589 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:51:23.243035 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.244655 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.244868 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:51:23.246286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.247634 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:51:23.247836 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.248007 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:51:23.259782 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.261292 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:51:23.261492 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:51:23.268217 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.269102 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:51:23.199492 => 14:51:23.269008
[0m14:51:23.269305 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:51:23.269696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938dd10>]}
[0m14:51:23.269991 [info ] [Thread-3 (]: 11 of 17 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.07s]
[0m14:51:23.270313 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:51:23.270562 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:51:23.271097 [info ] [Thread-3 (]: 12 of 17 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:51:23.271542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:51:23.271734 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:51:23.273295 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.273986 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:51:23.271855 => 14:51:23.273857
[0m14:51:23.274202 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:51:23.276885 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.277384 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.277570 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:51:23.277740 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:23.282790 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:51:23.284433 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:23.284641 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:51:23.286363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.288054 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:23.288284 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:51:23.289618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.289940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.291358 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:51:23.291587 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.291795 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:23.291988 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:51:23.292177 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:51:23.305339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.306896 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:51:23.307110 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:51:23.312341 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:51:23.314217 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.314506 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:51:23.315244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.315998 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:51:22.838758 => 14:51:23.315909
[0m14:51:23.316167 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.316361 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:51:23.317822 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.318228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109272910>]}
[0m14:51:23.318420 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:51:23.318787 [info ] [Thread-1 (]: 6 of 17 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.49s]
[0m14:51:23.319929 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:51:23.320575 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:51:23.320969 [info ] [Thread-1 (]: 13 of 17 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:51:23.321407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:51:23.321594 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:51:23.324487 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.324751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.326309 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:51:23.326714 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:51:23.321714 => 14:51:23.326610
[0m14:51:23.326883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.327086 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:51:23.327263 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:51:23.330146 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.330666 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.330847 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:51:23.331009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:23.339855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.340191 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.340392 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:51:23.340592 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.341977 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:51:23.342179 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:51:23.347796 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.348749 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:51:23.274330 => 14:51:23.348650
[0m14:51:23.348960 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:51:23.349346 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cbd90>]}
[0m14:51:23.349641 [info ] [Thread-3 (]: 12 of 17 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.08s]
[0m14:51:23.349960 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:51:23.352346 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:51:23.354206 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.354420 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:51:23.355283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.356399 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:51:23.356579 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.356740 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:51:23.367735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.369213 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:51:23.369412 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:51:23.370265 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.371018 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:51:23.327508 => 14:51:23.370924
[0m14:51:23.371209 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:51:23.371584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c62d0>]}
[0m14:51:23.371877 [info ] [Thread-1 (]: 13 of 17 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.05s]
[0m14:51:23.372194 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:51:23.426726 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 0.0 seconds
[0m14:51:23.428342 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:23.428533 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:51:23.429679 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.431243 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:23.431425 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:51:23.432430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.433705 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:51:23.433894 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:23.434053 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:51:23.454938 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.456477 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:51:23.456670 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:51:23.466847 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.467773 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:51:22.940453 => 14:51:23.467684
[0m14:51:23.467976 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:51:23.468365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bc090>]}
[0m14:51:23.468675 [info ] [Thread-2 (]: 8 of 17 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.53s]
[0m14:51:23.468998 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:51:23.486369 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:51:23.487994 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:23.488171 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:51:23.489163 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.490540 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:23.490723 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:51:23.491551 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.492871 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:51:23.493048 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:23.493208 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:51:23.501557 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.502843 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:51:23.503014 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:51:23.537962 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.538823 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:51:22.832379 => 14:51:23.538740
[0m14:51:23.539005 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:51:23.539360 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c4f90>]}
[0m14:51:23.539638 [info ] [Thread-4 (]: 5 of 17 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.72s]
[0m14:51:23.539949 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:51:23.540425 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:51:23.540611 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:51:23.540784 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:51:23.540954 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:51:23.541162 [info ] [Thread-3 (]: 14 of 17 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:51:23.541455 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:51:23.541723 [info ] [Thread-2 (]: 16 of 17 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:51:23.542055 [info ] [Thread-4 (]: 17 of 17 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:51:23.542999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:51:23.543398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:51:23.543722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:51:23.544014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:51:23.544209 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:51:23.544376 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:51:23.544536 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:51:23.544687 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:51:23.546211 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:51:23.547611 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.548919 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:51:23.550060 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:51:23.550535 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:51:23.544800 => 14:51:23.550424
[0m14:51:23.550805 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:51:23.551008 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:51:23.546356 => 14:51:23.550913
[0m14:51:23.551231 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:51:23.547741 => 14:51:23.551143
[0m14:51:23.554161 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:51:23.554363 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:51:23.549051 => 14:51:23.554276
[0m14:51:23.554538 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:51:23.554716 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:51:23.554911 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:51:23.557084 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.559272 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:51:23.559459 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:23.561946 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:51:23.562355 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:51:23.562622 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.562805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:23.562988 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.563171 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:23.563326 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:51:23.563609 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:51:23.563785 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:51:23.563952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:23.564114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:23.564273 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:23.580464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.580815 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.581071 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:51:23.582889 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.583156 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:23.583359 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:51:23.584400 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.584618 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:23.584838 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:23.585036 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.585236 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:51:23.585445 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:51:23.861722 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:51:23.866118 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.866659 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:51:23.867102 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:51:23.870987 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.871620 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:51:23.872410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.872817 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.876686 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.880602 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.881268 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:51:23.881759 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:51:23.883145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.883580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:23.886936 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:51:23.890441 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:51:23.891292 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.891805 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.892317 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:51:23.892802 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:51:23.901800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.903705 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:51:23.904026 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:23.904253 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:51:23.906025 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:51:23.906359 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:51:23.912075 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.913442 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:51:23.557219 => 14:51:23.913343
[0m14:51:23.913638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:23.914019 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:51:23.915890 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:51:23.555035 => 14:51:23.915643
[0m14:51:23.916971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cf890>]}
[0m14:51:23.917449 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:51:23.918222 [info ] [Thread-2 (]: 16 of 17 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.37s]
[0m14:51:23.919177 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:51:23.920286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109405250>]}
[0m14:51:23.921020 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.38s]
[0m14:51:23.921583 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:51:24.178090 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:51:24.183794 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:24.184333 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:51:24.185789 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:24.189610 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:24.189915 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:51:24.190825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:24.192169 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:51:24.192357 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:24.192524 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:51:24.202003 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:24.205656 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:51:24.205952 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:51:24.209115 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:24.210139 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:51:23.551347 => 14:51:24.210026
[0m14:51:24.210363 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:51:24.210797 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109286f90>]}
[0m14:51:24.211157 [info ] [Thread-3 (]: 14 of 17 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.67s]
[0m14:51:24.211530 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:51:24.438570 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:51:24.444320 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:24.445159 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:51:24.449487 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:24.452189 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:24.452449 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:51:24.453219 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:51:24.454462 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:51:24.454645 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:24.454798 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:51:24.469841 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:51:24.475077 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:51:24.475351 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:51:24.486807 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:51:24.488937 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:51:23.559604 => 14:51:24.488753
[0m14:51:24.489197 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:51:24.489644 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167848b8-9dd7-4e15-a9f0-7960bc18deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938b7d0>]}
[0m14:51:24.489995 [info ] [Thread-4 (]: 17 of 17 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.95s]
[0m14:51:24.490319 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:51:24.491509 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:24.491716 [debug] [MainThread]: On master: BEGIN
[0m14:51:24.491857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:24.500939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:24.501229 [debug] [MainThread]: On master: COMMIT
[0m14:51:24.501390 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:24.501535 [debug] [MainThread]: On master: COMMIT
[0m14:51:24.502172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:51:24.502320 [debug] [MainThread]: On master: Close
[0m14:51:24.502657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:24.502793 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:51:24.502915 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:51:24.503027 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:51:24.503139 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:51:24.503314 [info ] [MainThread]: 
[0m14:51:24.503518 [info ] [MainThread]: Finished running 1 view model, 16 table models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m14:51:24.504831 [debug] [MainThread]: Command end result
[0m14:51:24.508858 [info ] [MainThread]: 
[0m14:51:24.509133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:24.509350 [info ] [MainThread]: 
[0m14:51:24.509558 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:51:24.509936 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:24.509885 after 2.16 seconds
[0m14:51:24.510142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105255e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e3a50>]}
[0m14:51:24.510341 [debug] [MainThread]: Flushing usage events
[0m14:52:29.512079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104872ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104889010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104889d90>]}


============================== 14:52:29.515693 | 9ed5f72c-a8e0-4384-99b8-b5f6506d475d ==============================
[0m14:52:29.515693 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:52:29.516053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:29.562636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103669d90>]}
[0m14:52:29.569568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103669d90>]}
[0m14:52:29.569960 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:52:29.580553 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:52:29.603896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:52:29.604276 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_avg_credit_score_by_age_group.sql
[0m14:52:29.616776 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_avg_credit_score_by_age_group.sql
[0m14:52:29.646314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489b410>]}
[0m14:52:29.650339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef6950>]}
[0m14:52:29.650559 [info ] [MainThread]: Found 18 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:29.650774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102635090>]}
[0m14:52:29.651962 [info ] [MainThread]: 
[0m14:52:29.652451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:29.653327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:52:29.658733 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:52:29.658971 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:52:29.659120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:29.734745 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:52:29.735848 [debug] [ThreadPool]: On list_mydb: Close
[0m14:52:29.737349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:52:29.741410 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:29.741638 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:52:29.741810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:29.752060 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.752353 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:52:29.752563 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:52:29.760898 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m14:52:29.762123 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:52:29.762943 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:52:29.767973 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:29.768230 [debug] [MainThread]: On master: BEGIN
[0m14:52:29.768412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:29.778361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.778670 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:29.778984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:29.795158 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:52:29.796743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104866d90>]}
[0m14:52:29.797067 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:29.797957 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:29.798161 [debug] [MainThread]: On master: BEGIN
[0m14:52:29.799397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.799606 [debug] [MainThread]: On master: COMMIT
[0m14:52:29.799796 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:29.799977 [debug] [MainThread]: On master: COMMIT
[0m14:52:29.800740 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:29.800985 [debug] [MainThread]: On master: Close
[0m14:52:29.801480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:29.801790 [info ] [MainThread]: 
[0m14:52:29.806246 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:52:29.806521 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:52:29.806780 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:52:29.806987 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:52:29.807254 [info ] [Thread-1 (]: 1 of 18 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:52:29.807615 [info ] [Thread-2 (]: 2 of 18 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:52:29.808015 [info ] [Thread-3 (]: 3 of 18 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:52:29.808400 [info ] [Thread-4 (]: 4 of 18 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:52:29.808978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:52:29.809461 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:52:29.809939 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:52:29.810391 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:52:29.810638 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:52:29.810869 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:52:29.811090 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:52:29.811305 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:52:29.813404 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:52:29.815513 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:52:29.817139 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:52:29.818849 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:52:29.820128 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:52:29.813709 => 14:52:29.820010
[0m14:52:29.820380 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:52:29.811461 => 14:52:29.820256
[0m14:52:29.820604 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:52:29.815719 => 14:52:29.820509
[0m14:52:29.820810 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:52:29.821025 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:52:29.817311 => 14:52:29.820926
[0m14:52:29.821219 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:52:29.821417 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:52:29.842797 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:52:29.842997 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:52:29.845265 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:52:29.847452 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:52:29.857139 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:52:29.857495 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.857811 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.858051 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.858212 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:52:29.858360 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:29.858518 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:52:29.858671 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:52:29.858820 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:29.858965 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:52:29.859107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:29.859244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:52:29.859475 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:29.869520 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.869911 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.870251 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:52:29.871702 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.872086 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.872321 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:29.872632 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.872906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.873120 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:52:29.873326 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:52:29.873517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.873822 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:52:29.878342 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:52:29.882254 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.882514 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:52:29.885961 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.888028 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.888270 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:52:29.889703 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.900970 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:52:29.901239 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:52:29.901487 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.903066 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.903256 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:52:29.903433 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:52:29.904187 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:52:29.905781 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.905982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.906206 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:52:29.907781 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.908052 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:52:29.908989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.909153 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.912529 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:52:29.912757 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:29.914413 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.914608 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.917284 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:52:29.917494 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:52:29.917691 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:52:29.917870 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:52:29.919247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:29.920574 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:52:29.920745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:29.920926 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.922209 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:52:29.922394 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:52:29.922581 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:52:29.922741 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:52:29.923585 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:52:29.847710 => 14:52:29.923485
[0m14:52:29.923781 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:52:29.924207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501a150>]}
[0m14:52:29.924546 [info ] [Thread-4 (]: 4 of 18 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:52:29.924818 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:29.925095 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:52:29.926502 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:52:29.926749 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:52:29.926997 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:52:29.927245 [info ] [Thread-4 (]: 5 of 18 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:52:29.927935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:52:29.928148 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:52:29.930530 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:52:29.931128 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:52:29.928353 => 14:52:29.931022
[0m14:52:29.931398 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:52:29.934470 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:52:29.934714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:29.935600 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:52:29.843138 => 14:52:29.935507
[0m14:52:29.935833 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:29.936050 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:52:29.936802 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:52:29.821555 => 14:52:29.936711
[0m14:52:29.936989 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:29.937392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501bf50>]}
[0m14:52:29.937576 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:52:29.937763 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:52:29.938064 [info ] [Thread-1 (]: 1 of 18 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:52:29.938511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f461d0>]}
[0m14:52:29.938852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:52:29.939155 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:52:29.939508 [info ] [Thread-2 (]: 2 of 18 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.13s]
[0m14:52:29.939990 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:52:29.940346 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:52:29.940591 [info ] [Thread-1 (]: 6 of 18 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:52:29.941160 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:52:29.941657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:52:29.942083 [info ] [Thread-2 (]: 7 of 18 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:52:29.942425 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:52:29.942759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:52:29.944419 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:52:29.944711 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:52:29.947416 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:52:29.947924 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:52:29.942905 => 14:52:29.947626
[0m14:52:29.948352 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:52:29.951081 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:52:29.951395 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:52:29.945333 => 14:52:29.951274
[0m14:52:29.951744 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:52:29.954572 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:52:29.954842 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.955150 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:29.955383 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:29.955576 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:52:29.955786 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:52:29.955976 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:29.956180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:29.956364 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:52:29.956673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:29.970892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.971419 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:29.971658 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:52:29.974757 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:29.975092 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:29.975283 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:52:29.994913 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:52:29.998666 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:29.998945 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:52:30.001724 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.004471 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:30.004922 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:52:30.007466 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.009645 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:52:30.010045 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:30.010340 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:52:30.024154 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.025849 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:52:30.026070 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:52:30.033133 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.034091 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:52:29.951883 => 14:52:30.033993
[0m14:52:30.034303 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:52:30.034712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051622d0>]}
[0m14:52:30.035024 [info ] [Thread-2 (]: 7 of 18 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.09s]
[0m14:52:30.035369 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:52:30.035590 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:52:30.036041 [info ] [Thread-2 (]: 8 of 18 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:52:30.036500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:52:30.036698 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:52:30.038319 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:52:30.038828 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:52:30.036827 => 14:52:30.038724
[0m14:52:30.039021 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:52:30.042047 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:52:30.042664 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.043188 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:52:30.044124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:30.063226 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.063599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.063808 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:52:30.144405 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:52:30.146095 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:30.146298 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:52:30.147613 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.149220 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:30.149415 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:52:30.150582 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.151848 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:52:30.152032 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:30.152195 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:52:30.170658 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.172250 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:52:30.172446 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:52:30.182981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.184086 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:52:29.845404 => 14:52:30.183988
[0m14:52:30.184289 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:52:30.184680 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef3c50>]}
[0m14:52:30.184973 [info ] [Thread-3 (]: 3 of 18 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.37s]
[0m14:52:30.185297 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:52:30.185695 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:52:30.186286 [info ] [Thread-3 (]: 9 of 18 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:52:30.187425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:52:30.187682 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:52:30.189195 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:52:30.189947 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:52:30.187799 => 14:52:30.189837
[0m14:52:30.190146 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:52:30.192929 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:52:30.193412 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.193593 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:52:30.193759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.206690 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.207034 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.207229 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:52:30.230124 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:30.237328 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.237563 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:52:30.252102 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.256681 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.257283 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:52:30.259487 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.261862 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:52:30.262103 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.262273 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:52:30.289780 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.291430 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:52:30.291671 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:52:30.302219 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.304322 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:52:30.190275 => 14:52:30.304078
[0m14:52:30.304810 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:52:30.305717 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510d990>]}
[0m14:52:30.306411 [info ] [Thread-3 (]: 9 of 18 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.12s]
[0m14:52:30.307274 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:52:30.307692 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:52:30.308321 [info ] [Thread-3 (]: 10 of 18 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:52:30.308917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:52:30.309105 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:52:30.310834 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:52:30.311300 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:52:30.309222 => 14:52:30.311186
[0m14:52:30.311479 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:52:30.314628 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:52:30.315005 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.315173 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:52:30.315327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.339467 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.339808 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.340008 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:52:30.349743 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:30.351427 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.351642 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:52:30.352945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.354402 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.354593 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:52:30.355662 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.356920 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:52:30.357105 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.357268 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:52:30.368925 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.370525 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:52:30.370737 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:52:30.378115 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.379016 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:52:30.311595 => 14:52:30.378923
[0m14:52:30.379211 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:52:30.379699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f64f10>]}
[0m14:52:30.381270 [info ] [Thread-3 (]: 10 of 18 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.07s]
[0m14:52:30.381673 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:52:30.382037 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:52:30.382703 [info ] [Thread-3 (]: 11 of 18 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:52:30.383165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:52:30.383365 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:52:30.385140 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.385795 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:52:30.383487 => 14:52:30.385690
[0m14:52:30.385986 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:52:30.388867 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.389867 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.390075 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:52:30.390240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.406683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.407268 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.407485 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:52:30.428328 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:52:30.430115 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.430323 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:52:30.431769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.433260 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.433459 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:52:30.434548 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.435936 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:52:30.436125 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.436290 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:52:30.443714 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:52:30.445480 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:30.445756 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:52:30.459121 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.459353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.460892 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:52:30.462457 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:30.462706 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:52:30.462907 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:52:30.464021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.465754 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:52:30.466015 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:30.466185 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:52:30.475131 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.476088 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:52:30.386107 => 14:52:30.475986
[0m14:52:30.476353 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:52:30.477094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f46d50>]}
[0m14:52:30.477449 [info ] [Thread-3 (]: 11 of 18 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.09s]
[0m14:52:30.478173 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:52:30.478507 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:52:30.479022 [info ] [Thread-3 (]: 12 of 18 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:52:30.480058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.480693 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:52:30.482811 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:52:30.483114 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:52:30.483322 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:52:30.485548 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.486177 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:52:30.483479 => 14:52:30.486073
[0m14:52:30.486390 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:52:30.488966 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.489458 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.489654 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:52:30.489828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.496176 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.497178 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:52:29.948567 => 14:52:30.497076
[0m14:52:30.497391 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:52:30.497804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4f90>]}
[0m14:52:30.498137 [info ] [Thread-1 (]: 6 of 18 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.56s]
[0m14:52:30.499051 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:52:30.499311 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:52:30.499674 [info ] [Thread-1 (]: 13 of 18 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:52:30.500427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:52:30.500858 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:52:30.502726 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.503269 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:52:30.501150 => 14:52:30.503128
[0m14:52:30.503471 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:52:30.507721 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.508219 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.508414 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:52:30.508595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:30.518522 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.519123 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.519359 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:52:30.529443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.529960 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.530281 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:52:30.539854 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:30.541740 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.541999 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:52:30.542533 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:30.544289 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.544514 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.544736 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:52:30.545910 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:52:30.546173 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.546375 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:52:30.559931 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.560161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.561603 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:52:30.563148 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.563375 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:52:30.563580 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:52:30.564540 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.564720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.565487 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:52:30.486512 => 14:52:30.565395
[0m14:52:30.566764 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:52:30.566993 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:52:30.567187 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.567490 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:52:30.567845 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105114f90>]}
[0m14:52:30.568205 [info ] [Thread-3 (]: 12 of 18 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.09s]
[0m14:52:30.568534 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:52:30.568749 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:52:30.569249 [info ] [Thread-3 (]: 14 of 18 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:52:30.570201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:52:30.570801 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:52:30.572882 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.573477 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:52:30.570951 => 14:52:30.573358
[0m14:52:30.573682 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:52:30.577226 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.577891 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.578139 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:52:30.578405 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.578789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.580662 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:52:30.580951 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:52:30.594744 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.595815 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:52:30.503614 => 14:52:30.595714
[0m14:52:30.596046 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:52:30.596490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3810>]}
[0m14:52:30.596818 [info ] [Thread-1 (]: 13 of 18 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.10s]
[0m14:52:30.597173 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:52:30.609259 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.609883 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.610125 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:52:30.620739 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:30.622639 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.622863 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:52:30.624296 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.626176 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.626440 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:52:30.627797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.629219 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:52:30.629438 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.629610 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:52:30.642446 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.644081 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:52:30.644325 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:52:30.651971 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.652903 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:52:30.573800 => 14:52:30.652808
[0m14:52:30.653105 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:52:30.653485 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b6210>]}
[0m14:52:30.653801 [info ] [Thread-3 (]: 14 of 18 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.08s]
[0m14:52:30.654239 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:52:30.665611 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:52:30.667333 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.667537 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:52:30.668774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.670451 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.670666 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:52:30.671675 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.672950 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:52:30.673136 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.673294 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:52:30.682893 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.684386 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:52:30.684574 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:52:30.688056 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:52:30.690855 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:30.691102 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:52:30.692720 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.694314 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:30.694479 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.694684 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:52:30.695372 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:52:30.039144 => 14:52:30.695280
[0m14:52:30.695580 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:52:30.695939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f44390>]}
[0m14:52:30.696239 [info ] [Thread-2 (]: 8 of 18 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.66s]
[0m14:52:30.696567 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:52:30.696781 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:30.698419 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:52:30.698693 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:30.698882 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:52:30.703349 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:30.704934 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:52:30.705124 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:52:30.774625 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:30.775856 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:52:29.931619 => 14:52:30.775738
[0m14:52:30.776067 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:52:30.776500 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050eb790>]}
[0m14:52:30.776932 [info ] [Thread-4 (]: 5 of 18 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.85s]
[0m14:52:30.777307 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:52:30.778239 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:52:30.778492 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:30.778829 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:52:30.779100 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:52:30.779444 [info ] [Thread-1 (]: 15 of 18 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:52:30.779864 [info ] [Thread-3 (]: 16 of 18 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:52:30.780262 [info ] [Thread-2 (]: 17 of 18 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:52:30.780572 [info ] [Thread-4 (]: 18 of 18 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:52:30.781231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:52:30.781561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:52:30.781883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:52:30.782213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:52:30.782420 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:52:30.782598 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:30.782785 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:52:30.782977 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:52:30.784844 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:52:30.786369 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:30.787743 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:52:30.789106 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:52:30.789619 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:52:30.786517 => 14:52:30.789517
[0m14:52:30.789817 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:52:30.785006 => 14:52:30.789725
[0m14:52:30.790002 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:52:30.783105 => 14:52:30.789925
[0m14:52:30.790187 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:52:30.790380 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:30.790565 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:52:30.787904 => 14:52:30.790484
[0m14:52:30.790729 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:52:30.792996 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:52:30.795314 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:30.795603 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:52:30.797949 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:52:30.800265 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:52:30.800551 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:30.800723 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:30.800945 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:52:30.801127 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:30.801317 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:30.801464 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:52:30.801637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:30.801814 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:52:30.801981 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:52:30.802145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.802392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:30.802561 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:52:30.819580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.819987 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:30.820219 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:52:30.820568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.820796 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:30.820994 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:52:30.821944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.822160 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:30.822358 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:52:30.823060 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:30.823263 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:30.823446 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:52:31.156373 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:52:31.157093 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:52:31.166489 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:31.167064 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:31.167320 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:52:31.167579 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:52:31.169666 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.171755 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:31.171954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.172245 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:52:31.175009 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:31.175450 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:52:31.176479 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.177040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.179504 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:52:31.180987 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:52:31.181291 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:31.181474 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:31.181704 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:52:31.181905 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:52:31.188958 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:31.190607 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:52:31.190797 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:31.190996 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:52:31.192380 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:52:31.192741 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:52:31.198262 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:31.199361 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:52:30.793135 => 14:52:31.199238
[0m14:52:31.199598 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:52:31.199866 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:31.200527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f7450>]}
[0m14:52:31.201415 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:52:30.790848 => 14:52:31.201318
[0m14:52:31.201795 [info ] [Thread-3 (]: 16 of 18 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.42s]
[0m14:52:31.202411 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:52:31.202803 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:52:31.203509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104888910>]}
[0m14:52:31.204297 [info ] [Thread-2 (]: 17 of 18 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.42s]
[0m14:52:31.205190 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:52:31.474599 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:52:31.479259 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:31.480351 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:52:31.482102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.487168 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:31.487674 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:52:31.488788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.490248 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:52:31.490461 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:31.490638 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:52:31.502724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:31.506472 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:52:31.506754 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:52:31.509711 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:31.510582 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:52:30.795741 => 14:52:31.510484
[0m14:52:31.510782 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:52:31.511176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105118850>]}
[0m14:52:31.511473 [info ] [Thread-1 (]: 15 of 18 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.73s]
[0m14:52:31.511790 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:52:31.729806 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:52:31.736389 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:31.737019 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:52:31.738421 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.741967 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:31.742238 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:52:31.743094 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:52:31.744433 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:52:31.744629 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:31.744795 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:52:31.748400 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:31.749942 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:52:31.750142 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:52:31.763420 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:52:31.764347 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:52:30.798196 => 14:52:31.764256
[0m14:52:31.764536 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:52:31.764932 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed5f72c-a8e0-4384-99b8-b5f6506d475d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e150>]}
[0m14:52:31.765238 [info ] [Thread-4 (]: 18 of 18 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.98s]
[0m14:52:31.765558 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:52:31.767032 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:31.767281 [debug] [MainThread]: On master: BEGIN
[0m14:52:31.767436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:31.776561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:31.776885 [debug] [MainThread]: On master: COMMIT
[0m14:52:31.777045 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:31.777189 [debug] [MainThread]: On master: COMMIT
[0m14:52:31.777823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:31.778001 [debug] [MainThread]: On master: Close
[0m14:52:31.778355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:31.778494 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:52:31.778611 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:52:31.778723 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:52:31.778835 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:52:31.779051 [info ] [MainThread]: 
[0m14:52:31.779262 [info ] [MainThread]: Finished running 1 view model, 17 table models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m14:52:31.780668 [debug] [MainThread]: Command end result
[0m14:52:31.784958 [info ] [MainThread]: 
[0m14:52:31.785202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:31.785409 [info ] [MainThread]: 
[0m14:52:31.785663 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m14:52:31.786196 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:31.786143 after 2.29 seconds
[0m14:52:31.786440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e067d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f4de90>]}
[0m14:52:31.786616 [debug] [MainThread]: Flushing usage events
[0m14:53:38.769984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a006710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00ff90>]}


============================== 14:53:38.773684 | 0e1cb9bf-8507-4e31-9ff3-13445c2406a9 ==============================
[0m14:53:38.773684 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:53:38.774088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:38.816631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00f990>]}
[0m14:53:38.823639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966fd90>]}
[0m14:53:38.824052 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:53:38.834048 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:53:38.857975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:53:38.858359 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_avg_age_by_geography.sql
[0m14:53:38.869829 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_avg_age_by_geography.sql
[0m14:53:38.898995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a570e50>]}
[0m14:53:38.903030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d8f90>]}
[0m14:53:38.903253 [info ] [MainThread]: Found 19 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:38.903468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed2d0>]}
[0m14:53:38.904720 [info ] [MainThread]: 
[0m14:53:38.905225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:38.906193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:53:38.911707 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:53:38.911951 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:53:38.912099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:39.001613 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:53:39.002895 [debug] [ThreadPool]: On list_mydb: Close
[0m14:53:39.004712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:53:39.008980 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:53:39.009223 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:53:39.009411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:39.019767 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.020052 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:53:39.020272 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:53:39.030076 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:53:39.031337 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:53:39.032120 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:53:39.037592 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:39.037866 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.038064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:39.048216 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.048484 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:39.048812 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:39.069175 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:53:39.071017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a038fd0>]}
[0m14:53:39.071375 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:39.072254 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:39.072473 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.073851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.074149 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.074378 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:39.074591 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.075408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.075670 [debug] [MainThread]: On master: Close
[0m14:53:39.076191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:39.076510 [info ] [MainThread]: 
[0m14:53:39.080091 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:53:39.080393 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:53:39.080680 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:53:39.080955 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:53:39.081286 [info ] [Thread-1 (]: 1 of 19 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:53:39.081674 [info ] [Thread-2 (]: 2 of 19 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:53:39.082034 [info ] [Thread-3 (]: 3 of 19 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:53:39.082423 [info ] [Thread-4 (]: 4 of 19 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:53:39.082968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:53:39.083437 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:53:39.083865 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:53:39.084273 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:53:39.084498 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:53:39.084726 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:53:39.084934 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:53:39.085134 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:53:39.087168 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:53:39.088992 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:53:39.090728 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:53:39.092818 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:53:39.093910 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:53:39.089206 => 14:53:39.093741
[0m14:53:39.094183 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:53:39.090981 => 14:53:39.094068
[0m14:53:39.094411 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:53:39.085289 => 14:53:39.094310
[0m14:53:39.094618 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:53:39.094837 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:53:39.087362 => 14:53:39.094740
[0m14:53:39.095034 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:53:39.095247 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:53:39.113192 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:53:39.117759 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:53:39.127075 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:53:39.129355 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:53:39.131436 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:53:39.131898 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.132152 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.132330 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.132502 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:53:39.132677 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:53:39.132840 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:53:39.133000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:53:39.133147 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.133292 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:39.133436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.133671 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:53:39.133967 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:39.144840 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.145218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.145689 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.145884 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.146091 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:53:39.146336 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:53:39.146689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.146882 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.147069 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:53:39.147246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.147485 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.147680 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:53:39.152094 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:53:39.156997 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.157271 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:53:39.160969 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.162920 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.163174 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:53:39.164418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.175326 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:53:39.175657 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.175850 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:53:39.182462 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.186090 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:53:39.186384 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:53:39.187780 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:53:39.189864 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.190130 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:53:39.191994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.192238 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:53:39.194123 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.195808 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.196021 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:53:39.196192 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:53:39.196390 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:53:39.197156 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:53:39.117916 => 14:53:39.197060
[0m14:53:39.197433 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:53:39.197856 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ebcd0>]}
[0m14:53:39.198213 [info ] [Thread-4 (]: 4 of 19 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:53:39.198583 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:53:39.198845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.199080 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.199331 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:53:39.202965 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:53:39.204957 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.205334 [info ] [Thread-4 (]: 5 of 19 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:53:39.206311 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.207286 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:53:39.207850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:53:39.208055 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:53:39.208622 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:53:39.210564 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:53:39.210908 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.211125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.212550 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:53:39.213996 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:53:39.214239 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.214451 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:53:39.208879 => 14:53:39.214354
[0m14:53:39.214634 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:53:39.214814 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:53:39.214993 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:53:39.217640 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:53:39.217887 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.219459 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:53:39.219788 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:53:39.220257 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.220472 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:53:39.220653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:39.221541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.223860 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:53:39.127228 => 14:53:39.223687
[0m14:53:39.224194 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:53:39.224976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73bf90>]}
[0m14:53:39.226436 [info ] [Thread-1 (]: 1 of 19 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.14s]
[0m14:53:39.227955 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:53:39.228365 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:53:39.228927 [info ] [Thread-1 (]: 6 of 19 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:53:39.229439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:53:39.229640 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:53:39.231549 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:53:39.231835 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.232962 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:53:39.129503 => 14:53:39.232856
[0m14:53:39.233279 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:53:39.233533 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:53:39.229766 => 14:53:39.233445
[0m14:53:39.233772 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:53:39.234207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54f3d0>]}
[0m14:53:39.237074 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:53:39.237695 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.238101 [info ] [Thread-2 (]: 2 of 19 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:53:39.238483 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.238835 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:53:39.239041 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:53:39.239245 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.239481 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:53:39.239853 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:53:39.240166 [info ] [Thread-2 (]: 7 of 19 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:53:39.240751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.241164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:53:39.241534 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:53:39.243350 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:53:39.243893 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:53:39.241678 => 14:53:39.243783
[0m14:53:39.244104 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:53:39.248372 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:53:39.249284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.249482 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:53:39.249653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:39.260919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.261362 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.261633 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:53:39.269651 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.270048 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.270263 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:53:39.308890 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:53:39.313270 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.313569 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:53:39.316992 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.321547 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.322120 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:53:39.324247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.327346 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:53:39.327636 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.327825 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:53:39.341131 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.342739 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:53:39.342953 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:53:39.351196 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.352231 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:53:39.244228 => 14:53:39.352130
[0m14:53:39.352457 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:53:39.352875 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a727fd0>]}
[0m14:53:39.353187 [info ] [Thread-2 (]: 7 of 19 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.11s]
[0m14:53:39.353524 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:53:39.353747 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:53:39.354454 [info ] [Thread-2 (]: 8 of 19 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:53:39.355198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:53:39.355428 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:53:39.357386 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:53:39.358359 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:53:39.355565 => 14:53:39.358246
[0m14:53:39.358555 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:53:39.361097 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:53:39.361518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.361699 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:53:39.361874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:39.375816 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.376218 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.376475 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:53:39.420525 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:53:39.422308 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.422520 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:53:39.424091 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.425624 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.425822 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:53:39.426847 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.428118 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:53:39.428304 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.428465 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:53:39.441053 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.442633 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:53:39.442831 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:53:39.447800 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.448674 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:53:39.095406 => 14:53:39.448583
[0m14:53:39.448865 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:53:39.449251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a763f50>]}
[0m14:53:39.449546 [info ] [Thread-3 (]: 3 of 19 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.37s]
[0m14:53:39.449870 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:53:39.450074 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:53:39.450475 [info ] [Thread-3 (]: 9 of 19 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:53:39.450910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:53:39.451103 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:53:39.453528 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:53:39.454276 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:53:39.451229 => 14:53:39.454161
[0m14:53:39.454591 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:53:39.458062 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:53:39.458994 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.459235 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:53:39.459409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:39.486963 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.487543 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.487772 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:53:39.512423 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:53:39.514227 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.514450 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:53:39.515880 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.517502 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.517735 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:53:39.519244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.520706 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:53:39.520916 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.521089 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:53:39.535119 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.536563 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:53:39.537731 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:53:39.543495 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.544406 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:53:39.454753 => 14:53:39.544315
[0m14:53:39.544616 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:53:39.544992 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d8310>]}
[0m14:53:39.545282 [info ] [Thread-3 (]: 9 of 19 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.09s]
[0m14:53:39.545594 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:53:39.545795 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:53:39.546161 [info ] [Thread-3 (]: 10 of 19 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:53:39.546524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:53:39.546689 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:53:39.548187 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:53:39.548690 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:53:39.546799 => 14:53:39.548587
[0m14:53:39.548872 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:53:39.551455 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:53:39.551878 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.552045 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:53:39.552203 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:39.563196 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.563552 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.563954 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:53:39.578956 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:53:39.580889 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.581130 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:53:39.583146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.584958 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.585188 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:53:39.587779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.591003 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:53:39.591280 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.591448 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:53:39.603959 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.606903 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:53:39.607202 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:53:39.613680 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.614574 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:53:39.548986 => 14:53:39.614477
[0m14:53:39.614767 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:53:39.615141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966e990>]}
[0m14:53:39.615432 [info ] [Thread-3 (]: 10 of 19 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.07s]
[0m14:53:39.615747 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:53:39.615950 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:53:39.616582 [info ] [Thread-3 (]: 11 of 19 START sql table model dbt_warehouse.sum_avg_age_by_geography .......... [RUN]
[0m14:53:39.617720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_age_by_geography)
[0m14:53:39.618257 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_age_by_geography
[0m14:53:39.619924 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.620343 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (compile): 14:53:39.618448 => 14:53:39.620242
[0m14:53:39.620519 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_age_by_geography
[0m14:53:39.624144 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.624739 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.625113 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: BEGIN
[0m14:53:39.625302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:39.654702 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.655071 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.655271 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	geography,
	AVG(age) AS average_age
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY geography
  );
  
[0m14:53:39.687808 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:53:39.689597 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.689856 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp" rename to "sum_avg_age_by_geography"
[0m14:53:39.695527 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:53:39.695755 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.697452 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.698631 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:53:39.698856 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:53:39.699064 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.699307 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:53:39.710639 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.710904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.712363 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:53:39.714049 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.714328 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_backup" cascade
[0m14:53:39.714808 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:53:39.717321 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.718592 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (execute): 14:53:39.620692 => 14:53:39.718493
[0m14:53:39.719058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.719289 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: Close
[0m14:53:39.721259 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:53:39.721981 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.722992 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58c690>]}
[0m14:53:39.723252 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:53:39.723663 [info ] [Thread-3 (]: 11 of 19 OK created sql table model dbt_warehouse.sum_avg_age_by_geography ..... [[32mSELECT 3[0m in 0.11s]
[0m14:53:39.724393 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:53:39.724799 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:53:39.725087 [info ] [Thread-3 (]: 12 of 19 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:53:39.725627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_age_by_geography, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:53:39.725881 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:53:39.729182 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.729900 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:53:39.726009 => 14:53:39.729774
[0m14:53:39.730110 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:53:39.733104 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.733380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.734967 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:53:39.735283 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:53:39.737051 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.737311 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:53:39.737480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:39.750397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.751681 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:53:39.234387 => 14:53:39.751580
[0m14:53:39.751908 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:53:39.752393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a817890>]}
[0m14:53:39.752728 [info ] [Thread-1 (]: 6 of 19 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.52s]
[0m14:53:39.753098 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:53:39.753323 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:53:39.753618 [info ] [Thread-1 (]: 13 of 19 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:53:39.754294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:53:39.754566 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:53:39.756486 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.757083 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:53:39.754693 => 14:53:39.756955
[0m14:53:39.757305 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:53:39.760404 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.760943 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.761164 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:53:39.761340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.766636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.767010 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.767216 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:53:39.778266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.778599 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.778846 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:53:39.790551 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:53:39.792379 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.792592 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:53:39.794121 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.795712 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.795909 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:53:39.796127 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:53:39.797708 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.798041 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group" rename to "sum_avg_credit_score_by_age_group__dbt_backup"
[0m14:53:39.800311 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.800500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.801817 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:53:39.803286 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.803477 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.803672 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:53:39.803867 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:53:39.812382 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.812625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.814027 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:53:39.815254 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:53:39.815446 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:53:39.815620 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.815829 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:53:39.822562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.824261 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:53:39.824483 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.824696 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:53:39.825469 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:53:39.730240 => 14:53:39.825375
[0m14:53:39.825698 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:53:39.826141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a716410>]}
[0m14:53:39.826464 [info ] [Thread-3 (]: 12 of 19 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.10s]
[0m14:53:39.826849 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:53:39.827204 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:53:39.827590 [info ] [Thread-3 (]: 14 of 19 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:53:39.828039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:53:39.828238 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:53:39.830312 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.831021 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:53:39.828362 => 14:53:39.830910
[0m14:53:39.831238 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:53:39.834993 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.835605 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.836834 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:53:39.757434 => 14:53:39.836679
[0m14:53:39.837211 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.837397 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:53:39.837651 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:53:39.838268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a69b8d0>]}
[0m14:53:39.838681 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:39.839287 [info ] [Thread-1 (]: 13 of 19 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.08s]
[0m14:53:39.839950 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:53:39.840192 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:53:39.840570 [info ] [Thread-1 (]: 15 of 19 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:53:39.841478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:53:39.841981 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:53:39.845586 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.846095 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:53:39.842166 => 14:53:39.845989
[0m14:53:39.846306 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:53:39.849323 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.849758 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.849936 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:53:39.850100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.854619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.855272 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.855523 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:53:39.862262 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 0.0 seconds
[0m14:53:39.864089 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.864315 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:53:39.866826 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:53:39.868401 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.868590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.868834 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:53:39.871674 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.871893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:39.872141 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:53:39.872332 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.872568 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:53:39.873607 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.875298 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.875499 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:53:39.876549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.877877 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:53:39.878056 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.878254 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.879483 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:53:39.879677 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:53:39.879852 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.880058 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:53:39.890639 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.890890 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:53:39.891061 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.892571 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:53:39.894034 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.894195 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:53:39.895276 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:53:39.895456 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:53:39.895649 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:53:39.896971 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.897148 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:53:39.897399 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:53:39.898790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.898983 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.900575 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.902091 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.902268 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.902477 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:53:39.902699 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:53:39.903509 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:53:39.831361 => 14:53:39.903399
[0m14:53:39.903802 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:53:39.904224 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad13710>]}
[0m14:53:39.904559 [info ] [Thread-3 (]: 14 of 19 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.08s]
[0m14:53:39.904913 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:53:39.905816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.907440 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:53:39.908031 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.907733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:39.908220 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:53:39.909781 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:53:39.910069 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.910265 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:53:39.911527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.911715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:39.913385 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:53:39.914683 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:53:39.915329 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.915557 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:53:39.915755 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:53:39.916672 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:53:39.358679 => 14:53:39.916582
[0m14:53:39.916937 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:53:39.917345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c2a50>]}
[0m14:53:39.917886 [info ] [Thread-2 (]: 8 of 19 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.56s]
[0m14:53:39.918291 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:53:39.920952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.921977 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:53:39.846429 => 14:53:39.921868
[0m14:53:39.922211 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:53:39.922652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a621910>]}
[0m14:53:39.923019 [info ] [Thread-1 (]: 15 of 19 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.08s]
[0m14:53:39.923395 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:53:39.978769 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:39.979729 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:53:39.215178 => 14:53:39.979638
[0m14:53:39.979929 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:53:39.980310 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71d810>]}
[0m14:53:39.980619 [info ] [Thread-4 (]: 5 of 19 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.77s]
[0m14:53:39.980937 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:53:39.981431 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:53:39.981629 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:53:39.981798 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:53:39.981978 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:53:39.982199 [info ] [Thread-3 (]: 16 of 19 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:53:39.982482 [info ] [Thread-2 (]: 17 of 19 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:53:39.982742 [info ] [Thread-1 (]: 18 of 19 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:53:39.983049 [info ] [Thread-4 (]: 19 of 19 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:53:39.983716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_genre_views)
[0m14:53:39.984030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:53:39.984311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_views)
[0m14:53:39.984582 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:53:39.984764 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:53:39.984928 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:53:39.985080 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:53:39.985231 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:53:39.986939 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:53:39.988251 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:39.989930 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:53:39.991332 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:53:39.991815 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:53:39.985342 => 14:53:39.991703
[0m14:53:39.992043 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:53:39.987075 => 14:53:39.991960
[0m14:53:39.992295 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:53:39.988411 => 14:53:39.992204
[0m14:53:39.992454 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:53:39.992651 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:53:39.992834 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:53:39.990126 => 14:53:39.992754
[0m14:53:39.993012 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:53:39.996372 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:53:39.998485 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:39.998664 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:53:40.000835 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:53:40.003170 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:53:40.003382 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.003595 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.003829 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:53:40.004025 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.004197 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:53:40.004352 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.004516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:40.004701 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:53:40.004884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:40.005068 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:53:40.005322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:40.005604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:40.021085 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:40.021393 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:40.021637 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.021807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:40.021988 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.022201 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:53:40.022439 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.022654 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:53:40.022905 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:53:40.030687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:40.030976 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.031185 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:53:40.226659 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:53:40.228636 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.228852 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:53:40.230301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.231886 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.232090 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:53:40.233176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.234429 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:53:40.234622 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.234787 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:53:40.237322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:40.238939 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:53:40.239150 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:53:40.246390 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:40.248474 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:53:39.998791 => 14:53:40.248349
[0m14:53:40.248748 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:53:40.249208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a77f290>]}
[0m14:53:40.249572 [info ] [Thread-1 (]: 18 of 19 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.26s]
[0m14:53:40.249929 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:53:40.344395 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:53:40.349455 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.350200 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:53:40.352005 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.356078 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.356594 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:53:40.358071 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.360899 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:53:40.361162 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.361347 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:53:40.373336 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:40.376122 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:53:40.376389 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:53:40.382157 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:40.383411 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:53:39.996511 => 14:53:40.383271
[0m14:53:40.383634 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:53:40.384270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c6c50>]}
[0m14:53:40.384724 [info ] [Thread-2 (]: 17 of 19 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.40s]
[0m14:53:40.385382 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:53:40.667958 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:53:40.672329 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.672865 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:53:40.674872 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.679083 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.679596 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:53:40.680939 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.682338 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:53:40.682542 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.682706 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:53:40.690869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:40.693995 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:53:40.694274 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:53:40.697251 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:40.698078 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:53:39.993154 => 14:53:40.697985
[0m14:53:40.698264 [debug] [Thread-3 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:53:40.698637 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a763490>]}
[0m14:53:40.698930 [info ] [Thread-3 (]: 16 of 19 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.72s]
[0m14:53:40.699259 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:53:40.911073 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:53:40.917720 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.918341 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:53:40.919705 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.922681 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.924066 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:53:40.924880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:40.926137 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:53:40.926316 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.926472 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:53:40.935590 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:40.936934 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:53:40.937106 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:53:40.968344 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:53:40.970791 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:53:40.001085 => 14:53:40.970539
[0m14:53:40.971316 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:53:40.972315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1cb9bf-8507-4e31-9ff3-13445c2406a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53ced0>]}
[0m14:53:40.973055 [info ] [Thread-4 (]: 19 of 19 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.99s]
[0m14:53:40.973941 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:53:40.976300 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:40.976607 [debug] [MainThread]: On master: BEGIN
[0m14:53:40.976766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:40.986192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:40.986492 [debug] [MainThread]: On master: COMMIT
[0m14:53:40.986641 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:40.986879 [debug] [MainThread]: On master: COMMIT
[0m14:53:40.987521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:40.987722 [debug] [MainThread]: On master: Close
[0m14:53:40.988105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:40.988262 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:53:40.988388 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:53:40.988507 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:53:40.988624 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:53:40.988829 [info ] [MainThread]: 
[0m14:53:40.989035 [info ] [MainThread]: Finished running 1 view model, 18 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m14:53:40.990455 [debug] [MainThread]: Command end result
[0m14:53:40.994554 [info ] [MainThread]: 
[0m14:53:40.994811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:40.995038 [info ] [MainThread]: 
[0m14:53:40.995266 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m14:53:40.995736 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:40.995678 after 2.24 seconds
[0m14:53:40.995961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104565e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60de10>]}
[0m14:53:40.996142 [debug] [MainThread]: Flushing usage events
[0m14:54:22.034187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06f50>]}


============================== 14:54:22.037748 | e1adafe4-0453-4fd7-b538-676a5db07066 ==============================
[0m14:54:22.037748 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:22.038135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:22.079449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f30150>]}
[0m14:54:22.086457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efb410>]}
[0m14:54:22.086833 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:54:22.097276 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:22.121370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:54:22.121717 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_tenure.sql
[0m14:54:22.133594 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_tenure.sql
[0m14:54:22.162350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcc250>]}
[0m14:54:22.166524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdf9d0>]}
[0m14:54:22.166740 [info ] [MainThread]: Found 20 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:54:22.166958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ded090>]}
[0m14:54:22.168191 [info ] [MainThread]: 
[0m14:54:22.168644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:22.169567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:54:22.174850 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:54:22.175085 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:54:22.175238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:22.268487 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:54:22.269751 [debug] [ThreadPool]: On list_mydb: Close
[0m14:54:22.271617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:54:22.276203 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:22.276463 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:54:22.276655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:22.287179 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.287518 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:54:22.287783 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:54:22.295988 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m14:54:22.297459 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:54:22.298394 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:54:22.304360 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:22.304619 [debug] [MainThread]: On master: BEGIN
[0m14:54:22.304808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:22.315305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.315599 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:22.315946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:22.338381 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:54:22.340060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f07750>]}
[0m14:54:22.340375 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:22.341160 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:22.341377 [debug] [MainThread]: On master: BEGIN
[0m14:54:22.342588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.342839 [debug] [MainThread]: On master: COMMIT
[0m14:54:22.343072 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:22.343386 [debug] [MainThread]: On master: COMMIT
[0m14:54:22.344082 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.344286 [debug] [MainThread]: On master: Close
[0m14:54:22.344724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:22.344999 [info ] [MainThread]: 
[0m14:54:22.348194 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:54:22.348464 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:54:22.348695 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:54:22.348917 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:54:22.349189 [info ] [Thread-1 (]: 1 of 20 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:54:22.349573 [info ] [Thread-2 (]: 2 of 20 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:54:22.349937 [info ] [Thread-3 (]: 3 of 20 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:54:22.350332 [info ] [Thread-4 (]: 4 of 20 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:54:22.350890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:54:22.351352 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:54:22.351782 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:54:22.352206 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:54:22.352430 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:54:22.352647 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:54:22.352859 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:54:22.353067 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:54:22.355085 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:54:22.356988 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:54:22.358762 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:54:22.360529 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:54:22.361445 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:54:22.353221 => 14:54:22.361282
[0m14:54:22.361730 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:54:22.355273 => 14:54:22.361610
[0m14:54:22.362073 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:54:22.362380 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:54:22.357174 => 14:54:22.362244
[0m14:54:22.362648 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:54:22.362913 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:54:22.358971 => 14:54:22.362787
[0m14:54:22.386435 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:54:22.386667 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:54:22.389157 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:54:22.389351 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:54:22.391627 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:54:22.401399 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:54:22.401594 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.401879 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:54:22.402088 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.402304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.402471 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.402636 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.402800 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:54:22.403047 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:54:22.403218 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:54:22.403377 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:22.403526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:22.403678 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:22.413308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.413616 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.413921 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:54:22.414207 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.414576 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.414818 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.415041 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:54:22.415227 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.415466 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:54:22.415980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.416168 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.416345 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:54:22.420887 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:54:22.424629 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.424899 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:54:22.433107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.436203 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.436468 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:54:22.437943 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.446794 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:54:22.449452 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:54:22.449670 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:54:22.451366 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.451567 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.452836 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.453022 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:54:22.453191 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:54:22.453352 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:54:22.454851 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.455034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.456664 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.458123 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.458323 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:54:22.458539 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:54:22.459726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.459915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.463264 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:54:22.463447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.464718 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:54:22.464922 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.467658 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:54:22.467852 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.468033 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:54:22.468207 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:54:22.468375 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:54:22.470909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.471075 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.472413 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:54:22.473584 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:54:22.473776 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:54:22.473980 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:54:22.474683 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:54:22.475496 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:54:22.391883 => 14:54:22.475402
[0m14:54:22.475686 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:54:22.476093 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffb050>]}
[0m14:54:22.476426 [info ] [Thread-4 (]: 4 of 20 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:54:22.476770 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:54:22.477218 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:54:22.477643 [info ] [Thread-4 (]: 5 of 20 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:54:22.478140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:54:22.478367 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:54:22.480216 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:54:22.480462 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.480854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.482070 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:54:22.386829 => 14:54:22.481966
[0m14:54:22.482842 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:54:22.363078 => 14:54:22.482753
[0m14:54:22.483071 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:54:22.483285 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:54:22.478500 => 14:54:22.483182
[0m14:54:22.483478 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:54:22.483703 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:54:22.484075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef8bd0>]}
[0m14:54:22.484448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0650>]}
[0m14:54:22.487105 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:54:22.487543 [info ] [Thread-2 (]: 2 of 20 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.13s]
[0m14:54:22.487949 [info ] [Thread-1 (]: 1 of 20 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:54:22.488457 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:54:22.488755 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:54:22.488988 [debug] [Thread-2 (]: Began running node model.maker_warehouse.movies
[0m14:54:22.489199 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:22.489511 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_dim
[0m14:54:22.489807 [info ] [Thread-2 (]: 6 of 20 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:54:22.490132 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:54:22.490367 [info ] [Thread-1 (]: 7 of 20 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:54:22.490831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.movies)
[0m14:54:22.491025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:22.491332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.salary_dim)
[0m14:54:22.491510 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.movies
[0m14:54:22.492002 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:54:22.494490 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:54:22.496438 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:54:22.496993 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (compile): 14:54:22.492161 => 14:54:22.496889
[0m14:54:22.497228 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:54:22.494759 => 14:54:22.497125
[0m14:54:22.497405 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.movies
[0m14:54:22.497584 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:54:22.500163 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:54:22.503853 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:54:22.504459 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.504711 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.504923 [debug] [Thread-2 (]: On model.maker_warehouse.movies: BEGIN
[0m14:54:22.505098 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:54:22.505273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:22.505433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.506109 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.506397 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:22.506795 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:22.517113 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.517413 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.517601 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:22.521592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.521929 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.522132 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:54:22.539286 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:54:22.541089 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.541310 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:54:22.543083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.544860 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.545069 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:54:22.546714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.548154 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:54:22.548362 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.548536 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:54:22.560082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.562444 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:54:22.562854 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:54:22.569890 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.570809 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:54:22.500371 => 14:54:22.570714
[0m14:54:22.571009 [debug] [Thread-1 (]: On model.maker_warehouse.salary_dim: Close
[0m14:54:22.571409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143290>]}
[0m14:54:22.571709 [info ] [Thread-1 (]: 7 of 20 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.08s]
[0m14:54:22.572041 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:54:22.572255 [debug] [Thread-1 (]: Began running node model.maker_warehouse.users
[0m14:54:22.572639 [info ] [Thread-1 (]: 8 of 20 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:54:22.573049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:54:22.573231 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.users
[0m14:54:22.574965 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:54:22.575448 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (compile): 14:54:22.573355 => 14:54:22.575346
[0m14:54:22.575638 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.users
[0m14:54:22.578245 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:54:22.578700 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:22.578877 [debug] [Thread-1 (]: On model.maker_warehouse.users: BEGIN
[0m14:54:22.579045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.589021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.589538 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:22.589795 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:54:22.668000 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:54:22.669936 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.670156 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:54:22.671871 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.673568 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.673760 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:54:22.675065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.676347 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:54:22.676528 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.676686 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:54:22.692975 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.694588 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:54:22.694793 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:54:22.699911 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.700900 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:54:22.389537 => 14:54:22.700804
[0m14:54:22.701112 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:54:22.701511 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111140410>]}
[0m14:54:22.701808 [info ] [Thread-3 (]: 3 of 20 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.35s]
[0m14:54:22.702141 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:54:22.702356 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:54:22.702648 [info ] [Thread-3 (]: 9 of 20 START sql table model dbt_warehouse.customer_balances .................. [RUN]
[0m14:54:22.703061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.customer_balances)
[0m14:54:22.703254 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:54:22.704921 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:54:22.705866 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:54:22.703381 => 14:54:22.705744
[0m14:54:22.706079 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:54:22.708687 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:54:22.709449 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.709637 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:54:22.709798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:22.721823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.722153 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.722682 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:54:22.733599 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:54:22.735446 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.735669 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:54:22.737079 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.738788 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.738999 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:54:22.740244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.741631 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:54:22.741835 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.741996 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:54:22.756780 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.758203 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:54:22.759360 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:54:22.769006 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.769953 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:54:22.706202 => 14:54:22.769858
[0m14:54:22.770151 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:54:22.770547 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcbf50>]}
[0m14:54:22.770909 [info ] [Thread-3 (]: 9 of 20 OK created sql table model dbt_warehouse.customer_balances ............. [[32mSELECT 0[0m in 0.07s]
[0m14:54:22.771244 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:54:22.771449 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:54:22.771658 [info ] [Thread-3 (]: 10 of 20 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:54:22.772339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:54:22.772521 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:54:22.774039 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:54:22.774689 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:54:22.772632 => 14:54:22.774570
[0m14:54:22.774895 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:54:22.777510 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:54:22.777966 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.778142 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:54:22.778305 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:22.788489 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.788923 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.789159 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:54:22.796971 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:54:22.798812 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.799027 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:54:22.800309 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.801944 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.802147 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:54:22.803221 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.804537 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:54:22.804732 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.804895 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:54:22.816440 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.818015 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:54:22.818229 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:54:22.826734 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.827658 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:54:22.775017 => 14:54:22.827564
[0m14:54:22.827869 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:54:22.828266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bbf50>]}
[0m14:54:22.828566 [info ] [Thread-3 (]: 10 of 20 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.06s]
[0m14:54:22.829114 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:54:22.829339 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:54:22.829812 [info ] [Thread-3 (]: 11 of 20 START sql table model dbt_warehouse.sum_avg_age_by_geography .......... [RUN]
[0m14:54:22.830742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_age_by_geography)
[0m14:54:22.830962 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_age_by_geography
[0m14:54:22.832467 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.833051 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (compile): 14:54:22.831084 => 14:54:22.832950
[0m14:54:22.833232 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_age_by_geography
[0m14:54:22.835844 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.836265 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.836436 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: BEGIN
[0m14:54:22.836597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:22.848030 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.848402 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.848600 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	geography,
	AVG(age) AS average_age
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY geography
  );
  
[0m14:54:22.860744 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:54:22.862442 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.862651 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography" rename to "sum_avg_age_by_geography__dbt_backup"
[0m14:54:22.864113 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.865777 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.865990 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp" rename to "sum_avg_age_by_geography"
[0m14:54:22.878332 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.879783 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:54:22.879980 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.880148 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:54:22.883363 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.884858 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:54:22.885060 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_backup" cascade
[0m14:54:22.894593 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.895485 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (execute): 14:54:22.833347 => 14:54:22.895390
[0m14:54:22.895686 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: Close
[0m14:54:22.896076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110daa4d0>]}
[0m14:54:22.896377 [info ] [Thread-3 (]: 11 of 20 OK created sql table model dbt_warehouse.sum_avg_age_by_geography ..... [[32mSELECT 3[0m in 0.07s]
[0m14:54:22.896693 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:54:22.897356 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:54:22.897825 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:22.897643 [info ] [Thread-3 (]: 12 of 20 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:54:22.899722 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.900115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_age_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:54:22.900350 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:54:22.900579 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:54:22.902187 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.902415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.904129 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.904352 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:54:22.904660 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:54:22.900778 => 14:54:22.904555
[0m14:54:22.904874 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:54:22.907316 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.907506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.908915 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:22.909231 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.909402 [debug] [Thread-2 (]: On model.maker_warehouse.movies: COMMIT
[0m14:54:22.910104 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.910333 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:54:22.910615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:22.920902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.921283 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.921489 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:54:22.922133 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.924591 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:54:22.924832 [debug] [Thread-2 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:54:22.935182 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.936068 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.movies (execute): 14:54:22.497712 => 14:54:22.935978
[0m14:54:22.936262 [debug] [Thread-2 (]: On model.maker_warehouse.movies: Close
[0m14:54:22.936641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d08d0>]}
[0m14:54:22.936927 [info ] [Thread-2 (]: 6 of 20 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.45s]
[0m14:54:22.937248 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.movies
[0m14:54:22.937463 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:54:22.938220 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:54:22.937761 [info ] [Thread-2 (]: 13 of 20 START sql table model dbt_warehouse.sum_total_customers_by_tenure ..... [RUN]
[0m14:54:22.940458 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.940840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_total_customers_by_tenure)
[0m14:54:22.941057 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:54:22.941507 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:54:22.944419 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.944672 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.946376 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.946593 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:54:22.946882 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (compile): 14:54:22.942019 => 14:54:22.946768
[0m14:54:22.947084 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:54:22.949540 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.949732 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.951050 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:54:22.951259 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.951437 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:54:22.951609 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.951822 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: BEGIN
[0m14:54:22.951985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:22.961217 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:22.962713 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:54:22.963093 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:54:22.963706 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.963929 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.964124 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	tenure,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY tenure
  );
  
[0m14:54:22.974527 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:22.975473 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:54:22.905005 => 14:54:22.975375
[0m14:54:22.975677 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:54:22.976066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11110b450>]}
[0m14:54:22.976363 [info ] [Thread-3 (]: 12 of 20 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.08s]
[0m14:54:22.976696 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:54:22.977390 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:54:22.978196 [info ] [Thread-3 (]: 14 of 20 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:54:22.979488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:54:22.979754 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:54:22.981351 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:22.981553 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:54:22.983266 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.983498 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp" rename to "sum_total_customers_by_tenure"
[0m14:54:22.983730 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:54:22.979875 => 14:54:22.983612
[0m14:54:22.983969 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:54:22.986347 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:22.986551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:22.987704 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:54:22.987904 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:22.988078 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:22.988283 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:54:22.988455 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:54:22.988657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:22.998582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:22.998912 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:22.999112 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:54:23.000514 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.002051 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:54:23.002268 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_backup" cascade
[0m14:54:23.003295 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.004100 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (execute): 14:54:22.947206 => 14:54:23.004005
[0m14:54:23.004297 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: Close
[0m14:54:23.004682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c0410>]}
[0m14:54:23.004982 [info ] [Thread-2 (]: 13 of 20 OK created sql table model dbt_warehouse.sum_total_customers_by_tenure  [[32mSELECT 11[0m in 0.06s]
[0m14:54:23.005301 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:54:23.005512 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:54:23.006140 [info ] [Thread-2 (]: 15 of 20 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:54:23.006617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_tenure, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:54:23.006842 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:54:23.008948 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.009625 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:54:23.006975 => 14:54:23.009365
[0m14:54:23.009840 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:54:23.012610 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.013087 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.013265 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:54:23.013428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:23.018252 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:54:23.020028 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:23.020260 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:54:23.021589 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.023213 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:23.023437 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:54:23.024753 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.027766 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:54:23.028008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.028222 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:23.028403 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.028578 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:54:23.028764 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:54:23.052387 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.053853 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:54:23.054059 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:54:23.064466 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:54:23.064710 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.066357 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.067099 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:54:22.984092 => 14:54:23.067007
[0m14:54:23.067293 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group" rename to "sum_avg_credit_score_by_age_group__dbt_backup"
[0m14:54:23.067504 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:54:23.067948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143990>]}
[0m14:54:23.068264 [info ] [Thread-3 (]: 14 of 20 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.09s]
[0m14:54:23.068585 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:54:23.068794 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:54:23.069240 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.070232 [info ] [Thread-3 (]: 16 of 20 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:54:23.072778 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.073201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:54:23.073383 [debug] [Thread-1 (]: SQL status: SELECT 161918 in 0.0 seconds
[0m14:54:23.073572 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:54:23.073758 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:54:23.075258 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:23.077418 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.077679 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.077903 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:54:23.079258 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:54:23.079547 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.079858 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:54:23.075561 => 14:54:23.079753
[0m14:54:23.080020 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:54:23.080205 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:54:23.082858 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.083088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.084816 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:23.085049 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:54:23.085225 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.085455 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:54:23.085625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:23.086244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.087716 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:54:23.087906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.088100 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:23.089298 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:54:23.089487 [debug] [Thread-1 (]: On model.maker_warehouse.users: COMMIT
[0m14:54:23.089669 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:54:23.094745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.095165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.096718 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:54:23.096977 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.097174 [debug] [Thread-1 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:54:23.097385 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:54:23.098373 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.099164 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:54:23.009962 => 14:54:23.099073
[0m14:54:23.099377 [debug] [Thread-2 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:54:23.099779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f01950>]}
[0m14:54:23.100074 [info ] [Thread-2 (]: 15 of 20 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.09s]
[0m14:54:23.100394 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:54:23.104132 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:54:23.105977 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:23.106185 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:54:23.107669 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.109604 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:23.109861 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:54:23.111262 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.112920 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:23.113140 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:23.113321 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:54:23.115055 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:54:23.116653 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.116838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.116983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.117171 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:54:23.117857 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.users (execute): 14:54:22.575759 => 14:54:23.117772
[0m14:54:23.119078 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:54:23.119302 [debug] [Thread-1 (]: On model.maker_warehouse.users: Close
[0m14:54:23.119482 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:54:23.119882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115ce90>]}
[0m14:54:23.120080 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.122032 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.120362 [info ] [Thread-1 (]: 8 of 20 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.55s]
[0m14:54:23.122368 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:54:23.122694 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.users
[0m14:54:23.123930 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.125364 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:54:23.125583 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.125765 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:54:23.127389 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.130241 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:54:23.130491 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:54:23.133919 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.134963 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:54:23.080357 => 14:54:23.134854
[0m14:54:23.135188 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:54:23.135615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d69290>]}
[0m14:54:23.135955 [info ] [Thread-3 (]: 16 of 20 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.06s]
[0m14:54:23.136335 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:54:23.169677 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.170536 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:54:22.484581 => 14:54:23.170453
[0m14:54:23.170714 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:54:23.171083 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111528750>]}
[0m14:54:23.171372 [info ] [Thread-4 (]: 5 of 20 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.69s]
[0m14:54:23.171712 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:54:23.172106 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:54:23.172340 [info ] [Thread-2 (]: 17 of 20 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:54:23.172652 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:23.172996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_genre_views)
[0m14:54:23.173167 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:54:23.173369 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:54:23.173588 [info ] [Thread-1 (]: 18 of 20 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:54:23.173822 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:54:23.174024 [info ] [Thread-3 (]: 19 of 20 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:54:23.174279 [info ] [Thread-4 (]: 20 of 20 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:54:23.174699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:54:23.176659 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:54:23.177161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_views)
[0m14:54:23.177717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:54:23.177911 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:23.178138 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:54:23.178310 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:54:23.179814 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.181171 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:54:23.182399 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:54:23.182594 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:54:23.174881 => 14:54:23.182508
[0m14:54:23.183010 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:54:23.178466 => 14:54:23.182914
[0m14:54:23.183199 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:54:23.179969 => 14:54:23.183120
[0m14:54:23.183364 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:54:23.183672 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:23.183872 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:54:23.184060 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:54:23.181325 => 14:54:23.183968
[0m14:54:23.186383 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:54:23.188630 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.191040 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:54:23.191326 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:54:23.191808 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.192038 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.192250 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.195025 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:54:23.195331 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:54:23.195515 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:54:23.195684 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:54:23.195898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:23.196086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:23.196255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:23.196423 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:23.196784 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:54:23.196935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:23.206464 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.207044 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.207372 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.207791 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:23.208004 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.208233 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:54:23.208469 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:54:23.208725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:23.208918 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.209169 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.209371 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:54:23.209601 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:54:23.479785 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:23.480324 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:54:23.482175 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.483602 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.483816 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:54:23.484015 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:54:23.485450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.485928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.489279 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.491083 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.491342 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:54:23.491539 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:54:23.493284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.493769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.495578 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:23.496985 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:23.497214 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.497386 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.497550 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:54:23.497710 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:54:23.499202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.500838 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:54:23.501065 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.501283 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:54:23.503471 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:54:23.503773 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:54:23.507920 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.508812 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:54:23.186555 => 14:54:23.508722
[0m14:54:23.508984 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.509437 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:54:23.510149 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:54:23.188823 => 14:54:23.510068
[0m14:54:23.510540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153bed0>]}
[0m14:54:23.510730 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:54:23.511319 [info ] [Thread-1 (]: 18 of 20 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.34s]
[0m14:54:23.512503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d35cd0>]}
[0m14:54:23.512815 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:54:23.513532 [info ] [Thread-3 (]: 19 of 20 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.34s]
[0m14:54:23.514671 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:54:23.780359 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:54:23.785158 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.786042 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:54:23.787854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.792686 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.793210 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:54:23.794379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:23.795796 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:54:23.795983 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.796144 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:54:23.806402 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:23.809793 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:54:23.810055 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:54:23.812985 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:23.813746 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:54:23.184182 => 14:54:23.813659
[0m14:54:23.813927 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:54:23.814284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143590>]}
[0m14:54:23.814561 [info ] [Thread-2 (]: 17 of 20 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.64s]
[0m14:54:23.814868 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:54:24.044885 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:54:24.050207 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:24.050960 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:54:24.052823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:24.057488 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:24.058047 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:54:24.058920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:24.060361 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:54:24.060540 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:24.060697 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:54:24.082473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:24.087280 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:54:24.087687 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:54:24.100630 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:24.102945 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:54:23.192413 => 14:54:24.102691
[0m14:54:24.103508 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:54:24.104510 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1adafe4-0453-4fd7-b538-676a5db07066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eba350>]}
[0m14:54:24.105335 [info ] [Thread-4 (]: 20 of 20 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.93s]
[0m14:54:24.105756 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:54:24.106782 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:24.106964 [debug] [MainThread]: On master: BEGIN
[0m14:54:24.107100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:24.115683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:24.115978 [debug] [MainThread]: On master: COMMIT
[0m14:54:24.116144 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:24.116290 [debug] [MainThread]: On master: COMMIT
[0m14:54:24.116915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:24.117086 [debug] [MainThread]: On master: Close
[0m14:54:24.117418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:24.117566 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:54:24.117693 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:54:24.117812 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:54:24.117928 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:54:24.118111 [info ] [MainThread]: 
[0m14:54:24.118312 [info ] [MainThread]: Finished running 1 view model, 19 table models in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m14:54:24.119797 [debug] [MainThread]: Command end result
[0m14:54:24.124381 [info ] [MainThread]: 
[0m14:54:24.124656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:24.124850 [info ] [MainThread]: 
[0m14:54:24.125073 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m14:54:24.125472 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:24.125415 after 2.11 seconds
[0m14:54:24.125686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ae67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2ddd0>]}
[0m14:54:24.125891 [debug] [MainThread]: Flushing usage events
[0m14:55:31.387651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108127710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108149090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108149e50>]}


============================== 14:55:31.391436 | 1dfbc556-b3c2-45e4-b7f7-a499091aa404 ==============================
[0m14:55:31.391436 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:55:31.391801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:31.432511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108148b10>]}
[0m14:55:31.439508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815bc50>]}
[0m14:55:31.439867 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:55:31.450696 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:55:31.474252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:55:31.474607 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_credit_score_range.sql
[0m14:55:31.486755 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_credit_score_range.sql
[0m14:55:31.517771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a48750>]}
[0m14:55:31.521884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c7ed0>]}
[0m14:55:31.522098 [info ] [MainThread]: Found 21 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:31.522309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5090>]}
[0m14:55:31.523472 [info ] [MainThread]: 
[0m14:55:31.523890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:31.524783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:55:31.530380 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:55:31.530686 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:55:31.530831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:31.599806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:55:31.600929 [debug] [ThreadPool]: On list_mydb: Close
[0m14:55:31.602565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:55:31.606782 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:55:31.607068 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:55:31.607246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:31.617605 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.617908 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:55:31.618146 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:55:31.626540 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m14:55:31.627820 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:55:31.628671 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:55:31.634392 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.634632 [debug] [MainThread]: On master: BEGIN
[0m14:55:31.634811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:31.646422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.646715 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.647007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:31.669607 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:55:31.671335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d3ed0>]}
[0m14:55:31.671677 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:31.672578 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.672798 [debug] [MainThread]: On master: BEGIN
[0m14:55:31.674107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.674327 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.674530 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.674724 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.675467 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.675746 [debug] [MainThread]: On master: Close
[0m14:55:31.676252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:31.676565 [info ] [MainThread]: 
[0m14:55:31.680377 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:55:31.680653 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:55:31.680916 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:55:31.681196 [info ] [Thread-1 (]: 1 of 21 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:55:31.681532 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:55:31.681811 [info ] [Thread-2 (]: 2 of 21 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:55:31.682148 [info ] [Thread-3 (]: 3 of 21 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:55:31.682668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:55:31.682942 [info ] [Thread-4 (]: 4 of 21 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:55:31.683488 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:55:31.683974 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:55:31.684224 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:55:31.684642 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:55:31.684862 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:55:31.685074 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:55:31.687118 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:55:31.687368 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:55:31.689115 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:55:31.690693 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:55:31.692379 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:55:31.692844 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:55:31.685228 => 14:55:31.692725
[0m14:55:31.693171 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:55:31.687530 => 14:55:31.693030
[0m14:55:31.693483 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:55:31.693747 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:55:31.689285 => 14:55:31.693639
[0m14:55:31.693998 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:55:31.694224 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:55:31.690917 => 14:55:31.694127
[0m14:55:31.716686 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:55:31.716911 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:55:31.719243 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:55:31.719439 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:55:31.721745 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:55:31.731342 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:55:31.731538 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.731750 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.731999 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:55:31.732206 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:31.732394 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:55:31.732556 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.732717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.732879 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:55:31.733027 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:31.733176 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:55:31.733402 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:31.733629 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:31.744020 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.744336 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.744604 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:55:31.745272 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.745552 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.745737 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:55:31.746992 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.747262 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:31.747600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.747806 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:55:31.748040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.748284 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:55:31.750921 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:55:31.754764 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.755054 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:55:31.756566 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.759348 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.759593 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:55:31.760858 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.771579 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:55:31.771901 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.772081 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:55:31.776393 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:55:31.778371 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.778612 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:55:31.780381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.782246 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.782447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.782680 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:55:31.785696 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:55:31.785906 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:55:31.786162 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:55:31.787747 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.787919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.788138 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:55:31.791297 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:55:31.791571 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.791746 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:55:31.792883 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.794629 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.794851 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:55:31.795314 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:55:31.796084 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:55:31.721983 => 14:55:31.795984
[0m14:55:31.796272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.796430 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.796590 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:55:31.797861 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:55:31.799128 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:55:31.799367 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:55:31.799768 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896b790>]}
[0m14:55:31.800028 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.800559 [info ] [Thread-4 (]: 4 of 21 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:55:31.801465 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:55:31.802487 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:55:31.803352 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:55:31.803991 [info ] [Thread-4 (]: 5 of 21 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:55:31.804468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:55:31.804657 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:55:31.806639 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:55:31.806952 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.808769 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:55:31.809375 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:55:31.809869 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:55:31.804808 => 14:55:31.809733
[0m14:55:31.810249 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:31.810697 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:55:31.812455 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:55:31.694373 => 14:55:31.812345
[0m14:55:31.815497 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:55:31.815834 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:55:31.816704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108844050>]}
[0m14:55:31.817383 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:31.817652 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:31.817126 [info ] [Thread-1 (]: 1 of 21 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.13s]
[0m14:55:31.818118 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:55:31.819010 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:55:31.717054 => 14:55:31.818907
[0m14:55:31.819336 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:55:31.819622 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:31.819878 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:55:31.820116 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:55:31.820757 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fffd0>]}
[0m14:55:31.821022 [info ] [Thread-1 (]: 6 of 21 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:55:31.821392 [info ] [Thread-2 (]: 2 of 21 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.14s]
[0m14:55:31.821852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:55:31.822220 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:55:31.822426 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:55:31.823015 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:55:31.825487 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:55:31.825840 [info ] [Thread-2 (]: 7 of 21 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:55:31.826556 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:55:31.823978 => 14:55:31.826383
[0m14:55:31.827617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:55:31.827887 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:55:31.828090 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:55:31.831181 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:55:31.833146 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:55:31.834042 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:31.834293 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:55:31.834564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.834830 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:55:31.831462 => 14:55:31.834721
[0m14:55:31.835179 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:55:31.839058 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:55:31.839349 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.839740 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:31.839948 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:55:31.840476 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.840679 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:55:31.840848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:31.851271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.851682 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:31.851896 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:55:31.862222 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.862794 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.863464 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:55:31.885997 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:55:31.887953 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.888192 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:55:31.889689 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.891588 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.891828 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:55:31.894122 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.895589 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:55:31.895792 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.895959 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:55:31.907745 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.909341 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:55:31.909548 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:55:31.922002 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:31.922979 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:55:31.835308 => 14:55:31.922885
[0m14:55:31.923178 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:55:31.923574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a24950>]}
[0m14:55:31.923882 [info ] [Thread-2 (]: 7 of 21 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.10s]
[0m14:55:31.924209 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:55:31.924422 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:55:31.924864 [info ] [Thread-2 (]: 8 of 21 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:55:31.925676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:55:31.926364 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:55:31.929511 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:55:31.930271 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:55:31.926785 => 14:55:31.930153
[0m14:55:31.930485 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:55:31.933434 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:55:31.934057 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:31.934246 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:55:31.934426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:31.946855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.947255 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:31.947459 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:55:32.014749 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:55:32.016516 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:32.016738 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:55:32.018087 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.019743 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:32.019937 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:55:32.020987 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.022231 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:55:32.022415 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:32.022572 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:55:32.033617 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.035179 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:55:32.035384 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:55:32.039755 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.040687 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:55:31.719632 => 14:55:32.040592
[0m14:55:32.040899 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:55:32.041295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108969a50>]}
[0m14:55:32.041593 [info ] [Thread-3 (]: 3 of 21 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.36s]
[0m14:55:32.041924 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:55:32.042132 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:55:32.042665 [info ] [Thread-3 (]: 9 of 21 START sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [RUN]
[0m14:55:32.043425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_credit_score_range)
[0m14:55:32.043965 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:55:32.047035 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.047811 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (compile): 14:55:32.044332 => 14:55:32.047596
[0m14:55:32.048015 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:55:32.051291 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.051765 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.051943 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: BEGIN
[0m14:55:32.052107 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.064210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.064521 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.064721 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN creditscore < 600 THEN 'Poor (Below 600)'
		WHEN creditscore >= 600 AND creditscore < 700 THEN 'Fair (600-699)'
		WHEN creditscore >= 700 AND creditscore < 800 THEN 'Good (700-799)'
		ELSE 'Excellent (800+)'
	END AS credit_score_range,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."banking_fact"
GROUP BY credit_score_range
  );
  
[0m14:55:32.078263 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:55:32.079994 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.080208 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp" rename to "sum_total_customers_by_credit_score_range"
[0m14:55:32.081325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.082627 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:55:32.082826 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.082998 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:55:32.093655 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.095009 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:55:32.095207 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_backup" cascade
[0m14:55:32.096140 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.096879 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (execute): 14:55:32.048144 => 14:55:32.096787
[0m14:55:32.097072 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: Close
[0m14:55:32.097436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1f110>]}
[0m14:55:32.097724 [info ] [Thread-3 (]: 9 of 21 OK created sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [[32mSELECT 4[0m in 0.05s]
[0m14:55:32.098041 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:55:32.098242 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:55:32.098790 [info ] [Thread-3 (]: 10 of 21 START sql table model dbt_warehouse.customer_balances ................. [RUN]
[0m14:55:32.099415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_credit_score_range, now model.maker_warehouse.customer_balances)
[0m14:55:32.099626 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:55:32.101450 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:55:32.102486 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:55:32.099754 => 14:55:32.102373
[0m14:55:32.102682 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:55:32.106103 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:55:32.107002 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.107184 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:55:32.107560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.122429 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.122794 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.122993 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:55:32.132630 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:55:32.134437 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.134654 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:55:32.135933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.137460 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.137658 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:55:32.138780 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.140223 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:55:32.140419 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.140586 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:55:32.153393 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.154828 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:55:32.155035 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:55:32.160204 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.161074 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:55:32.102801 => 14:55:32.160984
[0m14:55:32.161270 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:55:32.161654 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a090>]}
[0m14:55:32.161942 [info ] [Thread-3 (]: 10 of 21 OK created sql table model dbt_warehouse.customer_balances ............ [[32mSELECT 0[0m in 0.06s]
[0m14:55:32.162254 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:55:32.162453 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:55:32.162808 [info ] [Thread-3 (]: 11 of 21 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:55:32.163221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:55:32.163401 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:55:32.165089 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:55:32.165545 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:55:32.163521 => 14:55:32.165449
[0m14:55:32.165721 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:55:32.168259 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:55:32.168698 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.168876 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:55:32.169041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.181655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.181971 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.182155 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:55:32.191674 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:55:32.193484 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.193716 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:55:32.195172 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.196865 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.197076 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:55:32.198328 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.199648 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:55:32.199838 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.200000 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:55:32.211891 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.213404 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:55:32.213603 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:55:32.224408 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.225312 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:55:32.165837 => 14:55:32.225220
[0m14:55:32.225510 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:55:32.225897 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ebbd0>]}
[0m14:55:32.226202 [info ] [Thread-3 (]: 11 of 21 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.06s]
[0m14:55:32.226525 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:55:32.226732 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:55:32.226937 [info ] [Thread-3 (]: 12 of 21 START sql table model dbt_warehouse.sum_avg_age_by_geography .......... [RUN]
[0m14:55:32.227418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_age_by_geography)
[0m14:55:32.227632 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_age_by_geography
[0m14:55:32.229144 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.229636 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (compile): 14:55:32.227762 => 14:55:32.229533
[0m14:55:32.229822 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_age_by_geography
[0m14:55:32.232359 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.232812 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.232995 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: BEGIN
[0m14:55:32.233163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.243221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.243600 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.243821 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	geography,
	AVG(age) AS average_age
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY geography
  );
  
[0m14:55:32.254772 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:55:32.256625 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.256840 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography" rename to "sum_avg_age_by_geography__dbt_backup"
[0m14:55:32.276843 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.280113 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.280361 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp" rename to "sum_avg_age_by_geography"
[0m14:55:32.284725 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.286230 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:55:32.286465 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.286642 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:55:32.314304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.315870 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:55:32.316058 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:55:32.316271 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_backup" cascade
[0m14:55:32.318521 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:32.318780 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:55:32.319953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.321547 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:32.321769 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:55:32.323069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.324407 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:55:32.324619 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:32.324783 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:55:32.328710 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.329829 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (execute): 14:55:32.229935 => 14:55:32.329730
[0m14:55:32.330029 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: Close
[0m14:55:32.330408 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a42310>]}
[0m14:55:32.330707 [info ] [Thread-3 (]: 12 of 21 OK created sql table model dbt_warehouse.sum_avg_age_by_geography ..... [[32mSELECT 3[0m in 0.10s]
[0m14:55:32.331023 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:55:32.331579 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:55:32.333229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.332941 [info ] [Thread-3 (]: 13 of 21 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:55:32.334994 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:55:32.335375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_age_by_geography, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:55:32.335573 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:55:32.335766 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:55:32.337496 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.338094 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:55:32.335966 => 14:55:32.337993
[0m14:55:32.338277 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:55:32.340830 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.341254 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.341453 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:55:32.341659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.353624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.353957 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.354152 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:55:32.357616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.358587 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:55:31.828215 => 14:55:32.358491
[0m14:55:32.358787 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:55:32.359190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886f190>]}
[0m14:55:32.359496 [info ] [Thread-1 (]: 6 of 21 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.54s]
[0m14:55:32.359821 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:55:32.360066 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:55:32.360992 [info ] [Thread-1 (]: 14 of 21 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:55:32.362589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:55:32.363093 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:55:32.365359 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.365987 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:55:32.363243 => 14:55:32.365869
[0m14:55:32.366193 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:55:32.369031 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.369534 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.370048 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:55:32.370241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:32.375753 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:55:32.377878 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.379105 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:55:32.380948 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.382829 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.383103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.383421 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:55:32.383670 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.384140 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:55:32.385775 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.387913 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:55:32.388184 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.388376 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:55:32.401612 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.403007 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:55:32.403207 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:55:32.409401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.410290 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:55:32.338393 => 14:55:32.410195
[0m14:55:32.410502 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:55:32.410875 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a75690>]}
[0m14:55:32.411166 [info ] [Thread-3 (]: 13 of 21 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.08s]
[0m14:55:32.411485 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:55:32.411693 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:55:32.412024 [info ] [Thread-3 (]: 15 of 21 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:55:32.412448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:55:32.412658 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:55:32.412956 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:55:32.414839 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.416407 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.416627 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group" rename to "sum_avg_credit_score_by_age_group__dbt_backup"
[0m14:55:32.417042 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:55:32.415063 => 14:55:32.416947
[0m14:55:32.417215 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:55:32.419550 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.419741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.421362 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.421584 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:55:32.421827 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.422005 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:55:32.422166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.422652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.424029 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:55:32.424251 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.424427 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:55:32.432355 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.432733 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.432934 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:55:32.435093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.437541 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:55:32.437798 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:55:32.442596 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:55:32.444366 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.444607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.444843 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:55:32.445660 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:55:32.366320 => 14:55:32.445563
[0m14:55:32.445925 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:55:32.446309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071462d0>]}
[0m14:55:32.446602 [info ] [Thread-1 (]: 14 of 21 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.08s]
[0m14:55:32.446928 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:55:32.447140 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:55:32.447352 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.447617 [info ] [Thread-1 (]: 16 of 21 START sql table model dbt_warehouse.sum_total_customers_by_tenure ..... [RUN]
[0m14:55:32.449444 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.449866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_total_customers_by_tenure)
[0m14:55:32.450080 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:55:32.450261 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:55:32.451833 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.452049 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.453391 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:55:32.453737 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (compile): 14:55:32.450418 => 14:55:32.453639
[0m14:55:32.453897 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.454084 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:55:32.454257 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:55:32.456644 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.457084 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.457277 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: BEGIN
[0m14:55:32.457441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:32.466023 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.467555 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:55:32.467816 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:55:32.469439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.469758 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.469955 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	tenure,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY tenure
  );
  
[0m14:55:32.474365 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.475348 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:55:32.417326 => 14:55:32.475251
[0m14:55:32.475554 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:55:32.475948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a249d0>]}
[0m14:55:32.476261 [info ] [Thread-3 (]: 15 of 21 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.06s]
[0m14:55:32.476595 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:55:32.476813 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:55:32.477032 [info ] [Thread-3 (]: 17 of 21 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:55:32.477427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:55:32.477608 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:55:32.479671 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.480120 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:55:32.482100 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.482368 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure" rename to "sum_total_customers_by_tenure__dbt_backup"
[0m14:55:32.482660 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:55:32.477774 => 14:55:32.482564
[0m14:55:32.482842 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:55:32.485288 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.485507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.487241 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.487489 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp" rename to "sum_total_customers_by_tenure"
[0m14:55:32.487765 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.487963 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:55:32.488131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.489246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.490666 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:55:32.490904 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.491079 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:55:32.499693 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.500138 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.500349 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:55:32.503259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.504905 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:55:32.505169 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:55:32.505367 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_backup" cascade
[0m14:55:32.506979 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:32.507309 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:55:32.511660 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.513593 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:32.513843 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:55:32.514763 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.515680 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (execute): 14:55:32.454376 => 14:55:32.515579
[0m14:55:32.515880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.516058 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:55:32.516273 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: Close
[0m14:55:32.517844 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:55:32.519485 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.519701 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:55:32.520088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99050>]}
[0m14:55:32.520256 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:32.520444 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:55:32.522083 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:32.522473 [info ] [Thread-1 (]: 16 of 21 OK created sql table model dbt_warehouse.sum_total_customers_by_tenure  [[32mSELECT 11[0m in 0.07s]
[0m14:55:32.522723 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:55:32.523133 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:55:32.523441 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:55:32.524298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.527231 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.527543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.527751 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.528042 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:55:32.529612 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:32.530856 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:55:32.531100 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:55:32.531289 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:55:32.532101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.533467 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:55:32.533664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.533852 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.535318 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:55:32.535548 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:55:32.535721 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:32.535943 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:55:32.537469 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.539227 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:55:32.539485 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.539978 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:55:32.541621 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:55:32.541976 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:55:32.547374 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.548538 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:55:32.482956 => 14:55:32.548420
[0m14:55:32.548813 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:55:32.549278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c46f50>]}
[0m14:55:32.549876 [info ] [Thread-3 (]: 17 of 21 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.07s]
[0m14:55:32.550397 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:55:32.562926 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.564058 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:55:31.930616 => 14:55:32.563965
[0m14:55:32.564262 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:55:32.564666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108894b10>]}
[0m14:55:32.565025 [info ] [Thread-2 (]: 8 of 21 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.64s]
[0m14:55:32.565818 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:55:32.592890 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.593862 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:55:31.812683 => 14:55:32.593770
[0m14:55:32.594058 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:55:32.594441 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bd090>]}
[0m14:55:32.594746 [info ] [Thread-4 (]: 5 of 21 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.79s]
[0m14:55:32.595060 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:55:32.595522 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:55:32.595708 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:55:32.595932 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:55:32.596130 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:55:32.596325 [info ] [Thread-1 (]: 18 of 21 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:55:32.596587 [info ] [Thread-3 (]: 19 of 21 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:55:32.596872 [info ] [Thread-2 (]: 20 of 21 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:55:32.597174 [info ] [Thread-4 (]: 21 of 21 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:55:32.597626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_tenure, now model.maker_warehouse.sum_genre_views)
[0m14:55:32.597909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:55:32.598178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_movie_views)
[0m14:55:32.598490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:55:32.598681 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:55:32.598850 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:55:32.599012 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:55:32.599171 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:55:32.600934 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:55:32.602298 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.603549 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:55:32.604741 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:55:32.605162 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:55:32.601067 => 14:55:32.605071
[0m14:55:32.605393 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:55:32.599283 => 14:55:32.605301
[0m14:55:32.605568 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:55:32.602423 => 14:55:32.605491
[0m14:55:32.605756 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:55:32.605946 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:55:32.606122 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:55:32.603678 => 14:55:32.606047
[0m14:55:32.606279 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:55:32.608506 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.610880 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:55:32.611207 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:55:32.613468 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:55:32.615772 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:55:32.616045 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:32.616265 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.616463 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:55:32.616616 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.616812 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:55:32.616980 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:32.617137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:32.617297 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:55:32.617460 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:32.617620 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:55:32.617919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:32.618185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:32.628452 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.628762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.629031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.629232 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.629437 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:32.629629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:55:32.629866 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:32.630082 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:55:32.630284 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:55:32.630470 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.630638 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:55:32.630900 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:55:32.904883 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:55:32.909415 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.909959 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:55:32.910512 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:55:32.916794 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.917596 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:55:32.918940 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.919492 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.924126 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.928596 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.929306 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:55:32.929867 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:55:32.931511 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.932007 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:32.934587 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:55:32.935972 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:55:32.936470 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.937093 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.937573 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:55:32.938049 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:55:32.947491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.948070 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:32.951832 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:55:32.953742 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:55:32.954043 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:55:32.954251 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:55:32.959051 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.959485 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:32.960398 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:55:32.611344 => 14:55:32.960295
[0m14:55:32.961095 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:55:32.606393 => 14:55:32.961013
[0m14:55:32.961295 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:55:32.961478 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:55:32.961884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089493d0>]}
[0m14:55:32.962223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108965710>]}
[0m14:55:32.962713 [info ] [Thread-2 (]: 20 of 21 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.36s]
[0m14:55:32.963638 [info ] [Thread-3 (]: 19 of 21 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.36s]
[0m14:55:32.964161 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:55:32.964749 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:55:33.229545 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:55:33.236026 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:33.236640 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:55:33.238140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:33.241125 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:33.241388 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:55:33.242291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:33.243710 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:55:33.243895 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:33.244056 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:55:33.262601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:33.266336 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:55:33.266784 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:55:33.269854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:33.270719 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:55:32.608641 => 14:55:33.270612
[0m14:55:33.270915 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:55:33.271322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108215a90>]}
[0m14:55:33.271628 [info ] [Thread-1 (]: 18 of 21 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.67s]
[0m14:55:33.271950 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:55:33.464618 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:55:33.470233 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:33.470851 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:55:33.472483 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:33.475780 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:33.476065 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:55:33.476774 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:33.478009 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:55:33.478182 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:33.478334 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:55:33.481239 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:55:33.482627 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:55:33.482804 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:55:33.493999 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:33.496553 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:55:32.613724 => 14:55:33.496261
[0m14:55:33.497009 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:55:33.497454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfbc556-b3c2-45e4-b7f7-a499091aa404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a3b50>]}
[0m14:55:33.497782 [info ] [Thread-4 (]: 21 of 21 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 0.90s]
[0m14:55:33.498106 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:55:33.499157 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:33.499350 [debug] [MainThread]: On master: BEGIN
[0m14:55:33.499489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:33.508978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:33.509315 [debug] [MainThread]: On master: COMMIT
[0m14:55:33.509622 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:33.509868 [debug] [MainThread]: On master: COMMIT
[0m14:55:33.510806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:55:33.511026 [debug] [MainThread]: On master: Close
[0m14:55:33.511486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:33.511698 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:55:33.511832 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:55:33.511953 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:55:33.512070 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:55:33.512286 [info ] [MainThread]: 
[0m14:55:33.512506 [info ] [MainThread]: Finished running 1 view model, 20 table models in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m14:55:33.514253 [debug] [MainThread]: Command end result
[0m14:55:33.519153 [info ] [MainThread]: 
[0m14:55:33.519440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:33.519715 [info ] [MainThread]: 
[0m14:55:33.519943 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m14:55:33.520312 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:33.520263 after 2.15 seconds
[0m14:55:33.520540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d13a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047656d0>]}
[0m14:55:33.520714 [debug] [MainThread]: Flushing usage events
[0m14:56:44.341925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3f90>]}


============================== 14:56:44.345715 | 9cc9702e-d4a2-4297-8e9b-6c0455418178 ==============================
[0m14:56:44.345715 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:56:44.346126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:56:44.388446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f5e90>]}
[0m14:56:44.395525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f5e90>]}
[0m14:56:44.395925 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:56:44.405646 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:56:44.430608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:56:44.430999 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/sum_total_customers_by_satisfaction_score.sql
[0m14:56:44.442798 [debug] [MainThread]: 1699: static parser successfully parsed facts/sum_total_customers_by_satisfaction_score.sql
[0m14:56:44.472145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a190d0>]}
[0m14:56:44.476441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313cd0>]}
[0m14:56:44.476666 [info ] [MainThread]: Found 22 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:56:44.476883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a1090>]}
[0m14:56:44.478235 [info ] [MainThread]: 
[0m14:56:44.478734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:44.479775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:56:44.485147 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:56:44.485349 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:56:44.485496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:44.570035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:56:44.571158 [debug] [ThreadPool]: On list_mydb: Close
[0m14:56:44.572912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:56:44.577018 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:56:44.577270 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:56:44.577449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:44.590031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.590340 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:56:44.590596 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:56:44.603504 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m14:56:44.604824 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:56:44.605715 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:56:44.611582 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.611838 [debug] [MainThread]: On master: BEGIN
[0m14:56:44.612013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:44.631923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.632251 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.632555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:44.654868 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:56:44.656423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d956d0>]}
[0m14:56:44.656754 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:44.657640 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.657863 [debug] [MainThread]: On master: BEGIN
[0m14:56:44.659357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.659743 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.659944 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.660121 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.660860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:44.661063 [debug] [MainThread]: On master: Close
[0m14:56:44.661483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:56:44.661736 [info ] [MainThread]: 
[0m14:56:44.664757 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:56:44.665014 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:56:44.665228 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:56:44.665420 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:56:44.665701 [info ] [Thread-1 (]: 1 of 22 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:56:44.666032 [info ] [Thread-2 (]: 2 of 22 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:56:44.666372 [info ] [Thread-3 (]: 3 of 22 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:56:44.666715 [info ] [Thread-4 (]: 4 of 22 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:56:44.667197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:56:44.667599 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:56:44.667987 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:56:44.668347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:56:44.668546 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:56:44.668862 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:56:44.669040 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:56:44.669217 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:56:44.670860 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:56:44.672390 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:56:44.673867 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:56:44.675552 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:56:44.676659 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:56:44.671010 => 14:56:44.676524
[0m14:56:44.677036 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:56:44.669347 => 14:56:44.676933
[0m14:56:44.677293 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:56:44.677575 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:56:44.672546 => 14:56:44.677436
[0m14:56:44.677827 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:56:44.674033 => 14:56:44.677718
[0m14:56:44.678052 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:56:44.701444 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:56:44.701683 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:56:44.701893 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:56:44.704229 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:56:44.706539 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:56:44.716191 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:56:44.716508 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.716794 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:56:44.717028 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.717233 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:56:44.717444 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.717589 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:56:44.717732 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:44.717976 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:56:44.718142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.718299 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:56:44.718473 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:56:44.718791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:56:44.726863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.727151 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.727343 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:56:44.729569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.729811 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.729998 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:56:44.730846 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.731100 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.731299 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:56:44.733867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.734145 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:44.734349 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:56:44.737728 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:56:44.741566 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.741874 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:56:44.743544 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.746220 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.746471 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:56:44.747630 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.758732 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:56:44.758993 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:56:44.759212 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.760706 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.760892 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:56:44.761179 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:56:44.763143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.764725 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.764984 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:56:44.766782 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:56:44.766961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.768544 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.771747 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:56:44.772012 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:56:44.772198 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.772419 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:56:44.773133 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:44.776012 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:56:44.776210 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.776377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:44.776590 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:56:44.778174 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.779348 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:56:44.779591 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:56:44.779780 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:56:44.780846 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.782213 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:56:44.782409 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.782572 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:56:44.783508 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:56:44.784389 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:56:44.706695 => 14:56:44.784284
[0m14:56:44.784595 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:44.784798 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:56:44.786253 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:56:44.786449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:44.786896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86a50>]}
[0m14:56:44.787088 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:56:44.787906 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:56:44.702029 => 14:56:44.787811
[0m14:56:44.788339 [info ] [Thread-4 (]: 4 of 22 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:56:44.788836 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:56:44.789373 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:56:44.789848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106373990>]}
[0m14:56:44.790112 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:56:44.790971 [info ] [Thread-1 (]: 1 of 22 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.12s]
[0m14:56:44.791723 [info ] [Thread-4 (]: 5 of 22 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:56:44.792627 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:56:44.793100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:56:44.793377 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:56:44.793576 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:56:44.794199 [info ] [Thread-1 (]: 6 of 22 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:56:44.796215 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:56:44.796594 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:44.797035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:56:44.798200 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:56:44.678215 => 14:56:44.798101
[0m14:56:44.798436 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:56:44.798701 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:56:44.798925 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:56:44.794460 => 14:56:44.798832
[0m14:56:44.800570 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:56:44.801118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106961bd0>]}
[0m14:56:44.801316 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:56:44.801953 [info ] [Thread-2 (]: 2 of 22 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.13s]
[0m14:56:44.802716 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:56:44.799057 => 14:56:44.802340
[0m14:56:44.805524 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:56:44.805915 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:56:44.806129 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:56:44.806448 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:56:44.809331 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:56:44.810266 [info ] [Thread-2 (]: 7 of 22 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:56:44.810579 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:44.811158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:56:44.811392 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:56:44.811711 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:56:44.811990 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:44.812204 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:44.814769 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:56:44.815107 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:56:44.815516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.815927 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:56:44.812463 => 14:56:44.815819
[0m14:56:44.816149 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:56:44.820913 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:56:44.821595 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.821793 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:56:44.821960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:44.827610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.827991 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:44.828175 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:56:44.831768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.832144 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:44.832482 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:56:44.834401 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.834836 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.835058 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:56:44.859388 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:56:44.861699 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.861966 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:56:44.863910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.865909 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.866236 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:56:44.867921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:44.869385 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:56:44.869677 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.869852 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:56:44.881884 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:44.884739 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:56:44.884989 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:56:44.900457 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:44.902051 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:56:44.816274 => 14:56:44.901949
[0m14:56:44.902285 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:56:44.902696 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba0c50>]}
[0m14:56:44.903002 [info ] [Thread-2 (]: 7 of 22 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.09s]
[0m14:56:44.903336 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:56:44.903825 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:56:44.904282 [info ] [Thread-2 (]: 8 of 22 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:56:44.904763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:56:44.904941 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:56:44.906511 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:56:44.907003 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:56:44.905056 => 14:56:44.906903
[0m14:56:44.907190 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:56:44.909932 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:56:44.910488 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:44.910974 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:56:44.911566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:44.925122 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:44.926191 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:44.926436 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:56:45.043165 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:56:45.047540 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:45.048241 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:56:45.050960 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.052804 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:45.053026 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:56:45.054386 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.055759 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:56:45.055953 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:45.056115 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:56:45.068596 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.070167 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:56:45.070375 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:56:45.074723 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.075649 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:56:44.704445 => 14:56:45.075553
[0m14:56:45.075858 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:56:45.076246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bd710>]}
[0m14:56:45.076558 [info ] [Thread-3 (]: 3 of 22 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.41s]
[0m14:56:45.076885 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:56:45.077778 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:56:45.078697 [info ] [Thread-3 (]: 9 of 22 START sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [RUN]
[0m14:56:45.079524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_credit_score_range)
[0m14:56:45.079881 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:56:45.083606 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.084690 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (compile): 14:56:45.080003 => 14:56:45.084553
[0m14:56:45.085318 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:56:45.089512 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.090064 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.090254 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: BEGIN
[0m14:56:45.090420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.114880 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.116575 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.116867 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN creditscore < 600 THEN 'Poor (Below 600)'
		WHEN creditscore >= 600 AND creditscore < 700 THEN 'Fair (600-699)'
		WHEN creditscore >= 700 AND creditscore < 800 THEN 'Good (700-799)'
		ELSE 'Excellent (800+)'
	END AS credit_score_range,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."banking_fact"
GROUP BY credit_score_range
  );
  
[0m14:56:45.133508 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:56:45.135264 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.135496 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range" rename to "sum_total_customers_by_credit_score_range__dbt_backup"
[0m14:56:45.136829 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.138373 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.138576 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp" rename to "sum_total_customers_by_credit_score_range"
[0m14:56:45.139670 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.141085 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:56:45.141284 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.141456 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:56:45.165863 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.167286 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:56:45.167486 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_backup" cascade
[0m14:56:45.173059 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.174243 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (execute): 14:56:45.085666 => 14:56:45.174136
[0m14:56:45.174458 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: Close
[0m14:56:45.174859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b39290>]}
[0m14:56:45.175168 [info ] [Thread-3 (]: 9 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [[32mSELECT 4[0m in 0.10s]
[0m14:56:45.175520 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:56:45.175733 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:56:45.175937 [info ] [Thread-3 (]: 10 of 22 START sql table model dbt_warehouse.customer_balances ................. [RUN]
[0m14:56:45.176302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_credit_score_range, now model.maker_warehouse.customer_balances)
[0m14:56:45.176472 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:56:45.181163 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:56:45.181820 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:56:45.176817 => 14:56:45.181717
[0m14:56:45.182006 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:56:45.184389 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:56:45.184781 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.184953 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:56:45.185111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.195195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.195531 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.195722 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:56:45.204457 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:45.206480 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.206804 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:56:45.210168 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.212586 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.212898 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:56:45.215672 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.217289 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:56:45.217518 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.217691 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:56:45.232880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.234364 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:56:45.234707 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:56:45.241087 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.242111 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:56:45.182123 => 14:56:45.242010
[0m14:56:45.242342 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:56:45.242792 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106373450>]}
[0m14:56:45.243114 [info ] [Thread-3 (]: 10 of 22 OK created sql table model dbt_warehouse.customer_balances ............ [[32mSELECT 0[0m in 0.07s]
[0m14:56:45.243453 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:56:45.243674 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:56:45.244010 [info ] [Thread-3 (]: 11 of 22 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:56:45.244418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:56:45.244606 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:56:45.244785 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:56:45.247195 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:45.248937 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:56:45.249201 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:56:45.249834 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:56:45.247424 => 14:56:45.249698
[0m14:56:45.250025 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:56:45.252548 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:56:45.252893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.254686 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:45.254937 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:56:45.255179 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.255350 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:56:45.255510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.256323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.257821 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:56:45.258064 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:45.258240 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:56:45.269482 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.270180 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.270542 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:56:45.274686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.277380 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:56:45.277659 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:56:45.283162 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:45.285395 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.285675 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:56:45.287888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.289839 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.290052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.290265 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:56:45.291096 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:56:44.806691 => 14:56:45.291003
[0m14:56:45.291370 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:56:45.291774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2c90>]}
[0m14:56:45.292087 [info ] [Thread-1 (]: 6 of 22 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.49s]
[0m14:56:45.292416 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:56:45.292632 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:56:45.293018 [info ] [Thread-1 (]: 12 of 22 START sql table model dbt_warehouse.sum_avg_age_by_geography .......... [RUN]
[0m14:56:45.293390 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.293790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_avg_age_by_geography)
[0m14:56:45.295433 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:56:45.295810 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_avg_age_by_geography
[0m14:56:45.296022 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.298213 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.298521 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:56:45.299146 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (compile): 14:56:45.296325 => 14:56:45.299034
[0m14:56:45.299337 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_avg_age_by_geography
[0m14:56:45.302040 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.302541 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.302723 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: BEGIN
[0m14:56:45.302887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:45.312000 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.315745 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:56:45.316054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.316279 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:56:45.316464 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.316739 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	geography,
	AVG(age) AS average_age
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY geography
  );
  
[0m14:56:45.327403 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.328344 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:56:45.250141 => 14:56:45.328250
[0m14:56:45.328544 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:56:45.328936 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105238b90>]}
[0m14:56:45.329235 [info ] [Thread-3 (]: 11 of 22 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.08s]
[0m14:56:45.329553 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:56:45.329758 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:56:45.330003 [info ] [Thread-3 (]: 13 of 22 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:56:45.330368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:56:45.330547 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:56:45.332275 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.332914 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:56:45.330660 => 14:56:45.332789
[0m14:56:45.333110 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:56:45.333323 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:56:45.334838 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.337377 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.337633 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography" rename to "sum_avg_age_by_geography__dbt_backup"
[0m14:56:45.338056 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.338247 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:56:45.338416 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.339145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.340746 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.340959 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp" rename to "sum_avg_age_by_geography"
[0m14:56:45.343208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.345229 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:56:45.345575 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.345757 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:56:45.350116 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.350791 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.351023 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:56:45.368419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.370663 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:56:45.370917 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_backup" cascade
[0m14:56:45.382569 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:56:45.384682 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.384936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.385216 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:56:45.386159 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (execute): 14:56:45.299451 => 14:56:45.386065
[0m14:56:45.386757 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_age_by_geography: Close
[0m14:56:45.387494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c29a90>]}
[0m14:56:45.388528 [info ] [Thread-1 (]: 12 of 22 OK created sql table model dbt_warehouse.sum_avg_age_by_geography ..... [[32mSELECT 3[0m in 0.09s]
[0m14:56:45.390047 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:56:45.390595 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.391268 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:56:45.395117 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.395831 [info ] [Thread-1 (]: 14 of 22 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:56:45.396182 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:56:45.396889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_age_by_geography, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:56:45.397456 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:56:45.399947 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.400253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.402153 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:56:45.402414 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.402741 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:56:45.397601 => 14:56:45.402636
[0m14:56:45.402904 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:56:45.403202 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:56:45.405897 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.406409 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.406595 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:56:45.406762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:45.417641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.418082 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.418324 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.419857 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:56:45.420139 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:56:45.420363 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:56:45.427422 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.428419 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:56:45.335010 => 14:56:45.428318
[0m14:56:45.428629 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:56:45.429036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3810>]}
[0m14:56:45.429370 [info ] [Thread-3 (]: 13 of 22 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.10s]
[0m14:56:45.429775 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:56:45.430061 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:56:45.430396 [info ] [Thread-3 (]: 15 of 22 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:56:45.430822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:56:45.431019 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:56:45.432590 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.433036 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:56:45.431141 => 14:56:45.432937
[0m14:56:45.433221 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:56:45.436960 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.437584 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.437938 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:56:45.438109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.442132 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:56:45.445077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.445599 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group" rename to "sum_avg_credit_score_by_age_group__dbt_backup"
[0m14:56:45.447923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.448176 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:56:45.451104 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.452936 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:45.453244 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:56:45.453439 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:56:45.454997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.455225 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.456680 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:56:45.459055 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.457062 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.459246 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:56:45.459444 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.458742 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:45.460099 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:56:45.459871 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:56:45.461681 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.463531 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:56:45.463789 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:45.463964 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:56:45.473730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.475589 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:56:45.476052 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.476268 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:56:45.477607 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:56:45.477924 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:56:45.481852 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:56:45.483777 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.484045 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:56:45.485308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.486196 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:56:45.403420 => 14:56:45.486091
[0m14:56:45.486390 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.486613 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:56:45.488279 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.488536 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:56:45.488952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c00c50>]}
[0m14:56:45.489275 [info ] [Thread-1 (]: 14 of 22 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.09s]
[0m14:56:45.489639 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:56:45.489877 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:56:45.490110 [info ] [Thread-1 (]: 16 of 22 START sql table model dbt_warehouse.sum_total_customers_by_satisfaction_score  [RUN]
[0m14:56:45.490726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_total_customers_by_satisfaction_score)
[0m14:56:45.490986 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.491158 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:56:45.492659 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:56:45.494577 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.494880 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.495123 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.495977 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:56:44.907308 => 14:56:45.495887
[0m14:56:45.496170 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:56:45.496354 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:56:45.497061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2450>]}
[0m14:56:45.497466 [info ] [Thread-2 (]: 8 of 22 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.59s]
[0m14:56:45.498002 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_satisfaction_score (compile): 14:56:45.492839 => 14:56:45.497894
[0m14:56:45.498307 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:56:45.498506 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:56:45.498861 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:56:45.502841 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.503239 [info ] [Thread-2 (]: 17 of 22 START sql table model dbt_warehouse.sum_total_customers_by_tenure ..... [RUN]
[0m14:56:45.503916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_total_customers_by_tenure)
[0m14:56:45.504187 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.504389 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:56:45.504741 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: BEGIN
[0m14:56:45.506773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:45.506507 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.507816 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (compile): 14:56:45.504875 => 14:56:45.507647
[0m14:56:45.508041 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:56:45.510992 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.511717 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.511941 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: BEGIN
[0m14:56:45.512116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:45.519554 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.521113 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:56:45.521389 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:56:45.521667 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:56:45.521936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.523717 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:45.523998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.524232 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.524431 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:56:45.524638 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.524856 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	satisfactionscore,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY satisfactionscore
  );
  
[0m14:56:45.525104 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	tenure,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY tenure
  );
  
[0m14:56:45.527491 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.529436 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:45.529694 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:56:45.531502 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.532997 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:56:45.533214 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:45.533385 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:56:45.533581 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.533762 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:56:45.533917 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m14:56:45.534770 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:56:45.433354 => 14:56:45.534672
[0m14:56:45.537463 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.537674 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.538964 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.539158 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:56:45.539338 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure" rename to "sum_total_customers_by_tenure__dbt_backup"
[0m14:56:45.540461 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:56:45.540648 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_tmp" rename to "sum_total_customers_by_satisfaction_score"
[0m14:56:45.541045 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c72910>]}
[0m14:56:45.541240 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:56:45.541583 [info ] [Thread-3 (]: 15 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.11s]
[0m14:56:45.541970 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:56:45.542204 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:56:45.542378 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.542658 [info ] [Thread-3 (]: 18 of 22 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:56:45.544664 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.544994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.545357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:56:45.545572 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp" rename to "sum_total_customers_by_tenure"
[0m14:56:45.546809 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: COMMIT
[0m14:56:45.547042 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:56:45.547291 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.549103 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.549320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.549534 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: COMMIT
[0m14:56:45.550992 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:56:45.551279 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.551500 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:56:45.547431 => 14:56:45.551392
[0m14:56:45.551699 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:56:45.551906 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:56:45.554686 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.554944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.555107 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.556454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:56:45.557806 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:56:45.558014 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.558191 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_backup" cascade
[0m14:56:45.558399 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_backup" cascade
[0m14:56:45.558579 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:56:45.558822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.559935 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.560965 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_satisfaction_score (execute): 14:56:45.499140 => 14:56:45.560853
[0m14:56:45.561209 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: Close
[0m14:56:45.561691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9dcd0>]}
[0m14:56:45.562090 [info ] [Thread-1 (]: 16 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_satisfaction_score  [[32mSELECT 5[0m in 0.07s]
[0m14:56:45.562486 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:56:45.564037 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.565014 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (execute): 14:56:45.508167 => 14:56:45.564912
[0m14:56:45.565222 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_tenure: Close
[0m14:56:45.565676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6490>]}
[0m14:56:45.566176 [info ] [Thread-2 (]: 17 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_tenure  [[32mSELECT 11[0m in 0.06s]
[0m14:56:45.566574 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:56:45.573832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.574287 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.574517 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:56:45.589353 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:56:45.591167 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.591378 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:56:45.592733 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.594918 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.595204 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:56:45.596605 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:45.598093 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:56:45.598328 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.598513 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:56:45.599932 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:45.601690 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:56:45.601955 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:56:45.606331 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.606624 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:45.607513 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:56:44.802890 => 14:56:45.607410
[0m14:56:45.608425 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:56:45.552068 => 14:56:45.608313
[0m14:56:45.608739 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:56:45.608999 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:56:45.609449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a08c10>]}
[0m14:56:45.609778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c14190>]}
[0m14:56:45.610109 [info ] [Thread-4 (]: 5 of 22 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.82s]
[0m14:56:45.610393 [info ] [Thread-3 (]: 18 of 22 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.06s]
[0m14:56:45.611094 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:56:45.611414 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:56:45.611937 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:56:45.612477 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:56:45.612922 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:56:45.612302 [info ] [Thread-1 (]: 19 of 22 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:56:45.613759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_satisfaction_score, now model.maker_warehouse.sum_genre_views)
[0m14:56:45.613975 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:56:45.616321 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:56:45.612704 [info ] [Thread-2 (]: 20 of 22 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:56:45.617131 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:56:45.618068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_tenure, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:56:45.613187 [info ] [Thread-4 (]: 21 of 22 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:56:45.618548 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:56:45.614152 => 14:56:45.618437
[0m14:56:45.619245 [info ] [Thread-3 (]: 22 of 22 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:56:45.621150 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:56:45.622170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_movie_views)
[0m14:56:45.623864 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:56:45.624803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_user_activity)
[0m14:56:45.626769 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:45.627070 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:56:45.630248 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:56:45.630608 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:56:45.632450 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:56:45.635119 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:56:45.635415 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:56:45.625034 => 14:56:45.635301
[0m14:56:45.635614 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:45.635938 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:56:45.636159 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:56:45.630804 => 14:56:45.636074
[0m14:56:45.636310 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:56:45.636480 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:56:45.632765 => 14:56:45.636407
[0m14:56:45.638726 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:45.638918 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:56:45.639088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:45.639249 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:56:45.641428 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:56:45.641718 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:45.644085 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:56:45.644445 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:56:45.644730 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:45.644892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:45.645092 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:56:45.645257 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:45.645507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:45.645695 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:56:45.646033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:45.651869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.652155 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:45.652349 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:56:45.655200 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.655429 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.655651 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:45.655846 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:45.656056 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:56:45.656260 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:56:45.659123 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:45.659459 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:45.659673 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:56:46.021383 [debug] [Thread-2 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:56:46.041749 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:46.042760 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:56:46.047789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.053773 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:46.054596 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:56:46.058021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.064368 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:56:46.065046 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:46.065962 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:56:46.074349 [debug] [Thread-4 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:56:46.078681 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:46.079292 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:56:46.081919 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.084943 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:46.085258 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:56:46.086906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.087148 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:46.089617 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:56:46.092544 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:56:46.093135 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:46.093499 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:56:46.093800 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:56:46.095932 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:46.098582 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:56:46.098976 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:56:46.101353 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:46.103079 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:56:45.636600 => 14:56:46.102873
[0m14:56:46.103482 [debug] [Thread-2 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:56:46.104245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07150>]}
[0m14:56:46.105054 [info ] [Thread-2 (]: 20 of 22 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.49s]
[0m14:56:46.105525 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:56:46.107670 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:46.111321 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:56:45.639404 => 14:56:46.110984
[0m14:56:46.112245 [debug] [Thread-4 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:56:46.113955 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87f50>]}
[0m14:56:46.115726 [info ] [Thread-4 (]: 21 of 22 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.49s]
[0m14:56:46.117233 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:56:46.458932 [debug] [Thread-1 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:56:46.464101 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:46.464765 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:56:46.466554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.471250 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:46.471892 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:56:46.473438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.475060 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:56:46.475301 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:46.475479 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:56:46.487598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:46.490454 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:56:46.490748 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:56:46.494607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:46.496552 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:56:45.627363 => 14:56:46.496303
[0m14:56:46.497047 [debug] [Thread-1 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:56:46.497841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8f10>]}
[0m14:56:46.498233 [info ] [Thread-1 (]: 19 of 22 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.88s]
[0m14:56:46.498586 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:56:46.693586 [debug] [Thread-3 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:56:46.698023 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:46.698657 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:56:46.700824 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.706294 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:46.706620 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:56:46.707806 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:46.709068 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:56:46.709247 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:46.709401 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:56:46.719372 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:46.720725 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:56:46.720903 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:56:46.734958 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:56:46.737485 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:56:45.641850 => 14:56:46.737213
[0m14:56:46.737986 [debug] [Thread-3 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:56:46.738803 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc9702e-d4a2-4297-8e9b-6c0455418178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106996290>]}
[0m14:56:46.739257 [info ] [Thread-3 (]: 22 of 22 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.11s]
[0m14:56:46.739664 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:56:46.741120 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:46.741327 [debug] [MainThread]: On master: BEGIN
[0m14:56:46.741474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:46.749843 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:46.750101 [debug] [MainThread]: On master: COMMIT
[0m14:56:46.750246 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:46.750385 [debug] [MainThread]: On master: COMMIT
[0m14:56:46.751001 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:46.751189 [debug] [MainThread]: On master: Close
[0m14:56:46.751536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:46.751678 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:56:46.751799 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:56:46.751913 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:56:46.752026 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:56:46.752237 [info ] [MainThread]: 
[0m14:56:46.752456 [info ] [MainThread]: Finished running 1 view model, 21 table models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m14:56:46.754035 [debug] [MainThread]: Command end result
[0m14:56:46.760179 [info ] [MainThread]: 
[0m14:56:46.760568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:46.760823 [info ] [MainThread]: 
[0m14:56:46.761456 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m14:56:46.764166 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:46.764103 after 2.45 seconds
[0m14:56:46.765259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028727d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c578d0>]}
[0m14:56:47.244220 [debug] [MainThread]: Flushing usage events
[0m14:57:52.876577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108435010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844e390>]}


============================== 14:57:52.880408 | 98dfc68b-55ae-4563-b775-494763ea10b0 ==============================
[0m14:57:52.880408 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:57:52.880757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/ilhaam.ahmed/Projects/data-warehouses-exercises/DBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:52.922518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108460150>]}
[0m14:57:52.929494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108474390>]}
[0m14:57:52.929891 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:57:52.939645 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:57:52.962954 [debug] [MainThread]: Partial parsing enabled: 22 files deleted, 22 files added, 0 files changed.
[0m14:57:52.963336 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/customer_salary.sql
[0m14:57:52.963503 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/movie_viewings.sql
[0m14:57:52.963650 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/genres.sql
[0m14:57:52.963790 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/customers_dim.sql
[0m14:57:52.963928 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_avg_credit_score_by_age_group.sql
[0m14:57:52.964063 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/sum_movie_views.sql
[0m14:57:52.964197 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/sum_genre_views.sql
[0m14:57:52.964330 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/movies.sql
[0m14:57:52.964463 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/sum_movie_viewing_time.sql
[0m14:57:52.964601 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_total_customers_by_tenure.sql
[0m14:57:52.964732 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_total_customers_by_gender.sql
[0m14:57:52.964862 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_avg_age_by_geography.sql
[0m14:57:52.964990 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_total_exited_by_card_type.sql
[0m14:57:52.965120 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/users.sql
[0m14:57:52.965247 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/customer_balances.sql
[0m14:57:52.965376 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/mac_test.sql
[0m14:57:52.965502 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_avg_balance_by_geography.sql
[0m14:57:52.965629 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/salary_dim.sql
[0m14:57:52.965755 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/banking_fact.sql
[0m14:57:52.965886 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_netflix/sum_user_activity.sql
[0m14:57:52.966012 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_total_customers_by_credit_score_range.sql
[0m14:57:52.966141 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/raw_banking/sum_total_customers_by_satisfaction_score.sql
[0m14:57:52.966301 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_genre_views.sql
[0m14:57:52.966439 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_views.sql
[0m14:57:52.966559 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_customers_by_gender.sql
[0m14:57:52.966686 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/genres.sql
[0m14:57:52.966808 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/banking_fact.sql
[0m14:57:52.966918 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_avg_balance_by_geography.sql
[0m14:57:52.967030 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/mac_test.sql
[0m14:57:52.967158 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_movie_viewing_time.sql
[0m14:57:52.967272 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_customers_by_credit_score_range.sql
[0m14:57:52.967389 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_user_activity.sql
[0m14:57:52.967501 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_customers_by_tenure.sql
[0m14:57:52.967609 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_avg_age_by_geography.sql
[0m14:57:52.967717 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/customer_balances.sql
[0m14:57:52.967823 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/customer_salary.sql
[0m14:57:52.967927 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_exited_by_card_type.sql
[0m14:57:52.968034 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/salary_dim.sql
[0m14:57:52.968146 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/users.sql
[0m14:57:52.968256 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_total_customers_by_satisfaction_score.sql
[0m14:57:52.968367 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/customers_dim.sql
[0m14:57:52.968475 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/sum_avg_credit_score_by_age_group.sql
[0m14:57:52.968587 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movies.sql
[0m14:57:52.968703 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/facts/movie_viewings.sql
[0m14:57:52.980515 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/customer_salary.sql
[0m14:57:52.988012 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/movie_viewings.sql
[0m14:57:52.990164 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/genres.sql
[0m14:57:52.992188 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/customers_dim.sql
[0m14:57:52.994072 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_avg_credit_score_by_age_group.sql
[0m14:57:53.013310 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/sum_movie_views.sql
[0m14:57:53.015179 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/sum_genre_views.sql
[0m14:57:53.016968 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/movies.sql
[0m14:57:53.018867 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/sum_movie_viewing_time.sql
[0m14:57:53.020654 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_total_customers_by_tenure.sql
[0m14:57:53.022499 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_total_customers_by_gender.sql
[0m14:57:53.024302 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_avg_age_by_geography.sql
[0m14:57:53.026053 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_total_exited_by_card_type.sql
[0m14:57:53.027945 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/users.sql
[0m14:57:53.029944 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/customer_balances.sql
[0m14:57:53.031864 [debug] [MainThread]: 1603: static parser failed on facts/raw_netflix/mac_test.sql
[0m14:57:53.034207 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/raw_netflix/mac_test.sql
[0m14:57:53.035169 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_avg_balance_by_geography.sql
[0m14:57:53.036941 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/salary_dim.sql
[0m14:57:53.038689 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/banking_fact.sql
[0m14:57:53.040429 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_netflix/sum_user_activity.sql
[0m14:57:53.042308 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_total_customers_by_credit_score_range.sql
[0m14:57:53.044045 [debug] [MainThread]: 1699: static parser successfully parsed facts/raw_banking/sum_total_customers_by_satisfaction_score.sql
[0m14:57:53.080757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c20e50>]}
[0m14:57:53.084930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842b8d0>]}
[0m14:57:53.085150 [info ] [MainThread]: Found 22 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:53.085368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f9090>]}
[0m14:57:53.086635 [info ] [MainThread]: 
[0m14:57:53.087085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:53.088127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m14:57:53.093754 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m14:57:53.094074 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m14:57:53.094244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:53.180676 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:57:53.181915 [debug] [ThreadPool]: On list_mydb: Close
[0m14:57:53.183707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_dbt_warehouse)
[0m14:57:53.187858 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:57:53.188109 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: BEGIN
[0m14:57:53.188298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:53.200462 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.200788 [debug] [ThreadPool]: Using postgres connection "list_mydb_dbt_warehouse"
[0m14:57:53.201036 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_dbt_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_warehouse'
  
[0m14:57:53.212143 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m14:57:53.213432 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: ROLLBACK
[0m14:57:53.214513 [debug] [ThreadPool]: On list_mydb_dbt_warehouse: Close
[0m14:57:53.220449 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:53.220712 [debug] [MainThread]: On master: BEGIN
[0m14:57:53.220904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:53.231852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.232122 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:53.232408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:57:53.251514 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m14:57:53.252978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744e6d0>]}
[0m14:57:53.253270 [debug] [MainThread]: On master: ROLLBACK
[0m14:57:53.254003 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:53.254217 [debug] [MainThread]: On master: BEGIN
[0m14:57:53.255288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.255487 [debug] [MainThread]: On master: COMMIT
[0m14:57:53.255661 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:53.255880 [debug] [MainThread]: On master: COMMIT
[0m14:57:53.256506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.256687 [debug] [MainThread]: On master: Close
[0m14:57:53.257099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:53.257348 [info ] [MainThread]: 
[0m14:57:53.260283 [debug] [Thread-1 (]: Began running node model.maker_warehouse.banking_fact
[0m14:57:53.260568 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_dim
[0m14:57:53.260773 [debug] [Thread-3 (]: Began running node model.maker_warehouse.genres
[0m14:57:53.260987 [debug] [Thread-4 (]: Began running node model.maker_warehouse.mac_test
[0m14:57:53.261313 [info ] [Thread-1 (]: 1 of 22 START sql table model dbt_warehouse.banking_fact ....................... [RUN]
[0m14:57:53.261681 [info ] [Thread-2 (]: 2 of 22 START sql table model dbt_warehouse.customers_dim ...................... [RUN]
[0m14:57:53.262013 [info ] [Thread-3 (]: 3 of 22 START sql table model dbt_warehouse.genres ............................. [RUN]
[0m14:57:53.262415 [info ] [Thread-4 (]: 4 of 22 START sql view model dbt_warehouse.mac_test ............................ [RUN]
[0m14:57:53.263085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_dbt_warehouse, now model.maker_warehouse.banking_fact)
[0m14:57:53.263562 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_dim'
[0m14:57:53.263997 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.genres'
[0m14:57:53.264449 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.mac_test'
[0m14:57:53.264691 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.banking_fact
[0m14:57:53.264905 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers_dim
[0m14:57:53.265112 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.genres
[0m14:57:53.265307 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.mac_test
[0m14:57:53.267215 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.banking_fact"
[0m14:57:53.268926 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers_dim"
[0m14:57:53.270466 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.genres"
[0m14:57:53.272153 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.mac_test"
[0m14:57:53.272799 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (compile): 14:57:53.265457 => 14:57:53.272677
[0m14:57:53.273047 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (compile): 14:57:53.267388 => 14:57:53.272930
[0m14:57:53.273325 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (compile): 14:57:53.269104 => 14:57:53.273208
[0m14:57:53.273549 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.banking_fact
[0m14:57:53.273771 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (compile): 14:57:53.270641 => 14:57:53.273676
[0m14:57:53.273970 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers_dim
[0m14:57:53.274170 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.genres
[0m14:57:53.296649 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.banking_fact"
[0m14:57:53.296919 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.mac_test
[0m14:57:53.299356 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers_dim"
[0m14:57:53.301681 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.genres"
[0m14:57:53.311154 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.mac_test"
[0m14:57:53.311529 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.311708 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.311997 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: BEGIN
[0m14:57:53.312213 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.312386 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.312549 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: BEGIN
[0m14:57:53.312720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:53.312890 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: BEGIN
[0m14:57:53.313045 [debug] [Thread-3 (]: On model.maker_warehouse.genres: BEGIN
[0m14:57:53.313198 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:57:53.313422 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:57:53.313578 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:57:53.324110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.324889 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.325124 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */

  
    

  create  table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    rownumber,
	customerid,
	creditscore,
	balance,
	exited,
	complain
FROM mydb.public.raw_banking
  );
  
[0m14:57:53.325540 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.325900 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.326082 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */

  
    

  create  table "mydb"."dbt_warehouse"."genres__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT genres
FROM mydb.public.raw_netflix
  );
  
[0m14:57:53.327140 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.327346 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.327563 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.327761 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.327957 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */

  create view "mydb"."dbt_warehouse"."mac_test__dbt_tmp"
    
    
  as (
    

select

    
    'bank_transfer'
    
    'credit_card'
    
    'gift_card'
    
  );
[0m14:57:53.328154 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	surname,
	geography,
	gender,
	age,
	tenure,
	numofproducts,
	hascrcard,
	isactivemember,
	cardtype,
	satisfactionscore,
	pointearned
FROM mydb.public.raw_banking
  );
  
[0m14:57:53.334791 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:57:53.338887 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.339154 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test" rename to "mac_test__dbt_backup"
[0m14:57:53.340619 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.343622 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.343909 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
alter table "mydb"."dbt_warehouse"."mac_test__dbt_tmp" rename to "mac_test"
[0m14:57:53.345515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.355743 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:57:53.356058 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.356243 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: COMMIT
[0m14:57:53.366341 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.370662 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.mac_test"
[0m14:57:53.370957 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.mac_test"} */
drop view if exists "mydb"."dbt_warehouse"."mac_test__dbt_backup" cascade
[0m14:57:53.372759 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:57:53.375233 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.375638 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:57:53.376158 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact" rename to "banking_fact__dbt_backup"
[0m14:57:53.378059 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.378399 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim" rename to "customers_dim__dbt_backup"
[0m14:57:53.380025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.380232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.381992 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.382179 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:57:53.383862 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.384108 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
alter table "mydb"."dbt_warehouse"."customers_dim__dbt_tmp" rename to "customers_dim"
[0m14:57:53.384914 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.mac_test (execute): 14:57:53.301893 => 14:57:53.384811
[0m14:57:53.385128 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
alter table "mydb"."dbt_warehouse"."banking_fact__dbt_tmp" rename to "banking_fact"
[0m14:57:53.385385 [debug] [Thread-4 (]: On model.maker_warehouse.mac_test: Close
[0m14:57:53.385908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b46910>]}
[0m14:57:53.386271 [info ] [Thread-4 (]: 4 of 22 OK created sql view model dbt_warehouse.mac_test ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:57:53.386630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.386859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.387206 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.mac_test
[0m14:57:53.390789 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:57:53.392229 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:57:53.392555 [debug] [Thread-4 (]: Began running node model.maker_warehouse.movie_viewings
[0m14:57:53.392894 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.393102 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.393378 [info ] [Thread-4 (]: 5 of 22 START sql table model dbt_warehouse.movie_viewings ..................... [RUN]
[0m14:57:53.393657 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: COMMIT
[0m14:57:53.393837 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: COMMIT
[0m14:57:53.394217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.mac_test, now model.maker_warehouse.movie_viewings)
[0m14:57:53.394646 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.movie_viewings
[0m14:57:53.396875 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.movie_viewings"
[0m14:57:53.397458 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (compile): 14:57:53.394788 => 14:57:53.397337
[0m14:57:53.397656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.397839 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.398032 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.movie_viewings
[0m14:57:53.399536 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.banking_fact"
[0m14:57:53.400847 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers_dim"
[0m14:57:53.403411 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.movie_viewings"
[0m14:57:53.403676 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.banking_fact"} */
drop table if exists "mydb"."dbt_warehouse"."banking_fact__dbt_backup" cascade
[0m14:57:53.403874 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_dim"} */
drop table if exists "mydb"."dbt_warehouse"."customers_dim__dbt_backup" cascade
[0m14:57:53.404306 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:53.404496 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: BEGIN
[0m14:57:53.404665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:53.410202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.410471 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.411406 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.banking_fact (execute): 14:57:53.274311 => 14:57:53.411305
[0m14:57:53.412367 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers_dim (execute): 14:57:53.297074 => 14:57:53.412268
[0m14:57:53.412628 [debug] [Thread-1 (]: On model.maker_warehouse.banking_fact: Close
[0m14:57:53.412849 [debug] [Thread-2 (]: On model.maker_warehouse.customers_dim: Close
[0m14:57:53.413445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108436850>]}
[0m14:57:53.413980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850ff10>]}
[0m14:57:53.414695 [info ] [Thread-1 (]: 1 of 22 OK created sql table model dbt_warehouse.banking_fact .................. [[32mSELECT 10000[0m in 0.15s]
[0m14:57:53.415188 [info ] [Thread-2 (]: 2 of 22 OK created sql table model dbt_warehouse.customers_dim ................. [[32mSELECT 10000[0m in 0.15s]
[0m14:57:53.415749 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.banking_fact
[0m14:57:53.416259 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_dim
[0m14:57:53.416837 [debug] [Thread-1 (]: Began running node model.maker_warehouse.movies
[0m14:57:53.417633 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_dim
[0m14:57:53.418477 [info ] [Thread-1 (]: 6 of 22 START sql table model dbt_warehouse.movies ............................. [RUN]
[0m14:57:53.419214 [info ] [Thread-2 (]: 7 of 22 START sql table model dbt_warehouse.salary_dim ......................... [RUN]
[0m14:57:53.419814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.banking_fact, now model.maker_warehouse.movies)
[0m14:57:53.420264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_dim, now model.maker_warehouse.salary_dim)
[0m14:57:53.420737 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.movies
[0m14:57:53.421043 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_dim
[0m14:57:53.423311 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.movies"
[0m14:57:53.425347 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_dim"
[0m14:57:53.426183 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (compile): 14:57:53.421247 => 14:57:53.426066
[0m14:57:53.426368 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.movies
[0m14:57:53.429423 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.movies"
[0m14:57:53.429886 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (compile): 14:57:53.423533 => 14:57:53.429643
[0m14:57:53.430144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.430743 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_dim
[0m14:57:53.431169 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:53.435223 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_dim"
[0m14:57:53.435481 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.435742 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */

  
    

  create  table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    datetime,
    duration,
    user_id,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:57:53.436020 [debug] [Thread-1 (]: On model.maker_warehouse.movies: BEGIN
[0m14:57:53.436321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:53.436513 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.436868 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: BEGIN
[0m14:57:53.437038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:53.450669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.451033 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.451232 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */

  
    

  create  table "mydb"."dbt_warehouse"."movies__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    title,
    genres,
    release_date,
    movie_id
FROM mydb.public.raw_netflix
  );
  
[0m14:57:53.452138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.452599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.452813 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */

  
    

  create  table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp"
  
  
    as
  
  (
    
SELECT
    DISTINCT
    customerid,
	estimatedsalary
FROM mydb.public.raw_banking
  );
  
[0m14:57:53.469465 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m14:57:53.471535 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.471788 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim" rename to "salary_dim__dbt_backup"
[0m14:57:53.473283 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.475090 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.475337 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
alter table "mydb"."dbt_warehouse"."salary_dim__dbt_tmp" rename to "salary_dim"
[0m14:57:53.477534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.479400 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:57:53.479616 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.479788 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: COMMIT
[0m14:57:53.496767 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.499160 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_dim"
[0m14:57:53.499405 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_dim"} */
drop table if exists "mydb"."dbt_warehouse"."salary_dim__dbt_backup" cascade
[0m14:57:53.507391 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.508901 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_dim (execute): 14:57:53.431424 => 14:57:53.508801
[0m14:57:53.509123 [debug] [Thread-2 (]: On model.maker_warehouse.salary_dim: Close
[0m14:57:53.509643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4ad10>]}
[0m14:57:53.510242 [info ] [Thread-2 (]: 7 of 22 OK created sql table model dbt_warehouse.salary_dim .................... [[32mSELECT 10000[0m in 0.09s]
[0m14:57:53.511332 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_dim
[0m14:57:53.512819 [debug] [Thread-2 (]: Began running node model.maker_warehouse.users
[0m14:57:53.513904 [info ] [Thread-2 (]: 8 of 22 START sql table model dbt_warehouse.users .............................. [RUN]
[0m14:57:53.514651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.salary_dim, now model.maker_warehouse.users)
[0m14:57:53.514884 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.users
[0m14:57:53.516717 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.users"
[0m14:57:53.517208 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (compile): 14:57:53.515023 => 14:57:53.517105
[0m14:57:53.517392 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.users
[0m14:57:53.520488 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.users"
[0m14:57:53.520996 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:53.521177 [debug] [Thread-2 (]: On model.maker_warehouse.users: BEGIN
[0m14:57:53.521339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:53.539699 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.540348 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:53.540621 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */

  
    

  create  table "mydb"."dbt_warehouse"."users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DISTINCT user_id
FROM mydb.public.raw_netflix
  );
  
[0m14:57:53.625243 [debug] [Thread-3 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m14:57:53.626937 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.627174 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres" rename to "genres__dbt_backup"
[0m14:57:53.628717 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.630334 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.630525 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
alter table "mydb"."dbt_warehouse"."genres__dbt_tmp" rename to "genres"
[0m14:57:53.684723 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.687937 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:57:53.688264 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.688451 [debug] [Thread-3 (]: On model.maker_warehouse.genres: COMMIT
[0m14:57:53.696604 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.698232 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.genres"
[0m14:57:53.698436 [debug] [Thread-3 (]: On model.maker_warehouse.genres: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.genres"} */
drop table if exists "mydb"."dbt_warehouse"."genres__dbt_backup" cascade
[0m14:57:53.702971 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.703984 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.genres (execute): 14:57:53.299504 => 14:57:53.703859
[0m14:57:53.704259 [debug] [Thread-3 (]: On model.maker_warehouse.genres: Close
[0m14:57:53.704657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d68090>]}
[0m14:57:53.704999 [info ] [Thread-3 (]: 3 of 22 OK created sql table model dbt_warehouse.genres ........................ [[32mSELECT 1190[0m in 0.44s]
[0m14:57:53.705627 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.genres
[0m14:57:53.705949 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:57:53.706330 [info ] [Thread-3 (]: 9 of 22 START sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [RUN]
[0m14:57:53.706924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.genres, now model.maker_warehouse.sum_total_customers_by_credit_score_range)
[0m14:57:53.707141 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:57:53.708787 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.709345 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (compile): 14:57:53.707275 => 14:57:53.709236
[0m14:57:53.709623 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:57:53.714078 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.714574 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.714759 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: BEGIN
[0m14:57:53.714944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:53.737833 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.738174 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.738723 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN creditscore < 600 THEN 'Poor (Below 600)'
		WHEN creditscore >= 600 AND creditscore < 700 THEN 'Fair (600-699)'
		WHEN creditscore >= 700 AND creditscore < 800 THEN 'Good (700-799)'
		ELSE 'Excellent (800+)'
	END AS credit_score_range,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."banking_fact"
GROUP BY credit_score_range
  );
  
[0m14:57:53.754459 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:57:53.756223 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.756530 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range" rename to "sum_total_customers_by_credit_score_range__dbt_backup"
[0m14:57:53.759040 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.761372 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.761674 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_tmp" rename to "sum_total_customers_by_credit_score_range"
[0m14:57:53.765157 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.766763 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:57:53.767059 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.767553 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: COMMIT
[0m14:57:53.776064 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.777705 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_credit_score_range"
[0m14:57:53.777969 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_credit_score_range"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_credit_score_range__dbt_backup" cascade
[0m14:57:53.784143 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.785271 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_customers_by_credit_score_range (execute): 14:57:53.709757 => 14:57:53.785134
[0m14:57:53.785523 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_customers_by_credit_score_range: Close
[0m14:57:53.785990 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b63090>]}
[0m14:57:53.786382 [info ] [Thread-3 (]: 9 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_credit_score_range  [[32mSELECT 4[0m in 0.08s]
[0m14:57:53.786744 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_customers_by_credit_score_range
[0m14:57:53.786964 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_balances
[0m14:57:53.787649 [info ] [Thread-3 (]: 10 of 22 START sql table model dbt_warehouse.customer_balances ................. [RUN]
[0m14:57:53.788109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_credit_score_range, now model.maker_warehouse.customer_balances)
[0m14:57:53.788300 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_balances
[0m14:57:53.791737 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_balances"
[0m14:57:53.792258 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (compile): 14:57:53.788419 => 14:57:53.792152
[0m14:57:53.792454 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_balances
[0m14:57:53.795234 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_balances"
[0m14:57:53.795761 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.795965 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: BEGIN
[0m14:57:53.796126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:53.813568 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.813884 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.814082 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp"
  
  
    as
  
  (
    


SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	b.balance
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN banking b ON c.customerid = b.customerid
  );
  
[0m14:57:53.823305 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:53.825060 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.825278 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances" rename to "customer_balances__dbt_backup"
[0m14:57:53.826924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.828648 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.828868 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
alter table "mydb"."dbt_warehouse"."customer_balances__dbt_tmp" rename to "customer_balances"
[0m14:57:53.870637 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.872288 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:57:53.872726 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.872932 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: COMMIT
[0m14:57:53.879470 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.881409 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_balances"
[0m14:57:53.881663 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_balances"} */
drop table if exists "mydb"."dbt_warehouse"."customer_balances__dbt_backup" cascade
[0m14:57:53.886633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.888117 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_balances (execute): 14:57:53.792574 => 14:57:53.887990
[0m14:57:53.888366 [debug] [Thread-3 (]: On model.maker_warehouse.customer_balances: Close
[0m14:57:53.888891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ceb690>]}
[0m14:57:53.889512 [info ] [Thread-3 (]: 10 of 22 OK created sql table model dbt_warehouse.customer_balances ............ [[32mSELECT 0[0m in 0.10s]
[0m14:57:53.889907 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_balances
[0m14:57:53.890644 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customer_salary
[0m14:57:53.891388 [info ] [Thread-3 (]: 11 of 22 START sql table model dbt_warehouse.customer_salary ................... [RUN]
[0m14:57:53.892006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_balances, now model.maker_warehouse.customer_salary)
[0m14:57:53.892444 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customer_salary
[0m14:57:53.895092 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customer_salary"
[0m14:57:53.896077 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (compile): 14:57:53.892581 => 14:57:53.895935
[0m14:57:53.896298 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customer_salary
[0m14:57:53.899703 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customer_salary"
[0m14:57:53.900310 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.900495 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: BEGIN
[0m14:57:53.900659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:53.914814 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:53.915320 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.915555 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */

  
    

  create  table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.customerid,
	c.surname,
	c.geography,
	c.gender,
	s.estimatedsalary
FROM "mydb"."dbt_warehouse"."customers_dim" c
JOIN salary s ON c.customerid = s.customerid
  );
  
[0m14:57:53.925627 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:57:53.927663 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.927876 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:53.928116 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies" rename to "movies__dbt_backup"
[0m14:57:53.929689 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.929941 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary" rename to "customer_salary__dbt_backup"
[0m14:57:53.931160 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.931345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.933420 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.935448 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.935701 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
alter table "mydb"."dbt_warehouse"."customer_salary__dbt_tmp" rename to "customer_salary"
[0m14:57:53.936086 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
alter table "mydb"."dbt_warehouse"."movies__dbt_tmp" rename to "movies"
[0m14:57:53.938656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.938931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:53.940438 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:57:53.941697 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:57:53.941917 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.942096 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.942261 [debug] [Thread-1 (]: On model.maker_warehouse.movies: COMMIT
[0m14:57:53.942418 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: COMMIT
[0m14:57:53.980127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.981720 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customer_salary"
[0m14:57:53.981906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:53.982106 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customer_salary"} */
drop table if exists "mydb"."dbt_warehouse"."customer_salary__dbt_backup" cascade
[0m14:57:53.983285 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.movies"
[0m14:57:53.983512 [debug] [Thread-1 (]: On model.maker_warehouse.movies: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movies"} */
drop table if exists "mydb"."dbt_warehouse"."movies__dbt_backup" cascade
[0m14:57:53.988722 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:53.989768 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customer_salary (execute): 14:57:53.896421 => 14:57:53.989564
[0m14:57:53.990393 [debug] [Thread-3 (]: On model.maker_warehouse.customer_salary: Close
[0m14:57:53.990992 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d99f10>]}
[0m14:57:53.991455 [info ] [Thread-3 (]: 11 of 22 OK created sql table model dbt_warehouse.customer_salary .............. [[32mSELECT 0[0m in 0.10s]
[0m14:57:53.991942 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customer_salary
[0m14:57:53.992248 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:57:53.992638 [info ] [Thread-3 (]: 12 of 22 START sql table model dbt_warehouse.sum_avg_age_by_geography .......... [RUN]
[0m14:57:53.993467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customer_salary, now model.maker_warehouse.sum_avg_age_by_geography)
[0m14:57:53.994074 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_age_by_geography
[0m14:57:53.997119 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:53.997955 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (compile): 14:57:53.994244 => 14:57:53.997595
[0m14:57:53.998176 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_age_by_geography
[0m14:57:54.002275 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.002559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.003669 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.movies (execute): 14:57:53.426486 => 14:57:54.003575
[0m14:57:54.004057 [debug] [Thread-1 (]: On model.maker_warehouse.movies: Close
[0m14:57:54.004273 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.004614 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: BEGIN
[0m14:57:54.005037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db7510>]}
[0m14:57:54.005242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:54.005618 [info ] [Thread-1 (]: 6 of 22 OK created sql table model dbt_warehouse.movies ........................ [[32mSELECT 8472[0m in 0.59s]
[0m14:57:54.006518 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.movies
[0m14:57:54.006803 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:57:54.007283 [info ] [Thread-1 (]: 13 of 22 START sql table model dbt_warehouse.sum_avg_balance_by_geography ...... [RUN]
[0m14:57:54.007835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movies, now model.maker_warehouse.sum_avg_balance_by_geography)
[0m14:57:54.008362 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:57:54.011080 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.012475 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (compile): 14:57:54.008754 => 14:57:54.011759
[0m14:57:54.012982 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:57:54.016337 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.016930 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.017119 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: BEGIN
[0m14:57:54.017309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:54.034491 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.034853 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.035418 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	geography,
	AVG(age) AS average_age
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY geography
  );
  
[0m14:57:54.035722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.036043 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.036346 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.geography,
	AVG(balance) AS average_balance
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY c.geography
  );
  
[0m14:57:54.051369 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:57:54.053552 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.053822 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography" rename to "sum_avg_age_by_geography__dbt_backup"
[0m14:57:54.055273 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.057034 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.057225 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:57:54.057469 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_tmp" rename to "sum_avg_age_by_geography"
[0m14:57:54.059030 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.059305 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography" rename to "sum_avg_balance_by_geography__dbt_backup"
[0m14:57:54.060229 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.061561 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:57:54.061736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.061916 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.063491 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.063703 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: COMMIT
[0m14:57:54.063904 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
alter table "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_tmp" rename to "sum_avg_balance_by_geography"
[0m14:57:54.077052 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.077501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.080537 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_age_by_geography"
[0m14:57:54.082451 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:57:54.082733 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_age_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_age_by_geography__dbt_backup" cascade
[0m14:57:54.082925 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.083185 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: COMMIT
[0m14:57:54.121757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.125916 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_avg_balance_by_geography"
[0m14:57:54.126223 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_balance_by_geography"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_balance_by_geography__dbt_backup" cascade
[0m14:57:54.133493 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.133810 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.135135 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_age_by_geography (execute): 14:57:53.998300 => 14:57:54.135017
[0m14:57:54.136032 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_avg_balance_by_geography (execute): 14:57:54.013145 => 14:57:54.135932
[0m14:57:54.136224 [debug] [Thread-2 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:57:54.136443 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_age_by_geography: Close
[0m14:57:54.136711 [debug] [Thread-1 (]: On model.maker_warehouse.sum_avg_balance_by_geography: Close
[0m14:57:54.138808 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:54.139310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae1a90>]}
[0m14:57:54.139712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbc0d0>]}
[0m14:57:54.139977 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users" rename to "users__dbt_backup"
[0m14:57:54.140430 [info ] [Thread-3 (]: 12 of 22 OK created sql table model dbt_warehouse.sum_avg_age_by_geography ..... [[32mSELECT 3[0m in 0.15s]
[0m14:57:54.140759 [info ] [Thread-1 (]: 13 of 22 OK created sql table model dbt_warehouse.sum_avg_balance_by_geography . [[32mSELECT 3[0m in 0.13s]
[0m14:57:54.141794 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_age_by_geography
[0m14:57:54.142108 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_avg_balance_by_geography
[0m14:57:54.142369 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:57:54.142917 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:57:54.143467 [info ] [Thread-3 (]: 14 of 22 START sql table model dbt_warehouse.sum_avg_credit_score_by_age_group . [RUN]
[0m14:57:54.144075 [info ] [Thread-1 (]: 15 of 22 START sql table model dbt_warehouse.sum_total_customers_by_gender ..... [RUN]
[0m14:57:54.144708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_age_by_geography, now model.maker_warehouse.sum_avg_credit_score_by_age_group)
[0m14:57:54.145156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_balance_by_geography, now model.maker_warehouse.sum_total_customers_by_gender)
[0m14:57:54.145386 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:57:54.145637 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_gender
[0m14:57:54.145834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.147963 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.149430 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.151072 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:54.151461 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
alter table "mydb"."dbt_warehouse"."users__dbt_tmp" rename to "users"
[0m14:57:54.151812 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (compile): 14:57:54.148200 => 14:57:54.151694
[0m14:57:54.152029 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (compile): 14:57:54.146025 => 14:57:54.151931
[0m14:57:54.152245 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_customers_by_gender
[0m14:57:54.152528 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:57:54.155232 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.155470 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.158125 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.161889 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:57:54.162576 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.163284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:54.163650 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.163976 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: BEGIN
[0m14:57:54.164310 [debug] [Thread-2 (]: On model.maker_warehouse.users: COMMIT
[0m14:57:54.164600 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: BEGIN
[0m14:57:54.164863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:54.165210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:54.172735 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.175086 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.users"
[0m14:57:54.175343 [debug] [Thread-2 (]: On model.maker_warehouse.users: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.users"} */
drop table if exists "mydb"."dbt_warehouse"."users__dbt_backup" cascade
[0m14:57:54.179283 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.179645 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.179859 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	CASE
		WHEN c.age < 30 THEN 'Under 30'
		WHEN c.age >= 30 AND age < 40 THEN '30-39'
		WHEN c.age >= 40 AND age < 50 THEN '40-49'
		ELSE '50+'
	END AS age_group,
	AVG(b.creditscore) AS average_credit_score
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
GROUP BY age_group
  );
  
[0m14:57:54.181124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.181495 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.181688 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	gender,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY gender
  );
  
[0m14:57:54.195670 [debug] [Thread-4 (]: SQL status: SELECT 671736 in 1.0 seconds
[0m14:57:54.198365 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:54.198589 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.198771 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:57:54.198992 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings" rename to "movie_viewings__dbt_backup"
[0m14:57:54.199787 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.users (execute): 14:57:53.517511 => 14:57:54.199678
[0m14:57:54.201312 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.201492 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:57:54.201726 [debug] [Thread-2 (]: On model.maker_warehouse.users: Close
[0m14:57:54.201935 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender" rename to "sum_total_customers_by_gender__dbt_backup"
[0m14:57:54.203333 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.203495 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.204025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6ee10>]}
[0m14:57:54.204261 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group" rename to "sum_avg_credit_score_by_age_group__dbt_backup"
[0m14:57:54.206955 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:54.207274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.207932 [info ] [Thread-2 (]: 8 of 22 OK created sql table model dbt_warehouse.users ......................... [[32mSELECT 161918[0m in 0.69s]
[0m14:57:54.208360 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
alter table "mydb"."dbt_warehouse"."movie_viewings__dbt_tmp" rename to "movie_viewings"
[0m14:57:54.210623 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.211126 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.users
[0m14:57:54.211433 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_tmp" rename to "sum_total_customers_by_gender"
[0m14:57:54.211687 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:57:54.212039 [info ] [Thread-2 (]: 16 of 22 START sql table model dbt_warehouse.sum_total_customers_by_satisfaction_score  [RUN]
[0m14:57:54.212896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.users, now model.maker_warehouse.sum_total_customers_by_satisfaction_score)
[0m14:57:54.213166 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:57:54.215759 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.216108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.217456 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:57:54.217674 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.217828 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.218039 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.219715 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.219932 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_satisfaction_score (compile): 14:57:54.213330 => 14:57:54.219831
[0m14:57:54.221213 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:57:54.221426 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: COMMIT
[0m14:57:54.221629 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
alter table "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_tmp" rename to "sum_avg_credit_score_by_age_group"
[0m14:57:54.221837 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:57:54.222011 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:54.225034 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.225303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.225526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.225720 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: COMMIT
[0m14:57:54.227260 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_gender"
[0m14:57:54.228935 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:57:54.229230 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.229455 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_gender"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_gender__dbt_backup" cascade
[0m14:57:54.229663 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.229925 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: BEGIN
[0m14:57:54.230197 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: COMMIT
[0m14:57:54.230548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:54.230984 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.232416 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.movie_viewings"
[0m14:57:54.232744 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.232959 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.movie_viewings"} */
drop table if exists "mydb"."dbt_warehouse"."movie_viewings__dbt_backup" cascade
[0m14:57:54.234392 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_avg_credit_score_by_age_group"
[0m14:57:54.234976 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_avg_credit_score_by_age_group"} */
drop table if exists "mydb"."dbt_warehouse"."sum_avg_credit_score_by_age_group__dbt_backup" cascade
[0m14:57:54.235230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.236228 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_gender (execute): 14:57:54.152692 => 14:57:54.236117
[0m14:57:54.236467 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_gender: Close
[0m14:57:54.236914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcc190>]}
[0m14:57:54.237247 [info ] [Thread-1 (]: 15 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_gender  [[32mSELECT 2[0m in 0.09s]
[0m14:57:54.237602 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_customers_by_gender
[0m14:57:54.237825 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:57:54.238210 [info ] [Thread-1 (]: 17 of 22 START sql table model dbt_warehouse.sum_total_customers_by_tenure ..... [RUN]
[0m14:57:54.238651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_gender, now model.maker_warehouse.sum_total_customers_by_tenure)
[0m14:57:54.238846 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:57:54.242151 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.243558 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (compile): 14:57:54.239019 => 14:57:54.243251
[0m14:57:54.243854 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:57:54.248114 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.248830 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.249301 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.249962 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: BEGIN
[0m14:57:54.252169 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_avg_credit_score_by_age_group (execute): 14:57:54.155620 => 14:57:54.251723
[0m14:57:54.252743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:54.253384 [debug] [Thread-3 (]: On model.maker_warehouse.sum_avg_credit_score_by_age_group: Close
[0m14:57:54.254635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d03a90>]}
[0m14:57:54.255873 [info ] [Thread-3 (]: 14 of 22 OK created sql table model dbt_warehouse.sum_avg_credit_score_by_age_group  [[32mSELECT 4[0m in 0.11s]
[0m14:57:54.256844 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_avg_credit_score_by_age_group
[0m14:57:54.257314 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:57:54.257799 [info ] [Thread-3 (]: 18 of 22 START sql table model dbt_warehouse.sum_total_exited_by_card_type ..... [RUN]
[0m14:57:54.258427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_avg_credit_score_by_age_group, now model.maker_warehouse.sum_total_exited_by_card_type)
[0m14:57:54.258629 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:57:54.262328 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.262993 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (compile): 14:57:54.258757 => 14:57:54.262871
[0m14:57:54.263204 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:57:54.266675 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.267019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.267374 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.267620 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	satisfactionscore,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY satisfactionscore
  );
  
[0m14:57:54.267965 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.268163 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: BEGIN
[0m14:57:54.268351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:54.273863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.274264 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.274484 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	tenure,
	COUNT(*) AS total_customers
FROM "mydb"."dbt_warehouse"."customers_dim"
GROUP BY tenure
  );
  
[0m14:57:54.277823 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.0 seconds
[0m14:57:54.279970 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.280223 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score" rename to "sum_total_customers_by_satisfaction_score__dbt_backup"
[0m14:57:54.283055 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.285998 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.286567 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:57:54.287067 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_tmp" rename to "sum_total_customers_by_satisfaction_score"
[0m14:57:54.289843 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.290255 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.290670 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure" rename to "sum_total_customers_by_tenure__dbt_backup"
[0m14:57:54.290925 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.291727 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp"
  
  
    as
  
  (
    

SELECT
	c.cardtype,
	COUNT(*) AS total_exited
FROM "mydb"."dbt_warehouse"."banking_fact" b
JOIN "mydb"."dbt_warehouse"."customers_dim" c ON b.customerid = c.customerid
WHERE b.exited = 1
GROUP BY c.cardtype
  );
  
[0m14:57:54.292513 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.294693 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: COMMIT
[0m14:57:54.295055 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.295281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.295521 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: COMMIT
[0m14:57:54.297698 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.298051 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
alter table "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_tmp" rename to "sum_total_customers_by_tenure"
[0m14:57:54.299754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.300109 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.302679 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:57:54.304364 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_satisfaction_score"
[0m14:57:54.304609 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.304833 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_satisfaction_score"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_satisfaction_score__dbt_backup" cascade
[0m14:57:54.305030 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: COMMIT
[0m14:57:54.308153 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.308436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.309386 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_total_customers_by_satisfaction_score (execute): 14:57:54.222194 => 14:57:54.309276
[0m14:57:54.309586 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m14:57:54.311086 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_total_customers_by_tenure"
[0m14:57:54.311318 [debug] [Thread-2 (]: On model.maker_warehouse.sum_total_customers_by_satisfaction_score: Close
[0m14:57:54.312913 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.313139 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_customers_by_tenure"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_customers_by_tenure__dbt_backup" cascade
[0m14:57:54.313377 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type" rename to "sum_total_exited_by_card_type__dbt_backup"
[0m14:57:54.313798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da7090>]}
[0m14:57:54.314194 [info ] [Thread-2 (]: 16 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_satisfaction_score  [[32mSELECT 5[0m in 0.10s]
[0m14:57:54.314555 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_total_customers_by_satisfaction_score
[0m14:57:54.316635 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.318460 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.318659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.318867 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
alter table "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_tmp" rename to "sum_total_exited_by_card_type"
[0m14:57:54.319666 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_total_customers_by_tenure (execute): 14:57:54.243982 => 14:57:54.319568
[0m14:57:54.319900 [debug] [Thread-1 (]: On model.maker_warehouse.sum_total_customers_by_tenure: Close
[0m14:57:54.320297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcc190>]}
[0m14:57:54.320613 [info ] [Thread-1 (]: 17 of 22 OK created sql table model dbt_warehouse.sum_total_customers_by_tenure  [[32mSELECT 11[0m in 0.08s]
[0m14:57:54.320942 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_total_customers_by_tenure
[0m14:57:54.321240 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.322715 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:57:54.322960 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.323149 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: COMMIT
[0m14:57:54.324151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.326138 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_total_exited_by_card_type"
[0m14:57:54.326728 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_total_exited_by_card_type"} */
drop table if exists "mydb"."dbt_warehouse"."sum_total_exited_by_card_type__dbt_backup" cascade
[0m14:57:54.330982 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.331953 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_total_exited_by_card_type (execute): 14:57:54.263328 => 14:57:54.331856
[0m14:57:54.332160 [debug] [Thread-3 (]: On model.maker_warehouse.sum_total_exited_by_card_type: Close
[0m14:57:54.332611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108432650>]}
[0m14:57:54.332961 [info ] [Thread-3 (]: 18 of 22 OK created sql table model dbt_warehouse.sum_total_exited_by_card_type  [[32mSELECT 4[0m in 0.07s]
[0m14:57:54.333344 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_total_exited_by_card_type
[0m14:57:54.350079 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.350950 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.movie_viewings (execute): 14:57:53.401007 => 14:57:54.350864
[0m14:57:54.351127 [debug] [Thread-4 (]: On model.maker_warehouse.movie_viewings: Close
[0m14:57:54.351502 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2a290>]}
[0m14:57:54.351797 [info ] [Thread-4 (]: 5 of 22 OK created sql table model dbt_warehouse.movie_viewings ................ [[32mSELECT 671736[0m in 0.96s]
[0m14:57:54.352110 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.movie_viewings
[0m14:57:54.352867 [debug] [Thread-2 (]: Began running node model.maker_warehouse.sum_genre_views
[0m14:57:54.353109 [debug] [Thread-1 (]: Began running node model.maker_warehouse.sum_movie_viewing_time
[0m14:57:54.353483 [debug] [Thread-3 (]: Began running node model.maker_warehouse.sum_movie_views
[0m14:57:54.353685 [debug] [Thread-4 (]: Began running node model.maker_warehouse.sum_user_activity
[0m14:57:54.353310 [info ] [Thread-2 (]: 19 of 22 START sql table model dbt_warehouse.sum_genre_views ................... [RUN]
[0m14:57:54.353984 [info ] [Thread-1 (]: 20 of 22 START sql table model dbt_warehouse.sum_movie_viewing_time ............ [RUN]
[0m14:57:54.354485 [info ] [Thread-3 (]: 21 of 22 START sql table model dbt_warehouse.sum_movie_views ................... [RUN]
[0m14:57:54.354782 [info ] [Thread-4 (]: 22 of 22 START sql table model dbt_warehouse.sum_user_activity ................. [RUN]
[0m14:57:54.355216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_satisfaction_score, now model.maker_warehouse.sum_genre_views)
[0m14:57:54.355536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_customers_by_tenure, now model.maker_warehouse.sum_movie_viewing_time)
[0m14:57:54.355828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.sum_total_exited_by_card_type, now model.maker_warehouse.sum_movie_views)
[0m14:57:54.356121 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.movie_viewings, now model.maker_warehouse.sum_user_activity)
[0m14:57:54.356301 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.sum_genre_views
[0m14:57:54.356466 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.sum_movie_viewing_time
[0m14:57:54.356627 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.sum_movie_views
[0m14:57:54.356785 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.sum_user_activity
[0m14:57:54.358949 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.sum_genre_views"
[0m14:57:54.360745 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.362646 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.sum_movie_views"
[0m14:57:54.364858 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.sum_user_activity"
[0m14:57:54.365783 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (compile): 14:57:54.360936 => 14:57:54.365650
[0m14:57:54.366056 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (compile): 14:57:54.359186 => 14:57:54.365916
[0m14:57:54.366302 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (compile): 14:57:54.356898 => 14:57:54.366193
[0m14:57:54.366561 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.sum_movie_views
[0m14:57:54.366766 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (compile): 14:57:54.362905 => 14:57:54.366678
[0m14:57:54.367015 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.sum_movie_viewing_time
[0m14:57:54.367221 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.sum_genre_views
[0m14:57:54.370911 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_views"
[0m14:57:54.371185 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.sum_user_activity
[0m14:57:54.373579 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.375898 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.sum_genre_views"
[0m14:57:54.378447 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.sum_user_activity"
[0m14:57:54.378813 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.379061 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:54.379240 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.379409 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: BEGIN
[0m14:57:54.379600 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:54.379750 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: BEGIN
[0m14:57:54.379924 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: BEGIN
[0m14:57:54.380086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:54.380247 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: BEGIN
[0m14:57:54.380402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:54.380559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:54.380787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:54.391191 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.391635 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.391894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.392066 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.392275 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:54.392451 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:54.392641 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_views
FROM (
    SELECT
        movie_id,
        COUNT(*) AS total_views
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:57:54.392840 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(DISTINCT movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings,
    SUM(duration) AS total_viewing_time
FROM "mydb"."dbt_warehouse"."movie_viewings"
GROUP BY user_id
  );
  
[0m14:57:54.393032 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    m.genres,
    COUNT(DISTINCT mv.movie_id) AS each_movie_viewed,
    COUNT(*) AS total_viewings
FROM "mydb"."dbt_warehouse"."movie_viewings" mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
GROUP BY genres
  );
  
[0m14:57:54.393415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:54.393609 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.393800 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */

  
    

  create  table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    mv.movie_id,
    m.title,
    mv.total_viewing_time
FROM (
    SELECT
        movie_id,
        SUM(duration) AS total_viewing_time
    FROM "mydb"."dbt_warehouse"."movie_viewings"
    GROUP BY movie_id
) mv
LEFT JOIN "mydb"."dbt_warehouse"."movies" m
ON mv.movie_id = m.movie_id
  );
  
[0m14:57:54.755985 [debug] [Thread-3 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:57:54.760323 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.760979 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views" rename to "sum_movie_views__dbt_backup"
[0m14:57:54.763014 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.767412 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.768101 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
alter table "mydb"."dbt_warehouse"."sum_movie_views__dbt_tmp" rename to "sum_movie_views"
[0m14:57:54.769212 [debug] [Thread-1 (]: SQL status: SELECT 8472 in 0.0 seconds
[0m14:57:54.769623 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.771368 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.772677 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:57:54.773196 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time" rename to "sum_movie_viewing_time__dbt_backup"
[0m14:57:54.773859 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.774487 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: COMMIT
[0m14:57:54.776933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.779048 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.779292 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.779714 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
alter table "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_tmp" rename to "sum_movie_viewing_time"
[0m14:57:54.782947 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.sum_movie_views"
[0m14:57:54.783531 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_views__dbt_backup" cascade
[0m14:57:54.784468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:54.788299 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:57:54.788849 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.789296 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.789761 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: COMMIT
[0m14:57:54.790819 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.sum_movie_views (execute): 14:57:54.367353 => 14:57:54.790719
[0m14:57:54.791137 [debug] [Thread-3 (]: On model.maker_warehouse.sum_movie_views: Close
[0m14:57:54.791609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da7090>]}
[0m14:57:54.791971 [info ] [Thread-3 (]: 21 of 22 OK created sql table model dbt_warehouse.sum_movie_views .............. [[32mSELECT 8472[0m in 0.44s]
[0m14:57:54.792330 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.sum_movie_views
[0m14:57:54.792739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:54.794267 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.sum_movie_viewing_time"
[0m14:57:54.794507 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_movie_viewing_time"} */
drop table if exists "mydb"."dbt_warehouse"."sum_movie_viewing_time__dbt_backup" cascade
[0m14:57:54.800598 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:54.802677 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.sum_movie_viewing_time (execute): 14:57:54.371333 => 14:57:54.802276
[0m14:57:54.803117 [debug] [Thread-1 (]: On model.maker_warehouse.sum_movie_viewing_time: Close
[0m14:57:54.804005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aef050>]}
[0m14:57:54.804668 [info ] [Thread-1 (]: 20 of 22 OK created sql table model dbt_warehouse.sum_movie_viewing_time ....... [[32mSELECT 8472[0m in 0.45s]
[0m14:57:54.805601 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.sum_movie_viewing_time
[0m14:57:55.171743 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 1.0 seconds
[0m14:57:55.176487 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:55.177092 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views" rename to "sum_genre_views__dbt_backup"
[0m14:57:55.179200 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:55.183619 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:55.184261 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
alter table "mydb"."dbt_warehouse"."sum_genre_views__dbt_tmp" rename to "sum_genre_views"
[0m14:57:55.185680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:55.188366 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:57:55.188652 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:55.188844 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: COMMIT
[0m14:57:55.196866 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:55.200197 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.sum_genre_views"
[0m14:57:55.200508 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_genre_views"} */
drop table if exists "mydb"."dbt_warehouse"."sum_genre_views__dbt_backup" cascade
[0m14:57:55.203820 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:55.204781 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.sum_genre_views (execute): 14:57:54.373757 => 14:57:55.204687
[0m14:57:55.204992 [debug] [Thread-2 (]: On model.maker_warehouse.sum_genre_views: Close
[0m14:57:55.205387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7e950>]}
[0m14:57:55.205709 [info ] [Thread-2 (]: 19 of 22 OK created sql table model dbt_warehouse.sum_genre_views .............. [[32mSELECT 1190[0m in 0.85s]
[0m14:57:55.206037 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.sum_genre_views
[0m14:57:55.387239 [debug] [Thread-4 (]: SQL status: SELECT 161918 in 1.0 seconds
[0m14:57:55.393568 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:55.394246 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity" rename to "sum_user_activity__dbt_backup"
[0m14:57:55.395623 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:55.399819 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:55.400094 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
alter table "mydb"."dbt_warehouse"."sum_user_activity__dbt_tmp" rename to "sum_user_activity"
[0m14:57:55.400897 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:55.402123 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:57:55.402304 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:55.402474 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: COMMIT
[0m14:57:55.408156 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:57:55.409587 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.sum_user_activity"
[0m14:57:55.409775 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.sum_user_activity"} */
drop table if exists "mydb"."dbt_warehouse"."sum_user_activity__dbt_backup" cascade
[0m14:57:55.423417 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:55.425731 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.sum_user_activity (execute): 14:57:54.376153 => 14:57:55.425642
[0m14:57:55.425938 [debug] [Thread-4 (]: On model.maker_warehouse.sum_user_activity: Close
[0m14:57:55.426334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dfc68b-55ae-4563-b775-494763ea10b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844ded0>]}
[0m14:57:55.426658 [info ] [Thread-4 (]: 22 of 22 OK created sql table model dbt_warehouse.sum_user_activity ............ [[32mSELECT 161918[0m in 1.07s]
[0m14:57:55.426977 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.sum_user_activity
[0m14:57:55.428194 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:55.428383 [debug] [MainThread]: On master: BEGIN
[0m14:57:55.428520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:55.438138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:55.438426 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.438586 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:55.438738 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.439631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:55.439849 [debug] [MainThread]: On master: Close
[0m14:57:55.440219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:55.440363 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_viewing_time' was properly closed.
[0m14:57:55.440491 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_genre_views' was properly closed.
[0m14:57:55.440608 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_movie_views' was properly closed.
[0m14:57:55.440720 [debug] [MainThread]: Connection 'model.maker_warehouse.sum_user_activity' was properly closed.
[0m14:57:55.440930 [info ] [MainThread]: 
[0m14:57:55.441152 [info ] [MainThread]: Finished running 1 view model, 21 table models in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m14:57:55.442802 [debug] [MainThread]: Command end result
[0m14:57:55.448284 [info ] [MainThread]: 
[0m14:57:55.448696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:55.449210 [info ] [MainThread]: 
[0m14:57:55.449681 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m14:57:55.451736 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:55.451680 after 2.59 seconds
[0m14:57:55.452225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11dd0>]}
[0m14:57:55.949354 [debug] [MainThread]: Flushing usage events
